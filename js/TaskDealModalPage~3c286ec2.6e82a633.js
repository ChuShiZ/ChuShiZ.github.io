(window["webpackJsonp_joinsoft-v9"]=window["webpackJsonp_joinsoft-v9"]||[]).push([["TaskDealModalPage~3c286ec2"],{"175a":function(e,t,r){"use strict";r("6202")},"41b8":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return 1===e.type?n("proj-modal",{ref:"projModal",attrs:{query:e.query}}):n("div",[n("div",{staticClass:"page-header-index-wide"},[n("a-card",{style:{height:"100%"},attrs:{bordered:!1,bodyStyle:{padding:"16px 0",height:"100%"}}},[n("a-spin",{attrs:{spinning:e.confirmLoading}},[n("div",{staticClass:"account-settings-info-main"},[n("div",{staticClass:"account-settings-info-left"},[n("a-menu",{style:{border:"0",width:"auto"},attrs:{mode:"inline",defaultSelectedKeys:e.defaultSelectedKeys,selectedKeys:e.selectedKeys,type:"inner"}},[n("a-menu-item",{key:"/account/settings/base",on:{click:function(t){return e.baseInfoClick()}}},[e._v("\n                "+e._s("审批信息")+"\n              ")]),n("a-menu-item",{key:"/account/settings/custom",on:{click:function(t){return e.flowChartClick()}}},[e._v("\n                审批流程\n              ")])],1)],1),n("div",{staticClass:"account-settings-info-right",staticStyle:{"overflow-x":"auto"}},[n("div",{staticClass:"account-settings-info-title"},[e.approvalInfoFlag?n("div",{staticStyle:{width:"100%","overflow-y":"auto","min-height":"100%",height:"100%"}},[n("a-card",{staticStyle:{width:"100%"}},[n(r("4b3b")("./"+e.pageName).default,{ref:"modalForm",tag:"component",attrs:{zIndex:e.compIndex,title:e.title,isTask:e.isTask,operate:e.operate,"req-id":e.reqId,"req-no":e.reqNo,"show-type":e.showType},on:{back:e.back,ok:e.back,close:e.close,errback:e.errback}})],1),e.onlyView?e._e():n("div",[n("a-card",{staticStyle:{width:"100%","margin-top":"5px"}},[n("a-tabs",{attrs:{defaultActiveKey:"1"}},[n("a-tab-pane",{key:"1",attrs:{tab:"意见信息"}},[n("j-form-container",{ref:"formRow",attrs:{rules:e.rules,disabled:!1,model:e.approveInfo,border:!1}},[n("a-row",{ref:"formOwnRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[n("a-col",{attrs:{span:4}},[e._v("\n                              审批选项\n                            ")]),n("a-col",{attrs:{span:8}},[n("a-radio-group",{on:{change:e.flagChange},model:{value:e.approveInfo.flag,callback:function(t){e.$set(e.approveInfo,"flag",t)},expression:"approveInfo.flag"}},[n("a-radio",{attrs:{value:1,ariaLabel:"同意"}},[e._v("\n                                  同意\n                                ")]),n("a-radio",{attrs:{value:3,"data-attr":"不同意"}},[e._v("\n                                  不同意\n                                ")]),-1===(e.innerpage+"").indexOf("break")?n("a-radio",{attrs:{value:0,"data-attr":"打回"}},[e._v("\n                                  打回\n                                ")]):e._e()],1)],1),n("a-col",{attrs:{span:4}}),n("a-col",{attrs:{span:8}}),n("a-col",{staticClass:"height-130",attrs:{span:4}},[n("span",{staticClass:"requiredText"},[e._v("*")]),e._v("审批意见\n                            ")]),n("a-col",{staticClass:"height-130",attrs:{span:20,"data-prop":"comment"}},[n("a-textarea",{attrs:{placeholder:"请输入审批意见",autosize:{minRows:5,maxRows:8}},model:{value:e.approveInfo.comment,callback:function(t){e.$set(e.approveInfo,"comment",t)},expression:"approveInfo.comment"}})],1)],1)],1)],1)],1)],1)],1)],1):e._e(),e.flowChartFlag?n("div",[n("a-divider",{attrs:{orientation:"left"}},[e._v("历史流程记录")]),n("div",{staticStyle:{"margin-top":"15px"}},[n("a-table",{ref:"table",attrs:{size:"middle",bordered:"",columns:e.columns,dataSource:e.dataSource,pagination:!1}})],1),n("a-divider",{attrs:{orientation:"left"}},[e._v("流程图")]),n("div",[n("img",{staticStyle:{width:"100%",cursor:"pointer"},attrs:{src:e.imageUrl,alt:""},on:{click:function(t){return e.handlePreview1(t,e.imageUrl,0)}}})])],1):e._e()])])])])],1)],1),e.previewVisible?n("div",{staticClass:"outer_box"},[n("previewPicture",{attrs:{isEdit:!1,isFlow:!0,fileNum:0,fileList:e.previewFileList},on:{cancel:function(t){e.previewVisible=!1}}})],1):e._e(),n("div",{staticStyle:{"text-align":"center",right:"0px",background:"rgb(255, 255, 255)","z-index":"999",width:"100%","padding-bottom":"20px"}},[n("a-button",{key:"back",attrs:{icon:"close"},on:{click:e.handleCancel}},[e._v("关闭")]),!e.onlyView&&e.approvalInfoFlag?n("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",loading:e.confirmLoading,icon:"check-circle"},on:{click:function(t){return e.adult()}}},[e._v("确定")]):e._e()],1)])},a=[],i=r("b65a"),o=r("0fea"),s=r("ac0d"),c=r("b7a8"),l=r("b801"),u=r("3dfe"),f=r("2b0e"),h=r("bc3a"),d=r.n(h);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */m=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,o=Object.create(i.prototype),s=new K(n||[]);return a(o,"_invoke",{value:C(e,r,s)}),o}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",d="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function k(){}var x={};l(x,o,(function(){return this}));var I=Object.getPrototypeOf,L=I&&I(I(j([])));L&&L!==r&&n.call(L,o)&&(x=L);var F=k.prototype=b.prototype=Object.create(x);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(a,i,o,s){var c=f(e[a],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==p(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(u).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,s)}))}s(c.arg)}var i;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function C(t,r,n){var a=h;return function(i,o){if(a===g)throw Error("Generator is already running");if(a===v){if("throw"===i)throw o;return{value:e,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===h)throw a=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=g;var l=f(t,r,n);if("normal"===l.type){if(a=n.done?v:d,l.arg===y)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=v,n.method="throw",n.arg=l.arg)}}}function P(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function $(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function K(e){this.tryEntries=[{tryLoc:"root"}],e.forEach($,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(p(t)+" is not iterable")}return w.prototype=k,a(F,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:w,configurable:!0}),w.displayName=l(k,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,l(e,c,"GeneratorFunction")),e.prototype=Object.create(F),e},t.awrap=function(e){return{__await:e}},_(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var o=new S(u(e,r,n,a),i);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(F),l(F,c,"Generator"),l(F,o,(function(){return this})),l(F,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,K.prototype={constructor:K,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function g(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){g(i,n,a,o,s,"next",e)}function s(e){g(i,n,a,o,s,"throw",e)}o(void 0)}))}}var y={name:"TaskDealModalPage",components:{PreviewPicture:c["default"],projModal:u["default"]},mixins:[i["a"],s["b"],l["a"]],computed:{compIndex:function(){return(this.$attrs["z-index"]||this.$attrs["zIndex"]||1e3)+1}},data:function(){return{type:0,query:null,useProcessKey:{process_key:"",process_key_insure:""},filingProcessKey:"b_busi_req.project_filing",flowId:null,taskPrimaryKey:null,pageName:null,flow:null,editUrl:null,innerpage:null,internalUrl:null,showType:"page",confirmLoading:!1,visible:!1,width:"",revokeMethod:"",domHeight:800,mainTitle:"",selectedKeys:[],defaultSelectedKeys:[],isTask:"none",disableMixinCreated:!0,labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:16}},columns:[{title:"序号",dataIndex:"",key:"rowIndex",width:50,align:"center",customRender:function(e,t,r){return parseInt(r)+1}},{title:"任务名称",align:"center",width:160,dataIndex:"name",ellipsis:!0},{title:"处理人",align:"center",width:100,dataIndex:"assigneeName",customRender:function(e,t){return e||t.assignee},ellipsis:!0},{title:"耗时",align:"center",width:180,dataIndex:"duration",customRender:function(e,t,r){var n=t.duration,a="";if(null!=n){var i=Math.floor(n/864e5);0!==i&&(a+=i+"天");var o=n%864e5,s=Math.floor(o/36e5);0!==s&&(a+=s+"小时");var c=o%36e5,l=Math.floor(c/6e4);0!==l&&(a+=l+"分");var u=Math.round(c%6e4/1e3);a+=u+"秒"}return a}},{title:"开始时间",align:"center",width:160,dataIndex:"startTime"},{title:"结束时间",align:"center",width:160,dataIndex:"endTime"},{title:"审批结果",align:"center",dataIndex:"taskFlow",width:80,customRender:function(e){return e+""==="1"?"通过":e+""==="0"?"未通过":e}},{title:"审批意见",align:"center",dataIndex:"comment"}],flowOptionFlag:!1,isLoanShow:!1,confirmPaymentFlag:!1,fileFlag:!1,branch:!1,printVis:!1,approverVis:!1,approvalInfoFlag:!1,plan:!1,flowChartFlag:!1,comps:[],deptList:[],selectedDept:"",dictItems:[],person:[],approver:"",agreeContents:[],disagreeContents:[],title:"",tableId:"",imageUrl:"",approveInfo:{comment:"同意",flag:1},rules:{comment:[{required:!0,message:"请输入审批意见",trigger:"change"}]},message:"",operate:"do",clickRow:{},reqId:"",reqNo:"",url:{getContentsByName:"/base/tpApprovalCommonWords/getContentsByName"},onlyView:!0,previewVisible:!1,previewFileList:[],redundantDield:{rreqId:"",rreqNo:""},record:{}}},mounted:function(){this.restartDataValue();var e=this.$main.$route.params.record,t=this.$main.$route.params.type;e&&(this.pageName=e.url,this.flowId=e.businessKey,this.innerpage=e.editUrl,this.flow=e.flow,this.internalUrl=e.internalUrl,this.taskId=e.id,this.taskPrimaryKey=e.id,e.revokeMethod&&(this.revokeMethod=e.revokeMethod)),this.toDeal(e,t)},methods:{checkData:function(){var e=this.$refs.formRow.validaRowMsg(this.$refs.formOwnRow);return e.valida},flagChange:function(e){this.approveInfo.flag=e.target.value,1===this.approveInfo.flag&&(this.approveInfo.comment="同意"),3===this.approveInfo.flag&&(this.approveInfo.comment="不同意"),0===this.approveInfo.flag&&(this.approveInfo.comment="打回")},handlePreview1:function(e,t,r){var n=[];n.push({originalImage:t,name:""}),this.previewFileList.showList=n,this.previewVisible=!1,this.previewVisible=!0},getShowOpinion:function(){if(!this.dataSource||this.dataSource.length<2)return!1;if(0===this.flow||"0"===this.flow)return!0;var e=this.getNumByDataSource(this.dataSource),t=this.getNumByDataSource(this.getErrorDataSource(this.dataSource));return e<=t},getNumByDataSource:function(e){for(var t=0,r=0;r<e.length;r++)e[r].taskFlow&&("0"===e[r].taskFlow?t=0:t++);return t+1},getErrorDataSource:function(e){var t=[],r=e.filter((function(e){return e.taskFlow&&"0"===e.taskFlow}));if(r&&r.length>0)for(var n=0;n<e.length;n++)e[n].id===r[r.length-1].id&&(t=e.slice(0,n));return t},restartDataValue:function(){this.type=0,this.message="",this.amount="",this.yjjcText="",this.approverText="",this.tripleAndBig=""},back:function(){this.confirmLoading=!1,this.$refs.modalForm.confirmLoading=!1},errback:function(){this.confirmLoading=!1,this.$refs.modalForm.confirmLoading=!1},chooseContent:function(e){this.approveInfo.comment=e.key},initData:function(e,t,r,n){this.onlyView="do"!==n,this.record=r,this.visible=!0,this.operate=n,this.approveInfo.comment="同意",this.title=t,this.mainTitle="审批流程（"+this.title+"）",this.defaultSelectedKeys=["/account/settings/base"],this.tableId=e,this.approvalInfoFlag=!0,this.flowChartFlag=!1,this.baseInfoClick()},initDataNoBase:function(){var e=v(m().mark((function e(t,r,n,a){return m().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.record=n,this.visible=!0,this.operate=a,this.approveInfo.comment="同意",this.title=r,this.mainTitle="审批流程（"+this.title+"）",this.defaultSelectedKeys=["/account/settings/base"],this.tableId=t,this.approvalInfoFlag=!0,this.flowChartFlag=!1;case 10:case"end":return e.stop()}}),e,this)})));function t(t,r,n,a){return e.apply(this,arguments)}return t}(),toUrl:function(){var e={},t=r("c3211");t.keys().forEach((function(r){var n=t(r);e[r.replace(/^\.\/(.*)\.\w+$/,"$1")]=n.default})),this.comps=e},close:function(){this.confirmLoading=!1,this.visible=!1,this.approverVis=!1,this.deptList=[],this.approver="",this.ruleName="",this.selectedDept="",this.$refs.modalForm&&(this.$refs.modalForm.disableSubmit=!0),this.approveInfo.flag=1,this.$setGlobalState({execute:"closeCurrentPage"})},handleCancel:function(){this.close(),this.$refs.modalForm&&this.$refs.modalForm.close&&this.$refs.modalForm.close()},baseInfoClick:function(){var e=this;this.isLoanShow=!1,this.plan=!1,this.isHavePayment=!1,this.fileFlag=!1,this.approvalInfoFlag=!0,this.flowChartFlag=!1,this.approverVis=!1,this.printVis=!1,this.perForm=!1,this.selectedKeys=["/account/settings/base"],this.$nextTick(v(m().mark((function t(){var r;return m().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loadList(),e.$refs.modalForm&&"function"===typeof e.$refs.modalForm.initData&&(e.$refs.modalForm.disableSubmit=(e.record.editUrl+"").indexOf("edit")<=-1,e.$refs.modalForm.isProcess=!0,e.redundantDield.rreqId&&e.$nextTick((function(){e.$refs.modalForm.rreqId=e.redundantDield.rreqId,e.$refs.modalForm.rreqNo=e.redundantDield.rreqNo})),e.$refs.modalForm.initData(e.tableId,e.record)),r=e,r.innerpage&&-1!==r.innerpage.indexOf("bankRequired")&&r.pageName.indexOf("jsmf/base/modules/CorpInfoDetail")<0&&r.record.variables["flag"]&&"1"===r.record.variables["flag"].toString()&&(r.$refs.modalForm.bankRequired=!0);case 4:case"end":return t.stop()}}),t)}))))},flowChartClick:function(){var e=this;this.perForm=!1,this.plan=!1,this.approvalInfoFlag=!1,this.flowChartFlag=!0,this.selectedKeys=["/account/settings/custom"],this.loadList(),Object(o["e"])("/handle/getPic/"+this.flowId,{}).then((function(t){e.imageUrl="data:image/png;base64,"+t}))},loadList:function(){var e=v(m().mark((function e(){var t=this;return m().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,Object(o["e"])("/act/taskinst/history/task/"+this.flowId,{}).then((function(e){e.success?t.dataSource=e.result:t.$message.error("查询审批历史记录发生错误！")})).finally((function(){t.loading=!1}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),adult:function(){var e=v(m().mark((function e(){var t,r,n,a,i;return m().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.confirmLoading=!0,t=this,0!==this.approveInfo.flag&&"0"!==this.approveInfo.flag&&3!==this.approveInfo.flag&&"3"!==this.approveInfo.flag&&1!==this.approveInfo.flag&&"1"!==this.approveInfo.flag){e.next=6;break}if(this.checkData()){e.next=6;break}return this.confirmLoading=!1,e.abrupt("return");case 6:if(r=btoa(encodeURIComponent(this.approveInfo.comment)),null!==r&&""!==r&&void 0!==r&&0!==r.split(" ").join("").length||(r=btoa(encodeURIComponent(this.passHint))),1!==this.approveInfo.flag&&"1"!==this.approveInfo.flag){e.next=25;break}if(-1===(this.record.editUrl+"").indexOf("edit")){e.next=25;break}if(n=!0,-1===t.innerpage.indexOf("bankRequired")){e.next=20;break}if(!t.record.variables["flag"]||"1"!==t.record.variables["flag"].toString()){e.next=18;break}return e.next=15,this.$refs.modalForm.handleOk().catch((function(){n=!1}));case 15:if(n){e.next=18;break}return this.confirmLoading=!1,e.abrupt("return");case 18:e.next=25;break;case 20:return e.next=22,this.$refs.modalForm.handleOk().catch((function(){n=!1}));case 22:if(n){e.next=25;break}return this.confirmLoading=!1,e.abrupt("return");case 25:if(3!==this.approveInfo.flag&&"3"!==this.approveInfo.flag){e.next=29;break}this.revokeMethod?(a={},a.functionName=this.revokeMethod,a.message=r,a.taskId=this.dataSource.id,t.$emit("revoke",a)):Object(o["e"])("/handle/termProcess",{taskId:this.taskPrimaryKey,comment:r}).then((function(e){e.success?(t.$emit("ok"),t.confirmLoading=!1,t.$message.success("操作成功"),t.close()):(t.$message.error(e.message),t.confirmLoading=!1)})).catch((function(e){t.$message.error(e),t.confirmLoading=!1})),e.next=35;break;case 29:return i=!0,e.next=32,this.commitFLow(r).catch((function(){i=!1}));case 32:if(i){e.next=35;break}return this.confirmLoading=!1,e.abrupt("return",!1);case 35:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),commitFLow:function(){var e=v(m().mark((function e(t){var r;return m().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=this,r.confirmLoading=!0,e.next=4,Object(o["i"])("/handle/task/complete/"+this.taskPrimaryKey+"/"+this.approveInfo.flag+"/"+t+"/0/0/0/0",{},"post").then((function(e){return e.success?(r.$emit("ok"),r.$message.success(e.message),r.confirmLoading=!1,r.close(),Promise.resolve()):(r.$message.warning(e.message),r.confirmLoading=!1,Promise.reject(e.message))}));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),toDeal:function(e,t){var r=this,n=!1;this.getUseProcessKey(e).then((function(a){n=a,r.businessKey=e.businessKey,n?r.goBusiPage(r.businessKey,e.tableId,"",e.tenantId):r.filingProcessKey&&-1!==r.businessKey.indexOf(r.filingProcessKey)?r.goBusiPage(e.variables&&e.variables.mainBusinessKey?e.variables.mainBusinessKey:e.businessKey,e.variables.projId,"e",e.tenantId):r.initData(e.tableId,e.title,e,t)}))},getUseProcessKey:function(e){var t=this;return new Promise(function(){var r=v(m().mark((function r(n,a){var i,s,c;return m().wrap((function(r){while(1)switch(r.prev=r.next){case 0:i=m().mark((function r(){var a;return m().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=Object.keys(t.useProcessKey)[c],t.useProcessKey[a]&&""!==t.useProcessKey[a]){r.next=4;break}return r.next=4,Object(o["e"])("/sys/dDict/getParamByCode/".concat(a,"/").concat(e.tenantId)).then((function(e){t.useProcessKey[a]=e.result}));case 4:if(-1===e.businessKey.indexOf(t.useProcessKey[a]+"")){r.next=7;break}return n(!0),r.abrupt("return",{v:void 0});case 7:case"end":return r.stop()}}),r)})),c=0;case 2:if(!(c<Object.keys(t.useProcessKey).length)){r.next=10;break}return r.delegateYield(i(),"t0",4);case 4:if(s=r.t0,!s){r.next=7;break}return r.abrupt("return",s.v);case 7:c++,r.next=2;break;case 10:n(!1);case 11:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())},goBusiPage:function(e,t,r,n,a){var i,s=this;!a&&e&&(a=-1!==e.indexOf("b_busi_req.insurance_process")?"04":null),i="04"!=a?"process_key":"process_key_insure",Object(o["e"])("/sys/dDict/getParamByCode/".concat(i,"/").concat(n)).then((function(a){var i={params:{key:a.result},headers:{"X-Access-Token":f["default"].ls.get("Access-Token"),"tenant-id":n,sourceName:f["default"].ls.get("SOURCE_NAME"),redisIndex:f["default"].ls.get("REDIS_INDEX")}};d.a.get(window._CONFIG["domianURL"]+"/act/model/queryById",i).then((function(a){if(!a.data.success)return f["default"].prototype.$message.warning("申报流程异常，请稍后重试"),!1;var i={busiKey:e,id:t,modelId:a.data.result.id,sysOrgCode:n};r&&(i.key=r),s.query=i,window.location.path=window.location.path+"?busiKey="+e+"&id="+t+"&modelId="+a.data.result.id+"&sysOrgCode="+n,s.type=1}))}))}}},b=y,w=(r("175a"),r("e801"),r("2877")),k=Object(w["a"])(b,n,a,!1,null,"cb991cf4",null);t["default"]=k.exports},6202:function(e,t,r){},e801:function(e,t,r){"use strict";r("edc9")},edc9:function(e,t,r){}}]);