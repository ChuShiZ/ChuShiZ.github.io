(window["webpackJsonp_joinsoft-v9"]=window["webpackJsonp_joinsoft-v9"]||[]).push([["app~f7a20696"],{"00d2":function(e,t,r){},"0117":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"partTreeNode"},[r("span",{staticClass:"partTreeNode-switcher",on:{click:e.expandTree}},[e.treeData.children&&e.treeData.children.length>0?r("a-icon",{class:{iconRight:!e.isExpand},attrs:{type:"caret-down"}}):e._e()],1),r("span",{staticClass:"nodeTitle",class:{active:e.selectKey===e.treeData.longId,disabled:e.disableNode},on:{click:e.selectNode,dblclick:function(t){return e.dblClickNode(void 0,e.parentNode,void 0,"dbl")}}},[r("a-tooltip",{attrs:{title:e.treeTitle,placement:"top",arrowPointAtCenter:""}},[e._v("\n        "+e._s(e.treeTitle)+"\n      ")])],1)]),r("transition",[r("div",{directives:[{name:"show",rawName:"v-show",value:e.isExpand,expression:"isExpand"}],staticClass:"childNode"},[e._l(e.treeData.children,(function(t){return[r("repair-part-tree-node",{key:t.id,attrs:{"tree-data":t,parentNode:e.treeData,"select-key":e.selectKey,disableNodes:e.disableNodes,treeTitle:t.name},on:{"update:treeData":function(e){t=e},"update:tree-data":function(e){t=e},childSelect:e.childSelect,dblTree:e.dblClickNode}})]}))],2)])],1)},o=[],i={name:"RepairPartTreeNode",components:{RepairPartTreeNode:c},props:{treeData:{type:Object,default:function(){}},treeTitle:{type:String,default:""},selectKey:{type:String,default:""},treekey:{type:String,default:""},parentNode:{type:Object,default:null},disableNodes:{type:Array,default:function(){return[]}},firstNode:{type:Boolean,default:!1}},model:{prop:"selectKey",event:"change"},watch:{selectNodeKey:function(e){this.$emit("update:selectKey",e)},disableNodes:{immediate:!0,handler:function(){this.getPartDesc()}}},computed:{disableNode:function(){var e=this,t=!1;return this.treeNode.children&&this.treeNode.children.length>0&&this.firstNode&&this.disableNodes.length>0?(t=this.treeNode.children.every((function(t){return e.disableNodes.indexOf(t.longId)>-1})),t):-1!==this.disableNodes.indexOf(this.treeData.longId)},treeNode:{get:function(){return this.treeData},set:function(e){this.$emit("update:treeData",e)}}},data:function(){return{treeNodeKey:this.treekey?this.treekey:this.$vnode.key,isExpand:!1,selectNodeKey:this.selectKey,disableClick:!1,desc:""}},methods:{treeToArr:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((function(e){e.pid=r,e.children&&0!==e.children.length||-1!==t.disableNodes.indexOf(e.longId)||n.push(e),e.children&&0!==e.children.length&&t.treeToArr(e.children,e.id,n,e.utilityName)})),n},getPartDesc:function(){var e;e=this.parentNode?(this.parentNode.name||this.parentNode.utilityName)+"-"+this.treeTitle:this.treeTitle,this.$set(this.treeNode,"partDesc",e)},selectNode:function(){var e=this;this.disableClick||this.disableNode||(this.disableClick=!0,this.selectKey===this.treeNodeKey?this.selectNodeKey="":this.selectNodeKey=this.treeNodeKey,this.$emit("childSelect",this.selectNodeKey),setTimeout((function(){e.disableClick=!1}),500))},childSelect:function(e){this.selectNodeKey=e},dblClickNode:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"emit";if(!this.disableNode){if("emit"===n)return this.$emit("dblTree",JSON.parse(JSON.stringify(e)),JSON.parse(JSON.stringify(t||r)));var o=this.treeToArr([this.treeNode]);return this.$emit("dblTree",JSON.parse(JSON.stringify(o)),JSON.parse(JSON.stringify(this.parentNode||this.treeNode)))}},expandTree:function(){this.isExpand=!this.isExpand}}},a=i,s=(r("a628"),r("2877")),l=Object(s["a"])(a,n,o,!1,null,"c27e289a",null),c=t["default"]=l.exports},"0245":function(e,t,r){},"051f":function(e,t,r){"use strict";r("acc9")},"0d99":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wordUnit"},[r("div",{staticClass:"unitTypes"},e._l(e.unitTypes,(function(t){return r("div",{key:"unitType"+t.value,staticClass:"unitTypeItem",class:{active:e.typeActive===t.value},on:{click:function(r){return e.changeType(t)}}},[e._v("\n      "+e._s(t.label)+"\n    ")])})),0),r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("施工单位")])]),r("a-col",{attrs:{span:9}},[r("a-input",{attrs:{readOnly:""}},[r("div",{staticClass:"myTagButton",attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("选择")])])],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("施工方案")])]),r("a-col",{attrs:{span:9}},[r("a-button",{attrs:{type:"primary",icon:"plus"}},[e._v("上传文件")]),r("span",{staticClass:"uploadDesc"},[e._v("支持格式：支持格式：.rar .zip .doc .docx .pdf")])],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("工程预算书")])]),r("a-col",{attrs:{span:9}},[r("a-button",{attrs:{type:"primary",icon:"plus"}},[e._v("上传文件")]),r("span",{staticClass:"uploadDesc"},[e._v("支持格式：支持格式：.rar .zip .doc .docx .pdf")])],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("工程款")])]),r("a-col",{attrs:{span:9}},[r("a-input",{attrs:{placeholder:"自动核算总价",readOnly:""}})],1)],1)],1)},o=[],i={name:"ProCreateWordUnit",inject:["editModel"],computed:{model:{get:function(){return this.editModel()},set:function(e){}}},data:function(){return{unitTypes:[{label:"议标",value:0},{label:"公开招标",value:1},{label:"邀请招标",value:2}],typeActive:0}},methods:{changeType:function(e){var t=e.value;e.label;this.typeActive=t}}},a=i,s=(r("6589"),r("2877")),l=Object(s["a"])(a,n,o,!1,null,"df7248b4",null);t["default"]=l.exports},"156e":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"baseInfo",staticClass:"baseInfo"},[r("div",{staticClass:"baseInfo_type"},[r("div",{staticClass:"padding12-16 font-text"},[r("span",{staticClass:"requiredText  "},[e._v("*")]),e._v("\n      项目类型：\n      "),r("j-d-dict-select-tag",{attrs:{excludeOptionByLabel:["计划"],type:"radioButton",dictCode:"project_type"},on:{change:e.changeBaseType},model:{value:e.model.baseType,callback:function(t){e.$set(e.model,"baseType",t)},expression:"model.baseType"}})],1),r("div",{staticClass:"flexCenter font-text",attrs:{slot:"extra"},on:{click:function(e){e.stopPropagation()}},slot:"extra"},[e._v("\n      分摊方式：\n      "),r("j-d-dict-select-tag",{attrs:{type:"radioButton",dictCode:"allocation_method"},on:{change:e.changeAllotMode},model:{value:e.model.allotMode,callback:function(t){e.$set(e.model,"allotMode",t)},expression:"model.allotMode"}})],1)]),r("j-form-container",{ref:"formRow",attrs:{rules:e.rules,model:e.model,border:!1,valiaTimer:600}},[r("a-row",{ref:"row",staticClass:"houseInfo",attrs:{slot:"edit",type:"flex"},slot:"edit"},[r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("申报小区")])]),r("a-col",{attrs:{span:20,"data-prop":"regionCode"}},[r("j-dict-region-list-select",{ref:"regionSelect",attrs:{getPopupContainer:function(){return e.$refs.baseInfo},customParams:{type:"20",baseType:e.model.baseType}},on:{change:e.regionChange},model:{value:e.model.regionCode,callback:function(t){e.$set(e.model,"regionCode",t)},expression:"model.regionCode"}})],1),r("a-col",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticStyle:{height:"unset"},attrs:{span:0}}),r("a-col",{staticStyle:{padding:"0","min-height":"unset",border:"none"},attrs:{span:24}},[r("custom-field-form",{ref:"customFieldForm",attrs:{colSpan:e.spanObject,"p-custom-key":"proj_name"},model:{value:e.model.customJson,callback:function(t){e.$set(e.model,"customJson",t)},expression:"model.customJson"}})],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("申报单位（个人）")])]),r("a-col",{attrs:{span:20,"data-prop":"reqCode"}},[r("a-switch",{staticStyle:{width:"65px"},attrs:{"checked-children":"单位","un-checked-children":"个人"},model:{value:e.reqType,callback:function(t){e.reqType=t},expression:"reqType"}}),e.reqType?r("a-select",{on:{change:e.reqCorpChange},model:{value:e.selectedItem,callback:function(t){e.selectedItem=t},expression:"selectedItem"}},e._l(e.reqCorpArr,(function(t){return r("a-select-option",{key:t.code,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1):r("a-input",{attrs:{placeholder:"请输入申报人"},model:{value:e.model.reqCode,callback:function(t){e.$set(e.model,"reqCode",t)},expression:"model.reqCode"}},[r("a-icon",{staticStyle:{cursor:"auto"}})],1)],1),"05"!=e.model.baseType?[r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("是否有子项目")]),r("a-tooltip",[r("template",{slot:"title"},[e._v("\n            当一个小区中有多个标准维修项目需要维修，且分摊范围与分摊金额均不相同时推荐使用子项目\n          ")]),r("a-icon",{staticStyle:{color:"#ff7e24"},attrs:{type:"question-circle"}})],2)],1),r("a-col",{attrs:{span:20}},[r("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否"},model:{value:e.model.hasChild,callback:function(t){e.$set(e.model,"hasChild",t)},expression:"model.hasChild"}})],1)]:e._e(),e.model.hasChild||"04"!=e.model.baseType?e._e():[r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("保险分类")])]),r("a-col",{attrs:{span:7,"data-prop":"insureType"}},[r("a-select",{attrs:{placeholder:"请选择保险分类"},on:{change:e.selectInsureType},model:{value:e.model.insureType,callback:function(t){e.$set(e.model,"insureType",t)},expression:"model.insureType"}},e._l(e.insureOptions,(function(t){return r("a-select-option",{key:t.code,attrs:{dataInsureType:t,value:t.code}},[e._v("\n              "+e._s(t.name)+"\n            ")])})),1)],1),r("a-col",{attrs:{span:5}},[r("span",{staticClass:"required"},[e._v("保险分类明细（险种）")])]),r("a-col",{attrs:{span:8,"data-prop":"insureTypeDetail"}},[r("a-select",{attrs:{placeholder:"请选择保险分类明细（险种）"},on:{change:e.selectInsureTypeDetail},model:{value:e.model.insureTypeDetail,callback:function(t){e.$set(e.model,"insureTypeDetail",t)},expression:"model.insureTypeDetail"}},e._l(e.insureDetailOptions,(function(t){return r("a-select-option",{key:t.code,attrs:{value:t.code}},[e._v("\n              "+e._s(t.name)+"\n            ")])})),1)],1)],r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("\n          "+e._s("04"!=e.model.baseType?"维修项目描述":"保险项目描述")+"\n        ")])]),r("a-col",{attrs:{span:20,"data-prop":"describe"}},[r("a-textarea",{attrs:{placeholder:"请输入"+("04"===e.model.baseType?"保险":"维修")+"项目描述"},model:{value:e.model.describe,callback:function(t){e.$set(e.model,"describe",t)},expression:"model.describe"}})],1),e.model.hasChild||"04"==e.model.baseType?e._e():[r("a-col",{attrs:{span:4}},[r("span",{class:{required:!e.hasEnablePageConfigByKey("imgVideoNotRequired")}},[e._v("受损图片或视频")]),r("a-popover",[r("template",{slot:"content"},[r("upload-file-comp",{attrs:{size:160,busiType:"20",busiTypeDetail:"202A","ere-code":"damaged_picture_ere_id"},on:{ok:function(t){return e.webShow("受损图片或视频",t)},click:function(e){e.stopPropagation()}}})],1),r("a-icon",{staticStyle:{color:"#ff7e24"},attrs:{type:"qrcode"}})],2)],1),r("a-col",{attrs:{span:20,"data-prop":e.hasEnablePageConfigByKey("imgVideoNotRequired")?"":"damagedPictureList"}},[r("a-upload",{staticClass:"uploadButtonStyle createProFile",attrs:{allowClick:"",accept:".jpg, .png, .jpeg, .bmp, .mp4,.JPG","before-upload":e.beforeUpload,customRequest:function(t){e.uploadFile(e.damagedPictureUrl,t,e.getItemByName("受损图片或视频"))},multiple:!0,listType:"picture-card","file-list":e.getItemByName("受损图片或视频").showList,remove:function(t){return e.onRemove(t,e.getItemByName("受损图片或视频"))}},on:{preview:function(t){return e.handlePreview(t,e.getItemByName("受损图片或视频"))}}},[r("div",[r("a-icon",{attrs:{type:"upload"}}),r("div",{staticClass:"ant-upload-text font-text"},[e._v("\n                上传\n              ")])],1)])],1)],e.model.hasChild||"05"==e.model.baseType?e._e():[r("a-col",{attrs:{span:4}},[e._v("\n          "+e._s("04"!=e.model.baseType?"维修对象":"保险对象")+"\n          "),r("a-tooltip",[r("template",{slot:"title"},[e._v("\n              此处设施设备/标准维修项目金额总价仅为参考与记录，不参与项目金额计算\n            ")]),r("a-icon",{staticStyle:{color:"#ff7e24"},attrs:{type:"question-circle"}})],2)],1),r("a-col",{attrs:{span:20,"data-prop":"choosePart"}},[r("selected-part-table",{attrs:{isEditFlag:!1,data:e.model.choosePart},scopedSlots:e._u([{key:"action",fn:function(t){t.row;var n=t.rowIndex;return[r("a-space",[r("a",{on:{click:e.openTransferModal}},[r("a-icon",{attrs:{type:"plus"}})],1),r("a",{on:{click:function(t){return e.removePart(n)}}},[r("a-icon",{attrs:{type:"minus"}})],1)])]}},{key:"empty",fn:function(){return[r("div",{staticStyle:{"padding-top":"10px"}},[r("a-empty",[r("a-button",{staticClass:"margin_bottom_10",attrs:{slot:"description",type:"primary"},on:{click:e.openTransferModal},slot:"description"},[e._v("\n                    "+e._s("04"!=e.model.baseType?"新增维修对象":"新增保险对象")+"\n                  ")])],1)],1)]},proxy:!0}],null,!1,2893666009)})],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("分摊范围")])]),r("a-col",{attrs:{span:20,"data-prop":"apportionFloors"}},[r("a",{staticStyle:{"flex-shrink":"0"}},[e._v("\n            "+e._s(e.model.apportionFloors?e.model.apportionFloors.length:0)+"户\n          ")]),e.model.choosePart&&"05"!==e.model.baseType?r("span",{staticClass:"tagButton margin_left_10 margin_right_10",on:{click:e.openFloorModal}},[e._v("\n            修改分摊范围\n          ")]):e._e()])],"05"==e.model.baseType?[r("a-col",{attrs:{span:4}},[e._v("\n          "+e._s("04"!=e.model.baseType?"维修对象":"保险对象")+"\n          "),r("a-tooltip",[r("template",{slot:"title"},[e._v("\n              此处设施设备/标准维修项目金额总价仅为参考与记录，不参与项目金额计算\n            ")]),r("a-icon",{staticStyle:{color:"#ff7e24"},attrs:{type:"question-circle"}})],2)],1),r("a-col",{attrs:{span:20,"data-prop":"choosePart"}},[r("selected-part-table",{attrs:{isEditFlag:!1,data:e.model.choosePart},scopedSlots:e._u([{key:"action",fn:function(t){t.row;var n=t.rowIndex;return[r("a-space",[r("a",{on:{click:e.openTransferModal}},[r("a-icon",{attrs:{type:"plus"}})],1),r("a",{on:{click:function(t){return e.removePart(n)}}},[r("a-icon",{attrs:{type:"minus"}})],1)])]}},{key:"empty",fn:function(){return[r("div",{staticStyle:{"padding-top":"10px"}},[r("a-empty",[r("a-button",{staticClass:"margin_bottom_10",attrs:{slot:"description",type:"primary"},on:{click:e.openTransferModal},slot:"description"},[e._v("\n                    "+e._s("04"!=e.model.baseType?"新增维修对象":"新增保险对象")+"\n                  ")])],1)],1)]},proxy:!0}],null,!1,2893666009)})],1)]:e._e(),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("联系人")])]),r("a-col",{attrs:{span:8,"data-prop":"reqMan"}},[r("a-input",{attrs:{placeholder:"请输入联系人"},model:{value:e.model.reqMan,callback:function(t){e.$set(e.model,"reqMan",t)},expression:"model.reqMan"}},[r("a-icon",{staticStyle:{cursor:"auto"},attrs:{slot:"addonAfter",type:"contacts"},slot:"addonAfter"})],1)],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("联系电话")])]),r("a-col",{attrs:{span:8,"data-prop":"reqPhone"}},[r("a-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.model.reqPhone,callback:function(t){e.$set(e.model,"reqPhone",t)},expression:"model.reqPhone"}},[r("a-icon",{staticStyle:{cursor:"auto"},attrs:{slot:"addonAfter",type:"phone"},slot:"addonAfter"})],1)],1),"05"==e.model.baseType?[[r("a-col",{attrs:{span:4}},[e._v("分摊范围")]),r("a-col",{attrs:{span:20,"data-prop":"publicFlag"}},[r("div",{staticClass:"publicApportionRange"},[e.model.publicFlag?[r("div",{staticClass:"publicApportionRangeTool"},[r("a-button",{attrs:{size:"small",type:"primary"},on:{click:e.openPublicHouseApportion}},[e._v("调整分摊")])],1),r("div",{staticClass:"publicApportionRangeBody"},["0"==e.model.publicFlag?[r("div",{staticClass:"width100"},[r("vxe-table",{key:"publicList_"+e.model.publicFlag,attrs:{"max-height":"180px","auto-resize":"",size:"small",border:"",data:e.model.publicList}},[r("vxe-table-column",{attrs:{title:"单位名称",field:"name"}}),r("vxe-table-column",{attrs:{title:"金额",field:"publicCorpAmount"}}),r("vxe-table-column",{attrs:{title:"操作",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){t.row;var n=t.rowIndex;return[r("a",{on:{click:function(t){return e.removeAllotLists(n)}}},[r("a-icon",{attrs:{type:"delete"}})],1)]}}],null,!1,249646246)})],1)],1)]:"1"==e.model.publicFlag?[r("a",{staticStyle:{"flex-shrink":"0"}},[e._v("\n                      "+e._s(e.model.apportionFloors?e.model.apportionFloors.length:0)+"户\n                    ")])]:"2"==e.model.publicFlag?[r("div",{staticClass:"width100"},[r("vxe-table",{key:"bldShowList"+e.model.publicFlag,attrs:{"auto-resize":"",size:"small","max-height":"180px",border:"",data:e.model.bldSelectedList}},[r("vxe-table-column",{attrs:{title:"自然幢名称",field:"name"}}),r("vxe-table-column",{attrs:{title:"金额",field:"publicBldAmount"}}),r("vxe-table-column",{attrs:{title:"操作",align:"center",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){t.row;var n=t.rowIndex;return[r("a",{on:{click:function(t){return e.removeBldSelectedList(n)}}},[r("a-icon",{attrs:{type:"delete"}})],1)]}}],null,!1,2778289196)})],1)],1)]:e._e()],2)]:r("div",{staticClass:"width100"},[r("a-empty",[r("div",{attrs:{slot:"description"},slot:"description"},[r("span",[e._v("暂未确认分摊范围")]),r("a-divider",{attrs:{type:"vertical"}}),r("a",{on:{click:e.openPublicHouseApportion}},[e._v("调整分摊")])],1)])],1)],2)])]]:e._e()],2)],1),r("custom-field-form",{ref:"customFieldForm",staticStyle:{"margin-top":"6px"},attrs:{"p-custom-key":"createPro_Contract"},model:{value:e.model.customJson,callback:function(t){e.$set(e.model,"customJson",t)},expression:"model.customJson"}}),e.previewVisible?r("div",{ref:"previewDiv",staticClass:"outer_box"},[r("previewPicture",{attrs:{fileList:e.getItemByName("受损图片或视频"),fileNum:e.previewNum},on:{cancel:e.exitPreview}})],1):e._e(),r("repair-parts-tree-modal",{ref:"repairPartsTreeModal",attrs:{zIndex:e.zIndex,choosePart:e.model.choosePart,regionId:e.regionInfo.id},on:{"update:choosePart":function(t){return e.$set(e.model,"choosePart",t)},"update:choose-part":function(t){return e.$set(e.model,"choosePart",t)},ok:e.partChooseOk}}),r("insurance-parts-tree-modal",{ref:"insurancePartsTreeModal",attrs:{insureType:e.model.insureType,choosePart:e.model.choosePart,regionId:e.regionInfo.id},on:{"update:insureType":function(t){return e.$set(e.model,"insureType",t)},"update:insure-type":function(t){return e.$set(e.model,"insureType",t)},"update:choosePart":function(t){return e.$set(e.model,"choosePart",t)},"update:choose-part":function(t){return e.$set(e.model,"choosePart",t)},ok:e.partChooseOk}}),r("create-pro-floor-choose",e._g({ref:"floorChoose",attrs:{apportionType:1,rangeIds:e.rangeIds,regionInfo:e.regionInfo,editPublicType:"05"===e.model.baseType}},e.$listeners))],1)},o=[],i=r("0fea"),a=r("4aae"),s=r("fdce"),l=r("5d0e"),c=r("e7a5"),u=r("2a9b"),d=r("6d33"),f=r("b7a8"),h=r("eb36"),p=r("d8a5"),m=r("eccd"),v=r("6603"),y=r("3ed7"),g=r("afcb"),b=r("d9a4"),_=r("9fb0"),w=r("ca1b"),C=r("2b0e");function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function I(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */I=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new A(n||[]);return o(a,"_invoke",{value:L(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",p="executing",m="completed",v={};function y(){}function g(){}function b(){}var _={};c(_,a,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(F([])));C&&C!==r&&n.call(C,a)&&(_=C);var k=b.prototype=y.prototype=Object.create(_);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(o,i,a,s){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==x(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=f;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var l=S(s,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=d(t,r,n);if("normal"===c.type){if(o=n.done?m:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function S(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,S(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(x(t)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},T(P.prototype),c(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new P(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(k),c(k,l,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function k(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){k(i,n,o,a,s,"next",e)}function s(e){k(i,n,o,a,s,"throw",e)}a(void 0)}))}}var P={name:"ProCreateBaseInfo",components:{AutoSelect:v["default"],JDDictSelectTag:m["default"],RepairPartsTreeModal:u["default"],InsurancePartsTreeModal:d["default"],CreateProFloorChoose:c["default"],AmountInput:a["default"],JDictRegionListSelect:s["default"],JDictRegionForCropListSelect:l["default"],PreviewPicture:f["default"],SelectedPartTable:g["default"],UploadFileComp:w["default"]},mixins:[h["a"]],inject:["projMainData"],props:{zIndex:{type:Number,default:1e3}},data:function(){var e=this,t=function(t,r,n){if(!e.model.hasChild&&(!e.model.apportionFloors||0===e.model.apportionFloors.length))return n(new Error("请选择分摊范围").message);n()},r=function(t,r,n){(!e.model.damagedPictureList||e.model.damagedPictureList.length<1)&&n(new Error("请上传受损图片或视频").message)},n=function(t,r,n){(!e.model.choosePart||e.model.choosePart.length<1)&&n(new Error("请选择维修对象").message)},o=function(e,t){return new Promise(function(){var e=T(I().mark((function e(r){return I().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",r());case 2:Object(i["j"])("/drools/droolsData/exeDrools",{type:"verifyPhoneNumber",name:"verify",data:{phone:t}}).then((function(e){return e.success?r():r(e.result)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return{spanObject:[{field:"proj_name",labelSpan:4,valueSpan:20}],damagedAreaSource:[],url:{fileUploadImg:window._CONFIG["domianURL"]+"/control/file/uploadImg?uploadType=5",unilityList:"/base/regionUtility/queryUtilityList",damagedPicture:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",queryRegionByList:"/base/rtRegion/queryRegionByList",loadTreeData:"/sys/category/buildTree",checkInsureByRuid:"/use/serviceUtility/checkInsureByRuid",getReqManAndReqPhone:"/base/rtRegion/getReqManAndReqPhone",getReqCorp:"/base/rtRegion/getReqCorp",queryListByRegionId:"/base/rCorpInfo/queryListByRegionId",queryBldListByRegionId:"/base/rRegionInfo/queryBldListByRegionId"},regionInfo:{},cropInfo:{},apportionTypes:[{value:0,text:"小区分摊"},{value:1,text:"楼栋分摊"},{value:2,text:"单元分摊"},{value:3,text:"自定义分摊"}],damagedPictureUrl:"",partColumns:[{field:"partDesc",title:"设施设备/标准维修项目",showOverflow:!0},{field:"describe",title:"维修描述",showOverflow:!0},{title:"材料数量",align:"right",width:100,slots:{default:"materialNum"}},{field:"totalPrice",title:"总价",width:100,align:"right",formatter:function(e){var t=e.cellValue;return Object(y["g"])(t)}},{title:"操作",width:"80px",align:"center",slots:{default:"action"}}],rules:{regionCode:[{required:!0,message:"请选择申报小区",trigger:"change"}],cropCode:[{required:!0,message:"请选择公房单位",trigger:"change"}],insureTypeDetail:[{required:!0,message:"请选择保险分类",trigger:"change"}],insureType:[{required:!0,message:"请选择保险分类明细",trigger:"change"}],damagedPictureList:[{validator:r}],describe:[{required:!0,message:"请输入项目描述",trigger:"change"}],choosePart:[{validator:n}],apportionFloors:[{required:!0,message:"请选择分摊范围",trigger:"change"},{validator:t}],preTime:[{required:!0,message:"请输入预估工期",trigger:"change"}],reqMan:[{required:!0,message:"请输入联系人",trigger:"change"}],reqPhone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:o,type:"Promise"}]},insureOptions:[],reqType:!0,reqCorpArr:[],selectedItem:"",insureDetailOptions:[],publicApportionGrid:{data:[],columns:[]}}},computed:{model:{get:function(){var e=this.projMainData();return e.customJson||this.$set(e,"customJson",""),this.projMainData()},set:function(){}},rangeIds:function(){if(!this.model.choosePart)return"";var e=this.model.choosePart.map((function(e){return e.rangeId}));return e.join(",")}},created:function(){var e=this,t=C["default"].ls.get(_["J"]);this.reqCorpArr=[{code:t.orgCode,name:t.orgCodeTxt}],this.selectedItem=this.reqCorpArr[0].code,Object(p["e"])("damaged_picture_ere_id").then((function(t){e.damagedPictureUrl=e.url.damagedPicture+t})),Object(i["e"])(this.url.loadTreeData,{code:"insure_type"}).then((function(t){t.success&&(e.insureOptions=t.result[0].children)}))},mounted:function(){this.initFile()},watch:{reqType:function(e){e?this.selectedItem=this.reqCorpArr[0].code:this.$set(this.model,"reqCode",null)}},methods:{hasEnablePageConfigByKey:b["a"],removeAllotLists:function(e){this.model.publicList.splice(e,1),0===this.model.publicList.length&&this.$set(this.model,"publicFlag","")},removeBldSelectedList:function(e){this.model.bldSelectedList.splice(e,1),0===this.model.bldSelectedList.length&&this.$set(this.model,"publicFlag","")},openPublicHouseApportion:function(){this.model.choosePart&&0!==this.model.choosePart.length?this.$refs.floorChoose.openModal():this.$message.warning("请先新增维修对象！")},initFile:function(){var e=[{name:"受损图片或视频",fileList:[]}];this.initUploadFile(e)},openTransferModal:function(){if(!this.regionInfo.id)return this.$refs.regionSelect.focus(),this.$message.warn("请选择申报小区");"04"===this.model.baseType?null!=this.model.insureType&&null!=this.model.insureTypeDetail?this.$refs.insurancePartsTreeModal.open():this.$refs.formRow.validaFields(["insureType","insureTypeDetail"]):this.$refs.repairPartsTreeModal.open()},transferChooseOk:function(e){this.model.utilityNames="";var t=e.map((function(e){return e.utilityName}));this.model.utilityNames=t.join(","),this.$forceUpdate()},openFloorModal:function(){this.model.choosePart&&0!==this.model.choosePart.length?this.$refs.floorChoose.openModal():this.$message.warning("请先新增维修对象！")},regionChange:function(e,t){var r=this;"2"==t.accAttr&&this.$set(this.model,"baseType","05"),this.$set(this.model,"reqMan",void 0),this.$set(this.model,"reqPhone",void 0),Object(i["e"])(this.url.getReqManAndReqPhone,{code:e}).then((function(e){r.$set(r.model,"reqMan",e.result.linkMan),r.$set(r.model,"reqPhone",e.result.phone)})),this.reqCorpArr.length>1&&this.reqCorpArr.splice(1),Object(i["e"])(this.url.getReqCorp,{id:t.id,corpCode:C["default"].ls.get(_["J"]).orgCode}).then((function(e){e&&e.result&&e.result.forEach((function(e){r.reqCorpArr.push(e)}))})),this.regionInfo=t,this.$set(this.model,"regionId",t.id),this.$set(this.model,"publicList",[]),this.$set(this.model,"bldShowList",[]),this.$set(this.model,"cropCode",void 0),this.initDevice(e),"0"==this.model.publicFlag?this.queryListByRegionId():"2"==this.model.publicFlag&&this.queryBldListByRegionId(),this.projMainData().choosePart=[],this.model.apportionFloors&&(this.model.apportionFloors=[]),this.projMainData().sysOrgCode=t.sysOrgCode,this.$refs.repairPartsTreeModal.clearPart()},reqCorpChange:function(e,t){this.$set(this.model,"reqCode",e)},cropChange:function(e,t){this.cropInfo=t;var r=this.model.publicList.find((function(e){return e.id===t.id}));r||this.model.publicList.push({id:t.id,name:t.name,accCode:t.accCode,publicCorpAmount:""})},removeSelectedItem:function(e){this.model.publicList.splice(e,1),0===this.model.publicList.length&&this.$set(this.model,"cropCode","")},initDevice:function(e){},removePart:function(e){this.model.choosePart.splice(e,1),this.partChooseOk(this.model.choosePart)},partChooseCallBack:function(e){var t=this,r=e.map((function(e){return e.rangeId})).join(",");Object(i["e"])(this.url.queryRegionByList,{ids:r}).then((function(e){if(e){if(t.$set(t.model,"apportionFloors",[]),e[0])for(var r=e[0],n=0;n<r.children.length;n++){var o=r.children[n];if(o.children)for(var i=0;i<o.children.length;i++){var a=o.children[i];if(a.children)for(var s=0;s<a.children.length;s++){var l=a.children[s],c=l.id,u=l.state,d=l.struArea,f=l.houseArea,h=l.houseUse,p=l.usableBalance;t.model.apportionFloors.push({id:c,state:u,struArea:d,houseArea:f,houseUse:h,usableBalance:p})}}}}else t.$message.error(e.message)}))},partChooseOk:function(e){var t=this,r=e.map((function(e){return e.regionUtilityId})).join(",");"04"!==this.model.baseType?Object(i["e"])(this.url.checkInsureByRuid,{regionUtilityId:r}).then((function(r){r.success&&(r.result?Object(b["a"])("useV8ShareStyle")?t.$set(t.model,"apportionFloors",[]):t.partChooseCallBack(e):t.$message.warning(r.message))})):this.$nextTick((function(){t.validaInsureDate().then((function(r){Object(b["a"])("useV8ShareStyle")?t.$set(t.model,"apportionFloors",[]):t.partChooseCallBack(e)}))}))},onFileChange:function(){this.$set(this.projMainData(),"damagedPictureList",""),this.projMainData().damagedPictureList=this.getItemByName("受损图片或视频").fileList},changeAllotMode:function(e){this.model.allotMode=e,this.model.children&&this.model.children.map((function(t){t.allotMode=e})),this.$forceUpdate()},changeBaseType:function(e){this.model.baseType=e,this.model.children&&this.model.children.map((function(t){t.baseType=e})),this.clearFileItem(this.getItemByName("受损图片或视频")),"01"!=e&&"02"!=e&&"04"!=e||this.$emit("changeBaseType",!0,this.model.baseType),this.$forceUpdate()},checkData:function(){var e=this;return new Promise(function(){var t=T(I().mark((function t(r){var n;return I().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.formRow.validaRowMsgPro(e.$refs.row);case 3:if(t.t0=t.sent.valida,!t.t0){t.next=8;break}return t.next=7,e.$refs.customFieldForm.checkData();case 7:t.t0=t.sent.valida;case 8:n=t.t0,t.next=15;break;case 11:t.prev=11,t.t1=t["catch"](0),n=!1;case 15:r({valida:n});case 17:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}())},beforeUpload:function(e){var t=this;return new Promise((function(r){e.type.includes("image")||e.type.includes("video")?r():t.$message.warning("请上传图片或视频！")}))},selectInsureType:function(e,t){this.insureDetailOptions=t.data.attrs.dataInsureType.children},selectInsureTypeDetail:function(e){var t=this;this.$nextTick((function(){t.validaInsureDate()}))},flagChange:function(e){this.$set(this.model,"publicList",[]),this.$set(this.model,"bldShowList",[]),"0"==e.target.value&&this.queryListByRegionId(),"2"==e.target.value&&this.queryBldListByRegionId()},queryListByRegionId:function(){var e=this;Object(i["e"])(this.url.queryListByRegionId,{regionId:this.regionInfo.id}).then((function(t){e.cropList=[],e.cropList=e.cropList.concat(t.result),e.cropList.forEach((function(t){var r=e.model.publicList.find((function(e){return e.id===t.id}));r||e.model.publicList.push({id:t.id,name:t.name,accCode:t.accCode,publicCorpAmount:""})})),e.loading=!1}))},queryBldListByRegionId:function(){var e=this;Object(i["e"])(this.url.queryBldListByRegionId,{regionId:this.regionInfo.id}).then((function(t){e.bldList=[],e.bldList=e.bldList.concat(t.result),e.bldList.forEach((function(t){var r=e.model.bldShowList.find((function(e){return e.id===t.bldId}));r||e.model.bldShowList.push({id:t.bldId,name:t.bldName,publicBldAmount:""})})),e.loading=!1}))},validaInsureDate:function(){var e=this;return new Promise((function(t,r){var n=e;n.model.choosePart[0]&&n.model.choosePart[0].regionUtilityId&&n.model.insureTypeDetail&&n.model.insureStartTime?Object(i["e"])(n.url.checkInsureByRuid,{regionUtilityId:n.model.choosePart[0].regionUtilityId,beginTime:n.model.insureStartTime,insureTypeDetail:n.model.insureTypeDetail}).then((function(e){e.result?t({result:!0}):(n.model.insureStartTime="",n.$message.warning(e.message),t({result:!1,message:e.message}))})):t({result:!0})}))}}},L=P,S=(r("83a3"),r("2877")),N=Object(S["a"])(L,n,o,!1,null,"5a47f8c0",null);t["default"]=N.exports},"197e":function(e,t,r){"use strict";r("c43a")},"1c83":function(e,t,r){},2091:function(e,t,r){},"24cf":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("vxe-modal",{attrs:{title:"部件物料","show-footer":"","z-index":e.zIndex,width:"1100",height:"600","destroy-on-close":!0},on:{close:e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[r("a-button",{on:{click:e.close}},[e._v("关闭")]),r("a-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")])]},proxy:!0}]),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("div",{staticClass:"modalBody"},[e.tabNodes&&e.tabNodes.length>1?r("div",{staticClass:"modalTab"},[r("a-tabs",{attrs:{size:"small"},model:{value:e.currentTabIndex,callback:function(t){e.currentTabIndex=t},expression:"currentTabIndex"}},e._l(e.tabNodes,(function(e,t){return r("a-tab-pane",{key:t,attrs:{tab:e.name}})})),1)],1):e._e(),e.tabNodes&&e.tabNodes.length>0?r("div",{staticClass:"modalContent"},[r("div",{staticClass:"modalTree"},[r("a-input-search",{staticClass:"modalTreeSearchInput",attrs:{"allow-clear":""},model:{value:e.filterStr,callback:function(t){e.filterStr=t},expression:"filterStr"}}),r("div",{staticClass:"modalTreeBody"},[r("a-tree",{staticClass:"modalTreeBodyTree",attrs:{blockNode:"",disabled:e.disabledAdd,treeData:e.filterTreeData,replaceFields:{key:"code"},checkable:!1,selectable:!0,checkStrictly:!1,selectedKeys:e.tabNodes[e.currentTabIndex].selectedKeys},on:{check:e.treeCheck,select:e.treeSelect},scopedSlots:e._u([{key:"title",fn:function(t){var n=t.title,o=t.dataRef;t.key;return[r("div",{staticClass:"treeTitleBox"},[r("span",{staticClass:"treeTitle"},[e._v(e._s(n))]),r("a-tooltip",{attrs:{title:"添加材料"}},[o.children&&o.children.length>0?r("a-icon",{staticClass:"treeTitleBtn",attrs:{type:"plus"},on:{click:function(t){return e.handleAddSub(o)}}}):e._e()],1)],1)]}}],null,!1,3539799734),model:{value:e.tabNodes[e.currentTabIndex].checkedKeys,callback:function(t){e.$set(e.tabNodes[e.currentTabIndex],"checkedKeys",t)},expression:"tabNodes[currentTabIndex].checkedKeys"}})],1)],1),r("div",{staticClass:"modalTable"},[r("div",{staticClass:"modalTableBody"},[e.visible?r("vxe-grid",{ref:"materialList",attrs:{columns:e.columns,data:e.getShowTableData({dataSource:e.tabNodes[e.currentTabIndex].materialList,pageNo:e.tabNodes[e.currentTabIndex].pageNo,pageSize:e.tabNodes[e.currentTabIndex].pageSize}),"edit-config":{mode:"row"},"edit-rules":e.comparAble?{}:e.editRules,height:"auto"},scopedSlots:e._u([{key:"name",fn:function(t){var n=t.row;return[r("span",[e._v(e._s(e.getMaterialName(n)))])]}},{key:"quantity",fn:function(t){var n=t.row;return[r("amount-input",{attrs:{isHideAddon:!0,formatDue:"04"},model:{value:n.quantity,callback:function(t){e.$set(n,"quantity",t)},expression:"materialRow.quantity"}})]}},{key:"unitPrice",fn:function(t){var n=t.row;return[r("amount-input",{model:{value:n.unitPrice,callback:function(t){e.$set(n,"unitPrice",t)},expression:"materialRow.unitPrice"}})]}},{key:"model",fn:function(t){var n=t.row;return[r("a-input",{attrs:{placeholder:"请输入材料型号"},model:{value:n.model,callback:function(t){e.$set(n,"model",t)},expression:"materialRow.model"}})]}},{key:"brand",fn:function(t){var n=t.row;return[r("a-input",{attrs:{placeholder:"请输入品牌名称"},model:{value:n.brand,callback:function(t){e.$set(n,"brand",t)},expression:"materialRow.brand"}})]}},{key:"action",fn:function(t){var n=t.rowIndex;return[r("a-icon",{staticClass:"color-red",attrs:{type:"delete"},on:{click:function(t){return e.removeMaterial(n)}}})]}}],null,!1,3917384439)}):e._e()],1),r("vxe-pager",{staticClass:"modalTablePage",attrs:{size:"small",border:"","current-page":e.tabNodes[e.currentTabIndex].pageNo,"page-sizes":[5,10,15,20,25],"page-size":e.tabNodes[e.currentTabIndex].pageSize,total:e.tabNodes[e.currentTabIndex].materialList.length,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":function(t){var r=t.currentPage,n=t.pageSize;return e.handlePageChange({tabNode:e.tabNodes[e.currentTabIndex],currentPage:r,pageSize:n})}}})],1)]):e._e()]),r("sysCategory-modal",{ref:"modalForm",attrs:{spliceParentCode:!0},on:{ok:e.modalFormOk}})],1)},o=[],i=r("3ed7"),a=r("4aae"),s=r("d8a5"),l=r("f1cf");function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e){return h(e)||f(e)||_(e)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e){if(Array.isArray(e))return w(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){var t=g(e,"string");return"symbol"==c(t)?t:t+""}function g(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function _(e,t){if(e){if("string"==typeof e)return w(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function C(e){var t=[];function r(e){var n,o=b(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;i.children&&i.children.length>0?r(i.children):t.push(i)}}catch(a){o.e(a)}finally{o.f()}}return r(e),t}var x={name:"SelectMaterialModal",components:{AmountInput:a["default"],SysCategoryModal:l["default"]},props:{zIndex:{type:Number,default:void 0},materialTree:{type:Array,default:function(){return[]}},disabledAdd:{type:Boolean,default:!1}},computed:{treeData:function(){function e(t){t.forEach((function(t){t.children&&t.children.length>0?(t.lastChild=!1,e(t.children)):t.lastChild=!0}))}var t=JSON.parse(JSON.stringify(this.materialTree));return e(t),t},filterTreeData:function(){function e(t,r){return t&&t.length?t.map((function(t){return t.id=t.key,t.title.includes(r)?m({},t):m(m({},t),{},{children:e(t.children,r)})})).filter((function(e){return(e.children||[]).length||e.title.includes(r)})):[]}var t=e(this.treeData,this.filterStr),r={key:"unFiltered",title:"其他类别",checkable:!1,children:[]};return r.children=this.treeData.filter((function(e){return!t.some((function(t){return e.key===t.key||(t.children||[]).some((function(t){return t.key===e.key}))}))})),r.children.length>0?[].concat(u(t),[r]):u(t)},CMaterialList:function(){var e=C(this.materialTree);return e}},data:function(){return{subExpandedKeys:[],comparAble:!1,visible:!1,currentTabIndex:0,checkedKeys:[],tabNodes:[],editRules:{model:[{required:!0,message:"请输入型号",trigger:["blur","change"]}],brand:[{required:!0,message:"请输入品牌",trigger:["blur","change"]}]},filterStr:"",modalType:"add",columns:[{field:"name",title:"名称",slots:{default:"name"}},{field:"quantity",title:"数量",editRender:{type:"visible"},slots:{edit:"quantity"}},{field:"unitPrice",title:"单价",editRender:{type:"visible"},slots:{edit:"unitPrice"}},{field:"model",title:"型号",editRender:{type:"visible"},slots:{edit:"model"}},{field:"brand",title:"品牌",editRender:{type:"visible"},slots:{edit:"brand"}},{title:"操作",width:60,align:"center",slots:{default:"action"}}],clicks:"",timer:null}},created:function(){this.getComparAble()},methods:{modalFormOk:function(){this.$emit("update-tree")},handleAddSub:function(e){this.subExpandedKeys=[],this.getExpandKeysByPid(e.id,this.filterTreeData,this.filterTreeData),this.$refs.modalForm.subExpandedKeys=this.subExpandedKeys,this.$refs.modalForm.title="添加子分类",this.$refs.modalForm.edit({pid:e.id,parentCode:e.code}),this.$refs.modalForm.disableSubmit=!1},getExpandKeysByPid:function(e,t,r){if(e&&t&&t.length>0){var n,o=b(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;i.id===e?(this.subExpandedKeys.push(i.id),this.getExpandKeysByPid(i["pid"],r,r)):this.getExpandKeysByPid(e,i.children,r)}}catch(a){o.e(a)}finally{o.f()}}},getComparAble:function(){var e=this;Object(s["e"])("compar_able").then((function(t){t&&(e.comparAble="1"==t)}))},getMaterialName:function(e){if(e.name)return e.name;var t=this.CMaterialList.find((function(t){return t.code===e.materialCode}));return t?t.title:void 0},initModal:function(){},open:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add";this.modalType=r;var n=JSON.parse(JSON.stringify(e));this.tabNodes=n.map((function(e){var n="add"===r?[]:e.materialList||[];return{checkedKeys:n.map((function(e){return e.materialCode})),materialList:n,name:e.name||e.remark,partDesc:e.partDesc,longId:e.longId,id:e.id,regionUtilityId:e.regionUtilityId,utilityId:e.utilityId,totalPrice:0,selectedKeys:[""],costListId:e.costListId,cprojId:e.cprojId,corpCode:e.corpCode,pageSize:10,pageNo:1,total:n.length,showTableData:t.getShowTableData({dataSource:n,pageNo:1,pageSize:10})}})),this.visible=!0},getShowTableData:function(e){var t=e.dataSource,r=e.pageNo,n=e.pageSize,o=r-1;return t.slice(o*n,r*n)},handlePageChange:function(e){var t=e.tabNode,r=e.currentPage,n=e.pageSize;this.$set(t,"pageNo",r),this.$set(t,"pageSize",n)},close:function(){this.visible=!1,this.filterStr=""},treeCheck:function(e,t){var r=t.checked,n=t.node,o=n.dataRef;this.updataTable({node:o,isAdd:r})},treeSelect:function(e,t){var r=this,n=t.node;if(""===this.clicks||this.clicks!==e[0])this.clicks=e[0],this.timer=setTimeout((function(){r.clicks=""}),300);else{clearTimeout(this.timer);var o=n.dataRef;if(o.lastChild)this.addTableData({node:o});else{var i=C([o]);i.forEach((function(e){r.addTableData({node:e})}))}this.clicks=""}},addTableData:function(e){var t=e.node,r=this.tabNodes[this.currentTabIndex];r.materialList.push({name:t.title,key:t.key,materialCode:t.code,quantity:1,unitPrice:0,model:"",brand:""})},removeMaterial:function(e){var t=this.tabNodes[this.currentTabIndex];t.materialList.splice(e,1)},setTotalPrice:function(e){var t=this.tabNodes[e];this.$set(t,"totalPrice",t.materialList.reduce((function(e,t){return Object(i["c"])(e,Object(i["e"])(t.quantity,t.unitPrice))}),0))},confirm:function(){for(var e=0;e<this.tabNodes.length;e++){var t=this.tabNodes[e];if(t.materialList.length<1)return void this.$message.warning(t.name+"中，请至少选择一份材料！");var r,n=0,o=b(t.materialList);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(!this.comparAble){if(Number(a.quantity)<=0)return this.$message.warning("".concat(t.name,"中，").concat(a.name,"的数量应大于0！"));if(Number(a.unitPrice)<=0)return this.$message.warning("".concat(t.name,"中，").concat(a.name,"的单价应大于0！"));if(!a.model)return this.$message.warning("".concat(t.name,"中，").concat(a.name,"的型号不能为空！"));if(!a.brand)return this.$message.warning("".concat(t.name,"中，").concat(a.name,"的品牌不能为空！"))}n=Object(i["c"])(n,Object(i["e"])(a.quantity,a.unitPrice))}}catch(s){o.e(s)}finally{o.f()}this.$set(t,"totalPrice",n)}this.visible=!1,this.$emit("confirm",this.tabNodes,this.modalType)}}},I=x,k=(r("33da"),r("2877")),T=Object(k["a"])(I,n,o,!1,null,"edb407ba",null);t["default"]=T.exports},2682:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"grantManage"},[r("div",{staticClass:"grantHeader"},[r("div",[e._v("\n      预算金额："),r("span",[e._v(e._s("5,000.00"))]),e._v("(元)\n    ")]),r("a",[e._v("子项目明细")])]),r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{attrs:{xxl:3,xl:6}},[e._v("\n      质保金\n    ")]),r("a-col",{staticClass:"warranty",attrs:{xxl:21,xl:18}},[r("a-space",{attrs:{size:16}},[r("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关"}}),r("div",{staticClass:"inputNumberUnit"},[r("a-input-number",{attrs:{precision:0,min:0,placeholder:"数值"}}),r("span",{staticClass:"amountUnit"},[e._v("%")])],1),r("span",[e._v("150元")])],1)],1),r("a-col",{attrs:{xxl:3,xl:6}},[r("span",{staticClass:"required"},[e._v("拨款批次")])]),r("a-col",{attrs:{xxl:21,xl:18}},[r("a-input-number",{attrs:{precision:0,min:0,placeholder:"0"}})],1)],1),r("vxe-table",{attrs:{border:"",data:e.grantList,align:"center","edit-config":{showIcon:!1}}},[r("vxe-table-column",{attrs:{width:"60",title:"序号",type:"seq"}}),r("vxe-table-column",{attrs:{width:"248",field:"grantBatch",title:"拨款批次","header-align":"left","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(){return[r("a-input",{attrs:{placeholder:"拨款批次"}})]},proxy:!0}])}),r("vxe-table-column",{attrs:{width:"190",field:"grantNo",title:"申请编号"}}),r("vxe-table-column",{attrs:{width:"110",field:"grantProportion",title:"拨款比例","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(){return[r("div",{staticClass:"inputNumberUnit"},[r("a-input-number",{attrs:{min:0,max:100,precision:0,placeholder:"比列"}}),r("span",{staticClass:"amountUnit"},[e._v("%")])],1)]},proxy:!0}])}),r("vxe-table-column",{attrs:{width:"135",field:"grantAmount",title:"拨款金额",formatter:e.formatterAmount,"header-align":"center",align:"right"}}),r("vxe-table-column",{attrs:{width:"120",field:"isPay",title:"是否决算后支付","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(){return[r("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否"}})]},proxy:!0}])}),r("vxe-table-column",{attrs:{field:"grantDesc",title:"描述","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(){return[r("a-input",{attrs:{placeholder:"描述"}})]},proxy:!0}])})],1),r("div",{staticClass:"grantFooter"},[r("a-button",{attrs:{icon:"check",type:"primary"}},[e._v("确认")])],1)],1)},o=[],i=r("3ed7"),a={name:"GrantManage",data:function(){return{grantList:[{id:1,grantNo:"012020211206429443",grantAmount:1e3}]}},methods:{formatterAmount:function(e){var t=e.cellValue;return Object(i["g"])(t)}}},s=a,l=(r("291a"),r("2877")),c=Object(l["a"])(s,n,o,!1,null,"7f9e9672",null);t["default"]=c.exports},28734:function(e,t,r){},"291a":function(e,t,r){"use strict";r("00d2")},"2a9b":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("vxe-modal",{attrs:{"z-index":e.zIndex+1,"show-footer":"",width:"1100",height:"700","destroy-on-close":"",position:{top:8},"show-zoom":""},on:{close:function(t){return e.open(!1)}},scopedSlots:e._u([{key:"title",fn:function(){return[r("span",[e._v("维修对象选择")]),e._v("\n      \n    "),e.isDetail?e._e():r("span",{staticClass:"message"},[e._v("\n      双击右侧标准维修项目列表或点击操作列删除图标可进行删除操作\n    ")])]},proxy:!0},{key:"footer",fn:function(){return[r("a-button",{attrs:{type:"primary"},on:{click:e.modalOk}},[e._v("确认")])]},proxy:!0}]),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("div",{ref:"modalContent",staticClass:"modal_content"},[e.isDetail?e._e():r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.partTreeLoading,expression:"partTreeLoading"}],staticClass:"modal_select",attrs:{"element-loading-text":"加载中..."}},[r("div",{staticClass:"model_select_floor"},[r("a-tree",{attrs:{blockNode:!0,"selected-keys":e.selectedKeys,expandedKeys:e.expandKeys,"tree-data":e.treeData},on:{"update:selectedKeys":function(t){e.selectedKeys=t},"update:selected-keys":function(t){e.selectedKeys=t},"update:expandedKeys":function(t){e.expandKeys=t},"update:expanded-keys":function(t){e.expandKeys=t},select:e.floorTreeSelect}},e._l(e.treeData,(function(t){return r("a-tree-node",{key:t.id,attrs:{title:t.name}},e._l(t.children,(function(t){return r("a-tree-node",{key:t.id,attrs:{title:t.name}},e._l(t.children,(function(e){return r("a-tree-node",{key:e.id,attrs:{title:e.name}})})),1)})),1)})),1)],1),r("div",{staticClass:"model_select_part"},[e._l(e.partList,(function(t){return[r("repair-part-tree-node",{key:t.id,staticClass:"font-text",attrs:{selectKey:e.selectedPart,treeData:t,"disable-nodes":e.disableParts,firstNode:"",treeTitle:t.utilityName},on:{"update:selectKey":function(t){e.selectedPart=t},"update:select-key":function(t){e.selectedPart=t},dblTree:e.dblPart}})]}))],2)]),r("div",{ref:"modalSelectPart",staticClass:"modal_checkedPartList model_select_part",style:{height:e.isDetail?"100%":void 0}},[r("div",{staticClass:"tableDiv"},[r("selected-part-table",{ref:"selectedPartTable",attrs:{data:e.checkedPartList,height:"auto"},on:{"update:data":function(t){e.checkedPartList=t},confirm:e.generate}})],1),e.checkedPartList.length>0?r("div",{staticClass:"message tableBottomMsg"},[e._v("\n        此处总价仅为参考与记录，不参与项目金额计算\n      ")]):e._e()])])])},o=[],i=r("0fea"),a=r("0117"),s=r("afcb"),l=r("4aae"),c=r("6603"),u=r("d8a5"),d=r("24cf");function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */h=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new A(n||[]);return o(a,"_invoke",{value:L(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function _(){}function w(){}var C={};c(C,a,(function(){return this}));var x=Object.getPrototypeOf,I=x&&x(x(F([])));I&&I!==r&&n.call(I,a)&&(C=I);var k=w.prototype=b.prototype=Object.create(C);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(o,i,a,s){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==f(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var l=S(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=d(t,r,n);if("normal"===c.type){if(o=n.done?y:m,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,S(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(f(t)+" is not iterable")}return _.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=c(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},T(P.prototype),c(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new P(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(k),c(k,l,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=b(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function y(e){return w(e)||_(e)||b(e)||g()}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e,t){if(e){if("string"==typeof e)return C(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}function _(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function w(e){if(Array.isArray(e))return C(e)}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var x={name:"RepairPartsTreeModal",props:{regionId:{type:String,default:""},choosePart:{type:Array,default:function(){return[]}},projId:{type:String,default:""},isDetail:{type:Boolean,default:!1},zIndex:{type:Number,default:void 0}},components:{AutoSelect:c["default"],AmountInput:l["default"],RepairPartTreeNode:a["default"],SelectMaterialModal:d["default"],SelectedPartTable:s["default"]},inject:{projMainData:{default:null}},data:function(){return{visible:!1,treeData:[],setRangeId:"",selectedKeys:[],expandKeys:[],partList:[],selectedPart:"",comparAble:!1,multipleScope:!1,checkedPartList:JSON.parse(JSON.stringify(this.choosePart))||[],partTreeLoading:!1,dblNodeParent:null,url:{getTreeById:"base/rtRegion/getTreeById",getUtilListById:"/base/regionUtility/getUtilListById",checkInsureByRuid:"/use/serviceUtility/checkInsureByRuid",getOtherChildProjScope:"/use/serviceProj/getOtherChildProjScope"}}},watch:{choosePart:function(e){this.checkedPartList=JSON.parse(JSON.stringify(e))||[]}},computed:{disableParts:function(){return this.checkedPartList.map((function(e){return e.longId}))}},created:function(){this.getComparAble(),this.getMultipleScope()},methods:{open:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.visible=t,t?Object(i["e"])(this.url.getTreeById,{id:this.regionId}).then((function(t){if(t.success){if(e.treeData=t.result,e.checkedPartList&&e.checkedPartList.length>0){var r=e.checkedPartList[0].rangeId,n=e.getRangeById(e.treeData,r),o=n.selectedRow,i=n.expandKeys;if(o)return e.selectedKeys=[r],e.expandKeys=i,void e.floorTreeSelect(e.selectedKeys,{node:{dataRef:o}})}if(e.treeData&&e.treeData.length>0){var a=e.treeData[0];e.selectedKeys=[a.id],e.floorTreeSelect(e.selectedKeys,{node:{dataRef:a}})}}else e.$message.error(t.message)})):this.expandKeys=[]},getRangeById:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e=e||[];var o,i,a=e.find((function(e){return e.id===t}));if(a)return{selectedRow:a,expandKeys:r};for(var s=0;s<e.length;s++){var l=e[s];r&&r[n]?r[n]=l.id:r.push(l.id);var c=this.getRangeById(l.children,t,r,n+1);if(c&&(o=c.selectedRow,i=c.expandKeys,o))return{selectedRow:o,expandKeys:i}}},modalOk:function(){var e=this;if(this.isDetail)return this.open(!1);this.checkedPartList.forEach((function(t){e.$set(t,"id","")})),this.$emit("ok",this.checkedPartList),this.$emit("update:choosePart",this.checkedPartList),this.open(!1)},floorTreeSelect:function(e,t){var r=t.node,n=this;if(0!==e.length){var o=!0;n.checkedPartList.length>0&&(o=n.checkedPartList.some((function(t){return e[0]===t.rangeId}))),o?n.getRepairPartTree(e[0],r.dataRef.baseType):n.$message.warning("您当前选择的房屋与已选择的标准维修项目所属房屋不同，此种情况推荐您新建项目时选择包含小项目进行项目申报")}else n.partList=[]},getRepairPartTree:function(e,t){var r=this;this.partTreeLoading=!0,Object(i["e"])(this.url.getUtilListById,{id:e,type:t}).then((function(e){e.success?(""!=e.message&&r.$message.info(e.message),r.partList=[],r.$nextTick((function(){r.partList=e.result}))):r.$message.error(e.message)})).finally((function(){setTimeout((function(){r.partTreeLoading=!1}),400)}))},generate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",r=this;if("add"===t){var n;e.forEach((function(e){e.rangeId=r.selectedKeys[0],e.remark=e.partDesc,e.brand=r.dblNodeParent.brand,e.model=r.dblNodeParent.model,e.partId=e.id,Reflect.deleteProperty(e,"createBy"),Reflect.deleteProperty(e,"createTime"),Reflect.deleteProperty(e,"updateBy"),Reflect.deleteProperty(e,"updateTime")})),(n=r.checkedPartList).push.apply(n,y(e))}else{var o,i=v(this.checkedPartList);try{for(i.s();!(o=i.n()).done;){var a=o.value;a.longId===e[0].longId&&(this.$set(a,"materialList",e[0].materialList),this.$set(a,"checkedKeys",e[0].checkedKeys),this.$set(a,"totalPrice",e[0].totalPrice))}}catch(s){i.e(s)}finally{i.f()}}},dblPart:function(){var e=m(h().mark((function e(t,r){var n,o,a,s,l=this;return h().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,n.dblNodeParent=r,!n.projMainData||!n.projMainData()||"04"===n.projMainData().baseType){e.next=32;break}o=v(t),e.prev=4,o.s();case 6:if((a=o.n()).done){e.next=21;break}if(s=a.value,e.t0=n.comparAble||!n.multipleScope,!e.t0){e.next=16;break}if(e.t1=n.checkedPartList.length>0&&n.checkedPartList[0].scopeValue!==s.scopeValue||t[0].scopeValue!==s.scopeValue,e.t1){e.next=15;break}return e.next=14,n.checkOtherChildProj(s.scopeValue);case 14:e.t1=e.sent;case 15:e.t0=e.t1;case 16:if(!e.t0){e.next=19;break}return n.$message.warning("请选择相同的维修范围"),e.abrupt("return");case 19:e.next=6;break;case 21:e.next=26;break;case 23:e.prev=23,e.t2=e["catch"](4),o.e(e.t2);case 26:return e.prev=26,o.f(),e.finish(26);case 29:Object(i["e"])(n.url.checkInsureByRuid,{regionUtilityId:r.id}).then((function(e){e.success&&(e.result?l.$refs.selectedPartTable.addPart(t):l.$message.warning(e.message))})),e.next=33;break;case 32:this.generate();case 33:case"end":return e.stop()}}),e,this,[[4,23,26,29]])})));function t(t,r){return e.apply(this,arguments)}return t}(),getSelectTitle:function(e,t){if(e.vcTreeNode&&e.vcTreeNode.title){var r=e.vcTreeNode;return r.vcTreeNode.title&&(t=r.title+"-"+t),this.getSelectTitle(r,t)}return t},cumputTotalPrice:function(e){0!==e.unitPrice&&0!==e.quantity&&(e.totalPrice=Number(e.unitPrice)*Number(e.quantity))},clearPart:function(){this.partList=[],this.checkedPartList=[]},getComparAble:function(){var e=this;Object(u["e"])("compar_able").then((function(t){e.comparAble="1"===t}))},getMultipleScope:function(){var e=this;Object(u["e"])("multiple_scope").then((function(t){e.multipleScope="0"===t}))},checkOtherChildProj:function(){var e=m(h().mark((function e(t){var r;return h().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=!1,e.next=3,Object(i["e"])(this.url.getOtherChildProjScope,{projId:this.projId}).then((function(e){e.success&&e.result.length>0&&!e.result.includes(t)&&(r=!0)}));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getPopoverPopupContainer:function(){return this.$refs.modalSelectPart}}},I=x,k=(r("a2d9"),r("2877")),T=Object(k["a"])(I,n,o,!1,null,"08a59521",null);t["default"]=T.exports},"2e362":function(e,t,r){},"32a4c":function(e,t,r){"use strict";r("0245")},"33da":function(e,t,r){"use strict";r("d94b")},"362e":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"costSetter"},[r("a-dropdown",{attrs:{trigger:["click"]}},[r("a-menu",{staticClass:"amountButtonMenu",attrs:{slot:"overlay"},slot:"overlay"},e._l(e.costTypeMenu,(function(t){return r("a-menu-item",{key:t.value},[r("div",{staticClass:"amountButtonItem",on:{click:function(r){return r.stopPropagation(),e.chooseAmount(t)}}},[e._v("\n          "+e._s(t.label)+"\n          "),e.costType_choose.find((function(e){return e.value===t.value}))?r("a-icon",{attrs:{type:"check"}}):e._e()],1)])})),1),r("a-button",{staticStyle:{margin:"0"},attrs:{type:"primary"}},[e._v("添加费用")])],1),r("div",{staticClass:"costList"},e._l(e.costType_choose,(function(t){return r("div",{key:t.value,staticClass:"costItem"},[r("j-select-corp",{attrs:{width:"220px",placeholder:"请选择"+t.label+"单位",baseType:t.type,multi:!1,value:e.modelCost[t.value+"Cost"]},on:{afterChoose:function(r){return e.unitChoose(r,t)}}}),r("span",[e._v(e._s(t.label)+"费")]),r("amount-input",{attrs:{value:e.modelCost[t.value+"Amount"],width:"150px"},on:{change:function(r){return e.setChooseAmount(r,t)}}}),r("a-radio-group",{staticStyle:{gap:"0"},attrs:{"button-style":"solid"},model:{value:t.computeType,callback:function(r){e.$set(t,"computeType",r)},expression:"costItem.computeType"}},[r("a-radio-button",{attrs:{value:"0"}},[e._v("分摊")]),r("a-radio-button",{attrs:{value:"1"}},[e._v("汇总")])],1)],1)})),0)],1)},o=[],i=r("4aae"),a={components:{AmountInput:i["default"]},name:"CostSetter",props:{},data:function(){return{costTypeMenu:[{value:"priceReview",label:"审价",type:"02"},{value:"supervisor",label:"监理",type:"03"},{value:"biddingCost",label:"招标",type:"04"},{value:"inspectionCost",label:"检测",type:"05"},{value:"makeCost",label:"造价",type:"06"}],costType_choose:[],modelCost:{}}},methods:{chooseAmount:function(e){var t=this.costType_choose.findIndex((function(t){return e.value===t.value}));-1===t?this.costType_choose.push(e):this.costType_choose.splice(t,1)},unitChoose:function(e,t){this.$emit("unitChoose",e,t)},setChooseAmount:function(e,t){this.$emit("amountChange",e,t)}}},s=a,l=(r("b110"),r("2877")),c=Object(l["a"])(s,n,o,!1,null,"07b292fc",null);t["default"]=c.exports},"3da6":function(e,t,r){},"42e2":function(e,t,r){"use strict";r("f021")},"43c2":function(e,t,r){},4773:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("vxe-modal",{ref:"modal",attrs:{title:"分摊范围选择","show-zoom":"",resize:"",width:"1200px",height:"80vh",position:{top:"center",left:"center"},"show-footer":"",loading:e.isLoading,zIndex:1e3},on:{confirm:e.modalOk},scopedSlots:e._u([{key:"footer",fn:function(){return[r("a-button",{on:{click:function(){return e.selectedHouseVisible=!0}}},[e._v("已选房屋（"+e._s(e.model.apportionFloors?e.model.apportionFloors.length:0)+"户）")]),r("a-button",{attrs:{type:"primary"},on:{click:e.confirmFloor}},[e._v("\n        确认选择\n      ")])]},proxy:!0}]),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("div",{staticClass:"modalContent"},[r("div",{staticClass:"buildTree"},[e.regionInfo?r("div",{staticStyle:{padding:"6px 0","text-align":"center","background-color":"#e1f1ff"}},[e._v(e._s(e.regionInfo.name))]):e._e(),r("div",{staticStyle:{flex:"1",height:"0",overflow:"auto"}},[e.regionInfo?r("a-tree",{attrs:{selectedKeys:e.selectedKeys,defaultExpandAll:!0},on:{"update:selectedKeys":function(t){e.selectedKeys=t},"update:selected-keys":function(t){e.selectedKeys=t},select:e.regionTreeSelect}},e._l(e.regionInfo.children,(function(t){return r("a-tree-node",{key:t.id,attrs:{title:t.name,dataRef:t}},e._l(t.children,(function(e){return r("a-tree-node",{key:e.id,attrs:{title:e.name,dataRef:e}})})),1)})),1):e._e()],1)]),r("div",{staticClass:"buildBody"},["2"===e.activeBaseType?r("house-apportion",{ref:"houseApportion",attrs:{apportionType:3,regionInfo:e.regionInfo,"is-show-checkbox":"",floorInfo:e.floorInfo}}):"3"===e.activeBaseType?r("vxe-grid",e._b({ref:"floorGrid",attrs:{height:"auto"},on:{"checkbox-change":e.checkboxFloor,"checkbox-all":e.checkboxFloor},scopedSlots:e._u([{key:"accState",fn:function(t){t.text;var n=t.row;return[e.checkHouseUseSpecial(n.houseUse)?r("a-badge",{attrs:{color:"#d7cfcf",text:"不交"}}):"9"===n.accState||"1"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"未交"}}):"5"===n.accState?r("a-badge",{attrs:{color:"#19be6b",text:"已注销"}}):"4"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"待销户"}}):"3"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"待退款"}}):"7"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"待转账"}}):r("a-badge",{attrs:{color:"#19be6b",text:"已交"}})]}}])},"vxe-grid",e.floorGridBind,!1)):e._e()],1)])]),r("vxe-modal",{attrs:{width:"900",height:"600",title:"已选房屋"},model:{value:e.selectedHouseVisible,callback:function(t){e.selectedHouseVisible=t},expression:"selectedHouseVisible"}},[r("vxe-grid",{attrs:{height:"auto",columns:e.selectedColumns,"auto-resize":!0,data:e.model.apportionFloors},scopedSlots:e._u([{key:"accState",fn:function(t){t.text;var n=t.row;return[e.checkHouseUseSpecial(n.houseUse)?r("a-badge",{attrs:{color:"#d7cfcf",text:"不交"}}):"9"===n.accState||"1"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"未交"}}):"5"===n.accState?r("a-badge",{attrs:{color:"#19be6b",text:"已注销"}}):"4"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"待销户"}}):"3"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"待退款"}}):"7"===n.accState?r("a-badge",{attrs:{color:"#ff9900",text:"待转账"}}):r("a-badge",{attrs:{color:"#19be6b",text:"已交"}})]}}])})],1)],1)},o=[],i=r("7c50"),a=r("df5d"),s=r("0fea"),l=r("d8a5");function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var f={name:"CreateProFloorChooseV8",components:{HouseApportion:a["default"],BuildApportion:i["default"]},props:{apportionType:{type:[String,Number],default:0},rangeIds:{type:String,default:""}},watch:{floorChoose_build:function(e){e?this.$refs.modal.revert():this.$refs.modal.maximize()}},inject:["projMainData"],computed:{model:{get:function(){return this.projMainData()},set:function(){}}},created:function(){var e=this;Object(l["g"])("house_use").then((function(t){t&&(e.houseUseList=t.result)}))},data:function(){return{visible:!1,selectedHouseVisible:!1,selectedColumns:[{title:"房屋位置",align:"left",field:"address",direction:"rtl",minWidth:280},{title:"建筑面积 (㎡)",align:"right",headerAlign:"right",field:"houseArea",width:130,formatter:function(e){var t=e.cellValue;return t?t.toFixed(3):"0.000"}},{title:"业主姓名",align:"center",field:"householderName",width:120,type:"input"},{title:"房屋用途",align:"center",field:"houseUseName",width:120},{title:"账户状态",align:"center",field:"accState",width:100,slots:{default:"accState"}}],selectedKeys:[],houseUseList:[],activeBaseType:"",floorGridBind:{autoResize:!0,rowId:"id",columns:[{type:"checkbox",width:60,align:"center"},{title:"房屋位置",align:"left",field:"address",direction:"rtl",minWidth:280},{title:"建筑面积 (㎡)",align:"right",headerAlign:"right",field:"houseArea",width:130,formatter:function(e){var t=e.cellValue;return t?t.toFixed(3):"0.000"}},{title:"业主姓名",align:"center",field:"householderName",width:120,type:"input"},{title:"房屋用途",align:"center",field:"houseUseName",width:120},{title:"账户状态",align:"center",field:"accState",width:100,slots:{default:"accState"}}]},showType:"view",regionInfo:null,floorInfo:"",currentBldName:"",floorChoose_build:!0,url:{queryHouseTreeList:"/base/rtRegion/queryHouseTreeList",queryFloors:"/use/serviceProj/queryFloors/"},isLoading:!1,apportionFloors_backup:[]}},methods:{openModal:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.activeBaseType="",this.selectedKeys=[],this.visible=e,this.getRegionInfo()},getRegionInfo:function(){var e=this;this.isLoading=!0,this.floorChoose_build=!0;var t=this;this.regionInfo=null,Object(s["e"])(this.url.queryHouseTreeList,{code:this.projMainData().regionCode}).then((function(r){if(r.length>0){if(t.regionInfo=r[0],e.regionInfo&&e.regionInfo.children){var n=e.regionInfo.children[0];e.regionTreeSelect([n.id],{node:{dataRef:n}})}t.isLoading=!1}else t.$message.error(r.message)}))},regionTreeSelect:function(e,t){var r=this,n=t.node;this.selectedKeys=e;var o=n.dataRef;this.activeBaseType="",o&&this.$nextTick((function(){"2"===o.baseType&&r.getFloorView(o),"3"===o.baseType&&r.getFloorGrid(o)}))},getFloorView:function(e){this.floorInfo=e.floorInfo,this.currentBldName=name,this.activeBaseType="2"},getFloorGrid:function(e){var t=this,r=this.regionInfo.children.find((function(t){return t.id===e.pid})),n=[],o=[];r.floorInfo&&r.floorInfo.houseTypeList&&r.floorInfo.houseTypeList.forEach((function(r){r.houseArr=r.houseArr||[],r.houseArr.forEach((function(r){r.unitId===e.id&&(n.push(r),t.model.apportionFloors.find((function(e){return e.id===r.id}))&&o.push(r))}))})),this.$set(this.floorGridBind,"data",n),this.activeBaseType="3",this.$nextTick((function(){t.$refs.floorGrid.setCheckboxRow(o,!0)}))},checkboxFloor:function(e){var t=e.records;e.checked;this.model.apportionFloors=t},checkHouseUseSpecial:function(e){var t,r=c(this.houseUseList);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(e==n.value){if(!n.description)return!1;var o=JSON.parse(n.description);if(o&&o.special)return!0}}}catch(i){r.e(i)}finally{r.f()}},changeType:function(e){this.showType=e},modalOk:function(){var e,t=[];if("view"===this.showType)for(var r in e=this.$refs.floorView.getViewChangeIds(this.showType),e){var n=e[r];for(var o in n)t=t.concat(n[o])}else t=this.$refs.floorView.getViewChangeIds(this.showType);this.$emit("getHouseIds",t)},modalClose:function(){this.floorChoose_build?this.visible=!1:this.floorChoose_build=!0},confirmFloor:function(){if(!this.model.apportionFloors||0===this.model.apportionFloors.length)return this.$message.warning("请选择分摊范围");this.floorChoose_build?(this.visible=!1,this.$emit("ok")):this.floorChoose_build=!0},customChoose:function(e){var t=e.floorInfo,r=e.name;this.floorInfo=t,this.currentBldName=r,this.floorChoose_build=!1,this.apportionFloors_backup=JSON.parse(JSON.stringify(this.model.apportionFloors))},changeFloor:function(e){var t=this;Object(s["j"])(this.url.queryFloors,e.sharedHousings).then((function(e){e.success?(t.$set(t.model,"apportionFloors",e.result),t.visible=!0,t.getRegionInfo()):t.$message.error(e.message)}))}}},h=f,p=(r("42e2"),r("2877")),m=Object(p["a"])(h,n,o,!1,null,"4f141721",null);t["default"]=m.exports},4989:function(e,t,r){},"4ef9":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"proInfo_cards"},[e._l(e.lists,(function(t){return n("div",{key:t.id,staticClass:"proInfo_cardItem"},[n("div",{staticClass:"cardItem_header"},[n("div",{staticClass:"flexAlignCenter"},[n("img",{staticStyle:{width:"16px",height:"16px"},attrs:{src:r("f26e"),alt:""}}),e._v("\n        保险项目编号："),n("span",[e._v(e._s(t.code))])]),n("span",[e._v(e._s(t.reqDate))])]),n("div",{staticClass:"cardItem_content"},[n("div",{staticClass:"cardItem_info"},[n("div",{staticClass:"cardItem_infoHeader"},[e._v("\n          "+e._s(t.describe)+"\n        ")]),n("div",{staticClass:"cardItem_infoAmount"},[n("div",[n("span",[e._v("保费金额")]),n("span",[e._v(e._s(t.insureCost?e.formatterAmount(t.insureCost):"0"))])]),n("div",[n("span",[e._v("申请资金")]),n("span",[e._v(e._s(t.budgetCost?e.formatterAmount(t.budgetCost):"0"))])]),n("div",[n("span",[e._v("保险时间范围")]),n("span",[e._v(e._s(t.insureStartTime+" 至 "+t.insureEndTime))])]),n("div",[n("span",[e._v("分摊户数")]),n("span",[e._v(e._s(t.allotLists.length))])])])])]),n("div",{staticClass:"cardItem_footer"},[e.isDetail?e._e():n("a",{staticClass:"red",on:{click:function(r){return e.delMiniProj(t)}}},[e._v("删除")]),n("a",{on:{click:function(r){return e.proManager(t)}}},[e._v("项目管理")]),e.isDetail?e._e():n("a",{on:{click:function(r){return e.copyProject(t)}}},[e._v("复制项目")])])])})),e.previewVisible?n("div",{ref:"previewBox",staticClass:"outer_box",style:{zIndex:e.zIndex+1}},[n("previewPicture",{ref:"previewPicture",attrs:{fileNum:e.previewNum,fileList:e.previewFileList},on:{"update:fileNum":function(t){e.previewNum=t},"update:file-num":function(t){e.previewNum=t},cancel:e.exitPreview}})],1):e._e(),n("child-pro-manager",{ref:"childProManager",attrs:{zIndex:e.zIndex+1,isDetail:e.isDetail,"pro-info":e.childInfo},on:{ok:e.reQueryProj}})],2)},o=[],i=r("b7a8"),a=r("e67d"),s=r("4aae"),l=r("5745"),c=r("3ed7"),u=r("0fea"),d={name:"ChildInsuranceCardss",mixins:[l["a"]],components:{AmountInput:s["default"],ChildProManager:a["default"],PreviewPicture:i["default"]},props:{lists:{type:Array,default:function(){return[{id:"aaaa",code:"11111",damagedPictureList:[],allotLists:[]}]}},isDetail:{type:Boolean,default:!1},showType:{type:String,default:"list"},zIndex:{type:Number}},provide:function(){return{previewZIndex:1200}},data:function(){return{previewUrl:"",filePage:0,childInfo:{},setAmountField:"",url:{delMiniProj:"/use/serviceProj/delMiniProj/"},formatterAmount:c["g"]}},watch:{lists:{immediate:!0,handler:function(e){this.initFile(e)}}},methods:{exitPreview:function(){this.previewVisible=!1},previewImg:function(e){!e.showList.length>0||(e.fileIndex=void 0!==e.fileIndex?e.fileIndex:0,this.cardInfo=e,this.previewFileList["showList"]=e.showList.map((function(e){return{originalImage:e.originalImage,name:e.name}})),this.previewVisible=!0)},proManager:function(e){this.childInfo=e,this.$refs.childProManager.open()},copyProject:function(e){this.$parent.addChild(e)},setAmount:function(e,t,r){e.field||this.$set(e,t,{cost:""}),this.$set(e[t],"cost",r),this.setAmountField=""},delMiniProj:function(e){var t=this,r=this.url.delMiniProj+e.id;Object(u["j"])(r).then((function(e){var r=e.success,n=e.result,o=e.message;r&&n?(t.$message.success(o),t.$emit("refresh")):t.$message.warning(o)}))},initFile:function(e){var t=this;e.forEach((function(e){e.fileManageList=e.damagedPictureList,t.buildShowList(void 0,e)}))},reQueryProj:function(){this.$emit("refresh")}}},f=d,h=(r("81ad"),r("2877")),p=Object(h["a"])(f,n,o,!1,null,"27a88c42",null);t["default"]=p.exports},"541e":function(e,t,r){"use strict";r("2e362")},"5a22":function(e,t,r){},"5c50":function(e,t,r){},6589:function(e,t,r){"use strict";r("ac2c")},"6b73":function(e,t,r){"use strict";r("4989")},"6b8f":function(e,t,r){},"6d33":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("vxe-modal",{attrs:{"show-footer":"",width:"1000",height:"660",position:{top:8},"show-zoom":""},on:{close:function(t){return e.open(!1)}},scopedSlots:e._u([{key:"title",fn:function(){return[r("span",[e._v("保险项目")]),e._v("  "),r("span",{staticClass:"message"},[e._v("双击设备列表或点击操作列删除图标可进行删除操作")])]},proxy:!0},{key:"footer",fn:function(){return[r("a-button",{attrs:{type:"primary"},on:{click:e.modalOk}},[e._v("确认")])]},proxy:!0}]),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("div",{staticClass:"modal_content"},[r("div",{staticClass:"modal_select"},[r("div",{staticClass:"model_select_floor"},[r("a-tree",{attrs:{blockNode:!0,"selected-keys":e.selectedKeys,"tree-data":e.treeData},on:{"update:selectedKeys":function(t){e.selectedKeys=t},"update:selected-keys":function(t){e.selectedKeys=t},select:e.floorTreeSelect}},e._l(e.treeData,(function(t){return r("a-tree-node",{key:t.id,attrs:{title:t.name}},e._l(t.children,(function(t){return r("a-tree-node",{key:t.id,attrs:{title:t.name}},e._l(t.children,(function(e){return r("a-tree-node",{key:e.id,attrs:{title:e.name}})})),1)})),1)})),1)],1),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.partTreeLoading,expression:"partTreeLoading"}],staticClass:"model_select_part"},[e._l(e.partList,(function(t){return[r("div",{staticClass:"partTreeNode"},[r("span",{staticClass:"nodeTitle",class:{active:t.id===e.selectedPart},on:{click:function(r){return e.selectNode(t)},dblclick:function(r){return e.dblClickNode(t)}}},[r("a-tooltip",{attrs:{title:t.utilityName,placement:"top",arrowPointAtCenter:""}},[e._v("\n                "+e._s(t.utilityName)+"\n              ")])],1)])]}))],2)]),r("div",{staticClass:"modal_checkedPartList model_select_part"},[r("div",{staticClass:"tableDiv"},[r("vxe-table",{attrs:{"empty-text":"没有更多数据了！",border:"","max-height":"100%","auto-resize":"","show-footer":"","header-align":"center",data:e.checkedPartList,"edit-config":{trigger:"click",mode:"row"}},on:{"cell-dblclick":function(t){var r=t.row,n=t.rowIndex;return e.deleteChoosePart(r,n)}}},[r("vxe-table-column",{attrs:{"show-overflow":!0,field:"remark",title:"设备"}}),r("vxe-table-column",{attrs:{field:"description",title:"描述","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;t.rowIndex;return[r("auto-select",{attrs:{url:"/business/dUtilityClassify/getUtilityListByDes","value-field":"description","label-field":"description","search-field":"description","page-size-field":"size","page-num-field":"current",queryParams:{partId:n.id}},model:{value:n.describe,callback:function(t){e.$set(n,"describe",t)},expression:"row.describe"}})]}}])}),r("vxe-table-column",{attrs:{width:"150px",field:"unitPrice",title:"单价","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[r("amount-input",{attrs:{min:0,placeholder:"单价"},on:{change:function(t){return e.cumputTotalPrice(n)}},model:{value:n.unitPrice,callback:function(t){e.$set(n,"unitPrice",t)},expression:"row.unitPrice"}})]}}])}),r("vxe-table-column",{attrs:{width:"120px",field:"quantity",title:"数量","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[r("a-input-number",{attrs:{min:1,precision:0},on:{change:function(t){return e.cumputTotalPrice(n)}},model:{value:n.quantity,callback:function(t){e.$set(n,"quantity",t)},expression:"row.quantity"}})]}}])}),r("vxe-table-column",{attrs:{width:"150px",field:"totalPrice",title:"总价","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[r("amount-input",{attrs:{"input-read-only":"",placeholder:"总价"},model:{value:n.totalPrice,callback:function(t){e.$set(n,"totalPrice",t)},expression:"row.totalPrice"}})]}}])}),r("vxe-table-column",{attrs:{width:"70px",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,o=t.rowIndex;return[r("a-icon",{staticStyle:{color:"red","font-size":"18px"},attrs:{type:"delete"},on:{click:function(t){return e.deleteChoosePart(n,o)}}})]}}])})],1)],1),e.checkedPartList.length>0?r("div",{staticClass:"message tableBottomMsg"},[e._v("\n        此处设备金额总价仅为参考与记录，不参与项目金额计算\n      ")]):e._e()])])])},o=[],i=r("0fea"),a=r("4aae"),s=r("6603"),l={name:"InsurancePartsTreeModal",props:{regionId:{type:String,default:""},choosePart:{type:Array,default:function(){return[]}},insureType:{type:String,default:null}},components:{AutoSelect:s["default"],AmountInput:a["default"]},data:function(){return{visible:!1,treeData:[],setRangeId:"",selectedKeys:[],selectedTreeDesc:"",partList:[],selectedPart:"",checkedPartList:this.choosePart,partTreeLoading:!1,url:{getTreeById:"base/rtRegion/getTreeById",getUtilListById:"/base/regionUtility/getUtilListById"}}},computed:{disableParts:function(){return this.checkedPartList.map((function(e){return e.id}))}},methods:{dblClickNode:function(e){var t=this,r=JSON.parse(JSON.stringify(e));r.rangeId=this.selectedKeys[0],r.remark=t.selectedTreeDesc+"-"+r.utilityName,r.partDesc=t.selectedTreeDesc+"-"+r.utilityName,r.partId=r.id,r.regionUtilityId=r.id,r.quantity=1,r.unitPrice=r.avePrice,r.totalPrice=Number(r.quantity)*Number(r.unitPrice),Reflect.deleteProperty(r,"createBy"),Reflect.deleteProperty(r,"createTime"),Reflect.deleteProperty(r,"updateBy"),Reflect.deleteProperty(r,"updateTime"),this.$set(this,"checkedPartList",this.checkedPartList.concat([r]))},selectNode:function(e){this.selectedPart=e.id},open:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.visible=t,t&&Object(i["e"])(this.url.getTreeById,{id:this.regionId}).then((function(t){t.success?e.treeData=t.result:e.$message.error(t.message)}))},modalOk:function(){var e=this;this.checkedPartList.forEach((function(t){t.quantity||e.$set(t,"quantity",1),t.unitPrice||e.$set(t,"unitPrice",0),e.$set(t,"id",""),e.$set(t,"totalPrice",Number(t.quantity)*Number(t.unitPrice))})),this.$emit("ok",this.checkedPartList),this.$emit("update:choosePart",this.checkedPartList),this.open(!1)},floorTreeSelect:function(e,t){var r=t.node;if(this.partList=[],0!==e.length){var n=!0;this.checkedPartList.length>0&&(n=this.checkedPartList.some((function(t){return e[0]===t.rangeId}))),n?(this.getRepairPartTree(e[0],r.dataRef.baseType),this.selectedTreeDesc=this.getSelectTitle(r,r.title)):this.$message.warning("您当前选择的房屋与已选择的保险设施设备所属房屋不同，此种情况推荐您新建项目时选择包含小项目进行项目申报")}},getRepairPartTree:function(e,t){var r=this;this.partTreeLoading=!0,Object(i["e"])(this.url.getUtilListById,{id:e,type:t,insureType:this.insureType}).then((function(e){e.success?(""!=e.message&&r.$message.info(e.message),e.result&&e.result instanceof Array&&(r.partList=e.result)):r.$message.error(e.message)})).finally((function(){r.partTreeLoading=!1}))},dblPart:function(e,t){var r=this,n=this;e.forEach((function(o){o.rangeId=r.selectedKeys[0],o.remark=n.selectedTreeDesc+"-"+o.partDesc,o.brand=t.brand,o.model=t.model,o.partId=e[0].id,o.regionUtilityId=t.id,o.quantity=1,o.unitPrice=o.avePrice,o.totalPrice=Number(o.quantity)*Number(o.unitPrice),Reflect.deleteProperty(o,"createBy"),Reflect.deleteProperty(o,"createTime"),Reflect.deleteProperty(o,"updateBy"),Reflect.deleteProperty(o,"updateTime")})),this.checkedPartList=this.checkedPartList.concat(e)},deleteChoosePart:function(e,t){this.checkedPartList.splice(t,1)},getSelectTitle:function(e,t){if(e.vcTreeNode.title){var r=e.vcTreeNode;return r.vcTreeNode.title&&(t=r.title+"-"+t),this.getSelectTitle(r,t)}return t},cumputTotalPrice:function(e){0!==e.unitPrice&&0!==e.quantity&&(e.totalPrice=Number(e.unitPrice)*Number(e.quantity))},clearPart:function(){this.partList=[],this.checkedPartList=[]}}},c=l,u=(r("d747"),r("2877")),d=Object(u["a"])(c,n,o,!1,null,"84de33c6",null);t["default"]=d.exports},"72cc":function(e,t,r){},"7aa5":function(e,t,r){"use strict";r("efb9")},"7c50":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"buildApportion"},[r("div",{staticClass:"apportion_title"},[e._v("\n      "+e._s(e.regionInfo.name)+"——分摊范围\n    ")]),r("div",{staticClass:"apportion_content"},[r("div",{staticClass:"apportion_view"},[r("div",{staticClass:"apportion_view_list"},e._l(e.bldList,(function(t){return r("div",{key:"build"+t.id,staticClass:"apportion_view_item",style:{height:"careMode"===e.layoutMode?"190px":"180px",width:(e.layoutMode,"170px")}},[r("div",{staticClass:"apportion_view_itemValue",class:[t.choose],on:{click:function(r){return e.getFloors(t)}}},[r("div",{on:{click:function(e){e.stopPropagation()}}},[t.houseNumTotal_count&&t.houseNumTotal_count>0?r("vxe-checkbox",{staticClass:"buildCheckbox",attrs:{value:"isAll"===t.choose,indeterminate:"isPart"===t.choose},on:{change:function(r){return e.chooseFloor(t)}}}):e._e()],1),r("div",{staticClass:"baseInfo"},[r("span",{attrs:{title:t.name}},[e._v(e._s(t.name))]),r("span",[e._v("分摊户数："+e._s(t.houseNum_count||0)+"户")]),r("span",[e._v("分摊面积："+e._s(t.houseArea_count||0)+"m²")]),r("span",[e._v("可用余额："+e._s(t.usableBalance_sum||0))])])]),r("div",{staticClass:"apportion_view_itemBmg"},[r("div",[e._v("总户数："+e._s(t.houseNumTotal_count||0)+"户")]),r("div",[e._v("总面积："+e._s(t.houseAreaTotal_count||0)+"m²")]),r("div",[e._v("可用余额："+e._s(t.usableBalanceTotal_sum||0))])])])})),0),r("div",{staticClass:"apportion_view_record"},[r("div",{staticClass:"houseCount",class:e.model.apportionFloors.length>0?"blue":"default"},[r("div",[e._v(e._s(e.model.apportionFloors.length))]),r("div",[e._v("已选分摊总户数")])]),r("div",{staticClass:"areaCount",class:e.selectArea>0?"orange":"default"},[r("div",[e._v(" "+e._s(e.selectArea)+" ")]),r("div",[e._v("已选分摊总面积")])]),r("div",{staticClass:"areaCount",class:e.selectUsableBalance>0?"green":"default"},[r("div",[e._v(" "+e._s(e.selectUsableBalance)+" ")]),e._m(0)])])])])])},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v("已选房屋"),r("br"),e._v("\n              可用余额")])}],i=r("3ed7"),a=r("2b2c");function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function l(e){return f(e)||d(e)||u(e)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function d(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function f(e){if(Array.isArray(e))return h(e)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var p={name:"BuildApportion",props:{buildList:{type:Array,default:function(){return[]}},regionInfo:{type:Object,default:function(){return{}}}},mixins:[a["a"]],inject:["projMainData"],computed:{model:{get:function(){return this.projMainData()},set:function(e){}},bldList:{get:function(){var e=this,t=[];return this.buildList.forEach((function(r){var n=[];r.children?(r.children.forEach((function(e){e.children&&n.push.apply(n,l(e.children))})),r.houseList=n):r.houseList=[],e.isAllChoose(r),t.push(r)})),t},set:function(){}},selectArea:{get:function(){var e=0;return this.model.apportionFloors.forEach((function(t){e=Object(i["c"])(e,t.struArea||t.houseArea||0)})),Object(i["g"])(e,3)},set:function(){}},selectUsableBalance:{get:function(){var e=0;return this.model.apportionFloors.forEach((function(t){e=Object(i["c"])(e,t.usableBalance||0)})),Object(i["g"])(e)},set:function(){}},layoutMode:{get:function(){return this.$store.state.app.layout},set:function(){}}},data:function(){return{isChoose_build:!0,bldId:""}},methods:{getBldInfo:function(e){function t(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return((t?e.houseList:e.chooseHouse)||[]).reduce((function(e,t){return Object(i["c"])(e,t.struArea||t.houseArea||0)}),0)}var r=0;e.chooseHouse&&e.chooseHouse.length>0&&e.chooseHouse.forEach((function(e){r=Object(i["c"])(r,e.usableBalance||0)}));var n=0;e.houseList&&e.houseList.length>0&&e.houseList.forEach((function(e){n=Object(i["c"])(n,e.usableBalance||0)})),this.$set(e,"houseNumTotal_count",(e.houseList||[]).length),this.$set(e,"houseNum_count",e.chooseHouse.length),this.$set(e,"houseAreaTotal_count",Object(i["g"])(t(!0),3)),this.$set(e,"houseArea_count",Object(i["g"])(t(),3)),this.$set(e,"usableBalance_sum",Object(i["g"])(r)),this.$set(e,"usableBalanceTotal_sum",Object(i["g"])(n))},chooseFloor:function(e){var t=this,r=this,n=[],o=e.floorInfo.houseTypeList||[];o.forEach((function(e){e.houseArr.forEach((function(e){t.checkHouseUseSpecial(e.houseUse)||n.push(e)}))}));var i=this.isAllChoose(e);if("isAll"===i){var a=[];this.model.apportionFloors.forEach((function(e){var t=n.findIndex((function(t){return t.id===e.id}));-1===t&&r.isOptionalHoust(e.state)&&a.push(e)})),this.$set(this.model,"apportionFloors",a),this.$set(e,"choose","none")}else if("isPart"===i){var s,l=[];n.forEach((function(e){-1===t.model.apportionFloors.findIndex((function(t){return t.id===e.id}))&&r.isOptionalHoust(e.state)&&l.push(e)})),(s=this.model.apportionFloors).push.apply(s,l),this.$set(e,"choose","isPart")}else n.forEach((function(e){-1===t.model.apportionFloors.findIndex((function(t){return t.id===e.id}))&&r.isOptionalHoust(e.state)&&t.model.apportionFloors.push(e)})),this.$set(e,"choose","isAll");this.$forceUpdate()},isAllChoose:function(e){var t,r=this,n=this,o=[],i=e.floorInfo.houseTypeList||[],a=s(i);try{for(a.s();!(t=a.n()).done;){var l=t.value;this.checkHouseUseSpecial(l.type)||o.push(l)}}catch(d){a.e(d)}finally{a.f()}if(0===o.length)return this.$set(e,"choose",""),"";var c=!1;e.chooseHouse=[];var u=0;return o.forEach((function(t){var o=!0;t.houseArr.forEach((function(t){var i=n.model.apportionFloors.findIndex((function(e){return e.id===t.id}));i>-1?(n.isOptionalHoust(t.state)&&e.chooseHouse.push(r.model.apportionFloors[i]),c=!0):n.isOptionalHoust(t.state)&&(o=!1)})),o&&u++})),this.getBldInfo(e),u===o.length?(this.$set(e,"choose","isAll"),"isAll"):u!==o.length&&c?(this.$set(e,"choose","isPart"),"isPart"):(this.$set(e,"choose",""),"")},isOptionalHoust:function(e){var t=["04","4"],r=!0;return t&&t.length>0&&-1!==t.indexOf(e)&&(r=!1),r},getFloors:function(e){e.houseNumTotal_count&&0!=e.houseNumTotal_count?this.$emit("customChoose",e):this.$message.warning("当前自然幢下无可分摊房屋！")}}},m=p,v=(r("7aa5"),r("2877")),y=Object(v["a"])(m,n,o,!1,null,"9eb65b20",null);t["default"]=y.exports},"7c60":function(e,t,r){"use strict";r("3da6")},"81ad":function(e,t,r){"use strict";r("1c83")},"82bf":function(e,t,r){},"83a3":function(e,t,r){"use strict";r("aa1d")},"83f2":function(e,t,r){"use strict";r("92e4")},8645:function(e,t,r){"use strict";r("caf6")},"8e97":function(e,t,r){},"917a":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"proInfo_cards"},[e._l(e.lists,(function(t){return r("div",{key:t.id,staticClass:"proInfo_cardItem"},[r("div",{staticClass:"cardItem_image"},[r("img",{attrs:{src:"https://img2.baidu.com/it/u=3326184467,53924783&fm=253&app=120&size=w931&n=0&f=JPEG&fmt=auto?sec=1656522000&t=adc319c414837b11e05bd8aec7a50342",alt:""},on:{click:function(r){return e.previewImg(t.file)}}}),r("span",[e._v(e._s("这里是图片名称"))])]),r("div",{staticClass:"cardItem_info"},[e._m(0,!0),r("div",{staticClass:"cardItem_infoAmount"},[r("div",[r("a",[e._v(e._s("1,000.00"))]),r("span",[e._v("预算金额")])]),r("div",[r("span",[e._v(e._s("0.00"))]),r("span",[e._v("决算金额")])]),r("div",[r("a",[e._v(e._s("300.00"))]),r("span",[e._v("审价费")])]),r("div",[r("span",[e._v(e._s("0.00"))]),r("span",[e._v("监理费")])]),r("div",[r("a",[e._v(e._s("125"))]),r("span",[e._v("分摊户数")])]),r("div",[r("a",[e._v(e._s("1245.25"))]),r("span",[e._v("残值回收")])])]),r("div",{staticClass:"cardItem_infoFooter"},[r("a-button",[e._v("删除")]),r("a-button",[e._v("项目管理")])],1)])])})),e.previewVisible?r("div",{staticClass:"outer_box"},[r("previewPicture",{ref:"previewPicture",attrs:{fileNum:0,fileList:e.previewFileList},on:{cancel:function(t){e.previewVisible=!1}}})],1):e._e()],2)},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"cardItem_infoHeader"},[r("span",{staticClass:"cardItem_infoHeaderText"},[e._v("13号楼2单元电梯维修13号楼2单元电梯维修13号楼2单元电梯维修13号楼2单元电梯维修")]),r("span",{staticClass:"cardItem_infoHeaderDate"},[e._v("2022-06-16")])])}],i=r("b7a8"),a={name:"ChildProCardItem",components:{PreviewPicture:i["default"]},props:{lists:{type:Array,default:function(){return[]}}},data:function(){return{previewUrl:"",previewFileList:[],previewVisible:!1}},methods:{previewImg:function(e){e&&(this.previewFileList["showList"]=[{originalImage:e.filePath,name:e.originalName}],this.previewVisible=!0)}}},s=a,l=(r("d377"),r("2877")),c=Object(l["a"])(s,n,o,!1,null,"310a4ed7",null);t["default"]=c.exports},"92e4":function(e,t,r){},"960a":function(e,t,r){},"9b3d":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("vxe-grid",e._b({key:"grid"+e.isDetail,ref:"table",attrs:{size:"small","footer-method":e.footerMethod,"footer-span-method":e.footerSpanMethod,"auto-resize":"","valid-config":{message:"default"},"footer-cell-style":e.footerCellStyle,data:e.tableData,"show-footer":"","edit-config":!e.isDetail,"edit-rules":e.isDetail||"0"!=e.comparFlag?{}:e.editRules},scopedSlots:e._u([{key:"typeEdit",fn:function(t){var n=t.row,o=(t.rowIndex,t.column);return[r("a-select",{staticClass:"costTypeSelect",attrs:{getPopupContainer:e.getContainer,disabled:e.isDetail||"01"==n.type||"1"==e.comparFlag},on:{dropdownVisibleChange:function(t){return e.getOldType(n)},change:function(t,r){var i=r.data;return e.costTypeChoose({row:n,column:o},t,{data:i})}},model:{value:n.type,callback:function(t){e.$set(n,"type",t)},expression:"row.type"}},[e._l(e.costTypeMenu,(function(t){return[r("a-select-option",{key:t.type,attrs:{disabled:!!e.tableData.find((function(e){return e.type===t.type})),dataObj:t}},[e._v("\n            "+e._s(t.label)+"\n          ")])]}))],2)]}},{key:"unit",fn:function(t){var n=t.row;return[r("j-select-corp",{attrs:{valueStyle:{height:"auto",padding:"0 11px 0 0"},showTootip:!1,"read-only":!n.type||e.isDetail,width:"220px"},model:{value:n["unitCode"],callback:function(t){e.$set(n,"unitCode",t)},expression:"row['unitCode']"}})]}},{key:"unitEdit",fn:function(t){var n=t.row,o=(t.rowIndex,t.column);return[r("input-search-modal",{attrs:{disabled:!n.type||e.isDetail||"1"==e.comparFlag,width:"100%",placeholder:"请选择单位",action:"/base/rCorpInfo/getCorpInfoByBaseType",options:{value:"code",label:"name",search:"name"},"page-fields":{current:"pageNo",size:"pageSize"},columns:e.columns,otherParams:{field:"id,name,address,linkMan",order:"desc",column:"createTime",baseType:e.getCorpType(n.type),extraFlag:"1"},getPopupContainer:e.getContainer,"is-custom-modal":!1},on:{change:function(t,r){return e.unitChoose([r],n.type,{row:n,column:o})}},scopedSlots:e._u([{key:"button",fn:function(){return[r("a-button",{directives:[{name:"show",rawName:"v-show",value:n.type&&!e.isDetail&&"0"==e.comparFlag,expression:"row.type && !isDetail && comparFlag == '0'"}]},[e._v("选择单位")])]},proxy:!0}],null,!0),model:{value:n["unitCode"],callback:function(t){e.$set(n,"unitCode",t)},expression:"row['unitCode']"}})]}},{key:"costEdit",fn:function(t){var n=t.row,o=(t.rowIndex,t.column);return[e.isHasChild&&!e.isChild?r("span",[e._v(e._s(e.formatterAmount(n["cost"])))]):r("amount-input",{attrs:{min:0,disabled:!n.type||e.isDetail||"1"===n.method||"01"===n.type&&e.isHasChild||"1"==e.comparFlag,width:"170px"},on:{change:function(t){return e.setChooseAmount(t,n.type,{row:n,column:o})}},model:{value:n["cost"],callback:function(t){e.$set(n,"cost",t)},expression:"row['cost']"}})]}},{key:"methodEdit",fn:function(t){var n=t.row;t.rowIndex;return[r("a-radio-group",{staticStyle:{gap:"0"},attrs:{disabled:"01"===n.type,"button-style":"solid"},model:{value:n["method"],callback:function(t){e.$set(n,"method",t)},expression:"row['method']"}},[r("a-radio-button",{attrs:{value:"0"}},[e._v("分摊")]),r("a-radio-button",{attrs:{value:"1"}},[e._v("汇总")])],1)]}},{key:"action",fn:function(t){var n=t.row,o=t.rowIndex;return[r("a-space",[r("a",["0"==e.comparFlag?r("a-icon",{attrs:{type:"plus"},on:{click:function(t){return e.addToTable(n,o)}}}):e._e()],1),r("a",["01"!==n.type?r("a-icon",{staticStyle:{color:"red"},attrs:{type:"delete"},on:{click:function(t){return e.deleteRow(n,o)}}}):e._e()],1)])]}},{key:"empty",fn:function(){return[r("div",{staticClass:"tableEmpty"},[r("a-empty"),r("a-button",{directives:[{name:"show",rawName:"v-show",value:!e.isDetail,expression:"!isDetail"}],on:{click:function(t){return e.addToTable(void 0)}}},[e._v("添加")])],1)]},proxy:!0}])},"vxe-grid",e.gridOptions,!1))],1)},o=[],i=r("cf20"),a=r("4aae"),s=r("aa2d"),l=r("3ed7"),c=r("da39"),u=r("d8a5"),d={name:"CostManage",mixins:[c["FooterMethod"]],components:{InputSearchModal:s["default"],JSelectCorp:i["default"],AmountInput:a["default"]},props:{isDetail:{type:Boolean,default:!1},isHasChild:{type:Boolean,default:!1},isChild:{type:Boolean,default:!1}},inject:{getContainer:{default:function(){return document.body}}},data:function(){var e=this,t=function(t){var r=t.cellValue,n=t.row;return new Promise((function(t,o){return"1"===n.method?t():Number(r)>0||"01"===n.type&&e.isHasChild?void t():o(new Error("费用应大于0"))}))};return{comparFlag:"0",gridOptions:{columns:[{title:"费用类别",field:"type",slots:{edit:"typeEdit"},editRender:{type:"visible"},formatter:function(t){var r=t.cellValue;return e.costTypeMenu.find((function(e){return e.type===r}))?e.costTypeMenu.find((function(e){return e.type===r})).label:""}},{title:"单位名称",field:"unitCode",slots:{edit:"unitEdit",default:"unit"},editRender:{type:"visible"}},{title:"金额（元）",field:"cost",slots:{edit:"costEdit"},editRender:{type:"visible"},align:"right",width:200,formatter:function(e){var t=e.cellValue;return Object(l["g"])(t)}},{title:"计算方式",field:"method",slots:{edit:"methodEdit"},editRender:{type:"visible"},width:150,align:"center",visible:!this.isDetail&&this.isHasChild},{title:"操作",slots:{default:"action"},width:60,align:"center",visible:!0}],border:!0,resizable:!0},editRules:{type:[{required:!0,message:"请选择费用类别！"}],unitCode:[{required:!1,message:"请选择单位！"}],cost:[{required:!0,message:"请输入费用！"},{validator:t}]},costTypeMenu:[{value:"construction",label:"工程款",type:"01",corpType:"03"},{value:"priceReview",label:"审价费",type:"02",corpType:"06"},{value:"supervisor",label:"监理费",type:"03",corpType:"05"},{value:"biddingCost",label:"招标费",type:"04",corpType:"07"},{value:"inspectionCost",label:"检测费",type:"05",corpType:"08"},{value:"makeCost",label:"造价费",type:"06",corpType:"09"}],columns:[{title:"单位名称",align:"left",field:"name"},{title:"地址",align:"left",field:"address"},{title:"联系人",align:"center",field:"linkMan"}],tableData:[]}},created:function(){this.getComparFlag()},watch:{isDetail:{handler:function(){var e=this.gridOptions.columns.find((function(e){return"操作"===e.title}));e&&(e.visible=!this.isDetail)},immediate:!0}},methods:{formatterAmount:l["g"],getComparFlag:function(){var e=this;Object(u["g"])("compar_able").then((function(t){t.success&&t.result.length>0&&(e.comparFlag=t.result[0].text)}))},getCorpType:function(e){var t=this.costTypeMenu.find((function(t){return t.type===e}));return t?t.corpType:null},addToTable:function(e,t){var r=this;void 0!==t?this.$refs.table.validate(e).then((function(){r.tableData.push({method:"0",type:void 0})})).catch((function(e){return e})):r.tableData.push({method:"0",type:void 0})},getOldType:function(e){e.oldType=e.type},costTypeChoose:function(e,t){var r=e.row,n=e.column;this.$refs.table.updateStatus({row:r,column:n});var o=this.costTypeMenu.find((function(e){return e.type===t}));if(r.oldType){var i=this.costTypeMenu.find((function(e){return e.type===r.oldType}));this.$emit("delCost",i,o),r.unitCode=null}else this.$emit("initCost",o);r.oldType=t},unitChoose:function(e,t,r){this.$refs.table.updateStatus(r);var n=this.costTypeMenu.find((function(e){return e.type===t}));this.$emit("unitChoose",e,n)},setChooseAmount:function(e,t,r){var n=this;this.$refs.table.updateStatus(r);var o=this.costTypeMenu.find((function(e){return e.type===t}));this.$nextTick((function(){n.$refs.table.updateFooter()})),this.$emit("amountChange",e,o)},deleteRow:function(e,t){var r=this.costTypeMenu.find((function(t){return t.type===e.type}));this.$emit("delCost",r,null),this.tableData.splice(t,1)},checkData:function(){var e=this;return new Promise((function(t,r){if(!e.isHasChild){var n=e.tableData.find((function(e){return"01"===e.type}));n||r(new Error("请选择工程款！"))}e.$refs.table.validate(e.tableData).then((function(){t()})).catch((function(e){r(e)}))}))},footerSpanMethod:function(e){e._rowIndex;var t=e._columnIndex;return 0===t?{colspan:2}:t<2?{colspan:0}:void 0},footerCellStyle:function(e){e.$rowIndex,e.column;var t=e.columnIndex;if(0===t)return"text-align: right"}}},f=d,h=(r("c30f"),r("2877")),p=Object(h["a"])(f,n,o,!1,null,"10ad2592",null);t["default"]=p.exports},a2d9:function(e,t,r){"use strict";r("2091")},a4ee:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-cascader",{attrs:{fieldNames:e.cascaderObj,options:e.options,"display-render":e.displayRender,"expand-trigger":"hover",placeholder:e.placeholder,disabled:e.disabled},on:{change:e.onChange},model:{value:e.showValue,callback:function(t){e.showValue=t},expression:"showValue"}})},o=[],i=r("0fea"),a={name:"CascaderSelect",props:{code:{type:String,default:""},placeholder:{type:String,default:""},value:{type:String,default:""},disabled:{type:Boolean,default:!1}},model:{prop:"value",event:"change.value"},computed:{showValue:{get:function(){try{var e=this.value.slice(0,2),t=this.value;return[e,t]}catch(r){return[]}},set:function(e){return e}}},data:function(){return{cascaderObj:{label:"name",value:"code",children:"children"},url:{loadTreeData:"/sys/category/buildTree"},options:[]}},created:function(){var e=this;Object(i["e"])(this.url.loadTreeData,{code:this.code}).then((function(t){t.success&&(e.options=t.result[0].children)}))},methods:{onChange:function(e){this.$emit("onChange",e),this.$emit("change.value",e[1])},displayRender:function(e){var t=e.labels;return t[t.length-1]}}},s=a,l=r("2877"),c=Object(l["a"])(s,n,o,!1,null,"3244bb28",null);t["default"]=c.exports},a628:function(e,t,r){"use strict";r("b7ec")},a69d:function(e,t,r){"use strict";r("8e97")},a836:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["modal"===e.showType?r("j-modal",{attrs:{title:e.title,width:e.width,visible:e.visible,switchFullscreen:"",okButtonProps:{class:{"jee-hidden":e.disableSubmit}},cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[r("a-collapse",{attrs:{bordered:!1,expandIconPosition:"right"},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[r("a-collapse-panel",{key:"1",staticStyle:{"background-color":"#fff"},scopedSlots:e._u([{key:"header",fn:function(){return[r("span",{staticClass:"collapseTitle",attrs:{"aria-label":"1"}},[e._v(" 分摊清册 ")])]},proxy:!0}],null,!1,4256689722)},[r("vxe-table",{ref:"xTable",staticClass:"vxeTable",attrs:{data:e.dataSource,"edit-config":{trigger:"manual",mode:"row"},border:"",resizable:"","header-align":"center","show-overflow":"tooltip","auto-resize":"","max-height":"400px"}},[r("vxe-table-column",{attrs:{type:"seq","show-overflow":!1,title:"序号","header-align":"center",align:"center",width:"60px"}}),r("vxe-table-column",{attrs:{field:"psnInfoName",title:"业主姓名","header-align":"center",align:"center",width:"100px"}}),r("vxe-table-column",{attrs:{field:"houseAddress","class-name":"vxe-table--rtl",title:"房屋位置","header-align":"center",align:"left"}}),r("vxe-table-column",{attrs:{field:"struArea",title:"建筑面积 (㎡)","header-align":"center",align:"right",width:"130px",formatter:function(t){var r=t.cellValue;return e.formatterAmount(r,3)}}}),r("vxe-table-column",{attrs:{field:"phone",title:"联系方式","header-align":"center",align:"center",width:"130px"}}),r("vxe-table-column",{attrs:{field:"amount",title:"分摊金额 (元)","header-align":"center",align:"right",width:"150px",formatter:function(t){var r=t.cellValue;return r?e.formatterAmount(r):"0.00"}}}),r("vxe-table-column",{attrs:{field:"accAmount",title:"资金支付 (元)","header-align":"center",align:"right",width:"150px",formatter:function(t){var r=t.cellValue;return r?e.formatterAmount(r):"0.00"}}}),r("vxe-table-column",{attrs:{field:"cashAmount",title:"补交现金 (元）","header-align":"center",align:"right",width:"150px",formatter:function(t){var r=t.cellValue;return r?e.formatterAmount(r):"0.00"}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("span",{class:n.cashAmount&&0!=n.cashAmount?"colorOrange":""},[e._v(e._s(e.formatterAmount(n.cashAmount)))])]}}],null,!1,1597082683)})],1)],1)],1)],1):r("div",[!e.childList||e.childList.length<=0?r("a-empty"):r("a-collapse",{attrs:{bordered:!1,expandIconPosition:"right"},model:{value:e.activeKeyBatch,callback:function(t){e.activeKeyBatch=t},expression:"activeKeyBatch"}},e._l(e.childList,(function(t,n){return r("a-collapse-panel",{key:n+"",staticStyle:{"background-color":"#fff"},scopedSlots:e._u([{key:"header",fn:function(){return[r("span",{staticClass:"collapseTitle"},[e._v("\n            "+e._s(t.remark)+"\n          ")])]},proxy:!0}],null,!0)},[r("div",{staticClass:"showData"},[r("div",{staticClass:"dataGroup"},[r("div",{staticClass:"row_1"},[r("span",[e._v("总户数/表决户数")]),r("span",[e._v(e._s(t.projVote.totalNum?Number(t.projVote.inNum/t.projVote.totalNum*100).toFixed(2):"0%")+"%")])]),r("div",{staticClass:"row_2"},[r("span",{staticClass:"num"},[e._v(e._s(t.projVote.totalNum))]),r("span",[e._v("户/")]),r("span",{staticClass:"num"},[e._v(e._s(t.projVote.inNum))]),r("span",[e._v("户")])]),r("div",[e._v(e._s(t.projVote.totalArea)+"m² / "+e._s(t.projVote.inArea)+"m²")]),r("div",{staticClass:"row_4"},[r("div",{staticClass:"progress"},[r("div",{staticClass:"blueProgress",style:{width:t.projVote.agreePercent+"%"}}),r("div",{staticClass:"redProgress",style:{width:t.projVote.notAgreePercent+"%"}}),r("div",{staticClass:"originProgress",style:{width:t.projVote.notVotePercent+"%"}})])])]),r("div",{staticClass:"dataGroup"},[r("div",{staticClass:"row_1"},[r("span",[e._v("同意")]),r("span",[e._v(e._s(t.projVote.agreePercent)+"%")])]),r("div",{staticClass:"row_2"},[r("span",{staticClass:"num"},[e._v(e._s(t.projVote.agreeNum))]),r("span",[e._v("户")])]),r("div",[e._v(e._s(t.projVote.agreeArea)+"m²")]),r("div",{staticClass:"row_4"},[r("div",{staticClass:"progress"},[r("div",{staticClass:"blueProgress",style:{width:t.projVote.agreePercent+"%"}})])])]),r("div",{staticClass:"dataGroup"},[r("div",{staticClass:"row_1"},[r("span",[e._v("不同意")]),r("span",[e._v(e._s(t.projVote.notAgreePercent)+"%")])]),r("div",{staticClass:"row_2"},[r("span",{staticClass:"num"},[e._v(e._s(t.projVote.notAgreeNum))]),r("span",[e._v("户")])]),r("div",[e._v(e._s(t.projVote.notAgreeArea)+"m²")]),r("div",{staticClass:"row_4"},[r("div",{staticClass:"progress"},[r("div",{staticClass:"redProgress",style:{width:t.projVote.notAgreePercent+"%"}})])])]),r("div",{staticClass:"dataGroup"},[r("div",{staticClass:"row_1"},[r("span",[e._v("未决策")]),r("span",[e._v(e._s(t.projVote.notVotePercent)+"%")])]),r("div",{staticClass:"row_2"},[r("span",{staticClass:"num"},[e._v(e._s(t.projVote.notVoteNum))]),r("span",[e._v("户")])]),r("div",[e._v(e._s(t.projVote.notVoteArea)+"m²")]),r("div",{staticClass:"row_4"},[r("div",{staticClass:"progress"},[r("div",{staticClass:"originProgress",style:{width:t.projVote.notVotePercent+"%"}})])])])]),e.isDetail?e._e():r("a-button",{staticStyle:{"margin-bottom":"8px"},attrs:{type:"primary",icon:"rollback"},on:{click:function(r){return e.reShare(t)}}},[e._v("重新分摊")]),!e.isDetail&&t.allotLists&&t.allotLists.length>0?r("a-button",{staticStyle:{"margin-bottom":"8px","margin-left":"8px"},attrs:{type:"primary",icon:"download"},on:{click:function(r){return e.exportVote(t.code)}}},[e._v("签名导出")]):e._e(),e.isDetail?e._e():r("a-upload",{attrs:{name:"file",showUploadList:!1,multiple:!1,data:{projNo:t.code,projId:t.id},headers:e.tokenHeader,action:e.url.importVoteList},on:{change:e.handleImportExcel}},[r("a-button",{staticStyle:{"margin-bottom":"8px","margin-left":"8px"},attrs:{type:"primary",loading:e.loading,icon:"import"}},[e._v("签名导入")])],1),r("vxe-table",{ref:"xTable",refInFor:!0,staticClass:"vxeTable",attrs:{data:t.allotLists,"edit-config":{trigger:"manual",mode:"row"},border:"",resizable:"","header-align":"center","show-overflow":"tooltip","auto-resize":"","max-height":"400px"}},[r("vxe-table-column",{attrs:{type:"seq","show-overflow":!1,title:"序号",align:"center",width:"60px"}}),r("vxe-table-column",{attrs:{field:"psnInfoName",title:"业主姓名","header-align":"center",align:"center",width:"100px"}}),r("vxe-table-column",{attrs:{field:"houseAddress","class-name":"vxe-table--rtl",title:"房屋位置","header-align":"center",align:"left"}}),r("vxe-table-column",{attrs:{field:"struArea",title:"建筑面积 (㎡)","header-align":"center",align:"right",width:"130px",formatter:function(t){var r=t.cellValue;return e.formatterAmount(r,3)}}}),r("vxe-table-column",{attrs:{field:"allotArea",title:"分摊面积 (㎡)","header-align":"center",align:"right",width:"130px",formatter:function(t){var r=t.cellValue;return e.formatterAmount(r,3)}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("a-input-number",{attrs:{disabled:e.isDetail||"0"===e.areaEnterState,placeholder:"请输入分摊面积"},model:{value:n.allotArea,callback:function(t){e.$set(n,"allotArea",t)},expression:"row.allotArea"}})]}}],null,!0)}),r("vxe-table-column",{attrs:{field:"amount",title:"分摊金额 (元)","header-align":"center",align:"right",width:"150px",formatter:function(t){var r=t.cellValue;return r?e.formatterAmount(r):"0.00"}}}),r("vxe-table-column",{attrs:{field:"accAmount",title:"资金支付 (元)","header-align":"center",align:"right",width:"150px",formatter:function(t){var r=t.cellValue;return r?e.formatterAmount(r):"0.00"}}}),r("vxe-table-column",{attrs:{field:"cashAmount",title:"补交现金 (元)","header-align":"center",align:"right",width:"150px",formatter:function(t){var r=t.cellValue;return r?e.formatterAmount(r):"0.00"}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("span",{class:n.cashAmount&&0!=n.cashAmount?"colorOrange":""},[e._v(e._s(e.formatterAmount(n.cashAmount)))])]}}],null,!0)}),r("vxe-table-column",{attrs:{field:"signFlag",title:"业主意见","header-align":"center",align:"right",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("a-select",{attrs:{placeholder:"请选择业主意见",disabled:e.isDetail},model:{value:n.signFlag,callback:function(t){e.$set(n,"signFlag",t)},expression:"row.signFlag"}},[r("a-select-option",{attrs:{value:"00"}},[e._v("同意")]),r("a-select-option",{attrs:{value:"01"}},[e._v("不同意")]),r("a-select-option",{attrs:{value:"99"}},[e._v("未签名")])],1)]}}],null,!0)}),r("vxe-table-column",{attrs:{field:"phone",title:"联系方式","header-align":"center",align:"right",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("a-input",{attrs:{disabled:e.isDetail,placeholder:"请输入联系方式"},model:{value:n.phone,callback:function(t){e.$set(n,"phone",t)},expression:"row.phone"}})]}}],null,!0)}),r("vxe-table-column",{attrs:{field:"signType",title:"签字来源","header-align":"center",align:"right",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("a-select",{attrs:{placeholder:"请选择签字来源",disabled:e.isDetail},model:{value:n.signType,callback:function(t){e.$set(n,"signType",t)},expression:"row.signType"}},[r("a-select-option",{attrs:{value:"00"}},[e._v("手工签字")]),r("a-select-option",{attrs:{value:"01"}},[e._v("网络投票")]),r("a-select-option",{attrs:{value:"02"}},[e._v("身份证识别投票")]),r("a-select-option",{attrs:{value:"03"}},[e._v("身份证读取投票")]),r("a-select-option",{attrs:{value:"04"}},[e._v("移动端投票")])],1)]}}],null,!0)}),r("vxe-table-column",{attrs:{field:"remark",title:"备注","header-align":"center",align:"right",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("a-input",{attrs:{disabled:e.isDetail,placeholder:"请输入备注"},model:{value:n.remark,callback:function(t){e.$set(n,"remark",t)},expression:"row.remark"}})]}}],null,!0)})],1)],1)})),1)],1)],1)},o=[],i=r("0fea"),a=r("d8a5"),s=r("3ed7"),l=r("dc9a"),c=r("2b0e"),u=r("9fb0"),d={name:"ShareDetail",components:{ContentView:l["default"]},props:{isDetail:{type:Boolean,default:function(){return!1}}},data:function(){return{visible:!1,title:"分摊清册",width:"140vh",disableSubmit:!1,activeKey:["1"],activeKeyBatch:["0"],dataSource:[],showType:"modal",loading:!1,url:{buildShared:"/use/projAllotList/buildShared",reShare:"/use/projAllotList/reShare",exportVoteList:"/use/projAllotList/downloadTemplate",importVoteList:"".concat(window._CONFIG["domianURL"],"/")+"use/projAllotList/importVoteExcel"},allotCashState:"1",areaEnterState:"0",formatterAmount:s["g"]}},inject:["projMainData"],computed:{childList:{get:function(){return this.projMainData().children},set:function(){}},tokenHeader:function(){return{"X-Access-Token":c["default"].ls.get(u["a"]),sourceName:c["default"].ls.get(u["A"]),redisIndex:c["default"].ls.get(u["x"])}}},created:function(){this.initDict()},methods:{exportVote:function(e){var t=this.url.exportVoteList+"/"+e;Object(i["d"])(t,"业主签名"+(new Date).getTime()+".xls")},handleImportExcel:function(e){if(this.loading=!0,"done"===e.file.status)if(this.loading=!1,e.file.response.success){this.$message.success(e.file.response.message||"".concat(e.file.name," 文件上传成功"));var t=e.file.response.result;this.projMainData().children.forEach((function(e){e.id==t.id&&(e.allotLists=t.allotLists)}))}else this.$message.error("文件导入失败: ".concat(e.file.response.message," "));else"error"===e.file.status&&(this.loading=!1,this.$message.error("文件导入失败: ".concat(e.file.response.message," ")))},reShare:function(e){Object(i["j"])(this.url.reShare,e).then((function(t){t.success&&t.result&&(e.allotLists=t.result)}))},checkData:function(){var e=this;return new Promise((function(t,r){if("0"===e.allotCashState){var n=0;e.childList.map((function(e){e.allotLists&&e.allotLists.length>0&&e.allotLists.map((function(e){n+=Number(e.cashAmount)}))})),n>0?(e.$message.warn("当前项目不允许补交现金，请续交后再进行处理！"),r()):t()}else t()}))},initDict:function(){var e=this;Object(a["e"])("cash_allotment_allowed").then((function(t){t&&(e.allotCashState=t)})),Object(a["e"])("area_enter_state").then((function(t){t&&(e.areaEnterState=t)}))},showModal:function(e,t,r){var n=this;this.visible=!0,this.dataSource=[],this.$nextTick((function(){var o={};o.houseIds=e,o.projId=t,o.serviceProj=r,Object(i["k"])(n.url.buildShared,o,"application/json;charset=UTF-8").then((function(e){e.success&&e.result&&(n.dataSource=e.result)}))}))},handleOk:function(){this.visible=!1},handleCancel:function(){this.visible=!1}}},f=d,h=(r("ec22"),r("6b73"),r("2877")),p=Object(h["a"])(f,n,o,!1,null,"5b599759",null);t["default"]=p.exports},a8d6:function(e,t,r){"use strict";r("960a")},aa1d:function(e,t,r){},ac2c:function(e,t,r){},acc9:function(e,t,r){},ad08:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"floorTableView"},[r("div",{staticClass:"tableHeader"},[r("span",{staticClass:"tableHeaderText",on:{click:function(t){e.tableShow=!e.tableShow}}},[e._v(e._s(e.typeName)),e.houseNums?[e._v("（"+e._s(e.houseNums)+"户）")]:e._e()],2)]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tableShow,expression:"tableShow"}],staticStyle:{"max-width":"100%"}},["type01"===e.type?r("table",{ref:"viewTable",class:["viewTableClass",e.type],staticStyle:{"table-layout":"fixed"}},[e._l(e.maxFloor,(function(t,n){return[r("tr",{key:n+"floorZz"},e._l(t.unitArr,(function(o,i){return r("td",{key:i+1+"unit",class:"row_"+n+"_col"},[(i+1)%2!==0?[t.isTitle||0!==i?e._e():[r("div",{staticClass:"floorNum"},[e.isShowCheckbox?r("input",{class:["floorCheck_"+e.getFloorNum(n)],attrs:{type:"checkbox"},domProps:{value:"floorCheck_"+e.getFloorNum(n)},on:{change:function(t){return e.batchCheckedHousesByFloor(t,e.$refs.viewTable,e.getFloorNum(n))}}}):e._e(),r("span",[e._v(e._s(e.getFloorNum(n))+"层")])])],t.isTitle&&0===i?[r("div",{staticClass:"floorNum"})]:e._e()]:e._e(),(i+1)%2===0?[t.isTitle?[r("div",{staticClass:"unitInfo"},[t.title?e._e():[e.isShowCheckbox?r("input",{class:"unitCheckClass_"+o.unitId+"_"+e.type,attrs:{type:"checkBox"},domProps:{value:"unitCheck_"+o.unitId},on:{change:function(t){return e.houseChangeByUnit({event:t,unit:o})}}}):e._e(),e._v("\n                      "+e._s(o.name)+"\n                    ")],t.title?[e._v("\n                      "+e._s(t.title)+"\n                    ")]:e._e()],2),r("div",{staticClass:"houseCheckBoxs"},e._l(o.maxHouseNum,(function(t,i){return r("div",{key:"houseCheck_"+i,staticClass:"houseCheckBoxItem"},[r("input",{attrs:{type:"checkbox"},on:{change:function(t){return e.houseChangeByHouseNum({event:t,floor:e.maxFloor.length-n,unitInfo:o,houseNo:i+1})}}}),e._v(" "+e._s(i+1)+"号房\n                    ")])})),0)]:[r("div",{staticClass:"tdContent",class:["floorContent_"+(e.maxFloor.length-n),"unitContent_"+o.unitId],style:{width:e.getTdContentWidth(o.houseArr.length),"--notDepositColor":e.floorCardColor.get("未交")}},[e._l(o.houseArr,(function(t,n){return[r("div",{key:t.id,ref:"tdContent_Num"+t.id,refInFor:!0,staticClass:"tdContent_num",class:["floor_"+t.floor,"unit_"+t.unitId,{houseInputDisabled:!e.isOptionalHoust(t.state)}],style:{backgroundColor:e.getHouseCardColor(t)},on:{mouseenter:function(r){return e.houseInfoOver(t,r)},mouseleave:function(r){return e.houseInfoOut(t)}}},[e.isOptionalHoust(t.state)?e._e():r("a-icon",{staticClass:"house_issuesIcon",staticStyle:{color:"#ec4646"},attrs:{type:"issues-close"}}),e.isShowCheckbox?r("input",{directives:[{name:"show",rawName:"v-show",value:e.isOptionalHoust(t.state,t.houseUse),expression:"isOptionalHoust(houseItem.state, houseItem.houseUse)"}],ref:"houseInfoCheckBoxRef"+t.id,refInFor:!0,class:["unit_"+t.unitId+"_type_"+e.data.type+"_houseCheckbox","houseCheckFloor_"+t.floor],attrs:{disabled:!e.isOptionalHoust(t.state,t.houseUse),type:"checkbox",houseUse:t.houseUse,houseNo:n+1,unitNum:t.unitId,floorNum:t.floor},domProps:{value:t.id},on:{click:function(t){return e.checkBoxClick(t)},change:function(r){return e.houseChange({houseItem:t,checked:r.target.checked})}}}):e._e(),r("span",{class:{notCheckBoxSpan:e.isShowCheckbox}},[e._v(e._s(t.roomName))]),e.areaShow&&t.houseArea?r("div",{staticClass:"otherInfo tdFloorUnitContent_area"},[e._v("\n                          "+e._s(t.houseArea)+"m²\n                        ")]):e._e(),e.moneyShow&&t.balance?r("div",{staticClass:"otherInfo tdFloorUnitContent_money"},[e._v("\n                          "+e._s(t.balance)+"元\n                        ")]):e._e(),null!==t.fstDepDate?r("div",{staticClass:"fstDepDate"},[e._v(e._s(e.formatDate(t.fstDepDate)))]):e._e()],1)]}))],2)]]:e._e()],2)})),0)]}))],2):[e._l(e.maxUnitNum,(function(t){return[r("table",{key:"tableUnit"+t.unitId,ref:"viewTable"+t.unitId,refInFor:!0,staticClass:"otherFloorTable",class:["viewTableClass",e.type],staticStyle:{"table-layout":"fixed"}},[e._l(t.maxFloor,(function(n,o){return[r("tr",{key:o+"floorZz"},e._l(n.unitArr,(function(i,a){return r("td",{key:a+1+"unit",class:"row_"+o+"_col",style:0===a?"width:60px;text-overflow: ellipsis;overflow: hidden;white-space: nowrap":""},[0===a?[n.isTitle?e._e():[r("div",{staticClass:"floorNum"},[e.isShowCheckbox?r("input",{class:["floorCheck_"+e.getFloorNum(o,t)],attrs:{type:"checkbox",unitId:t.unitId},domProps:{value:"floorCheck_"+e.getFloorNum(o,t)},on:{change:function(r){return e.batchCheckedHousesByFloor(r,e.$refs["viewTable"+t.unitId][0],e.getFloorNum(o,t))}}}):e._e(),r("span",[e._v(e._s(e.getFloorNum(o,t))+" 层")])])],n.isTitle?[r("div",{staticClass:"floorNum"})]:e._e()]:e._e(),0!==a?[n.isTitle?[r("div",{staticClass:"unitInfo"},[e.isShowCheckbox?r("input",{class:"unitCheckClass_"+t.unitId+"_"+e.type,attrs:{type:"checkBox"},domProps:{value:"unitCheck_"+t.unitId},on:{change:function(r){return e.houseChangeByUnit({event:r,unit:t})}}}):e._e(),e._v("\n                        "+e._s(t.name)+"\n                      ")])]:[r("div",{staticClass:"tdContent",class:["floorContent_"+(e.maxFloor.length-o),"unitContent_"+t.unitId],style:{width:"100%","--notDepositColor":e.floorCardColor.get("未交")}},[e._l(i.houseArr,(function(t,n){return[r("div",{key:t.id,ref:"tdContent_Num"+t.id,refInFor:!0,staticClass:"tdContent_num",class:["floor_"+t.floor,"unit_"+t.unitId],style:{backgroundColor:e.getHouseCardColor(t)},on:{mouseenter:function(r){return e.houseInfoOver(t,r)},mouseleave:function(r){return e.houseInfoOut(t)}}},[e.isOptionalHoust(t.state)?e._e():r("a-icon",{staticClass:"house_issuesIcon",attrs:{type:"issues-close"}}),e.isShowCheckbox?r("input",{directives:[{name:"show",rawName:"v-show",value:e.isOptionalHoust(t.state,t.houseUse),expression:"isOptionalHoust(houseItem.state, houseItem.houseUse)"}],ref:"houseInfoCheckBoxRef"+t.id,refInFor:!0,class:["unit_"+t.unitId+"_type_"+e.data.type+"_houseCheckbox","houseCheckFloor_"+t.floor],attrs:{disabled:!e.isOptionalHoust(t.state,t.houseUse),houseUse:t.houseUse,type:"checkbox",houseNo:n+1,unitNum:t.unitId,floorNum:t.floor},domProps:{value:t.id},on:{click:function(t){return e.checkBoxClick(t)},change:function(r){return e.houseChange({houseItem:t,checked:r.target.checked})}}}):e._e(),r("span",{class:{notCheckBoxSpan:e.isShowCheckbox}},[e._v(e._s(t.roomName))]),e.areaShow&&t.houseArea?r("div",{staticClass:"otherInfo tdFloorUnitContent_area"},[e._v("\n                              "+e._s(t.houseArea)+"m²\n                            ")]):e._e(),e.moneyShow&&t.balance?r("div",{staticClass:"otherInfo tdFloorUnitContent_money"},[e._v("\n                              "+e._s(t.balance)+"元\n                            ")]):e._e(),null!==t.fstDepDate?r("div",{staticClass:"fstDepDate"},[e._v(e._s(e.formatDate(t.fstDepDate)))]):e._e()],1)]}))],2)]]:e._e()],2)})),0)]}))],2)]}))]],2)])},o=[],i=r("ca00"),a=r("2b2c"),s=r("4ec3");function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function f(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */f=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new A(n||[]);return o(a,"_invoke",{value:L(e,r,s)}),a}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function _(){}function w(){}var C={};u(C,a,(function(){return this}));var x=Object.getPrototypeOf,I=x&&x(x(F([])));I&&I!==r&&n.call(I,a)&&(C=I);var k=w.prototype=b.prototype=Object.create(C);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(o,i,a,s){var c=h(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==l(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var l=S(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(t,r,n);if("normal"===c.type){if(o=n.done?y:m,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,S(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(l(t)+" is not iterable")}return _.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=u(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},T(P.prototype),u(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new P(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function h(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){h(i,n,o,a,s,"next",e)}function s(e){h(i,n,o,a,s,"throw",e)}a(void 0)}))}}var m={name:"HouseViewTable",props:{unitNums:{type:Number,default:1},areaShow:{type:Boolean,default:!1},moneyShow:{type:Boolean,default:!1},isShowCheckbox:{type:Boolean,default:!1},isShowHouseCheckBox:{type:Boolean,default:!1},isDetail:{type:Boolean,default:!1},optionalAccState:{type:Array,default:null}},mixins:[a["a"]],inject:["projMainData"],computed:{model:{get:function(){return this.projMainData()},set:function(e){}}},mounted:function(){$("body").append('<div id="floorBaseInfoModal"></div>')},data:function(){return{floorCardColor:new Map([["未交","#8FD623"],["已交","#a0c2fd"],["已交不足额","#4687f8"],["余额不足30%","#fdb3b8"],["免交","#d7cfcf"]]),floorNums:0,maxFloor:[],maxUnitNum:[],startFloor:0,type:"",typeName:"",houseNums:0,data:{},tableShow:!0,houseLoading:!1,houseListGroupByUnit:{},houseAllList:[],initChooseFloors:[],unitAll:[],notDepositColor:"#edf5fd"}},methods:{getHouseCardColor:function(e){return this.checkHouseUseSpecial(e.houseUse)?this.floorCardColor.get("不交"):e.notThree?this.floorCardColor.get("余额不足30%"):e.deposit&&"0"===e.depFlag?this.floorCardColor.get("已交不足额"):e.deposit?this.floorCardColor.get("已交"):this.floorCardColor.get("未交")},getFloorNum:function(e,t){return this.startFloor>0?"type01"===this.type?this.maxFloor.length-1-e+this.startFloor:t.maxFloor.length-1-e+this.startFloor:"type01"===this.type?this.maxFloor.length-1+this.startFloor-(e-1)<=0?this.maxFloor.length-1+this.startFloor-(e-1)-1:this.maxFloor.length-1+this.startFloor-(e-1):t.maxFloor.length-1+this.startFloor-(e-1)<=0?t.maxFloor.length-1+this.startFloor-(e-1)-1:t.maxFloor.length-1+this.startFloor-(e-1)},formatDate:function(e){var t=new Date(e),r=t.getFullYear(),n=t.getMonth()+1,o=t.getDate();return"".concat(r,"-").concat(n,"-").concat(o)},initData:function(){var e=p(f().mark((function e(t){var r,n,o=this;return f().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["l"])("floor_notdeposit_color").catch((function(){}));case 2:return r=e.sent,this.notDepositColor=r.result||"#edf5fd",this.floorCardColor.set("未交",this.notDepositColor),e.next=7,Object(s["i"])("floor_card_color").catch((function(){}));case 7:n=e.sent,n.success&&n.result.forEach((function(e){o.floorCardColor.set(e.text,e.value)})),this.houseLoading=!0,this.data=t,this.type="type"+t.type,this.typeName=t.typeName,this.startFloor=t.startFloor,this.houseNums=t.houseArr.length,this.floorNums=0,this.setTableTrTd(t);case 17:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setTableTrTd:function(e){if("01"===e.type){var t,r=[],n=c(e.houseArr);try{var o=function(){var e=t.value;if("4"===e.state||"5"===e.state)return 1;r.find((function(t){return t.unitId===e.unitId}))||r.push({num:r.length},{num:r.length,unitId:e.unitId,houseArr:[]})};for(n.s();!(t=n.n()).done;)o()}catch(a){n.e(a)}finally{n.f()}for(var i=0;i<=e.floorNums;i++)0===i?this.maxFloor.push({type:"01",isTitle:!0,unitArr:[]}):this.maxFloor.push({type:"01",houseArr:[],unitArr:[],maxHouseNum:0});this.getData(e,!0)}else this.getData(e,!1)},getData:function(e,t){var r=this,n=this;if(e.startFloor=Number(e.startFloor),!(e.floorNums>=0))return n.$message.warning(e.typeName+"楼层数小于0，楼盘数据异常");function o(e){n.isOptionalHoust(e.state,e.houseUse)&&n.$nextTick((function(){var t=n.model.apportionFloors.find((function(t){return e.id===t.id}));n.houseChange({houseItem:e,checked:t})}))}t?n.unitAll=[]:(n.setFloorAllByFloorData(e),n.maxUnitNum=[]),n.$nextTick((function(){var i,a=c(e.houseArr);try{var s=function(){var a=i.value;a.floor=Number(a.floor);var s=0;if(a.floor>=0?(s=e.floorNums-(a.floor-e.startFloor),e.startFloor<0&&(s+=1)):s=e.floorNums-(a.floor-e.startFloor),t)try{n.$refs.viewTable.rows[s].style.display="table-row",n.getNewUnitByHouse(a);var l=n.maxFloor[s]["unitArr"];n.setUnitObj(l);var c=l.findIndex((function(e){return e.unitId===a.unitId})),u=r.maxFloor[0]["unitArr"];if(-1!==c){l[c].houseArr.push(a);var d=u.find((function(e){return e.unitId===a.unitId})),f=l[c].houseArr.length;(f>d.maxHouseNum||!d.maxHouseNum)&&n.$set(d,"maxHouseNum",f)}o(a)}catch(p){return 0}else{if("4"===a.state||"5"===a.state)return 0;var h=n.getUnitData(a);if(0===a.floor)return n.$message.warning({content:"楼层数为0，数据异常",key:"floor=0"}),0;n.$nextTick((function(){n.setFloorData(h,a),o(a)}))}};for(a.s();!(i=a.n()).done;)s()}catch(l){a.e(l)}finally{a.f()}n.houseLoading=!1}))},getNewUnitByHouse:function(e){this.unitAll.find((function(t){return t.unitId===e.unitId}))||(this.maxFloor[0]["unitArr"].push({num:this.unitAll.length},{type:"01",isTitle:!0,name:e.cellName,unitId:e.unitId}),this.unitAll.push({unitId:e.unitId,cellName:e.cellName}))},setUnitObj:function(e){this.unitAll.forEach((function(t){e.find((function(e){return e.unitId===t.unitId}))||e.push({num:e.length},{num:e.length,unitId:t.unitId,houseArr:[]})}))},setFloorData:function(e,t){var r=0;t.floor>=0?(r=this.data.floorNums-(t.floor-this.data.startFloor),this.data.startFloor<0&&(r+=1)):r=this.data.floorNums-(t.floor-this.data.startFloor);var n=null;n=this.$refs["viewTable"+t.unitId][0],n.rows[r].style.display="table-row";var o=e.maxFloor[r]["unitArr"];o.find((function(e){return e.unitId===t.unitId}))||(e.maxFloor[0].unitArr.find((function(e){return e.unitId===t.unitId}))||e.maxFloor[0].unitArr.push({isTitle:!0},{unitId:t.unitId,houseArr:[]}),o.push({unitId:t.unitId,isTitle:!0,cellName:t.cellName},{unitId:t.unitId,houseArr:[]})),o[1]["houseArr"].push(t)},getUnitData:function(e){var t,r=this.maxUnitNum.findIndex((function(t){return t.unitId===e.unitId}));return-1===r?(this.maxUnitNum.push({maxFloor:Object(i["c"])(this.floorAll),unitId:e.unitId,name:e.cellName}),t=this.maxUnitNum[this.maxUnitNum.length-1]):t=this.maxUnitNum[r],t},setFloorAllByFloorData:function(e){this.floorAll=[];for(var t=0;t<=e.floorNums;t++)0===t?this.floorAll.push({isTitle:!0,unitArr:[]}):this.floorAll.push({houseArr:[],unitArr:[]})},checkBoxClick:function(e){if(!this.isShowHouseCheckBox)return!1;e=e||window.event,e.stopPropagation()},houseChange:function(e){var t=e.houseItem,r=e.checked,n=e.floorAll,o=e.unitAll,i=void 0!==o&&o,a=this.model.apportionFloors.findIndex((function(e){return e.id===t.id}));r?-1===a&&this.model.apportionFloors.push(t):-1!==a&&this.model.apportionFloors.splice(a,1);var s=this.$refs["houseInfoCheckBoxRef"+t.id][0];s&&(s.checked=r),n||this.updateFloorCheckState(t.floor,t.unitId),i||this.updateUnitCheckState(t.unitId)},houseChangeByHouseNum:function(e){var t,r=e.event,n=e.unitInfo,o=e.houseNo,i=this;t="type01"===i.type?i.$refs["viewTable"]:i.$refs["viewTable"+n.unitId][0];var a,s=t.querySelectorAll(".tdContent.unitContent_".concat(n.unitId,' input[type="checkbox"][houseNo="').concat(o,'"]')),l=c(s);try{var u=function(){var e=a.value,t=i.data.houseArr.find((function(t){return t.id===e.value}));i.houseChange({houseItem:t,checked:r.target.checked})};for(l.s();!(a=l.n()).done;)u()}catch(d){l.e(d)}finally{l.f()}},batchCheckedHousesByFloor:function(e,t,r){var n,o=this,i=t.querySelectorAll(".houseCheckFloor_".concat(r)),a=c(i);try{var s=function(){var t=n.value;if(o.checkHouseUseSpecial(t.getAttribute("houseUse")))return 1;var r=o.data.houseArr.find((function(e){return e.id===t.getAttribute("value")}));o.houseChange({houseItem:r,checked:e.target.checked,floorAll:!0})};for(a.s();!(n=a.n()).done;)s()}catch(l){a.e(l)}finally{a.f()}},updateUnitCheckState:function(e){var t;t="type01"===this.type?this.$refs["viewTable"]:this.$refs["viewTable"+e][0];var r=t.querySelectorAll(".tdContent.unitContent_".concat(e," input[type=checkbox]")),n=t.querySelectorAll(".tdContent.unitContent_".concat(e," input[type=checkbox]:checked")),o=t.querySelector("input[type=checkbox].unitCheckClass_".concat(e,"_").concat(this.type));n.length===r.length?(o.checked=!0,o.indeterminate=!1):n.length>0?(o.checked=!1,o.indeterminate=!0):(o.checked=!1,o.indeterminate=!1)},updateFloorCheckState:function(e,t){var r=null,n=null;"type01"===this.type?(r=this.$refs["viewTable"],n=this.$el.querySelector(".floorCheck_".concat(e))):(r=this.$refs["viewTable"+t][0],n=this.$el.querySelector(".floorCheck_".concat(e,'[unitId="').concat(t,'"]')));var o=r.querySelectorAll(".houseCheckFloor_".concat(e)),i=r.querySelectorAll(".houseCheckFloor_".concat(e,":checked"));n&&(o.length===i.length?(n.checked=!0,n.indeterminate=!1):i.length>0?(n.checked=!1,n.indeterminate=!0):(n.checked=!1,n.indeterminate=!1))},houseChangeByUnit:function(e){var t=e.event,r=e.unit,n=this,o=null,i=0;o="type01"===this.type?this.$refs["viewTable"]:this.$refs["viewTable"+r.unitId][0];var a,s=o.querySelectorAll(".tdContent.unitContent_".concat(r.unitId," input[type=checkbox]")),l=c(s);try{for(l.s();!(a=l.n()).done;){var u=a.value,d=u.getAttribute("houseNo");Number(d)>i&&(i=Number(d))}}catch(y){l.e(y)}finally{l.f()}for(var f=1;f<=i;f++){var h,p=o.querySelectorAll(".tdContent.unitContent_".concat(r.unitId,' input[type="checkbox"][houseNo="').concat(f,'"]')),m=c(p);try{var v=function(){var e=h.value;if(n.checkHouseUseSpecial(e.getAttribute("houseUse")))return 1;var r=n.data.houseArr.find((function(t){return t.id===e.value}));n.houseChange({houseItem:r,checked:t.target.checked,unitAll:!0})};for(m.s();!(h=m.n()).done;)v()}catch(y){m.e(y)}finally{m.f()}}},openBatchChooseByColModal:function(e){var t=this,r=null,n=0,o=[];r="type01"===this.type?this.$refs["viewTable"]:this.$refs["viewTable"+e][0];var i,a=r.querySelectorAll(".tdContent.unitContent_".concat(e," input[type=checkbox]")),s=c(a);try{for(s.s();!(i=s.n()).done;){var l=i.value,u=l.getAttribute("houseNo");Number(u)>n&&(n=Number(u))}}catch(h){s.e(h)}finally{s.f()}for(var d=1;d<=n;d++)o.push({key:d,value:!1});function f(e,t){for(var r=[],n=function(t){r.push(e("div",{style:{display:"flex",alignItems:"center",columnGap:"4px"}},[e("input",{style:{cursor:"pointer"},attrs:{id:"batchModalColumnId_".concat(t),type:"checkbox"},on:{change:function(e){var r=e.target.checked,n=o.findIndex((function(e){return e.key===t}));o[n].value=!!r}}}),e("label",{style:{cursor:"pointer"},attrs:{for:"batchModalColumnId_".concat(t)}},["".concat(t,"号屋")])]))},i=1;i<=t;i++)n(i);return r}this.$confirm({title:"批量选择",width:600,zIndex:9e3,content:function(e){return e("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"}},f(e,n))},onOk:function(){var r;r="type01"===t.type?t.$refs["viewTable"]:t.$refs["viewTable"+e][0],o.forEach((function(n){var o,i=r.querySelectorAll(".tdContent.unitContent_".concat(e,' input[type="checkbox"][houseNo="').concat(n.key,'"]')),a=c(i);try{var s=function(){var e=o.value;if(t.checkHouseUseSpecial(e.getAttribute("houseUse")))return 1;var r=t.data.houseArr.find((function(t){return t.id===e.value}));t.houseChange({houseItem:r,checked:n.value})};for(a.s();!(o=a.n()).done;)s()}catch(h){a.e(h)}finally{a.f()}}))}})},houseInfoOver:function(e,t){this.isShowHouseCheckBox&&this.isOptionalHoust(e.state,e.houseUse)&&(this.$refs["houseInfoCheckBoxRef"+e.id][0].style.display="unset");var r=$("body"),n=t.pageX+10,o=t.pageY+30;n>r.width()/2&&(n-=300),r.height()-o<300&&(o-=300);var i='\n        <div class="houseInfoOverModal">\n          <h3>'.concat(e.houseName,'</h3>\n          <ul style="list-style: none;padding-left: 10px">\n             <li>户主姓名：').concat(e.householderName?e.householderName:"无","</li>\n             <li>房屋面积：").concat(e.houseArea?Number(e.houseArea).toFixed(3):"0.000","m<sup>2</sup></li>\n             <li>房屋售价：").concat(e.price?this.formatAmount(e.price):"0.00","元</li>\n             <li>账户余额：").concat(e.balance?this.formatAmount(e.balance):"0.00","元</li>\n             <li>可用余额：").concat(e.usableBalance?this.formatAmount(e.usableBalance):"0.00","元</li>\n             <li>房屋用途：").concat(e.houseUseName?e.houseUseName:"","</li>\n          </ul>\n        </div>\n      ");$("#floorBaseInfoModal").html(i).css({left:n+"px",top:o+"px"}).show()},houseInfoOut:function(e){if(this.isShowHouseCheckBox&&this.isOptionalHoust(e.state,e.houseUse)){var t=this.$refs["houseInfoCheckBoxRef"+e.id];t[0].style.removeProperty("display")}$("#floorBaseInfoModal").html("").hide()},getTdContentWidth:function(e){return e?e&&e<10?"".concat(80*e,"px"):e>=10?"800px":void 0:"80px"},formatAmount:function(e){var t={style:"decimal",currency:"CNY",minimumFractionDigits:2,maximumFractionDigits:2};return Number(e).toLocaleString("zh-CN",t)},deleteArrayTarget:function(e,t){var r=[];for(var n in e)e[n]!==t&&r.push(e[n]);return r},houseUnitAllChange:function(e,t){var r,n=this,o=this,i="unitCheckClass_".concat(t,"_").concat(o.type),a=JSON.parse(JSON.stringify(o.model.apportionFloors));o.initChooseFloors=[],e.target.checked?o.houseListGroupByUnit[i].houseList.forEach((function(e){var t=a.findIndex((function(t){return t.id===e.id}));-1===t&&o.isOptionalHoust(e.state,e.houseUse)&&n.model.apportionFloors.push(e)})):(o.$set(this.model,"apportionFloors",[]),a.forEach((function(e){var t=o.houseListGroupByUnit[i].houseList.findIndex((function(t){return t.id===e.id}));-1===t&&o.isOptionalHoust(e.state,e.houseUse)&&n.model.apportionFloors.push(e)}))),r="type01"===o.type?o.$refs["viewTable"].querySelectorAll(".unitContent_"+t):o.$refs["viewTable"+t][0].querySelectorAll(".unitContent_"+t),r.forEach((function(r){var n,i=o.type.split("type")[1],a=r.querySelectorAll("input[type=checkbox].unit_".concat(t,"_type_").concat(i,"_houseCheckbox:not([disabled])")),s=c(a);try{for(s.s();!(n=s.n()).done;){var l=n.value;l.checked=e.target.checked,l.checked?l.style.display="unset":l.style.display="none"}}catch(u){s.e(u)}finally{s.f()}}))},isOptionalHoust:function(e,t){var r=!0;this.optionalAccState&&this.optionalAccState.length>0&&-1!==this.optionalAccState.indexOf(e)&&(r=!1);var n,o=c(this.houseUseList);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(t==i.value){if(!i.description)return!0;var a=JSON.parse(i.description);if(a&&a.special)return!1}}}catch(s){o.e(s)}finally{o.f()}return r}},beforeDestroy:function(){$("div").remove("#floorBaseInfoModal")}},v=m,y=(r("83f2"),r("2877")),g=Object(y["a"])(v,n,o,!1,null,"7ca43eae",null);t["default"]=g.exports},afcb:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"h-100 w-100"},[r("vxe-table",e._b({ref:"selectTable",staticClass:"w-100",attrs:{"empty-text":"没有更多数据了！",border:"","auto-resize":"","show-footer":"","header-align":"center",data:e.CPartList,"edit-config":e.isEditFlag?{trigger:"click",mode:"row"}:void 0,showFooter:!("1"==e.comparAble&&(!e.biddingCorpCode||""==e.biddingCorpCode)),"footer-method":function(){return[[]]},"footer-span-method":e.footerSpanMethod},scopedSlots:e._u([e._l(e.CScopedSlotsKeys,(function(t){return{key:t,fn:function(r){var n=r.row;return[e._t(t,null,{row:n})]}}}))],null,!0)},"vxe-table",e.$attrs,!1),[r("vxe-table-column",{attrs:{"show-overflow":!0,field:"remark",title:"设施设备-标准维修项目名称","footer-align":"right"},scopedSlots:e._u([{key:"footer",fn:function(){return[r("span",[e._v("合计：")])]},proxy:!0}])}),r("vxe-table-column",{attrs:{field:"description",title:"维修描述","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[r("auto-select",{attrs:{url:"/business/dUtilityClassify/getUtilityListByDes","value-field":"description","label-field":"description","search-field":"description","page-size-field":"size","page-num-field":"current",queryParams:{partId:n.id||n.partId}},model:{value:n.describe,callback:function(t){e.$set(n,"describe",t)},expression:"row.describe"}})]}},{key:"default",fn:function(t){var n=t.row;return[r("span",[e._v(e._s(n.describe))])]}}])}),r("vxe-table-column",{attrs:{width:"150px",align:"center",title:"已选材料数量"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("MaterialQuantity",{ref:"MaterialQuantity",attrs:{ItemList:t.materialList}})]}}])}),"1"!=e.comparAble||e.biddingCorpCode&&""!=e.biddingCorpCode?r("vxe-table-column",{attrs:{width:"150px",field:"totalPrice",title:"总价（元）",align:"right","edit-render":{type:"visible"}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("span",[e._v(e._s(e._f("FForamtAmount")(n.totalPrice)))])]}},{key:"edit",fn:function(t){var n=t.row;return[r("amount-input",{attrs:{"input-read-only":n.materialList&&n.materialList.length>0,placeholder:"总价"},model:{value:n.totalPrice,callback:function(t){e.$set(n,"totalPrice",t)},expression:"row.totalPrice"}})]}},{key:"footer",fn:function(){return[r("span",[e._v(" "+e._s(e.getPartTotalPrice())+" ")])]},proxy:!0}],null,!1,956601363)}):e._e(),e.hiddenAciton?e._e():r("vxe-table-column",{attrs:{width:"70px",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,o=t.rowIndex;return[e._t("action",(function(){return[r("a-space",[e.materialTree.length>0?r("a-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"edit"},on:{click:function(t){return e.editChoosePart(n,o)}}}):e._e(),e.hideDelete?e._e():r("a-icon",{staticStyle:{color:"red","font-size":"18px"},attrs:{type:"delete"},on:{click:function(t){return e.deleteChoosePart(o)}}})],1)]}),{row:n,rowIndex:o})]}}],null,!0)})],1),r("select-material-modal",{ref:"selectMaterialModal",attrs:{materialTree:e.materialTree,zIndex:e.zIndex?e.zIndex:void 0,disabledAdd:e.disabledAdd},on:{confirm:e.confirm,"update-tree":e.initMaterialTree}})],1)},o=[],i=r("24cf"),a=r("6603"),s=r("4aae"),l=r("0fea"),c=r("3ed7"),u=r("4ec3"),d=r("406d");function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=h(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function h(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var m={name:"SelectedPartTable",components:{SelectMaterialModal:i["default"],AutoSelect:a["default"],AmountInput:s["default"],MaterialQuantity:d["default"]},props:{biddingCorpCode:{type:String,default:""},comparAble:{type:String,default:"0"},data:{type:Array,default:function(){return[]}},isEditFlag:{type:Boolean,default:!0},zIndex:{type:Number,default:1e3},hiddenAciton:{type:Boolean,defualt:!1},disabledAdd:{type:Boolean,default:!1},hideDelete:{type:Boolean,default:!1}},computed:{CPartList:{get:function(){return this.data},set:function(e){this.$emit("update:data",e)}},CScopedSlotsKeys:function(){return["empty"]},CMaterialList:function(){var e=[];function t(r){var n,o=f(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;i.children&&i.children.length>0?t(i.children):e.push(i)}}catch(a){o.e(a)}finally{o.f()}}return t(this.materialTree),e}},filters:{FForamtAmount:c["g"]},created:function(){this.initMaterialTree(),this.getMaterialRequireFlag()},data:function(){return{materialRequireFlag:!1,materialTree:[],materialColumns:[{field:"name",title:"材料名称",slots:{default:"name"}},{field:"quantity",title:"数量",align:"right"},{field:"unitPrice",title:"单价",align:"right"},{field:"model",title:"型号"},{field:"brand",title:"品牌"}],previewPage:{current:1,size:5,total:0,showList:[],allList:[]},hideTimer:null}},methods:{getPartTotalPrice:function(){var e=this.CPartList.reduce((function(e,t){return Object(c["c"])(e,t.totalPrice)}),0);return Object(c["g"])(e)},footerSpanMethod:function(e){var t=e.$rowIndex,r=e._columnIndex;if(0===t){if(0===r)return{rowspan:1,colspan:3};if([1,2].includes(r))return{rowspan:1,colspan:0}}},getMaterialName:function(e){if(e.name)return e.name;var t=this.CMaterialList.find((function(t){return t.code===e.materialCode}));return t?t.title:void 0},initMaterialTree:function(){var e=this;this.materialTree=[],Object(l["e"])("/sys/category/loadTreeRoot",{async:!1,pcode:"material_type"}).then((function(t){t&&t.success&&t.result.length>0&&(e.materialTree=t.result)}))},getMaterialRequireFlag:function(){var e=this;Object(u["l"])("material_required").then((function(t){e.materialRequireFlag=t.success?t.result:"0"}))},editChoosePart:function(e,t){this.$refs.selectMaterialModal.open([e],"edit")},addPart:function(e){this.materialTree.length>0&&"1"===this.materialRequireFlag?this.$refs.selectMaterialModal.open(e):this.$emit("confirm",e,"add")},deleteChoosePart:function(e){var t=this.CPartList;t.splice(e,1)},confirm:function(e,t){this.$emit("confirm",e,t)}}},v=m,y=(r("c86c"),r("2877")),g=Object(y["a"])(v,n,o,!1,null,"4841e35b",null);t["default"]=g.exports},b110:function(e,t,r){"use strict";r("28734")},b6bf:function(e,t,r){},b7ec:function(e,t,r){},b80d:function(e,t,r){"use strict";r("5c50")},b88f:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"proInfo_cards"},[e._l(e.lists,(function(t){return n("div",{key:t.id,staticClass:"proInfo_cardItem"},[n("div",{staticClass:"cardItem_header"},[n("div",{staticClass:"flexAlignCenter"},[n("img",{staticStyle:{width:"16px",height:"16px"},attrs:{src:r("f26e"),alt:""}}),e._v("\n        项目编号："),n("span",[e._v(e._s(t.code))])]),n("span",[e._v(e._s(t.reqDate))])]),n("div",{staticClass:"cardItem_content"},[n("div",{staticClass:"cardItem_image"},[t.showList[t.fileIndex?t.fileIndex:0]?[e.isVideo(t.showList[t.fileIndex?t.fileIndex:0].name)?[n("video",{attrs:{src:t.showList[t.fileIndex?t.fileIndex:0].originalImage},on:{click:function(r){return e.handlePreview(void 0,t)}}})]:n("img",{attrs:{src:t.showList[t.fileIndex?t.fileIndex:0].url,alt:""},on:{click:function(r){return e.handlePreview(void 0,t)}}})]:n("a-icon",{staticStyle:{"font-size":"100px",color:"#dce0e6"},attrs:{type:"picture"}}),n("span",{staticClass:"cardItem_imagePage"},[e._v(e._s(t.fileIndex?t.fileIndex+1:1)+"/"+e._s(t.damagedPictureList?t.damagedPictureList.length:""))])],2),n("div",{staticClass:"cardItem_info"},[n("div",{staticClass:"cardItem_infoHeader"},[e._v("\n          "+e._s(t.describe)+"\n        ")]),n("div",{staticClass:"cardItem_infoAmount"},["1"!=e.comparAble||e.biddingCorpCode&&""!=e.biddingCorpCode?[n("div",[n("span",[e._v("预算金额")]),n("span",[e._v(e._s(e.formatterAmount(t.budgetCost)))])]),n("div",[n("span",[e._v("决算金额")]),n("span",[e._v(e._s(e.formatterAmount(t.finalCost)))])]),n("div",[n("span",[e._v("审价费"),e.isDetail?e._e():n("a-icon",{attrs:{type:"edit"}})],1),"priceReview"===e.setAmountField?n("amount-input",{attrs:{value:t.priceReview?t.priceReview.cost:"0",align:"right","is-hide-addon":"","is-get-focus":"",width:"80px",size:"small"},on:{change:function(r){return e.setAmount(t,"priceReview",r)}}}):n("span",{on:{click:function(t){!e.isDetail&&(e.setAmountField="priceReview")}}},[e._v(e._s(e.formatterAmount(t.priceReview?t.priceReview.cost:"0")))])],1),n("div",[n("span",[e._v("监理费"),e.isDetail?e._e():n("a-icon",{attrs:{type:"edit"}})],1),"supervisor"===e.setAmountField?n("amount-input",{attrs:{value:t.supervisor?t.supervisor.cost:"0",align:"right","is-hide-addon":"","is-get-focus":"",width:"80px",size:"small"},on:{change:function(r){return e.setAmount(t,"supervisor",r)}}}):n("span",{on:{click:function(t){!e.isDetail&&(e.setAmountField="supervisor")}}},[e._v(e._s(e.formatterAmount(t.supervisor?t.supervisor.cost:"0")))])],1)]:e._e(),n("div",[n("span",[e._v("分摊户数")]),n("span",[e._v(e._s(t.allotLists.length))])]),n("div",[n("span",[e._v("残值回收")]),n("span",[e._v(e._s(t.scrapValue))])])],2)])]),n("div",{staticClass:"cardItem_footer"},[e.isDetail?e._e():n("a-popconfirm",{attrs:{title:"是否确定删除？"},on:{confirm:function(r){return e.delMiniProj(t)}}},[n("a",{staticClass:"red"},[e._v("删除")])]),n("a",{on:{click:function(r){return e.proManager(t)}}},[e._v("项目管理")]),e.isDetail?e._e():n("a",{on:{click:function(r){return e.copyProject(t)}}},[e._v("复制项目")])],1)])})),e.previewVisible?n("div",{ref:"previewBox",staticClass:"outer_box"},[n("previewPicture",{ref:"previewPicture",attrs:{fileNum:e.previewNum,fileList:e.previewFileList},on:{"update:fileNum":function(t){e.previewNum=t},"update:file-num":function(t){e.previewNum=t},cancel:e.exitPreview}})],1):e._e(),n("child-pro-manager",{ref:"childProManager",attrs:{pageType:e.pageType,indexNum:e.zIndex+1,isDetail:e.isDetail,"pro-info":e.childInfo},on:{ok:e.reQueryProj}})],2)},o=[],i=r("b7a8"),a=r("bed7"),s=r("4aae"),l=r("5745"),c=r("3ed7"),u=r("0fea"),d={name:"ChildProCardss",mixins:[l["a"]],components:{AmountInput:s["default"],ChildProManager:a["default"],PreviewPicture:i["default"]},props:{biddingCorpCode:{type:String,default:""},comparAble:{type:String,default:"0"},lists:{type:Array,default:function(){return[]}},isDetail:{type:Boolean,default:!1},showType:{type:String,default:"list"},zIndex:{type:Number,default:1e3},pageType:{type:Boolean,default:!0}},provide:function(){return{previewZIndex:1200}},data:function(){return{previewUrl:"",filePage:0,childInfo:{},setAmountField:"",url:{delMiniProj:"/use/serviceProj/delMiniProj/"},formatterAmount:c["g"]}},watch:{lists:{immediate:!0,handler:function(e){this.initFile(e)}}},methods:{exitPreview:function(){this.previewVisible=!1},previewImg:function(e){!e.showList.length>0||(e.fileIndex=void 0!==e.fileIndex?e.fileIndex:0,this.cardInfo=e,this.previewFileList["showList"]=e.showList.map((function(e){return{originalImage:e.originalImage,name:e.name}})),this.previewVisible=!0)},proManager:function(e){this.childInfo=JSON.parse(JSON.stringify(e)),this.$refs.childProManager.open()},copyProject:function(e){this.$parent.addChild(e)},setAmount:function(e,t,r){e.field||this.$set(e,t,{cost:""}),this.$set(e[t],"cost",r),this.setAmountField=""},delMiniProj:function(e){var t=this,r=this.url.delMiniProj+e.id;Object(u["j"])(r).then((function(e){var r=e.success,n=e.result,o=e.message;r&&n?(t.$message.success(o),t.$emit("refresh")):t.$message.warning(o)}))},initFile:function(e){var t=this;e.forEach((function(e){e.fileManageList=e.damagedPictureList,t.buildShowList(void 0,e)}))},reQueryProj:function(){this.$emit("refresh")}}},f=d,h=(r("a69d"),r("2877")),p=Object(h["a"])(f,n,o,!1,null,"c5af1d6e",null);t["default"]=p.exports},bed7:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("vxe-modal",{attrs:{title:"子项目管理",position:{left:"center",top:"center"},"z-index":e.indexNum,width:"1200px",transfer:"","min-height":"700px",height:"80vh","destroy-on-close":""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("div",{staticClass:"childProManager"},[r("a-tabs",{attrs:{type:"card"},model:{value:e.tabActiveKey,callback:function(t){e.tabActiveKey=t},expression:"tabActiveKey"}},e._l(e.tabList,(function(e){return r("a-tab-pane",{key:e.key,attrs:{tab:e.title}})})),1),r("div",{staticClass:"content"},[r(e.comps[e.tabList[e.tabActiveKey].comName],{tag:"component",attrs:{zIndex:e.indexNum+1,projId:e.proInfo.id,proInfo:e.proInfo,isDetail:e.tabList[e.tabActiveKey].isDetail},on:{close:function(t){return e.close()}}})],1)],1)])},o=[],i={name:"ChildProManager",props:{proInfo:{type:Object,default:function(){return{}}},isDetail:{type:Boolean,default:!1},indexNum:{type:Number,default:1e3}},mounted:function(){var e={},t=r("bf0b");t.keys().forEach((function(r){var n=t(r);e[r.replace(/^\.\/(.*)\.\w+$/,"$1")]=n.default})),this.comps=e},computed:{com:function(){var e=this,t=this.tabList.find((function(t){return t.key===e.tabActiveKey}));return t}},data:function(){return{visible:!1,tabList:[{key:0,title:"基本信息",comName:"ServiceProAuditInfoComp",isDetail:this.isDetail},{key:1,title:"现场勘察",comName:"FieldSiteInfoComp"},{key:2,title:"图档信息",comName:"DrawFileInfo"}],tabActiveKey:0,comps:[],test:[]}},methods:{open:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.visible=e},close:function(){this.$emit("ok"),this.visible=!1}}},a=i,s=(r("c6d3"),r("2877")),l=Object(s["a"])(a,n,o,!1,null,"7f685508",null);t["default"]=l.exports},c30f:function(e,t,r){"use strict";r("5a22")},c43a:function(e,t,r){},c5eb:function(e,t,r){"use strict";r("e349")},c6d3:function(e,t,r){"use strict";r("82bf")},c82f:function(e,t,r){},c86c:function(e,t,r){"use strict";r("6b8f")},caf6:function(e,t,r){},d377:function(e,t,r){"use strict";r("c82f")},d446:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"signContract"},[r("div",{staticClass:"formRowHeader tableRow"},[r("div",{staticClass:"checkboxColumn"},[r("a-checkbox",{on:{change:e.isAllChoose}})],1),r("div",[e._v("项目信息")])]),r("a-checkbox-group",{staticClass:"projectList",model:{value:e.test,callback:function(t){e.test=t},expression:"test"}},[e._l(e.projectList,(function(t){return r("div",{key:t.id,staticClass:"tableRow projectRow"},[r("div",{staticClass:"checkboxColumn"},[r("a-checkbox",{attrs:{value:t.id}})],1),r("div",{staticClass:"tableRow_label"},[e._v("项目名称")]),r("div",{staticClass:"tableRow_value"},[e._v(e._s(t.name))]),r("div",{staticClass:"tableRow_label"},[e._v("预算费用")]),r("div",{staticClass:"tableRow_value"},[e._v(e._s(t.amount)+"元")])])})),r("div",{staticClass:"tableRow marginTop_10"},[r("div",{staticClass:"checkboxColumn"},[r("a-checkbox",{attrs:{value:"sj"}})],1),r("div",{staticClass:"tableRow_label"},[e._v("审价")]),r("div",{staticClass:"tableRow_value"}),r("div",{staticClass:"tableRow_label"},[e._v("审价单位")]),r("div",{staticClass:"tableRow_value"})]),r("div",{staticClass:"tableRow"},[r("div",{staticClass:"checkboxColumn"},[r("a-checkbox",{attrs:{value:"jl"}})],1),r("div",{staticClass:"tableRow_label"},[e._v("监理")]),r("div",{staticClass:"tableRow_value"}),r("div",{staticClass:"tableRow_label"},[e._v("监理单位")]),r("div",{staticClass:"tableRow_value"})])],2),r("a-button",{staticClass:"submit",attrs:{type:"primary",disabled:!e.test.length>0}},[e._v("生成合同")])],1)},o=[],i={name:"SignContract",data:function(){return{projectList:[{id:"a123",name:"万象新天四区9号楼1单元楼顶防水A",amount:"8034.81"},{id:"a1233",name:"万象新天四区9号楼1单元楼顶防水A",amount:"8034.81"},{id:"a1223",name:"万象新天四区9号楼1单元楼顶防水A",amount:"8034.81"},{id:"a1243",name:"万象新天四区9号楼1单元楼顶防水A",amount:"8034.81"},{id:"a1253",name:"万象新天四区9号楼1单元楼顶防水A",amount:"8034.81"}],test:[]}},methods:{isAllChoose:function(e){var t=e.target;this.test=[],t.checked&&(this.test=this.projectList.map((function(e){return e.id})))}}},a=i,s=(r("541e"),r("2877")),l=Object(s["a"])(a,n,o,!1,null,"0674f3b6",null);t["default"]=l.exports},d717:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"baseInfo",staticClass:"baseInfo"},[r("j-form-container",{ref:"formRow",attrs:{rules:e.rules,model:e.model,border:!1}},[r("a-row",{ref:"row",staticClass:"bidNegotiationFormRow",attrs:{slot:"edit",type:"flex"},slot:"edit"},[e.projMainData().hasChild?e._e():[r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("开始时间：")])]),e.projMainData().hasChild?e._e():r("a-col",{attrs:{span:9,"data-prop":"insureStartTime"}},[r("j-date",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择开始时间","max-date":e.model.insureEndTime,getCalendarContainer:e.getCalendarContainer,valueFormat:"YYYY-MM-DD"},on:{focuse:e.gainFocus,change:function(t){return e.checkBgeinTime(t,"insureStartTime")}},model:{value:e.model.insureStartTime,callback:function(t){e.$set(e.model,"insureStartTime",t)},expression:"model.insureStartTime"}})],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("结束时间：")])]),r("a-col",{attrs:{span:9,"data-prop":"insureEndTime"}},[r("j-date",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择结束时间",minDate:e.model.insureStartTime,getCalendarContainer:e.getCalendarContainer,valueFormat:"YYYY-MM-DD"},on:{change:function(t){return e.onTimeChange(t,"insureEndTime")}},model:{value:e.model.insureEndTime,callback:function(t){e.$set(e.model,"insureEndTime",t)},expression:"model.insureEndTime"}})],1),r("a-col",{attrs:{span:3}},[e._v("保险明细列表：")]),r("a-col",{attrs:{span:21,"data-prop":"choosePart"}},[r("vxe-grid",{ref:"table",staticClass:"width100",attrs:{"edit-config":{},border:"","auto-resize":"","edit-rules":e.editRules,data:e.insureList,columns:e.insureColumns},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.row,o=t.rowIndex;return[r("a-space",[r("a-icon",{staticStyle:{color:"#1890ff","font-size":"18px"},attrs:{type:"plus-circle"},on:{click:function(t){return e.addInsure(n)}}}),r("a-icon",{directives:[{name:"show",rawName:"v-show",value:0!==o,expression:"rowIndex !== 0"}],staticStyle:{color:"red","font-size":"18px"},attrs:{type:"minus-circle"},on:{click:function(t){return e.deleteInsure(n,o)}}})],1)]}},{key:"payDate",fn:function(t){var n=t.row;t.rowIndex;return[r("j-date",{staticClass:"width100",staticStyle:{width:"80%"},attrs:{"min-date":e.model.insureStartTime,"max-date":e.model.insureEndTime,getCalendarContainer:e.getCalendarContainer,format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD"},model:{value:n.payDate,callback:function(t){e.$set(n,"payDate",t)},expression:"row.payDate"}})]}},{key:"insureCost",fn:function(t){var n=t.row,o=t.rowIndex;return[r("a-space",[r("amount-input",{attrs:{min:0},on:{change:function(t){return e.setInsureCost(o)}},model:{value:n.insureCost,callback:function(t){e.$set(n,"insureCost",t)},expression:"row.insureCost"}})],1)]}},{key:"cost",fn:function(t){var n=t.row,o=t.rowIndex;return[r("a-space",[r("amount-input",{attrs:{min:0},on:{change:function(t){return e.setBudgetAmount(o)}},model:{value:n.cost,callback:function(t){e.$set(n,"cost",t)},expression:"row.cost"}})],1)]}}],null,!1,3312768783)})],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("保费总金额：")])]),r("a-col",{attrs:{span:9,"data-prop":"insureCost"}},[r("a-input",{attrs:{addonAfter:"元",readOnly:"",placeholder:"自动核算保费总金额（保险明细保费金额之和）"},model:{value:e.model.insureCost,callback:function(t){e.$set(e.model,"insureCost",t)},expression:"model.insureCost"}})],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("申请总资金：")])]),r("a-col",{attrs:{span:9,"data-prop":"budgetCost"}},[r("a-input",{attrs:{addonAfter:"元",readOnly:"",placeholder:"自动核算申请总资金（保险明细申请资金之和）"},model:{value:e.model.budgetCost,callback:function(t){e.$set(e.model,"budgetCost",t)},expression:"model.budgetCost"}})],1)],r("a-col",{attrs:{span:3}},[e._v("\n        保险单位\n      ")]),r("a-col",{attrs:{span:9,"data-prop":"chargeCorpCode"}},[r("div",{staticClass:"row_col_flexDiv"},[r("input-search-modal",{attrs:{width:"100%",placeholder:"请选择保险单位",action:"/base/rCorpInfo/getCorpInfoByBaseType",options:{value:"code",label:"name",search:"name"},"page-fields":{current:"pageNo",size:"pageSize"},columns:e.columns,otherParams:{field:"id,name,address,linkMan",order:"desc",column:"createTime",baseType:"13"},"is-custom-modal":!1},on:{change:function(t,r){return e.afterChoose([r])}},scopedSlots:e._u([{key:"button",fn:function(){return[r("a-button",[e._v("选择单位")])]},proxy:!0}]),model:{value:e.model.chargeCorpCode,callback:function(t){e.$set(e.model,"chargeCorpCode",t)},expression:"model.chargeCorpCode"}})],1)]),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"requiredText"},[e._v("*")]),e._v("保险方案\n      ")]),r("a-col",{attrs:{span:9,"data-prop":"projectInsureFile"}},[-1!==e.fileUploadState?r("div",{staticClass:"row_col_flexDiv"},[!e.getItemByName("保险方案").fileList||0===e.getItemByName("保险方案").fileList.length||e.getItemByName("保险方案").loading?[r("a-upload",{attrs:{showUploadList:!1,customRequest:function(t){return e.uploadFile(e.insureSchemeUrl,t,e.getItemByName("保险方案"))}},on:{change:function(t){return e.uploadChange(t,e.getItemByName("保险方案"))}}},[r("a-button",{attrs:{loading:e.getItemByName("保险方案").loading,icon:"upload"}},[e._v("上传文件")])],1),e.getItemByName("保险方案").loading?e._e():r("span",{staticClass:"placeholder"},[e._v("支持格式：.rar .zip .doc .docx .pdf")])]:e._e(),e.getItemByName("保险方案").loading?r("a-progress",{attrs:{width:32,type:"circle",percent:e.getItemByName("保险方案").percent}}):e._e(),e.getItemByName("保险方案").fileList&&e.getItemByName("保险方案").fileList.length>0&&!e.getItemByName("保险方案").loading?r("div",{staticClass:"div_upload_show"},[r("a",{staticClass:"a_upload_fileName",staticStyle:{"line-height":"32px","pointer-events":"auto"},attrs:{allowClick:!0,href:e.getFirstFileByName("保险方案").filePath,title:e.getFirstFileByName("保险方案").originalName}},[e._v(e._s(e.getFirstFileByName("保险方案").originalName))]),r("a-button",{staticClass:"button_upload_delete",attrs:{shape:"circle",icon:"close"},on:{click:function(t){e.clearFileItem(e.getItemByName("保险方案"),"projectInsureFile")}}})],1):e._e()],2):e._e()])],2)],1)],1)},o=[],i=r("0fea"),a=r("4aae"),s=r("fdce"),l=r("e7a5"),c=r("2a9b"),u=r("b7a8"),d=r("eb36"),f=r("d8a5"),h=r("eccd"),p=r("6603"),m=r("3ed7"),v=r("c1df"),y=r.n(v),g=r("a4ee"),b=r("aa2d"),_={name:"ProjCreateInseureInfo",components:{InputSearchModal:b["default"],CascaderSelect:g["default"],AutoSelect:p["default"],JDDictSelectTag:h["default"],RepairPartsTreeModal:c["default"],CreateProFloorChoose:l["default"],AmountInput:a["default"],JDictRegionListSelect:s["default"],PreviewPicture:u["default"]},mixins:[d["a"]],inject:["projMainData"],data:function(){var e=this,t=function(e,t,r){Number(t)>0?r():r(new Error("金额应大于0").message)},r=function(t){var r=t.cellValue,n=t.rowIndex;return new Promise((function(t,o){var i=e.model.insureStartTime,a=e.model.insureEndTime;return y()(r).isBefore(i)?o(new Error("缴费日期不能早于开始日期")):y()(r).isAfter(a)?o(new Error("缴费日期不能晚于结束日期")):void e.$nextTick((function(){for(var i=!1,a=0;a<e.insureList.length;a++){var s=e.insureList[a];if(r&&s&&s.payDate===r&&a!==n){o(new Error("缴费日期不能重复！")),i=!0;break}}i||t()}))}))},n=function(t,r,n){try{e.getItemByName("保险方案").fileList.length>0?n():n(new Error("请上传保险方案").message)}catch(o){n(new Error("请上传保险方案").message)}},o=function(t,r,n){e.model.chargeCorpCode?n():n(new Error("请选择保险单位").message)};return{filedlength:0,editRules:{payDate:[{required:!0,message:"请输入日期",trigger:"change"},{validator:r}],cost:[{required:!0,min:.01,message:"申请资金应大于0！",type:"number"}],insureCost:[{required:!0,min:.01,message:"保费金额应大于0！",type:"number"}]},damagedAreaSource:[],url:{insureScheme:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",loadTreeData:"/sys/category/buildTree",checkInsureByRuid:"/use/serviceUtility/checkInsureByRuid"},insureColumns:[{field:"payDate",title:"缴费日期",editRender:{type:"visible"},slots:{edit:"payDate"},formatter:function(e){var t=e.cellValue;return y()(t).format("YYYY年MM月DD日")}},{field:"insureCost",title:"保费金额",editRender:{type:"visible"},slots:{edit:"insureCost"},width:200,align:"right",formatter:function(e){var t=e.cellValue;return Object(m["g"])(t)}},{field:"cost",title:"申请资金",editRender:{type:"visible"},slots:{edit:"cost"},width:200,align:"right",formatter:function(e){var t=e.cellValue;return Object(m["g"])(t)}},{title:"操作",width:"80px",align:"center",slots:{default:"action"}}],rules:{insureStartTime:[{required:!0,message:"请选择开始时间"},{validator:this.validateStartTime}],insureEndTime:[{required:!0,message:"请选择结束时间",trigger:"change"},{validator:this.validateEndTime}],choosePart:[{required:!0,message:"请选择施工单位",trigger:"change"}],chargeCorpCode:[{validator:o}],projectInsureFile:[{validator:n}],insureCost:[{required:!0,message:"请输入保费金额",trigger:"change"},{validator:t}],budgetCost:[{required:!0,message:"请输入申请资金",trigger:"change"},{validator:t}]},columns:[{title:"单位名称",align:"left",field:"name"},{title:"地址",align:"left",field:"address"},{title:"联系人",align:"center",field:"linkMan"}],cascaderObj:{label:"name",value:"value",children:"children"},insureSchemeUrl:"",insureList:[],options:[]}},computed:{model:{get:function(){return this.projMainData()},set:function(){}}},watch:{},created:function(){var e=this,t={payDate:y()().format("YYYY-MM-DD"),cost:0,insureCost:0},r=[{name:"保险方案",fileList:this.model.projectInsureFile?[this.model.projectInsureFile]:[]}];this.initUploadFile(r),this.insureList.push(t),this.model.insureCostMsg||(this.$set(this.model,"insureCostMsg",{}),this.model.insureCostMsg.chargeCorpCode=""),Object(f["e"])("construction_plan_ere_id").then((function(t){e.insureSchemeUrl=e.url.insureScheme+t})),Object(i["e"])(this.url.loadTreeData,{code:"insure_type"}).then((function(t){t.success&&(e.options=t.result[0].children)}))},mounted:function(){},methods:{gainFocus:function(){this.model.insureTypeDetail||this.model.choosePart?this.model.insureTypeDetail?this.model.choosePart||this.$message.warning("请先填写保险对象"):this.$message.warning("请先填写保险分类明细"):this.$message.warning("请先填写保险分类明细和保险对象")},validateEndTime:function(e,t,r){var n=this.model.insureStartTime;n&&t?new Date(n).getTime()>new Date(t).getTime()&&r("结束时间不能小于开始时间！"):r()},validateStartTime:function(e,t,r){var n=this.model.insureEndTime;n&&t?new Date(n).getTime()<new Date(t).getTime()&&r("开始时间不能大于结束时间！"):r()},clearFileItem:function(e,t){e.fileList=[],e.showList=[],this.$set(this.model,t,void 0),this.$emit("change",this.enclosureList),"function"===typeof this.onFileChange&&this.onFileChange(this.enclosureList,e),this.$forceUpdate()},onTimeChange:function(e,t){var r=this;this.$set(this.model,t,e),this.model.insureStartTime&&this.model.insureEndTime&&this.insureList.forEach((function(t){(new Date(t.payDate).getTime()<new Date(r.model.insureStartTime).getTime()||new Date(t.payDate).getTime()>new Date(r.model.insureEndTime).getTime())&&(t.payDate=e)}))},checkBgeinTime:function(e,t){var r=this;this.model.choosePart[0]&&this.model.choosePart[0].regionUtilityId&&this.model.insureTypeDetail&&this.model.insureStartTime&&Object(i["e"])(this.url.checkInsureByRuid,{regionUtilityId:this.model.choosePart[0].regionUtilityId,beginTime:e,insureTypeDetail:this.model.insureTypeDetail}).then((function(n){n.success&&(n.result?r.onTimeChange(e,t):(r.$set(r.model,t,null),r.$message.warning(n.message)))}))},convert:function(e,t){for(var r=e,n=[],o=0;o<r.length;o++){var i={};i.value=t?r[o].value:r[o].code,i.label=r[o].title,n.push(i)}return n},deleteInsure:function(e,t){this.insureList.splice(t,1)},addInsure:function(e){var t=this;this.$refs.table.validate(e,(function(r){if(!r||void 0==r){var n={payDate:y()(e.payDate).add(1,"days").format("YYYY-MM-DD"),cost:0,insureCost:0};t.insureList.push(n)}}))},onFileChange:function(){var e=this.getFirstFileByName("保险方案");this.model.projectInsureFile=e},initUploadFile:function(e){e&&0!==e.length||(e=[]);for(var t=0;t<e.length;t++)this.buildShowList(e[t]);this.enclosureList=e,"function"===typeof this.onFileChange&&this.onFileChange(this.enclosureList),this.fileUploadState=0,this.$forceUpdate()},setInsureCost:function(e){var t=this;this.$set(this.model,"insureCost",0),this.insureList.forEach((function(e){t.model.insureCost=Object(m["c"])(Number(e.insureCost),Number(t.model.insureCost))})),this.checkCost("1",e)},setBudgetAmount:function(e){var t=this;this.$set(this.model,"budgetCost",0),this.insureList.forEach((function(e){t.model.budgetCost=Object(m["c"])(Number(e.cost),Number(t.model.budgetCost))})),this.checkCost("2",e)},checkCost:function(e,t){var r=this;this.model.budgetCost>this.model.insureCost&&("1"==e?(this.$set(this.insureList[t],"insureCost",0),this.model.insureCost=0,this.insureList.forEach((function(e){r.model.insureCost=Object(m["c"])(Number(e.insureCost),Number(r.model.insureCost))}))):(this.$set(this.insureList[t],"cost",0),this.model.budgetCost=0,this.insureList.forEach((function(e){r.model.budgetCost=Object(m["c"])(Number(e.cost),Number(r.model.budgetCost))}))),this.$refs.table.refreshData(),this.$message.info("申请资金总和不可大于保费资金总和"))},onChange:function(e){0!=e.length?(this.$set(this.model,"insureType",e[0]),this.$set(this.model,"insureTypeDetail",e[1])):(this.$set(this.model,"insureType",null),this.$set(this.model,"insureTypeDetail",null)),this.$refs.formRow.validaFields(["insureTypeDetail"])},checkData:function(){var e=this;return new Promise((function(t,r){e.$refs.table.validate(e.insureList,(function(r){e.model.projInsureList=e.insureList;var n=e.$refs.formRow.validaRowMsg(e.$refs.rowContent).valida;t({valida:!r&&n})}))}))},afterChoose:function(e){this.model.insureCostMsg||this.$set(this.model,"insureCostMsg",{}),e&&e[0]?(this.model.insureCostMsg.projId=this.model.id,this.model.insureCostMsg.costType="07",this.model.insureCostMsg.chargeCorpCode=e[0].code,this.model.insureCostMsg.chargeCorpMan=e[0].linkMan,this.model.insureCostMsg.chargeCorpPhone=e[0].phone,this.model.insureCostMsg.describe=this.model.describe+"保险总费用",this.model.chargeCorpCode=e[0].code):this.$set(this.model,"insureCostMsg",{}),this.$refs.formRow.validaFields(["insureCostMsg"])},getCalendarContainer:function(){return document.body},validationFilefile:function(){this.$refs.formRow.validaFields(["projectInsureFile"])}}},w=_,C=(r("feed"),r("7c60"),r("2877")),x=Object(C["a"])(w,n,o,!1,null,"4ae23c99",null);t["default"]=x.exports},d747:function(e,t,r){"use strict";r("43c2")},d749:function(e,t,r){},d94b:function(e,t,r){},dd7f:function(e,t,r){"use strict";r("d749")},df5d:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-spin",{attrs:{spinning:e.loading}},[r("div",{ref:"floorView",attrs:{id:"floorView"}},[r("div",{staticClass:"div_floorView_legend"},[r("div",{staticStyle:{display:"flex","align-items":"center"}},[r("div",{staticClass:"div_floorView_colorLegend"},[e._l(e.floorCardColor,(function(t,n){return r("span",{key:n,staticClass:"houseColorType",style:{"--typeBgColor":t[1]}},[e._v(e._s(t[0]))])})),r("a-icon",{staticClass:"house_issuesIcon",attrs:{type:"issues-close"}}),e._v("\n          销户退房\n        ")],2),r("div")])]),r("div",{staticClass:"viewContent",attrs:{id:"viewContentId"}},[e._l(e.houseList,(function(t,n){return[r("house-view-table",{key:n,ref:"floorTable"+t.type,refInFor:!0,attrs:{isDetail:e.isShowDetail,optionalAccState:["04","4"],isShowCheckbox:!0,"is-show-house-check-box":3===e.apportionType,"unit-nums":e.unitNums}})]}))],2)])])},o=[],i=r("eccd"),a=r("ad08"),s=r("fdce"),l=r("0b6e"),c=r("4ec3");function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=f(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function f(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function p(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */p=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new A(n||[]);return o(a,"_invoke",{value:L(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function _(){}function w(){}var C={};c(C,a,(function(){return this}));var x=Object.getPrototypeOf,I=x&&x(x(F([])));I&&I!==r&&n.call(I,a)&&(C=I);var k=w.prototype=b.prototype=Object.create(C);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(o,i,a,s){var l=f(e[o],e,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==u(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=h;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var l=S(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=f(t,r,n);if("normal"===c.type){if(o=n.done?y:m,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,S(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(u(t)+" is not iterable")}return _.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=c(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},T(P.prototype),c(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new P(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(k),c(k,l,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function m(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){m(i,n,o,a,s,"next",e)}function s(e){m(i,n,o,a,s,"throw",e)}a(void 0)}))}}var y={name:"HouseApportion",components:{FloorTable:l["default"],JDictRegionListSelect:s["default"],HouseViewTable:a["default"],JDDictSelectTag:i["default"]},props:{floorInfo:{type:Object,default:null,required:!0},isDetail:{type:Boolean,default:!1},isShowCheckbox:{type:Boolean,default:!1},regionInfo:{type:Object,default:function(){return{}}},apportionType:{type:Number,default:0}},inject:["projMainData"],computed:{model:{get:function(){return this.projMainData()},set:function(e){}}},created:function(){var e=v(p().mark((function e(){var t,r=this;return p().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["l"])("floor_notdeposit_color").catch((function(){}));case 2:t=e.sent,this.notDepositColor=t.result||"#edf5fd",this.floorCardColor.set("未交",this.notDepositColor),Object(c["i"])("floor_card_color").then((function(e){e.success&&e.result.forEach((function(e){r.floorCardColor.set(e.text,e.value)}))}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),data:function(){return{floorCardColor:new Map([["未交","#8FD623"],["已交","#a0c2fd"],["已交不足额","#4687f8"],["余额不足30%","#fdb3b8"],["免交","#d7cfcf"]]),isShowDetail:this.isDetail,areaVisible:!1,moneyVisible:!1,bgActive:!1,bgActive1:!1,loading:!1,exportLoading:!1,buildType:"0",loadingProgress:0,isSuccess:!1,maxFloor:[],unitNums:0,houseFloorNums:0,shoppingFloorNums:0,basementFloorNums:0,houseList:[],screenWidth:document.body.clientWidth,bldState:"0",id:"",selectArr:[],buildArr:[]}},mounted:function(){this.loadData(this.floorInfo)},methods:{handleBuildChange:function(e){this.loadData(e)},loadData:function(e){var t=this;this.bldState=e.bldState,this.unitNums=e.unitNums;var r,n=[],o=[],i=e.houseTypeList||[],a=d(i);try{for(a.s();!(r=a.n()).done;){var s=r.value;"01"===s.type?n.push(s):o.push(s)}}catch(l){a.e(l)}finally{a.f()}this.houseList=[].concat(n,o),this.$nextTick((function(){i.forEach((function(e){t.$refs["floorTable"+e.type][0].initData(e)}))}))}}},g=y,b=(r("32a4c"),r("2877")),_=Object(b["a"])(g,n,o,!1,null,"89408c38",null);t["default"]=_.exports},e06d:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"baseInfo"},[r("div",{staticClass:"baseInfo_type"},[r("div",{staticClass:"padding12-16"},[r("span",{staticClass:"requiredText"},[e._v("*")]),e._v("项目类型：\n      "),r("j-d-dict-select-tag",{attrs:{disabled:!0,type:"radioButton",dictCode:"project_type"},model:{value:e.model.baseType,callback:function(t){e.$set(e.model,"baseType",t)},expression:"model.baseType"}})],1),r("div",{staticClass:"flexCenter",attrs:{slot:"extra"},on:{click:function(e){e.stopPropagation()}},slot:"extra"},[e._v("\n      分摊方式：\n      "),r("j-d-dict-select-tag",{attrs:{disabled:!0,type:"radioButton",dictCode:"allocation_method"},model:{value:e.model.allotMode,callback:function(t){e.$set(e.model,"allotMode",t)},expression:"model.allotMode"}})],1)]),r("j-form-container",{ref:"formRow",attrs:{rules:e.rules,model:e.model,border:!1}},[r("a-row",{ref:"row",staticClass:"houseInfo",attrs:{slot:"edit",type:"flex"},slot:"edit"},[r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("申报小区")])]),r("a-col",{attrs:{span:21}},[r("a-input",{attrs:{readOnly:""},model:{value:e.model.communityName,callback:function(t){e.$set(e.model,"communityName",t)},expression:"model.communityName"}})],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("保险分类")])]),r("a-col",{attrs:{span:8,"data-prop":"insureType"}},[r("a-select",{attrs:{placeholder:"请选择保险分类"},on:{change:e.selectInsureType},model:{value:e.model.insureType,callback:function(t){e.$set(e.model,"insureType",t)},expression:"model.insureType"}},e._l(e.insureOptions,(function(t){return r("a-select-option",{key:t.code,attrs:{dataInsureType:t,value:t.code}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),1)],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"required"},[e._v("保险分类明细（险种）")])]),r("a-col",{attrs:{span:9,"data-prop":"insureTypeDetail"}},[r("a-select",{attrs:{placeholder:"请选择保险分类明细（险种）"},on:{change:e.selectInsureTypeDetail},model:{value:e.model.insureTypeDetail,callback:function(t){e.$set(e.model,"insureTypeDetail",t)},expression:"model.insureTypeDetail"}},e._l(e.insureDetailOptions,(function(t){return r("a-select-option",{key:t.code,attrs:{value:t.code}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),1)],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("保险项目描述")])]),r("a-col",{attrs:{span:21,"data-prop":"describe"}},[r("a-textarea",{attrs:{placeholder:"请输入保险项目描述"},model:{value:e.model.describe,callback:function(t){e.$set(e.model,"describe",t)},expression:"model.describe"}})],1),e.model.isChild?e._e():[r("a-col",{attrs:{span:3}},[e._v("\n          保险对象\n          "),r("a-tooltip",[r("template",{slot:"title"},[e._v("此处标准维修项目金额总价仅为参考与记录，不参与项目金额计算")]),r("a-icon",{staticStyle:{color:"#ff7e24"},attrs:{type:"question-circle"}})],2)],1),r("a-col",{attrs:{span:21,"data-prop":"choosePart"}},[r("vxe-grid",{staticClass:"width100",attrs:{border:"","auto-resize":"",data:e.model.choosePart,columns:e.partColumns},scopedSlots:e._u([{key:"descInput",fn:function(e){var t=e.row;e.rowIndex;return[r("auto-select",{attrs:{url:"/business/dUtilityClassify/getUtilityListByDes","value-field":"description","label-field":"description","search-field":"description","page-size-field":"size","page-num-field":"current",queryParams:{partId:t.id}}})]}},{key:"action",fn:function(t){t.row;var n=t.rowIndex;return[r("a-space",[r("a",{on:{click:e.openTransferModal}},[r("a-icon",{attrs:{type:"plus"}})],1),r("a",{on:{click:function(t){return e.removePart(n)}}},[r("a-icon",{attrs:{type:"minus"}})],1)])]}},{key:"empty",fn:function(){return[r("div",{staticStyle:{"padding-top":"10px"}},[r("a-empty",[r("a-button",{staticClass:"margin_bottom_10",attrs:{slot:"description",type:"primary"},on:{click:e.openTransferModal},slot:"description"},[e._v("\n                    新增保险对象\n                  ")])],1)],1)]},proxy:!0}],null,!1,1393951838)})],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("分摊范围")])]),r("a-col",{attrs:{span:21,"data-prop":"apportionFloors"}},[r("a",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.model.apportionFloors?e.model.apportionFloors.length:0)+"户")]),e.model.choosePart?r("span",{staticClass:"tagButton margin_left_10 margin_right_10",on:{click:e.openFloorModal}},[e._v("\n            修改分摊范围\n          ")]):e._e()])],r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("联系人")])]),r("a-col",{attrs:{span:9,"data-prop":"reqMan"}},[r("a-input",{attrs:{placeholder:"请输入联系人"},model:{value:e.model.reqMan,callback:function(t){e.$set(e.model,"reqMan",t)},expression:"model.reqMan"}},[r("a-icon",{attrs:{slot:"addonAfter",type:"contacts"},slot:"addonAfter"})],1)],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("联系电话")])]),r("a-col",{attrs:{span:9,"data-prop":"reqPhone"}},[r("a-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.model.reqPhone,callback:function(t){e.$set(e.model,"reqPhone",t)},expression:"model.reqPhone"}},[r("a-icon",{attrs:{slot:"addonAfter",type:"phone"},slot:"addonAfter"})],1)],1)],2)],1),e.previewVisible?r("div",{ref:"previewDiv",staticClass:"outer_box"},[r("previewPicture",{attrs:{fileList:e.getItemByName("受损图片或视频"),fileNum:e.previewNum},on:{cancel:e.exitPreview}})],1):e._e(),r("insurance-parts-tree-modal",{ref:"repairPartsTreeModal",attrs:{insureType:e.model.insureType,insureType:e.model.insureType,choosePart:e.model.choosePart,regionId:e.regionInfo.id},on:{"update:insureType":function(t){return e.$set(e.model,"insureType",t)},"update:insure-type":function(t){return e.$set(e.model,"insureType",t)},"update:choosePart":function(t){return e.$set(e.model,"choosePart",t)},"update:choose-part":function(t){return e.$set(e.model,"choosePart",t)},ok:e.partChooseOk}}),r("create-pro-floor-choose",{ref:"floorChoose",attrs:{apportionType:e.model.apportionType,rangeIds:e.rangeIds,regionInfo:e.regionInfo}})],1)},o=[],i=r("0fea"),a=r("4aae"),s=r("fdce"),l=r("e7a5"),c=r("6d33"),u=r("b7a8"),d=r("eb36"),f=r("d8a5"),h=r("eccd"),p=r("6603");function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */v=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new A(n||[]);return o(a,"_invoke",{value:L(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",p="executing",y="completed",g={};function b(){}function _(){}function w(){}var C={};c(C,a,(function(){return this}));var x=Object.getPrototypeOf,I=x&&x(x(F([])));I&&I!==r&&n.call(I,a)&&(C=I);var k=w.prototype=b.prototype=Object.create(C);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(o,i,a,s){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==m(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=f;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var l=S(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=d(t,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,S(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(m(t)+" is not iterable")}return _.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=c(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},T(P.prototype),c(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new P(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(k),c(k,l,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function y(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){y(i,n,o,a,s,"next",e)}function s(e){y(i,n,o,a,s,"throw",e)}a(void 0)}))}}var b={name:"InsuranceCreateChild",components:{AutoSelect:p["default"],JDDictSelectTag:h["default"],InsurancePartsTreeModal:c["default"],CreateProFloorChoose:l["default"],AmountInput:a["default"],JDictRegionListSelect:s["default"],PreviewPicture:u["default"]},mixins:[d["a"]],inject:["projMainData"],props:{disabled:{type:Boolean,default:!1}},computed:{model:{get:function(){return this.projMainData().construction||(this.projMainData().construction={}),this.projMainData()},set:function(e){}},rangeIds:function(){if(!this.model.choosePart)return"";var e=this.model.choosePart.map((function(e){return e.rangeId}));return e.join(",")}},data:function(){var e=this,t=function(e,t){return new Promise(function(){var e=g(v().mark((function e(r){return v().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",r());case 2:Object(i["j"])("/drools/droolsData/exeDrools",{type:"verifyPhoneNumber",name:"verify",data:{phone:t}}).then((function(e){return e.success?r():r(e.result)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},r=function(t,r){return new Promise(function(){var t=g(v().mark((function t(r){return v().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.model.apportionFloors&&0!==e.model.apportionFloors.length){t.next=2;break}return t.abrupt("return",r(new Error("请选择分摊范围").message));case 2:r();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},n=function(t,r){return new Promise(function(){var t=g(v().mark((function t(r){return v().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.model.choosePart&&0!==e.model.choosePart.length){t.next=2;break}return t.abrupt("return",r(new Error("请选择维修对象").message));case 2:r();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())};return{damagedAreaSource:[],url:{fileUploadImg:window._CONFIG["domianURL"]+"/control/file/uploadImg?uploadType=5",unilityList:"/base/regionUtility/queryUtilityList",damagedPicture:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",queryRegionByList:"/base/rtRegion/queryRegionByList",constructionPlanUrl:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",projectBudgetUrl:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",loadTreeData:"/sys/category/buildTree",checkInsureByRuid:"/use/serviceUtility/checkInsureByRuid"},regionInfo:{},apportionTypes:[{value:0,text:"小区分摊"},{value:1,text:"楼栋分摊"},{value:2,text:"单元分摊"},{value:3,text:"自定义分摊"}],damagedPictureUrl:"",constructionPlanEreUrl:"",projectbudgetEreUrl:"",partColumns:[{field:"partDesc",title:"设施设备"},{field:"describe",title:"维修描述"},{field:"unitPrice",title:"单价",width:100,headerAlign:"center",align:"right"},{field:"quantity",title:"数量",width:100,align:"center"},{field:"totalPrice",title:"总价",width:100,headerAlign:"center",align:"right"},{title:"操作",width:"80px",align:"center",slots:{default:"action"}}],rules:{insureTypeDetail:[{required:!0,message:"请选择保险分类明细",trigger:"change"}],insureType:[{required:!0,message:"请选择保险分类",trigger:"change"}],describe:[{required:!0,message:"请输入项目描述",trigger:"change"}],choosePart:[{required:!0,message:"请选择保险设施设备",trigger:"change"},{validator:n}],apportionFloors:[{required:!0,message:"请选择分摊范围",trigger:"change"},{validator:r}],reqMan:[{required:!0,message:"请输入联系人",trigger:"change"}],reqPhone:[{required:!0,message:"请输入联系电话",trigger:"change"},{validator:t,type:"Promise"}]},insureOptions:[],insureDetailOptions:[]}},created:function(){var e=this;Object(f["e"])("damaged_picture_ere_id").then((function(t){e.damagedPictureUrl=e.url.damagedPicture+t})),Object(f["e"])("construction_plan_ere_id").then((function(t){e.constructionPlanEreUrl=e.url.constructionPlanUrl+t})),Object(f["e"])("project_budget_ere_id").then((function(t){e.projectbudgetEreUrl=e.url.projectBudgetUrl+t})),Object(i["e"])(this.url.loadTreeData,{code:"insure_type"}).then((function(t){t.success&&(e.insureOptions=t.result[0].children)}))},mounted:function(){this.initFile()},methods:{initFile:function(){var e=[{name:"受损图片或视频",fileList:[]},{name:"工程预算书",fileList:[]},{name:"施工方案",fileList:[]}];this.initUploadFile(e)},openTransferModal:function(){this.$refs.repairPartsTreeModal.open()},transferChooseOk:function(e){this.model.utilityNames="";var t=e.map((function(e){return e.utilityName}));this.model.utilityNames=t.join(","),this.$forceUpdate()},openFloorModal:function(){this.$refs.floorChoose.openModal()},regionChange:function(e,t){this.regionInfo=t},initDevice:function(e){},partChooseOk:function(e){var t=this,r=e.map((function(e){return e.rangeId})).join(",");Object(i["e"])(this.url.queryRegionByList,{ids:r}).then((function(e){if(e){if(t.$set(t.model,"apportionFloors",[]),e&&e[0]){var r=e[0];r.children.forEach((function(e){e.children.forEach((function(e){e.children.forEach((function(e){t.model.apportionFloors.push(e)}))}))}))}}else t.$message.error(e.message)}))},afterChoose:function(e){this.projMainData().construction||this.$set(this.projMainData(),"construction",{}),this.projMainData().construction.projId=this.projMainData().id,this.projMainData().construction.chargeCorpCode=e[0].code,this.projMainData().construction.chargeCorpMan=e[0].linkMan,this.projMainData().construction.chargeCorpPhone=e[0].phone},removePart:function(e){this.model.choosePart.splice(e,1),this.partChooseOk(this.model.choosePart)},setConstructionAmount:function(e){},onFileChange:function(e,t,r){var n=this.getFirstFileByName("施工方案"),o=this.getFirstFileByName("工程预算书"),i=this.getItemByName("受损图片或视频").fileList;this.projMainData.constructionPlanFile=n,this.model.constructionPlanFile=n&&Object.keys(n).length>0?n:void 0,this.projMainData.projectBudgetFile=o,this.model.projectBudgetFile=o&&Object.keys(o).length>0?o:void 0,this.projMainData.damagedPictureList=i,this.model.damagedPictureList=i&&Object.keys(i).length>0?i:void 0},checkData:function(){return this.$refs.formRow.validaRowMsgPro(this.$refs.row)},beforeUpload:function(e){var t=this;return new Promise((function(r,n){e.type.includes("image")||e.type.includes("video")?r():t.$message.warning("请上传图片或视频！")}))},selectInsureType:function(e,t){this.insureDetailOptions=t.data.attrs.dataInsureType.children},selectInsureTypeDetail:function(e,t){this.validaInsureDate()},validaInsureDate:function(){this.model.insureTypeDetail&&this.model.choosePart&&this.model.choosePart[0]&&this.model.choosePart[0].regionUtilityId&&this.model.insureEndTime&&Object(i["e"])(this.url.checkInsureByRuid,{regionUtilityId:this.model.choosePart[0].regionUtilityId,beginTime:this.model.insureEndTime,insureTypeDetail:this.model.insureTypeDetail}).then((function(e){}))}}},_=b,w=(r("197e"),r("2877")),C=Object(w["a"])(_,n,o,!1,null,"ae0ef99a",null);t["default"]=C.exports},e349:function(e,t,r){},e4d8:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"baseInfo"},[r("div",{staticClass:"baseInfo_type"},[r("div",{staticClass:"padding12-16"},[r("span",{staticClass:"requiredText"},[e._v("*")]),e._v("\n      项目类型：\n      "),r("j-d-dict-select-tag",{attrs:{disabled:!0,type:"radioButton",dictCode:"project_type"},model:{value:e.model.baseType,callback:function(t){e.$set(e.model,"baseType",t)},expression:"model.baseType"}})],1),r("div",{staticClass:"flexCenter",attrs:{slot:"extra"},on:{click:function(e){e.stopPropagation()}},slot:"extra"},[e._v("\n      分摊方式：\n      "),r("j-d-dict-select-tag",{attrs:{disabled:!0,type:"radioButton",dictCode:"allocation_method"},model:{value:e.model.allotMode,callback:function(t){e.$set(e.model,"allotMode",t)},expression:"model.allotMode"}})],1)]),r("j-form-container",{ref:"formRow",attrs:{rules:e.rules,model:e.model,border:!1}},[r("a-row",{ref:"row",staticClass:"houseInfo",attrs:{slot:"edit",type:"flex"},slot:"edit"},[r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("申报小区")])]),r("a-col",{attrs:{span:21}},[r("a-input",{attrs:{readOnly:""},model:{value:e.model.communityName,callback:function(t){e.$set(e.model,"communityName",t)},expression:"model.communityName"}})],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("维修项目描述")])]),r("a-col",{attrs:{span:21,"data-prop":"describe"}},[r("a-textarea",{attrs:{placeholder:"请输入维修项目描述"},model:{value:e.model.describe,callback:function(t){e.$set(e.model,"describe",t)},expression:"model.describe"}})],1),e.model.isHasChild?e._e():[r("a-col",{attrs:{span:3}},[r("span",{class:{required:!e.hasEnablePageConfigByKey("imgVideoNotRequired")}},[e._v("受损图片或视频")])]),r("a-col",{attrs:{span:21,"data-prop":e.hasEnablePageConfigByKey("imgVideoNotRequired")?"":"damagedPictureList"}},[r("a-upload",{staticClass:"uploadButtonStyle",attrs:{accept:".jpg, .png, .jpeg, .bmp, .mp4","before-upload":e.beforeUpload,allowClick:"",customRequest:function(t){e.uploadFile(e.damagedPictureUrl,t,e.getItemByName("受损图片或视频"))},multiple:!0,listType:"picture-card","file-list":e.getItemByName("受损图片或视频").showList,remove:function(t){return e.onRemove(t,e.getItemByName("受损图片或视频"))}},on:{preview:function(t){return e.handlePreview(t,e.getItemByName("受损图片或视频"))}}},[r("div",[r("a-icon",{attrs:{type:"upload"}}),r("div",{staticClass:"ant-upload-text"},[e._v("\n                上传\n              ")])],1)])],1)],e.model.isChild?e._e():[r("a-col",{attrs:{span:3}},[e._v("\n          维修对象\n          "),r("a-tooltip",[r("template",{slot:"title"},[e._v("\n              此处标准维修项目金额总价仅为参考与记录，不参与项目金额计算\n            ")]),r("a-icon",{staticStyle:{color:"#ff7e24"},attrs:{type:"question-circle"}})],2)],1),r("a-col",{attrs:{span:21,"data-prop":"choosePart"}},[r("selected-part-table",{attrs:{isEditFlag:!1,data:e.model.choosePart},scopedSlots:e._u([{key:"action",fn:function(t){t.row;var n=t.rowIndex;return[r("a-space",[r("a",{on:{click:e.openTransferModal}},[r("a-icon",{attrs:{type:"plus"}})],1),r("a",{on:{click:function(t){return e.removePart(n)}}},[r("a-icon",{attrs:{type:"minus"}})],1)])]}},{key:"empty",fn:function(){return[r("div",{staticStyle:{"padding-top":"10px"}},[r("a-empty",[r("a-button",{staticClass:"margin_bottom_10",attrs:{slot:"description",type:"primary"},on:{click:e.openTransferModal},slot:"description"},[e._v("\n                    新增维修对象\n                  ")])],1)],1)]},proxy:!0}],null,!1,1429883239)})],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("分摊范围")])]),r("a-col",{attrs:{span:9,"data-prop":"apportionFloors"}},[r("a",{staticStyle:{"flex-shrink":"0"}},[e._v("\n            "+e._s(e.model.apportionFloors?e.model.apportionFloors.length:0)+"户\n          ")]),e.model.choosePart?r("span",{staticClass:"tagButton margin_left_10 margin_right_10",on:{click:e.openFloorModal}},[e._v("\n            修改分摊范围\n          ")]):e._e()]),e.comparAble?e._e():[r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("工程款")])]),r("a-col",{attrs:{span:9,"data-prop":"constructionAmount"}},[r("amount-input",{attrs:{min:0,placeholder:"请输入工程款"},on:{change:e.setConstructionAmount},model:{value:e.model.constructionAmount,callback:function(t){e.$set(e.model,"constructionAmount",t)},expression:"model.constructionAmount"}})],1)]],r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("联系人")])]),r("a-col",{attrs:{span:9,"data-prop":"reqMan"}},[r("a-input",{attrs:{readOnly:!0,placeholder:"请输入联系人"},model:{value:e.model.reqMan,callback:function(t){e.$set(e.model,"reqMan",t)},expression:"model.reqMan"}},[r("a-icon",{attrs:{slot:"addonAfter",type:"contacts"},slot:"addonAfter"})],1)],1),r("a-col",{attrs:{span:3}},[r("span",{staticClass:"required"},[e._v("联系电话")])]),r("a-col",{attrs:{span:9,"data-prop":"reqPhone"}},[r("a-input",{attrs:{readOnly:!0,placeholder:"请输入联系电话"},model:{value:e.model.reqPhone,callback:function(t){e.$set(e.model,"reqPhone",t)},expression:"model.reqPhone"}},[r("a-icon",{attrs:{slot:"addonAfter",type:"phone"},slot:"addonAfter"})],1)],1)],2)],1),e.previewVisible?r("div",{ref:"previewDiv",staticClass:"outer_box"},[r("previewPicture",{attrs:{fileList:e.getItemByName("受损图片或视频"),fileNum:e.previewNum},on:{cancel:e.exitPreview}})],1):e._e(),r("repair-parts-tree-modal",{ref:"repairPartsTreeModal",attrs:{choosePart:e.model.choosePart,regionId:e.regionInfo.id,"proj-id":e.model.pid},on:{"update:choosePart":function(t){return e.$set(e.model,"choosePart",t)},"update:choose-part":function(t){return e.$set(e.model,"choosePart",t)},ok:e.partChooseOk}}),r("create-pro-floor-choose",{ref:"floorChoose",attrs:{apportionType:e.model.apportionType,rangeIds:e.rangeIds,regionInfo:e.regionInfo}})],1)},o=[],i=r("d9a4"),a=r("0fea"),s=r("4aae"),l=r("fdce"),c=r("e7a5"),u=r("2a9b"),d=r("b7a8"),f=r("eb36"),h=r("d8a5"),p=r("eccd"),m=r("6603"),v=r("afcb");function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function g(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */g=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new A(n||[]);return o(a,"_invoke",{value:L(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",p="executing",m="completed",v={};function b(){}function _(){}function w(){}var C={};c(C,a,(function(){return this}));var x=Object.getPrototypeOf,I=x&&x(x(F([])));I&&I!==r&&n.call(I,a)&&(C=I);var k=w.prototype=b.prototype=Object.create(C);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(o,i,a,s){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==y(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=f;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var l=S(s,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var c=d(t,r,n);if("normal"===c.type){if(o=n.done?m:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function S(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,S(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function F(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(y(t)+" is not iterable")}return _.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=c(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},T(P.prototype),c(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new P(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(k),c(k,l,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function b(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){b(i,n,o,a,s,"next",e)}function s(e){b(i,n,o,a,s,"throw",e)}a(void 0)}))}}var w={name:"ProCreateChild",components:{SelectedPartTable:v["default"],AutoSelect:m["default"],JDDictSelectTag:p["default"],RepairPartsTreeModal:u["default"],CreateProFloorChoose:c["default"],AmountInput:s["default"],JDictRegionListSelect:l["default"],PreviewPicture:d["default"]},mixins:[f["a"]],inject:["projMainData"],props:{disabled:{type:Boolean,default:!1}},computed:{model:{get:function(){this.projMainData().construction||(this.projMainData().construction={});var e=this.projMainData();return this.$set(e,"constructionAmount",this.projMainData().construction.cost),e},set:function(e){}},rangeIds:function(){if(!this.model.choosePart)return"";var e=this.model.choosePart.map((function(e){return e.rangeId}));return e.join(",")}},data:function(){var e=function(e,t,r){if(!t||Number(t)<=0)return r(new Error("工程款金额应大于0").message);r("")},t=function(e,t){return new Promise(function(){var e=_(g().mark((function e(r){return g().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",r());case 2:Object(a["j"])("/drools/droolsData/exeDrools",{type:"verifyPhoneNumber",name:"verify",data:{phone:t}}).then((function(e){return e.success?r():r(e.result)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return{comparAble:!1,damagedAreaSource:[],url:{fileUploadImg:window._CONFIG["domianURL"]+"/control/file/uploadImg?uploadType=5",unilityList:"/base/regionUtility/queryUtilityList",damagedPicture:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",queryRegionByList:"/base/rtRegion/queryRegionByList",constructionPlanUrl:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",projectBudgetUrl:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId="},regionInfo:{},apportionTypes:[{value:0,text:"小区分摊"},{value:1,text:"楼栋分摊"},{value:2,text:"单元分摊"},{value:3,text:"自定义分摊"}],damagedPictureUrl:"",constructionPlanEreUrl:"",projectbudgetEreUrl:"",partColumns:[{field:"partDesc",title:"标准维修项目"},{field:"describe",title:"维修描述"},{title:"材料数量",width:100,slots:{default:"materialNum"}},{field:"totalPrice",title:"总价",width:100,headerAlign:"center",align:"right"},{title:"操作",width:"80px",align:"center",slots:{default:"action"}}],rules:{describe:[{required:!0,message:"请输入项目描述",trigger:"change"}],damagedPictureList:[{required:!0,message:"请上传受损图片",trigger:"change"}],choosePart:[{required:!0,message:"请选择标准维修项目",trigger:"change"}],apportionFloors:[{required:!0,message:"请选择分摊范围",trigger:"change"}],reqMan:[{required:!0,message:"请输入联系人",trigger:"change"}],constructionAmount:[{validator:e}],reqPhone:[{required:!0,message:"请输入联系电话",trigger:"change"},{validator:t,type:"Promise"}]}}},created:function(){var e=this;Object(h["e"])("damaged_picture_ere_id").then((function(t){e.damagedPictureUrl=e.url.damagedPicture+t})),Object(h["e"])("construction_plan_ere_id").then((function(t){e.constructionPlanEreUrl=e.url.constructionPlanUrl+t})),Object(h["e"])("project_budget_ere_id").then((function(t){e.projectbudgetEreUrl=e.url.projectBudgetUrl+t})),this.getComparAble()},mounted:function(){this.initFile()},methods:{hasEnablePageConfigByKey:i["a"],getComparAble:function(){var e=this;Object(h["e"])("compar_able").then((function(t){e.comparAble="1"==t}))},initFile:function(){var e=[{name:"受损图片或视频",fileList:[]},{name:"工程预算书",fileList:[]},{name:"施工方案",fileList:[]}];this.initUploadFile(e)},openTransferModal:function(){this.$refs.repairPartsTreeModal.open()},transferChooseOk:function(e){this.model.utilityNames="";var t=e.map((function(e){return e.utilityName}));this.model.utilityNames=t.join(","),this.$forceUpdate()},openFloorModal:function(){this.$refs.floorChoose.openModal()},regionChange:function(e,t){this.regionInfo=t},initDevice:function(e){},partChooseOk:function(e){var t=this,r=e.map((function(e){return e.rangeId})).join(",");Object(a["e"])(this.url.queryRegionByList,{ids:r}).then((function(e){if(e){if(t.$set(t.model,"apportionFloors",[]),e&&e[0]){var r=e[0];r.children.forEach((function(e){e.children.forEach((function(e){e.children.forEach((function(e){t.model.apportionFloors.push(e)}))}))}))}}else t.$message.error(e.message)}))},afterChoose:function(e){this.projMainData().construction||this.$set(this.projMainData(),"construction",{}),this.projMainData().construction.projId=this.projMainData().id,this.projMainData().construction.chargeCorpCode=e[0].code,this.projMainData().construction.chargeCorpMan=e[0].linkMan,this.projMainData().construction.chargeCorpPhone=e[0].phone},removePart:function(e){this.model.choosePart.splice(e,1),this.partChooseOk(this.model.choosePart)},setConstructionAmount:function(e){this.$set(this.model.construction,"cost",e)},onFileChange:function(e,t,r){var n=this.getFirstFileByName("施工方案"),o=this.getFirstFileByName("工程预算书"),i=this.getItemByName("受损图片或视频").fileList;this.projMainData.constructionPlanFile=n,this.model.constructionPlanFile=n&&Object.keys(n).length>0?n:void 0,this.projMainData.projectBudgetFile=o,this.model.projectBudgetFile=o&&Object.keys(o).length>0?o:void 0,this.projMainData.damagedPictureList=i,this.model.damagedPictureList=i&&Object.keys(i).length>0?i:void 0},checkData:function(){return this.$refs.formRow.validaRowMsgPro(this.$refs.row)},beforeUpload:function(e){var t=this;return new Promise((function(r,n){e.type.includes("image")||e.type.includes("video")?r():t.$message.warning("请上传图片或视频！")}))}}},C=w,x=(r("a8d6"),r("2877")),I=Object(x["a"])(C,n,o,!1,null,"72818379",null);t["default"]=I.exports},e67d:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("vxe-modal",e._b({attrs:{title:"子项目管理",position:{left:"center",top:"center"},width:"1200px",transfer:"","min-height":"700px",height:"80vh","destroy-on-close":""},on:{close:e.close},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},"vxe-modal",e.bindAttr,!1),[r("div",{staticClass:"childProManager"},[r("a-tabs",{attrs:{type:"card"},model:{value:e.tabActiveKey,callback:function(t){e.tabActiveKey=t},expression:"tabActiveKey"}},e._l(e.tabList,(function(e){return r("a-tab-pane",{key:e.key,attrs:{tab:e.title}})})),1),r("div",{staticClass:"content"},[r(e.comps[e.tabList[e.tabActiveKey].comName],{tag:"component",attrs:{busiNo:"1542405896691933185",busiType:"70",busiTypeDetail:"7001",zIndex:e.bindAttr.zIndex,projId:e.proInfo.id,proInfo:e.proInfo,isDetail:e.tabList[e.tabActiveKey].isDetail},on:{close:function(t){return e.close()}}})],1)],1)])},o=[],i={name:"ChildInsuranceManager",props:{proInfo:{type:Object,default:function(){return{}}},isDetail:{type:Boolean,default:!1}},mounted:function(){var e={},t=r("bf0b");t.keys().forEach((function(r){var n=t(r);e[r.replace(/^\.\/(.*)\.\w+$/,"$1")]=n.default})),this.comps=e},computed:{com:function(){var e=this,t=this.tabList.find((function(t){return t.key===e.tabActiveKey}));return t},bindAttr:function(){var e=Object.assign({zIndex:1e3},this.$attrs);return e}},data:function(){return{visible:!1,tabList:[{key:0,title:"基本信息",comName:"InsuranceProAuditInfoComp",isDetail:this.isDetail},{key:1,title:"图档信息",comName:"DrawFileInfo"}],tabActiveKey:0,comps:[],test:[]}},methods:{open:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.visible=e},close:function(){this.$emit("ok"),this.visible=!1}}},a=i,s=(r("c5eb"),r("2877")),l=Object(s["a"])(a,n,o,!1,null,"7c047aab",null);t["default"]=l.exports},e7a5:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.hasEnablePageConfigByKey("useV8ShareStyle")?r("create-pro-floor-choose-v8",{ref:"floorChoose",attrs:{apportionType:1,rangeIds:e.rangeIds},on:{ok:function(){return e.$emit("ok")}}}):r("vxe-modal",{ref:"modal",attrs:{"show-zoom":"",resize:"",width:"1100px",height:"80vh",position:{top:"center",left:"center"},"show-footer":"",loading:e.isLoading,zIndex:1e3},on:{confirm:e.modalOk},scopedSlots:e._u([{key:"header",fn:function(){return[r("div",{staticClass:"modalHeader",style:{marginRight:(e.floorChoose_build,"-3.6em")}},["05"===e.model.baseType&&e.editPublicType?[r("div",{staticClass:"modalTitle"},[e._v("\n          公房分摊\n        ")]),r("div",{staticClass:"apportion_desc"})]:[r("div",{staticClass:"modalTitle"},[e._v("\n          "+e._s(e.floorChoose_build?"分摊范围选择":e.currentBldName+"：分摊范围选择")+"\n        ")]),r("div",{staticClass:"apportion_desc"},[e.floorChoose_build?[r("div",{staticClass:"yellow"}),r("span",[e._v("未选中分摊")]),r("div",{staticClass:"isPart"}),r("span",[e._v("部分户选中分摊")]),r("div",{staticClass:"isAll"}),r("span",[e._v("全部户选中分摊")])]:e._e()],2)],r("div",{staticClass:"modalClose"},[r("a-icon",{attrs:{type:"close"},on:{click:e.modalClose}})],1)],2)]},proxy:!0},{key:"footer",fn:function(){return["1"==e.publicFlag?[e.floorChoose_build?e._e():r("a-button",{on:{click:e.backBuild}},[e._v("返回自然幢视图")]),r("a-button",{attrs:{type:"primary"},on:{click:e.confirmFloor}},[e._v("\n        确认选择（"+e._s(e.model.apportionFloors?e.model.apportionFloors.length:0)+"）户\n      ")])]:"0"==e.publicFlag?[r("a-button",{attrs:{type:"primary"},on:{click:e.savePublicUnit}},[e._v("确定")])]:"2"==e.publicFlag?[r("a-button",{attrs:{type:"primary"},on:{click:e.saveBldPublicUnit}},[e._v("确定")])]:e._e()]},proxy:!0}],null,!1,1202331148),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("div",{staticClass:"modalContent"},[r("a-tabs",{model:{value:e.publicFlag,callback:function(t){e.publicFlag=t},expression:"publicFlag"}},[e.model.baseType&&"05"==e.model.baseType?r("a-tab-pane",{key:"0",attrs:{tab:"公房单位"}}):e._e(),e.model.baseType&&"05"==e.model.baseType?r("a-tab-pane",{key:"2",attrs:{tab:"自然幢"}}):e._e(),r("a-tab-pane",{key:"1",attrs:{tab:"住户"}})],1),r("div",{staticClass:"modalContentBody"},["1"==e.publicFlag?[e.floorChoose_build&&e.model.describe?r("div",{staticClass:"contentHeader"},[e._v(e._s(e.model.describe)+"：")]):e._e(),r("div",{staticClass:"contentBody"},[e.visible&&!e.isLoading&&e.regionInfo?[e.floorChoose_build?r("build-apportion",{attrs:{regionInfo:e.regionInfo,buildList:e.regionInfo.children},on:{customChoose:e.customChoose,"update:buildList":function(t){return e.$set(e.regionInfo,"children",t)},"update:build-list":function(t){return e.$set(e.regionInfo,"children",t)}}}):r("house-apportion",{ref:"houseApportion",attrs:{apportionType:3,regionInfo:e.regionInfo,"is-show-checkbox":"",floorInfo:e.floorInfo}})]:e._e()],2)]:"0"==e.publicFlag?[r("div",{staticClass:"publicUnitList"},e._l(e.regionList,(function(t,n){return r("div",{key:n,staticClass:"publicUnitItem"},[r("div",{staticClass:"publicUnitItemHeader"},[e._v("\n              "+e._s(t.name)+"\n            ")]),r("div",{staticClass:"publicUnitItemBody"},[r("amount-input",{attrs:{min:0},model:{value:t.amount,callback:function(r){e.$set(t,"amount",r)},expression:"item.amount"}})],1)])})),0)]:[r("div",{staticClass:"publicUnitList"},e._l(e.bldInfoList,(function(t,n){return r("div",{key:n,staticClass:"publicUnitItem"},[r("div",{staticClass:"publicUnitItemHeader"},[e._v("\n              "+e._s(t.bldName)+"\n            ")]),r("div",{staticClass:"publicUnitItemBody"},[r("amount-input",{attrs:{min:0},model:{value:t.publicBldAmount,callback:function(r){e.$set(t,"publicBldAmount",r)},expression:"item.publicBldAmount"}})],1)])})),0)]],2)],1)])},o=[],i=r("7c50"),a=r("df5d"),s=r("0fea"),l=r("4773"),c=r("d9a4"),u=r("4aae"),d=r("dc9a"),f={name:"CreateProFloorChoose",components:{HouseApportion:a["default"],BuildApportion:i["default"],AmountInput:u["default"],ContentView:d["default"],CreateProFloorChooseV8:l["default"]},props:{apportionType:{type:[String,Number],default:0},rangeIds:{type:String,default:""},editPublicType:{type:Boolean,default:!1}},watch:{floorChoose_build:function(e){e?this.$refs.modal.revert():this.$refs.modal.maximize()}},inject:["projMainData"],computed:{model:{get:function(){return this.projMainData()},set:function(){}}},data:function(){return{visible:!1,showType:"view",regionInfo:null,floorInfo:"",currentBldName:"",floorChoose_build:!0,url:{queryHouseTreeList:"/base/rtRegion/queryHouseTreeList",queryFloors:"/use/serviceProj/queryFloors/",queryListByRegionId:"/base/rCorpInfo/queryListByRegionId",queryBldListByRegionId:"/base/rRegionInfo/queryBldListByRegionId"},isLoading:!1,apportionFloors_backup:[],regionList:[],bldInfoList:[],publicFlag:""}},methods:{hasEnablePageConfigByKey:c["a"],handlePublicFlagChange:function(){},savePublicUnit:function(){for(var e=[],t=0;t<this.regionList.length;t++){var r=this.regionList[t];r.amount>0&&e.push({id:r.id,nodeId:r.id,name:r.name,accCode:r.accCode,publicCorpAmount:r.amount})}this.$set(this.model,"apportionFloors",[]),this.$set(this.model,"bldSelectedList",[]),this.$set(this.model,"publicList",e),this.$set(this.model,"publicFlag",this.publicFlag),this.visible=!1,this.$emit("ok")},saveBldPublicUnit:function(){for(var e=[],t=0;t<this.bldInfoList.length;t++){var r=this.bldInfoList[t];r.publicBldAmount>0&&e.push({id:r.bldId,name:r.bldName,publicBldAmount:r.publicBldAmount})}this.$set(this.model,"apportionFloors",[]),this.$set(this.model,"publicList",[]),this.$set(this.model,"bldSelectedList",e),this.$set(this.model,"publicFlag",this.publicFlag),this.visible=!1,this.$emit("ok")},checkedUnit:function(e){this.$set(e,"checked",!e.checked)},getRegionListByRegionId:function(){var e=this;e.regionList=[],Object(s["e"])(this.url.queryListByRegionId,{regionId:e.model.regionId}).then((function(t){t.success&&(e.regionList=t.result,e.regionList.forEach((function(t){var r=(e.model.publicList||[]).find((function(e){return e.nodeId===t.id}));e.$set(t,"amount",r?r.publicCorpAmount:"")})))}))},queryBldListByRegionId:function(){var e=this;e.bldInfoList=[],Object(s["e"])(e.url.queryBldListByRegionId,{regionId:e.model.regionId}).then((function(t){t.success&&(e.bldInfoList=t.result,e.model.bldSelectedList&&e.model.bldSelectedList.length>0&&e.bldInfoList.forEach((function(t){var r=e.model.bldSelectedList.find((function(e){return e.nodeId===t.bldId||e.id===t.bldId}));e.$set(t,"publicBldAmount",r?r.publicBldAmount:"")})))}))},openModal:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Object(c["a"])("useV8ShareStyle")?this.$refs.floorChoose.openModal(e):(this.visible=e,this.publicFlag="05"===this.model.busiType?this.model.publicFlag:"1",this.getRegionInfo())},getRegionInfo:function(){this.isLoading=!0,this.floorChoose_build=!0;var e=this;this.regionInfo=null,"05"===e.model.baseType&&(e.getRegionListByRegionId(),e.queryBldListByRegionId()),Object(s["e"])(this.url.queryHouseTreeList,{code:this.projMainData().regionCode}).then((function(t){t.length>0?e.regionInfo=t[0]:e.$message.error(t.message),e.isLoading=!1}))},changeType:function(e){this.showType=e},modalOk:function(){var e,t=[];if("view"===this.showType)for(var r in e=this.$refs.floorView.getViewChangeIds(this.showType),e){var n=e[r];for(var o in n)t=t.concat(n[o])}else t=this.$refs.floorView.getViewChangeIds(this.showType);this.$emit("getHouseIds",t)},modalClose:function(){this.floorChoose_build?this.visible=!1:this.floorChoose_build=!0},confirmFloor:function(){if(!this.model.apportionFloors||0===this.model.apportionFloors.length)return this.$message.warning("请选择分摊范围");this.floorChoose_build?(this.visible=!1,"05"===this.model.baseType&&(this.$set(this.model,"publicList",[]),this.$set(this.model,"bldSelectedList",[]),this.$set(this.model,"publicFlag",this.publicFlag)),this.$emit("ok")):this.floorChoose_build=!0},customChoose:function(e){var t=e.floorInfo,r=e.name;this.floorInfo=t,this.currentBldName=r,this.floorChoose_build=!1,this.apportionFloors_backup=JSON.parse(JSON.stringify(this.model.apportionFloors))},changeFloor:function(e){var t=this;Object(c["a"])("useV8ShareStyle")?this.$refs.floorChoose.changeFloor(e):Object(s["j"])(this.url.queryFloors,e.sharedHousings).then((function(e){e.success?(t.$set(t.model,"apportionFloors",e.result),t.visible=!0,t.getRegionInfo()):t.$message.error(e.message)})),this.publicFlag="05"===this.model.busiType?this.model.publicFlag:"1",this.regionList.forEach((function(e){var r=t.model.allotLists.find((function(t){return t.nodeId===e.id}));t.$set(e,"checked",!!r),t.$set(e,"amount",r?r.amount:"")})),this.model.bldSelectedList&&this.model.bldSelectedList.length>0?this.bldInfoList.forEach((function(e){var r=t.model.bldSelectedList.find((function(t){return t.id===e.bldId}));t.$set(e,"checked",!!r),t.$set(e,"publicBldAmount",r?r.publicBldAmount:"")})):this.bldInfoList.forEach((function(e){var r=t.model.allotLists.find((function(t){return t.nodeId===e.bldId}));t.$set(e,"checked",!!r),t.$set(e,"publicBldAmount",r?r.amount:"")})),Object(s["j"])(this.url.queryFloors,e.sharedHousings).then((function(e){e.success?(t.$set(t.model,"apportionFloors",e.result),t.visible=!0):t.$message.error(e.message)}))},backBuild:function(){this.$set(this.model,"apportionFloors",this.apportionFloors_backup),this.floorChoose_build=!0}}},h=f,p=(r("b80d"),r("2877")),m=Object(p["a"])(h,n,o,!1,null,"a147434a",null);t["default"]=m.exports},e7cd:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"projectReview"},[r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{staticClass:"formHeader",attrs:{span:24}},[e._v("项目预算")]),r("a-col",{attrs:{span:0}}),r("a-col",{staticClass:"formLabel",attrs:{xxl:2,xl:3,span:12}},[e._v("项目预算")]),r("a-col",{attrs:{xxl:10,xl:9,span:12}},[e._v("万象新天四区9号楼1单元楼顶防水，下雨漏雨严重，雨季来临尽快修复")]),r("a-col",{staticClass:"formLabel",attrs:{xxl:2,xl:3,span:12}},[e._v("项目预算")]),r("a-col",{attrs:{xxl:10,xl:9,span:12}})],1),r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{staticClass:"formHeader",attrs:{span:24}},[e._v("审批流程")]),r("a-col",{staticClass:"step",attrs:{span:24}},[r("a-steps",{attrs:{"progress-dot":"",current:1}},[r("a-step",{attrs:{title:"项目申报"},scopedSlots:e._u([{key:"description",fn:function(){return[r("p",[e._v("万象新天四区")]),r("p",[e._v("2022-07-04 15:57")])]},proxy:!0}])}),r("a-step",{attrs:{title:"项目审核"},scopedSlots:e._u([{key:"description",fn:function(){return[r("el-timeline",{staticStyle:{"text-align":"left"}},[r("el-timeline-item",{attrs:{timestamp:"2018-04-15"}},[r("p",[e._v("初审")]),r("p",[e._v("同意")])]),r("el-timeline-item",[e._v("\n                复审\n              ")])],1)]},proxy:!0}])}),r("a-step",{attrs:{title:"资金拨付"}}),r("a-step",{attrs:{title:"业务记账"}}),r("a-step",{attrs:{title:"完成"}})],1)],1)],1),r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{attrs:{xxl:2,xl:3,span:12}},[r("span",{staticClass:"required"},[e._v("审核意见")])]),r("a-col",{attrs:{xxl:10,xl:9,span:12}},[r("j-dict-radio-button",{attrs:{options:[{label:"同意",value:0},{label:"不同意",value:1},{label:"打回",value:2}]}})],1),r("a-col",{attrs:{xxl:0,xl:0,span:0}}),r("a-col",{attrs:{xxl:12,xl:12,span:12}}),r("a-col",{attrs:{xxl:2,xl:3,span:12}},[r("span",{staticClass:"required"},[e._v("意见描述")])]),r("a-col",{attrs:{xxl:10,xl:9,span:12}},[r("a-textarea",{staticStyle:{width:"472px"}})],1),r("a-col",{attrs:{xxl:0,xl:0,span:0}}),r("a-col",{attrs:{xxl:12,xl:12,span:12}})],1),r("a-row",{staticClass:"footer"},[r("a-col",{attrs:{xxl:2,xl:3,span:12}}),r("a-col",{attrs:{xxl:10,xl:9,span:12}},[r("a-button",{attrs:{type:"primary"}},[e._v("提交")])],1)],1)],1)},o=[],i=r("7d9a"),a={name:"ProjectReview",components:{JDictRadioButton:i["default"]}},s=a,l=(r("051f"),r("2877")),c=Object(l["a"])(s,n,o,!1,null,"0a98fe7b",null);t["default"]=c.exports},eb8c:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"treeNode",class:e.isFirstNode?"firstTreeNode":""},[r("div",{staticClass:"treeNodeContent",style:e.isFirstNode?"padding-right: 10px;":""},[r("div",{staticClass:"treeNodeContentTitle",class:e.isDisabled(e.treeData)?"treeNodeContentTitle_disabled":""},["left"===e.type?[!e.treeItem.isOpen&&e.treeItem.children?r("a-icon",{staticClass:"treeNodeIcon",attrs:{type:"folder",theme:"filled"}}):e.treeItem.isOpen&&e.treeItem.children?r("a-icon",{staticClass:"treeNodeIcon",attrs:{type:"folder-open",theme:"filled"}}):r("a-icon",{staticClass:"treeNodeIcon",attrs:{type:"file",theme:"filled"}})]:[r("a-icon",{staticClass:"treeNodeIcon",attrs:{type:"file",theme:"filled"}})],r("div",{staticClass:"titleText",style:[{backgroundColor:e.selectValue===e.treeItem.id?"#bae7ff":""},{cursor:e.isDisabled(e.treeData)?"not-allowed":"pointer"}],on:{click:function(t){return e.nodeClick(e.treeItem)},dblclick:function(t){!e.treeItem.noDblClick&&!e.isDisabled(e.treeData)&&e.dblClick(e.treeItem)}}},[r("span",{staticClass:"titleName"},[e._v(e._s(e.treeItem.utilityName))]),e.treeItem.instPlaceName?r("a-tooltip",{staticClass:"detailTooltip"},[r("template",{slot:"title"},[e._v("\n              "+e._s(e.treeItem.instPlaceName)+"\n            ")]),e._v("\n            【"),r("span",{staticClass:"detail"},[e._v(e._s(e.treeItem.instPlaceName))]),e._v("】\n          ")],2):e._e()],1)],2),e.treeItem.children&&"right"!==e.type?r("a",{staticClass:"treeNodeContentButton"},[e.treeItem.isOpen?r("span",{on:{click:function(t){return e.showChildren(!1)}}},[e._v("收起")]):r("span",{on:{click:function(t){return e.showChildren(!0)}}},[e._v("下级")])]):e._e()]),r("transition-group",{attrs:{tag:"div",name:"router-slid"}},[e.treeItem.isOpen&&"right"!==e.type?e._l(e.treeItem.children,(function(t){return r("tree-comp",{key:"child"+t.id,ref:"ref"+t.id,refInFor:!0,attrs:{parentNode:e.treeItem,selectTrees:e.selectNodes,proSelectTree:e.proSelectTree,treeData:t},on:{"update:selectTrees":function(t){e.selectNodes=t},"update:select-trees":function(t){e.selectNodes=t},"update:proSelectTree":function(t){e.proSelectTree=t},"update:pro-select-tree":function(t){e.proSelectTree=t},dblNode:e.dblClick,select:e.onSelect},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}})})):e._e()],2)],1)])},o=[],i={name:"TreeComp",props:{treeData:{type:Object,default:function(){return{}}},isFirstNode:{type:Boolean,default:!1},selectKey:{type:String,default:""},selectTrees:{type:Array,default:function(){return[]}},type:{type:String,default:"left"},rightIndex:{type:Number,default:void 0},proSelectTree:{type:Array,default:function(){return[]}},parentNode:{type:Object,default:null}},model:{prop:"selectKey",event:"change"},watch:{selectKey:function(e){this.selectValue=e},selectTrees:function(e){this.selectNodes=e},treeData:function(e){this.treeItem=Object.assign({},e)}},created:function(){this.treeItem.children&&this.$set(this.treeItem,"isOpen",!0)},data:function(){return{selectValue:"",treeItem:this.treeData,selectNodes:this.selectTrees,time:null}},methods:{nodeClick:function(e){var t=this;clearTimeout(this.time),this.time=setTimeout((function(){e.disabled||(t.$emit("change",e.id),t.$emit("select",e.id,e))}),100)},onSelect:function(e){this.$emit("change",e)},showChildren:function(e){this.$set(this.treeItem,"isOpen",e)},dblClick:function(e,t){var r=this;if(clearTimeout(this.time),"left"===this.type)t||(e.parentNode=JSON.parse(JSON.stringify(this.parentNode)),this.selectNodes.push(Object.assign({},e)),this.proSelectTree.push(e.id),e.children&&0!==e.children.length&&e.children.forEach((function(t){r.goRight(t,e)})));else if(void 0!==this.rightIndex&&!t){var n=this.selectNodes.findIndex((function(t){return t.id===e.id}));-1!==n&&this.selectNodes.splice(n,1),this.proSelectTree.splice(this.proSelectTree.indexOf(e.id),1),e.children&&0!==e.children.length&&e.children.forEach((function(e){r.goLeft(e)}))}this.$emit("update: selectTrees",this.selectNodes),this.$emit("update: proSelectTree",this.selectNodes),this.$emit("dblNode",e,!0)},goRight:function(e,t){var r=this;this.isDisabled(e)||(e.parentNode=JSON.parse(JSON.stringify(t)),this.selectNodes.push(Object.assign({},e)),this.proSelectTree.push(e.id)),e.children&&0!==e.children.length&&e.children.forEach((function(t){r.goRight(t,e)}))},goLeft:function(e){this.deleteSelected(this.selectTrees,e);var t=this.proSelectTree.indexOf(e.id);t>=0&&this.proSelectTree.splice(t,1)},deleteSelected:function(e,t){var r=this,n=e.findIndex((function(e){return e.id===t.id}));-1!==n&&(e.splice(n,1),t.children&&0!==t.children.length&&t.children.forEach((function(e){r.goLeft(e)})))},isDisabled:function(e){var t=this.proSelectTree.indexOf(e.id);return t>=0&&"left"===this.type}}},a=i,s=(r("8645"),r("2877")),l=Object(s["a"])(a,n,o,!1,null,"3a0a299b",null);t["default"]=l.exports},ec22:function(e,t,r){"use strict";r("72cc")},efb9:function(e,t,r){},f021:function(e,t,r){},f83a:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"proInfo_cards"},[e._l(e.lists,(function(t){return n("div",{key:t.id,staticClass:"proInfo_cardItem"},[n("div",{staticClass:"cardItem_header"},[n("div",{staticClass:"flexAlignCenter"},[n("img",{staticStyle:{width:"16px",height:"16px"},attrs:{src:r("f26e"),alt:""}}),e._v("\n        计划编号："),n("span",[e._v(e._s(t.code))])]),n("span",[e._v(e._s(t.reqDate))])]),n("div",{staticClass:"cardItem_content"},[n("div",{staticClass:"cardItem_info"},[n("div",{staticClass:"cardItem_infoHeader"},[e._v("\n          "+e._s(t.describe)+"\n        ")]),n("div",{staticClass:"cardItem_infoAmount"},[n("div",[n("span",[e._v("保险时间范围")]),n("span",[e._v(e._s(t.startTime+" 至 "+t.endTime))])]),n("div",[n("span",[e._v("计划总金额")]),n("span",[e._v(e._s(t.countCost?e.formatterAmount(t.countCost):"0"))])]),n("div",[n("span",[e._v("单次金额")]),n("span",[e._v(e._s(t.singleMaxCost?e.formatterAmount(t.singleMaxCost):"0"))])]),n("div",[n("span",[e._v("分摊户数")]),n("span",[e._v(e._s(t.allotLists.length))])])])])]),n("div",{staticClass:"cardItem_footer"},[e.isDetail?e._e():n("a",{staticClass:"red",on:{click:function(r){return e.delMiniProj(t)}}},[e._v("删除")]),n("a",{on:{click:function(r){return e.proManager(t)}}},[e._v("项目管理")]),e.isDetail?e._e():n("a",{on:{click:function(r){return e.copyProject(t)}}},[e._v("复制项目")])])])})),e.previewVisible?n("div",{ref:"previewBox",staticClass:"outer_box"},[n("previewPicture",{ref:"previewPicture",attrs:{fileNum:e.previewNum,fileList:e.previewFileList},on:{"update:fileNum":function(t){e.previewNum=t},"update:file-num":function(t){e.previewNum=t},cancel:e.exitPreview}})],1):e._e(),n("child-pro-manager",{ref:"childProManager",attrs:{isDetail:e.isDetail,"pro-info":e.childInfo},on:{ok:e.reQueryProj}})],2)},o=[],i=r("b7a8"),a=r("e67d"),s=r("4aae"),l=r("5745"),c=r("3ed7"),u=r("0fea"),d={name:"ChildPlanCardss",mixins:[l["a"]],components:{AmountInput:s["default"],ChildProManager:a["default"],PreviewPicture:i["default"]},props:{lists:{type:Array,default:function(){return[]}},isDetail:{type:Boolean,default:!1},showType:{type:String,default:"list"}},provide:function(){return{previewZIndex:1200}},data:function(){return{previewUrl:"",filePage:0,childInfo:{},setAmountField:"",url:{delMiniProj:"/use/serviceProj/delMiniProj/"},formatterAmount:c["g"]}},watch:{lists:{immediate:!0,handler:function(e){this.initFile(e)}}},methods:{exitPreview:function(){this.previewVisible=!1},previewImg:function(e){!e.showList.length>0||(e.fileIndex=void 0!==e.fileIndex?e.fileIndex:0,this.cardInfo=e,this.previewFileList["showList"]=e.showList.map((function(e){return{originalImage:e.originalImage,name:e.name}})),this.previewVisible=!0)},proManager:function(e){this.childInfo=e,this.$refs.childProManager.open()},copyProject:function(e){this.$parent.addChild(e)},setAmount:function(e,t,r){e.field||this.$set(e,t,{cost:""}),this.$set(e[t],"cost",r),this.setAmountField=""},delMiniProj:function(e){var t=this,r=this.url.delMiniProj+e.id;Object(u["j"])(r).then((function(e){var r=e.success,n=e.result,o=e.message;r&&n?(t.$message.success(o),t.$emit("refresh")):t.$message.warning(o)}))},initFile:function(e){var t=this;e.forEach((function(e){e.fileManageList=e.damagedPictureList,t.buildShowList(void 0,e)}))},reQueryProj:function(){this.$emit("refresh")}}},f=d,h=(r("dd7f"),r("2877")),p=Object(h["a"])(f,n,o,!1,null,"0b20c840",null);t["default"]=p.exports},feed:function(e,t,r){"use strict";r("b6bf")}}]);