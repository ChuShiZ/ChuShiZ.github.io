(window["webpackJsonp_joinsoft-v9"]=window["webpackJsonp_joinsoft-v9"]||[]).push([["app~300c15f8"],{"0279":function(t,e,r){},"02a5":function(t,e,r){"use strict";r("7240")},"02bd":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("j-modal",{attrs:{title:t.title,width:t.width,visible:t.visible,switchFullscreen:"",okButtonProps:{class:{"jee-hidden":t.disableSubmit}},cancelText:"关闭"},on:{ok:t.handleOk,cancel:t.handleCancel}},[r("b-compar-config-child-form",{ref:"realForm",attrs:{disabled:t.disableSubmit},on:{ok:t.submitCallback,"close-modal":t.handleCancel}})],1)},n=[],i=r("e0d9");function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */s=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,r){return t[e]=r}}function f(t,e,r,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",m="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function _(){}var x={};d(x,c,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,c)&&(x=C);var L=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,s,c){var l=p(t[n],t,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==o(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(d).then((function(t){u.value=t,s(u)}),(function(t){return r("throw",t,s,c)}))}c(l.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=h;return function(i,o){if(n===g)throw Error("Generator is already running");if(n===v){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===h)throw n=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=g;var l=p(e,r,a);if("normal"===l.type){if(n=a.done?v:m,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=v,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=p(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(o(e)+" is not iterable")}return w.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:w,configurable:!0}),w.displayName=d(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,d(t,u,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),d(D.prototype,l,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(f(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),d(L,u,"Generator"),d(L,c,(function(){return this})),d(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function c(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){c(i,a,n,o,s,"next",t)}function s(t){c(i,a,n,o,s,"throw",t)}o(void 0)}))}}var u={name:"BComparConfigModal",components:{BComparConfigChildForm:i["default"]},data:function(){return{title:"",width:1e3,visible:!1,disableSubmit:!1}},methods:{edit:function(t,e){var r=this;this.$nextTick((function(){r.$refs.realForm.loadData(t,e)}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var t=l(s().mark((function t(){return s().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$refs.realForm.save();case 2:this.$emit("ok");case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),submitCallback:function(){},handleCancel:function(){this.close()}}},d=u,f=r("2877"),p=Object(f["a"])(d,a,n,!1,null,null,null);e["default"]=p.exports},"0629":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-modal",{attrs:{title:t.title,width:800,visible:t.visible,confirmLoading:t.confirmLoading,cancelText:"关闭",destroyOnClose:!0,wrapClassName:"ant-modal-cust-warp"},on:{ok:t.handleOk,cancel:t.handleCancel}},[r("a-spin",{attrs:{spinning:t.confirmLoading}},[r("j-form-container",{ref:"formRow",attrs:{rules:t.validatorRules,model:t.model,border:!1}},[r("a-row",{ref:"formOwnRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("比选类型")]),r("a-col",{attrs:{span:20,"data-prop":"comparName"}},[r("a-input",{attrs:{disabled:t.roleDisabled,placeholder:"请输入比选类型"},model:{value:t.model.comparName,callback:function(e){t.$set(t.model,"comparName",e)},expression:"model.comparName"}})],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("设施设备")]),r("a-col",{attrs:{span:20,"data-prop":"utilityIds"}},[r("a-checkbox-group",{attrs:{options:t.utilityList},model:{value:t.model.utilityIds,callback:function(e){t.$set(t.model,"utilityIds",e)},expression:"model.utilityIds"}})],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("主管单位")]),r("a-col",{attrs:{span:20,"data-prop":"utilityIds"}},[r("j-dict-county-tree-select",{attrs:{replaceFields:{value:"code",children:"children",title:"name"}},model:{value:t.model.utilityIds,callback:function(e){t.$set(t.model,"utilityIds",e)},expression:"model.utilityIds"}})],1),r("a-col",{staticClass:"height-108",attrs:{span:4}},[t._v("备注")]),r("a-col",{staticClass:"height-108",attrs:{span:20,"data-prop":"remark"}},[r("a-textarea",{attrs:{rows:4,placeholder:"请输入备注"},model:{value:t.model.remark,callback:function(e){t.$set(t.model,"remark",e)},expression:"model.remark"}})],1)],1)],1)],1)],1)},n=[],i=r("4ec3"),o=r("db21"),s=r("0fea"),c={name:"ComparConfigModal",components:{JDictCountyTreeSelect:o["default"]},data:function(){return{utilityList:[],url:{getUtilityList:"/business/utility/getUtilityList"},title:"操作",visible:!1,model:{},layout:{labelCol:{span:3},wrapperCol:{span:14}},confirmLoading:!1,validatorRules:{comparName:[{required:!0,message:"请输入角色名称!"}],utilityIds:[{required:!0,message:"请输入角色名称!"}],roleCode:[{required:!0,message:"请输入角色编码!"},{min:0,max:64,message:"长度不超过 64 个字符",trigger:"blur"},{validator:this.validateRoleCode}],description:[{min:0,max:126,message:"长度不超过 126 个字符",trigger:"blur"}]}}},created:function(){this.modelDefault=JSON.parse(JSON.stringify(this.model))},methods:{getUtilityList:function(){var t=this;Object(s["e"])(this.url.getUtilityList).then((function(e){e.success&&e.result.forEach((function(e){t.utilityList.push({label:e.utilityName,value:e.id})}))}))},add:function(){this.edit(this.modelDefault)},edit:function(t){this.model=Object.assign({},t),this.visible=!0,this.roleDisabled=!!this.model.id},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var t,e=this,r=this.$refs.formRow.validaRowMsg(this.$refs.formOwnRow).valida;r&&(e.confirmLoading=!0,t=this.model.id?Object(i["z"])(this.model):Object(i["g"])(this.model),t.then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok")):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1,e.close()})))},handleCancel:function(){this.close()},validateRoleCode:function(t,e,r){if(/[\u4E00-\u9FA5]/g.test(e))r("角色编码不可输入汉字!");else{var a={tableName:"sys_role",fieldName:"role_code",fieldVal:e,dataId:this.model.id};Object(i["s"])(a).then((function(t){t.success?r():r(t.message)}))}}}},l=c,u=(r("7d22"),r("2877")),d=Object(u["a"])(l,a,n,!1,null,"685e1ea4",null);e["default"]=d.exports},"06ec":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{staticClass:"height-100",attrs:{"body-style":{height:"100%"},bordered:!1}},[r("a-row",{staticClass:"height-100",attrs:{gutter:10,type:"flex"}},[r("a-col",{staticClass:"height-100",staticStyle:{margin:"0"},attrs:{span:t.leftColMd}},[r("div",{staticClass:"height-100"},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[r("a-row",{attrs:{gutter:24}},[r("a-col",{attrs:{md:4,sm:4}},[r("a-form-item",[r("a-input",{attrs:{placeholder:"请输入比选类型"},model:{value:t.queryParam.comparName,callback:function(e){t.$set(t.queryParam,"comparName",e)},expression:"queryParam.comparName"}})],1)],1),r("a-col",{attrs:{md:4,sm:4}},[r("a-form-item",[r("a-select",{attrs:{placeholder:"请选择数据类型"},model:{value:t.queryParam.pastFlag,callback:function(e){t.$set(t.queryParam,"pastFlag",e)},expression:"queryParam.pastFlag"}},[r("a-select-option",{attrs:{value:"0"}},[t._v("正常数据")]),r("a-select-option",{attrs:{value:"1"}},[t._v("历史数据")])],1)],1)],1),r("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-space",[r("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.searchQuery}},[t._v("查询")]),r("a-button",{attrs:{icon:"redo"},on:{click:t.searchReset}},[t._v("重置")])],1)],1)],1)],1)],1)],1),r("div",{staticStyle:{margin:"0 0 8px 0"}},[r("a-space",[r("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v("新建")]),r("a-button",{attrs:{type:"primary",icon:"copy"},on:{click:t.copyBatch}},[t._v("复制")])],1)],1),r("div",{ref:"modalContent",staticClass:"tableDiv"},[r("a-table",{ref:"table",attrs:{scroll:{y:t.tableHeight+"px"},size:"middle",bordered:"",rowKey:"id",columns:t.columns,dataSource:t.dataSource,pagination:t.ipagination,loading:t.loading,rowSelection:{selectedRowKeys:t.selectedRowKeys1,onChange:t.onSelectChange1,type:"radio"}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"sysOrgCode_dictText",fn:function(e){return[e?r("span",{attrs:{title:e}},[t._v(t._s(e))]):r("span",[t._v("系统预设")])]}},{key:"comparConfigScopes",fn:function(e,r){return[t._v("\n              "+t._s(t.getComparConfigScopesText(e))+"\n            ")]}},{key:"pastFlag",fn:function(e,a){return[r("span","0"===e?[t._v("正常数据")]:[t._v("历史数据")])]}},{key:"action",fn:function(e,a){return r("span",{},["0"===a.pastFlag?r("a",{on:{click:function(e){return t.handleEdit(a)}}},[r("a-icon",{attrs:{type:"edit"}}),t._v(" 编辑")],1):t._e(),"0"===a.pastFlag?r("a-divider",{attrs:{type:"vertical"}}):t._e(),"0"===a.pastFlag?r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.handleDelete1(a.id)}}},[r("a",[r("a-icon",{attrs:{type:"delete"}}),t._v(" 删除")],1)]):t._e(),"0"===a.pastFlag?r("a-divider",{attrs:{type:"vertical"}}):t._e(),r("a",{on:{click:function(e){return t.handleOpen(a)}}},[r("a-icon",{attrs:{type:"setting"}}),t._v("配置权重")],1)],1)}}])})],1)])]),1===this.rightcolval&&0!==t.selectedRowKeys1.length?r("a-col",{staticClass:"height-100",staticStyle:{margin:"0"},attrs:{span:t.rightColMd}},[r("div",{staticClass:"closeRightTable"},[r("a-icon",{attrs:{type:"close-circle"},on:{click:t.hideUserList}})],1),r("b-compar-config-child-form",{ref:"childConfigForm",on:{ok:t.modalFormOk}})],1):t._e(),r("b-compar-config-modal",{ref:"modalForm",on:{ok:t.modalFormOk}})],1),r("a-modal",{attrs:{title:"请选择主管单位",width:500,visible:t.copyVisible,maskClosable:!1,destroyOnClose:"",bodyStyle:{height:"270px"},cancelText:"关闭"},on:{ok:t.copyHandleOk,cancel:t.copyHandleCancel}},[r("j-form-container",{ref:"form",attrs:{rules:t.validatorRules,model:t.model}},[r("a-row",{ref:"formOwnRow",staticClass:"houseInfo",attrs:{slot:"detail",gutter:24},slot:"detail"},[r("a-col",{attrs:{span:6}},[r("span",{staticClass:"requiredText"},[t._v("*")]),r("span",[t._v("主管单位：")])]),r("a-col",{attrs:{span:18,"data-prop":"sysOrgCode"}},[r("a-tree-select",{staticStyle:{width:"100%"},attrs:{allowClear:"","show-search":!0,filterTreeNode:t.filter,dropdownStyle:{maxHeight:"200px",overflow:"auto"},treeData:t.sysOrgTreeData,placeholder:"请选择主管单位"},model:{value:t.model.sysOrgCode,callback:function(e){t.$set(t.model,"sysOrgCode",e)},expression:"model.sysOrgCode"}})],1)],1)],1)],1)],1)},n=[],i=r("d8a5"),o=r("e0d9"),s=r("70b7"),c=r("b65a"),l=r("0fea"),u=r("c1df"),d=r.n(u);function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=p(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function p(t,e){if(t){if("string"==typeof t)return h(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}var m={name:"ComparConfigList",mixins:[c["a"]],components:{BComparConfigModal:s["default"],BComparConfigChildForm:o["default"],moment:d.a},data:function(){return{parentObj:{},utilityList:[],scopeList:[],model2:{},currentRoleId:"",queryParam1:{},queryParam2:{},dataSource1:[],dataSource2:[],ipagination1:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:function(t,e){return e[0]+"-"+e[1]+" 共"+t+"条"},showQuickJumper:!0,showSizeChanger:!0,total:0},ipagination2:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:function(t,e){return e[0]+"-"+e[1]+" 共"+t+"条"},showQuickJumper:!0,showSizeChanger:!0,total:0},isorter1:{column:"createTime",order:"desc"},isorter2:{column:"createTime",order:"desc"},filters1:{},filters2:{},loading1:!1,loading2:!1,selectedRowKeys1:[],selectedRowKeys2:[],selectionRows1:[],selectionRows2:[],test:{},rightcolval:0,copyVisible:!1,sysOrgTreeData:[],sysOrgCode:"",model:{},columns:[{title:"比选类型",align:"center",dataIndex:"comparName",width:120},{title:"维修范围",align:"left",dataIndex:"comparConfigScopes",scopedSlots:{customRender:"comparConfigScopes"},ellipsis:!0},{title:"主管单位",align:"center",dataIndex:"sysOrgCode_dictText",scopedSlots:{customRender:"sysOrgCode_dictText"},width:180},{title:"备注",align:"center",dataIndex:"remark"},{title:"数据类型",align:"center",dataIndex:"pastFlag",scopedSlots:{customRender:"pastFlag"},width:120},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"},width:240}],url:{list:"/compare/bComparConfig/getParentConfigList",delete:"/compare/bComparConfig/delete",tenantListByCode:"/tenant/sysTenantInfo/tenantListByCode",copyBatch:"/compare/bComparConfig/copyBatch"},validatorRules:{sysOrgCode:[{required:!0,message:"请选择主管单位!"}]}}},computed:{leftColMd:function(){return 0===this.selectedRowKeys1.length?24:16},rightColMd:function(){return 0===this.selectedRowKeys1.length?0:8}},created:function(){this.getScopeList(),this.getSysOrgTreeData()},methods:{getScopeList:function(){var t=this;Object(i["g"])("repair_range").then((function(e){t.scopeList=e.result.map((function(t){var e={};return e.label=t.text,e.value=t.value,e}))}))},getComparConfigScopesText:function(t){var e=this,r=[];return t.forEach((function(t){e.scopeList.forEach((function(e){e.value==t&&r.push(e.label)}))})),r.toString()},onSelectChange2:function(t,e){this.selectedRowKeys2=t,this.selectionRows2=e},onClearSelected2:function(){this.selectedRowKeys2=[],this.selectionRows2=[]},onClearSelected1:function(){this.selectedRowKeys1=[],this.selectionRows1=[]},onSelectChange1:function(t,e){var r=this;this.rightcolval=1,this.selectedRowKeys1=t,this.selectionRows1=e,this.parentObj=Object.assign({},e[0]),this.$nextTick((function(){r.$refs.childConfigForm.loadData(r.parentObj)}))},handleDelete1:function(t){this.handleDelete(t),this.dataSource2=[],this.currentRoleId=""},modalFormOk:function(){this.searchQuery(),this.hideUserList()},selectOK:function(t){var e=this,r={};r.roleId=this.currentRoleId,r.userIdList=[];var a,n=f(t);try{for(n.s();!(a=n.n()).done;){var i=a.value;r.userIdList.push(i)}}catch(o){n.e(o)}finally{n.f()}Object(l["j"])(this.url.addUserRole,r).then((function(t){t.success?(e.loadData2(),e.$message.success(t.message)):e.$message.warning(t.message)}))},handleAddUserRole:function(){this.currentRoleId?this.$refs.selectUserModal.visible=!0:this.$message.error("请选择一个角色!")},handleOpen:function(t){var e=this;this.rightcolval=1,this.selectedRowKeys1=[t.id],this.parentObj=Object.assign({},t),this.$nextTick((function(){e.$refs.childConfigForm.loadData(e.parentObj)}))},hideUserList:function(){this.selectedRowKeys1=[]},handlePerssion:function(t){this.$refs.modalUserRole.show(t)},copyBatch:function(){if(0===this.selectedRowKeys1.length)return this.$message.warning("请选择要复制的配置");this.copyVisible=!0},copyHandleOk:function(){this.valida()&&this.handleCopySure()},handleCopySure:function(){var t=this,e={sysOrgCode:this.model.sysOrgCode},r=this.url.copyBatch;e.id=this.selectedRowKeys1[0],Object(l["e"])(r,e).then((function(e){e.success?(t.$message.success(e.message),t.searchQuery(),t.copyHandleCancel()):t.$message.error(e.message)}))},valida:function(){var t=this.$refs.form.validaRowMsg(this.$refs.formOwnRow);return t.valida},copyHandleCancel:function(){this.model.sysOrgCode="",this.copyVisible=!1},filter:function(t,e){return e.data.props.title.includes(t)},getSysOrgTreeData:function(){var t=this;Object(l["e"])(this.url.tenantListByCode).then((function(e){e.success&&(t.sysOrgTreeData=e.result)}))}},mounted:function(){this.resetScreenSize(80.5)}},g=m,v=(r("7fa2"),r("5df1"),r("2877")),y=Object(v["a"])(g,a,n,!1,null,"1073bef6",null);e["default"]=y.exports},"0a8d":function(t,e,r){"use strict";r("e9f3")},"0c21":function(t,e,r){},"0c6a":function(t,e,r){"use strict";r("4c8e")},"0dac":function(t,e,r){"use strict";r("3a8c")},1416:function(t,e,r){},1423:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editModalDiv"},[a("a-spin",{staticClass:"editModalSpin",attrs:{spinning:0!==t.loadingNum,tip:"加载中..."}},[t._l(t.getComList("1"),(function(e,n){return a(r("a8c4")("./views"+e.comPath).default,{key:n+"1",ref:e.comPath+e.sort,refInFor:!0,tag:"component",style:{marginTop:0===n?"0":"5px"},attrs:{pageStatus:t.record.id||0!==t.status?t.status:-1,isDetail:"boolean"===typeof e.isDetail?e.isDetail:t.isDetail,id:n+"1"},on:{addParameter:t.addParameter,startLoading:t.onStartLoading,endLoading:t.onEndLoading,closeModal:t.handleCancel,approval:t.onApproval}})})),1===t.status||4===t.status?a("div",t._l(t.getComList("0"),(function(e,n){return a(r("a8c4")("./views"+e.comPath).default,{key:n,ref:e.comPath+e.sort,refInFor:!0,tag:"component",style:{marginTop:0===n?"0":"5px"},attrs:{pageStatus:t.record.id||0!==t.status?t.status:-1,isDetail:!0,id:n},on:{closeModal:t.handleCancel}})})),1):t._e()],2)],1)},n=[],i=r("0fea"),o=r("c7b6"),s=r("9265"),c=r("6e86");function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */u=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,r){return t[e]=r}}function f(t,e,r,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",m="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function _(){}var x={};d(x,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(x=C);var L=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,s){var c=p(t[n],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==l(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(d).then((function(t){u.value=t,o(u)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=h;return function(i,o){if(n===g)throw Error("Generator is already running");if(n===v){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===h)throw n=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=g;var l=p(e,r,a);if("normal"===l.type){if(n=a.done?v:m,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=v,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=p(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(l(e)+" is not iterable")}return w.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:w,configurable:!0}),w.displayName=d(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,d(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),d(D.prototype,s,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(f(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),d(L,c,"Generator"),d(L,o,(function(){return this})),d(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function d(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){d(i,a,n,o,s,"next",t)}function s(t){d(i,a,n,o,s,"throw",t)}o(void 0)}))}}var p={name:"DetailModal",components:{EditModalTabs:c["default"],WorkFlowHistory:o["default"],WorkFlowApproval:s["default"]},props:{approvalFunction:Function},provide:function(){var t=this;return{projMainData:function(){return t.mainData},comData:function(){return t.comData}}},inject:["closeCurrent","routeReload"],data:function(){return{tagColor:["#f50","#2db7f5","#87d068","#108ee9"],fullscreen:!1,currentTab:"1",loadingNum:0,status:0,current:0,record:{},mainData:{},isDetail:!1,overheadShowStatus:!0,visible:!1,isUpload:!1,comData:{},workFlowVariable:{},workFlowRecord:{},tableId:"",nodeId:"",taskId:"",businessKey:"",elementsArr:[],isSave:!0,url:{getMatterByCode:"/components/comMatter/queryByCode",saveOrEditForm:"/form/joinFormDataStructure/saveOrEditForm",queryDataStructureByCode:"/form/joinFormDataStructure/queryDataStructureByCode",queryStructureId:"/form/joinFormStructure/queryByCode",getNowNode:"/act/task/getNowNode"}}},computed:{isWorkflow:function(){return this.comData&&this.comData.workflowCode&&""!==this.comData.workflowCode},closeCurrentPage:function(){return this.closeCurrent},routeReloadPage:function(){return this.routeReload}},created:function(){},methods:{initNowNode:function(t){var e=this;Object(i["e"])(this.url.getNowNode+"/"+t).then((function(t){if(t.success&&t.result)if(t.result.endTime)e.initData(e.elementsArr[0].customform,{id:e.$route_query.id},!0);else{e.nodeId=t.result.taskDefKey;var r=e.elementsArr.map((function(t){return t.overrideid})).indexOf(t.result.taskDefKey);e.current=r,e.workFlowRecord.editUrl=t.result.formKey,e.initData(e.elementsArr[r].customform,{id:e.$route_query.id},!1)}else e.initData(e.elementsArr[0].customform,{id:e.$route_query.id},!0)}))},onChange:function(t){this.current=t;var e=!0;e=this.nodeId?this.nodeId&&this.elementsArr[t].overrideid!==this.nodeId:0!==t,this.initData(this.elementsArr[t].customform,{id:this.$route_query.id},e)},onTagClick:function(t){var e=this;"0"!==t.comPosition?this.currentTab=t.comPosition:this.currentTab="1",setTimeout((function(){e.$refs[t.comPath+t.sort][0].$el.scrollIntoView({block:"center",behavior:"smooth"}),-1!==(e.$refs[t.comPath+t.sort][0].$el.className+"").indexOf("ant-collapse")?e.$refs[t.comPath+t.sort][0].$el.className=e.$refs[t.comPath+t.sort][0].$el.className+" borderLightCollapse":e.$refs[t.comPath+t.sort][0].$el.className=e.$refs[t.comPath+t.sort][0].$el.className+" borderLight",setTimeout((function(){e.$refs[t.comPath+t.sort][0].$el.className=(e.$refs[t.comPath+t.sort][0].$el.className+"").replace(" borderLight",""),e.$refs[t.comPath+t.sort][0].$el.className=(e.$refs[t.comPath+t.sort][0].$el.className+"").replace(" borderLightCollapse","")}),1e3)}),100)},initData:function(t,e){this.businessKey=e.businessKey,this.taskId=e.id,this.tableId=e.tableId,this.workFlowVariable=e.variables,this.workFlowRecord=e;var r={id:e.tableId};this.isDetail=!0,this.status=4;var a=this.workFlowVariable.matterCode;e.customform&&""!==e.customform&&(a=e.customform),this.init(a,r)},getComList:function(t){return this.comData.comMatterDetailList&&this.comData.comMatterDetailList.length>0?this.comData.comMatterDetailList.filter((function(e){return e.comPosition||(e.comPosition="1"),e.comPosition===t})):[]},initModelElements:function(){var t=f(u().mark((function t(e){var r=this;return u().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["e"])("/service/model/"+e+"/json").then((function(t){if(t){var e=[];t.model.childShapes.map((function(t){"UserTask"===t.stencil.id&&e.push(t.properties)})),r.elementsArr=e,r.$route_query.busiKey?r.initNowNode(r.$route_query.busiKey):r.initData(r.elementsArr[0].customform,{id:r.$route_query.id},!1)}}));case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),init:function(t,e){var r=this;this.isUpload=!1,this.tableId="",this.visible=!0,this.loadingNum=1,Object(i["e"])(this.url.getMatterByCode,{code:t,id:e.id}).then(function(){var t=f(u().mark((function t(a){var n,o,s,c,l,d,f,p;return u().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a.success||!a.result){t.next=16;break}for(r.comData=a.result,n=0;r.comData.comMatterDetailList&&r.comData.comMatterDetailList.length>0&&n<r.comData.comMatterDetailList.length;n++)if(o=r.comData.comMatterDetailList[n],s={},o.comVar&&""!==o.comVar&&(s=JSON.parse(o.comVar),o.tmpParameters=s),s.workFlowName&&""!==s.workFlowName?0===r.status||e.state&&"1"===e.state&&r.isDetail?(r.comData.comMatterDetailList.splice(n,1),n--):(1!==r.status||a.result.comMap.includes(s.workFlowName))&&(2!==r.status&&3!==r.status||-1!==(r.workFlowRecord.editUrl+"").indexOf(s.workFlowName))||(r.comData.comMatterDetailList.splice(n,1),n--):!s.onlyEditPage||0===r.status||1===r.status&&"0"===e.state||(r.comData.comMatterDetailList.splice(n,1),n--),s.hideState&&(r.comData.comMatterDetailList.splice(n,1),n--),s.workFlowName&&""!==s.workFlowName&&-1!==(r.workFlowRecord.editUrl+"").indexOf("!"+s.workFlowName)?o.isDetail=!1:o.isDetail=s.isDetail,delete s.isDetail,s.workFlowName&&""!==s.workFlowName&&-1!==(r.workFlowRecord.editUrl+"").indexOf(s.workFlowName+"."))for(c=(r.workFlowRecord.editUrl+"").split(","),l=0;c&&c.length>0&&l<c.length;l++)-1!==(c[l]+"").indexOf(s.workFlowName+".")&&(d=(c[l]+"").substring((c[l]+"").indexOf(".")+1,(c[l]+"").indexOf("=")),f=(c[l]+"").substring((c[l]+"").indexOf("=")+1,(c[l]+"").length),d&&""!==d&&("isDetail"===d?o.isDetail="true"===f||"false"!==f&&f:"position"===d?o.comPosition=f:s[d]="true"===f||"false"!==f&&f));if(p={},!e||!e.id){t.next=11;break}if(r.tableId=e.id,!r.comData.getByIdUrl){t.next=9;break}return t.next=9,Object(i["e"])(r.comData.getByIdUrl,{id:e.id}).then((function(t){t.success&&t.result&&(p=t.result,p.businessKey=p.businessKey?p.businessKey:r.comData.workflowCode+"."+e.id)}));case 9:t.next=12;break;case 11:p=e||{};case 12:r.mainData=p,r.$nextTick((function(){for(var t=function(){var t=r.comData.comMatterDetailList[e];if(t.tmpParameters)for(var a=Object.keys(t.tmpParameters),n=0;r.$refs[t.comPath+t.sort]&&a&&a.length>0&&n<a.length;n++)r.$refs[t.comPath+t.sort][0][a[n]]=t.tmpParameters[a[n]];t.slotDynamicCode&&""!==t.slotDynamicCode&&(t.refreshState=!1,t.widgetFormPreview="",t.dataStructureId="",t.formModal={},t.dataFormId=t.slotDynamicCode,t.tpFormInfo={},Object(i["e"])(r.url.queryStructureId,{code:t.dataFormId}).then((function(e){if(e.success&&(t.refreshState=!0,t.tpFormInfo=e.result.tpFormInfo,t.widgetFormPreview=JSON.parse(e.result.formStructure),r.tableId)){var a={code:t.dataFormId,planId:r.tableId};Object(i["e"])(r.url.queryDataStructureByCode,a).then((function(e){e.success&&(t.dataStructureId=e.result.id,t.formModal=JSON.parse(e.result.dataStructure))}))}}))),r.$refs[t.comPath+t.sort]&&"function"===typeof r.$refs[t.comPath+t.sort][0].initData&&r.$refs[t.comPath+t.sort][0].initData(t.sort),r.$forceUpdate()},e=0;r.comData.comMatterDetailList&&r.comData.comMatterDetailList.length>0&&e<r.comData.comMatterDetailList.length;e++)t();r.loadingNum=0})),t.next=17;break;case 16:r.$message.warn("事项加载失败，请稍后重试");case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onTakeBack:function(){var t=this;this.loadingNum=1,this.$refs.TakeBackInformation.checkData().then((function(e){var r=t.tmpData;r.takeBackReason=e.data.takeBackReason,r.sign=e.data.sign,r.taskId=t.taskId,Object(i["l"])("/zlbt/takeBack/saveTakeBack",r).then((function(e){e.success?(t.$message.success(e.message),t.handleCancel(),t.$emit("ok")):(t.loadingNum=0,t.$message.warning(e.message))})).catch((function(e){t.loadingNum=0}))}))},onStartLoading:function(){this.loadingNum++},onEndLoading:function(){this.loadingNum--,this.loadingNum<0&&(this.loadingNum=0)},handleOk:function(){var t=f(u().mark((function t(e){var r,a,n,o,s=this;return u().wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.loadingNum=1,{id:this.tableId,type:this.type},r=u().mark((function t(){var r,a;return u().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=!0,a=s.comData.comMatterDetailList[n],!s.$refs[a.comPath+a.sort]||"function"!==typeof s.$refs[a.comPath+a.sort][0].checkData){t.next=8;break}return t.next=5,s.$refs[a.comPath+a.sort][0].checkData(e).then((function(t){})).catch((function(t){s.$refs[a.comPath+a.sort][0].$el.scrollIntoView({block:"center",behavior:"smooth"}),r=!1}));case 5:if(r){t.next=8;break}return s.loadingNum=0,t.abrupt("return",{v:!1});case 8:case"end":return t.stop()}}),t)})),n=0;case 4:if(!(this.comData.comMatterDetailList&&this.comData.comMatterDetailList.length>0&&n<this.comData.comMatterDetailList.length)){t.next=12;break}return t.delegateYield(r(),"t0",6);case 6:if(a=t.t0,!a){t.next=9;break}return t.abrupt("return",a.v);case 9:n++,t.next=4;break;case 12:if(o=!0,3!==this.status){t.next=18;break}return t.next=16,this.onApproval(1,"编辑完成").catch((function(t){o=!1}));case 16:t.next=28;break;case 18:if(this.mainData.isSubmit=e?"1":"0",this.isUpload&&(this.mainData.saveFlag="1"),this.mainData.matterCode=this.comData.matterCode,!this.mainData.id){t.next=26;break}return t.next=24,Object(i["l"])(this.comData.editUrl,this.mainData).then((function(t){t.success?(s.$message.success("操作成功"),s.initData(s.elementsArr[s.current].customform,{id:s.$route_query.id},!0)):(s.$message.error(t.message),o=!1)}));case 24:t.next=28;break;case 26:return t.next=28,Object(i["j"])(this.comData.addUrl,this.mainData).then((function(t){t.success?(s.$message.success("操作成功"),s.initData(s.elementsArr[s.current].customform,{id:s.$route_query.id},!0)):(s.$message.error(t.message),o=!1)}));case 28:if(o){t.next=31;break}return this.loadingNum=0,t.abrupt("return",!1);case 31:this.visible=!1,this.loadingNum=0,this.$emit("ok"),this.closeCurrentPage(),this.$nextTick((function(){s.routeReloadPage()}));case 36:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),buildData:function(t,e){if(t&&t.data)if(t.path&&""!==t.path){var r=t.path.split("."),a=e;if(r.length>1)for(var n=0;n<r.length-1;n++)a[r[n]]||(a[r[n]]={}),a=a[r[n]];a[r[r.length-1]]&&Array.isArray(a[r[r.length-1]])?a[r[r.length-1]].concat(t.data):a[r[r.length-1]]?a[r[r.length-1]]=Object.assign(a[r[r.length-1]],a[r[r.length-1]]):a[r[r.length-1]]=t.data}else for(var i=Object.keys(t.data),o=0;i&&i.length>0&&o<i.length;o++)if(e[i[o]]&&Array.isArray(e[i[o]]))for(var s=0;s<t.data[i[o]].length;s++)t.data[i[o]][s]&&-1===e[i[o]].indexOf(t.data[i[o]][s])&&e[i[o]].push(t.data[i[o]][s]);else e[i[o]]=t.data[i[o]]},onApproval:function(t,e){var r=this;return new Promise(function(){var a=f(u().mark((function a(n,o){var s,c,l,d,f;return u().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r.approvalFunction){a.next=5;break}return a.next=3,r.approvalFunction(t,e);case 3:return n(),a.abrupt("return");case 5:if({id:r.tableId,matterCode:r.comData.matterCode},s=!0,r.tableId&&""!==r.tableId){a.next=11;break}return r.$message.warning("没有工作流任务ID"),o(),a.abrupt("return",!1);case 11:if(t+="",""===t&&(t="1"),!(r.getComList("0").length>0)){a.next=32;break}c=u().mark((function e(){var a,n;return u().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=!0,n=r.getComList("0")[d],"1"!==t){e.next=7;break}if(!r.$refs[n.comPath+n.sort]||"function"!==typeof r.$refs[n.comPath+n.sort][0].checkPass){e.next=7;break}if(r.$refs[n.comPath+n.sort][0].checkPass()){e.next=7;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 7:if("function"!==typeof r.$refs[n.comPath+n.sort][0].checkData){e.next=13;break}return e.next=10,r.$refs[n.comPath+n.sort][0].checkData().then((function(t){})).catch((function(t){a=!1}));case 10:if(a){e.next=13;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 13:case"end":return e.stop()}}),e)})),d=0;case 16:if(!(d<r.getComList("0").length)){a.next=24;break}return a.delegateYield(c(),"t0",18);case 18:if(l=a.t0,!l){a.next=21;break}return a.abrupt("return",l.v);case 21:d++,a.next=16;break;case 24:return r.mainData.saveFlag="1",r.mainData.state=t,r.mainData.workflowNode=r.workFlowRecord?r.workFlowRecord.name:"",a.next=29,Object(i["l"])(r.comData.editUrl,r.mainData).then((function(t){t.success||(r.$message.error(t.msg),s=!1)}));case 29:if(s){a.next=32;break}return r.loadingNum=0,a.abrupt("return",!1);case 32:return r.loadingNum=1,f=btoa(encodeURIComponent(e&&""!==e?e:"审批通过")),a.next=36,Object(i["j"])("/handle/task/complete/"+r.taskId+"/"+t+"/"+f+"/0/0/0/0",r.workFlowVariable).then((function(t){t.success?(r.$emit("ok"),r.$message.success("操作成功"),n(),r.handleCancel()):(r.loadingNum=0,r.$message.warning("操作失败"),o())}));case 36:case"end":return a.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}())},onEditOk:function(t,e){var r=this;return new Promise(function(){var a=f(u().mark((function a(n,o){var s,c,l,d,f,p;return u().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if({id:r.tableId,matterCode:r.comData.matterCode},s=!0,r.tableId&&""!==r.tableId){a.next=6;break}return r.$message.warning("没有工作流任务ID"),o(),a.abrupt("return",!1);case 6:if(t+="",""===t&&(t="1"),c=[].concat(r.getComList("1")).concat(r.getComList("2")),!(c.length>0)){a.next=29;break}l=u().mark((function e(){var a,n;return u().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=!0,n=c[f],"1"!==t){e.next=7;break}if(!r.$refs[n.comPath+n.sort]||"function"!==typeof r.$refs[n.comPath+n.sort][0].checkPass){e.next=7;break}if(r.$refs[n.comPath+n.sort][0].checkPass()){e.next=7;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 7:if("function"!==typeof r.$refs[n.comPath+n.sort][0].checkData){e.next=13;break}return e.next=10,r.$refs[n.comPath+n.sort][0].checkData().then((function(t){})).catch((function(t){a=!1}));case 10:if(a){e.next=13;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 13:case"end":return e.stop()}}),e)})),f=0;case 12:if(!(f<c.length)){a.next=20;break}return a.delegateYield(l(),"t0",14);case 14:if(d=a.t0,!d){a.next=17;break}return a.abrupt("return",d.v);case 17:f++,a.next=12;break;case 20:return r.mainData.saveFlag="1",r.mainData.state=t,r.mainData.workflowNode=r.workFlowRecord?r.workFlowRecord.name:"",r.mainData.matterCode=r.comData.matterCode,a.next=26,Object(i["l"])(r.comData.editUrl,r.mainData).then((function(t){t.success||(r.$message.error(t.msg),s=!1)}));case 26:if(s){a.next=29;break}return r.loadingNum=0,a.abrupt("return",!1);case 29:return r.loadingNum=1,p=btoa(encodeURIComponent(e&&""!==e?e:"审批通过")),a.next=33,Object(i["j"])("/handle/task/complete/"+r.taskId+"/"+t+"/"+p+"/0/0/0/0",r.workFlowVariable).then((function(t){t.success?(r.$emit("ok"),r.$message.success("操作成功"),n(),r.handleCancel()):(r.loadingNum=0,r.$message.warning("操作失败"),o())}));case 33:case"end":return a.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}())},addParameter:function(t){this.workFlowVariable=Object.assign(this.workFlowVariable,t)},handleCancel:function(){this.currentTab="1",this.loadingNum=0,this.visible=!1,this.businessKey="",this.taskId="",this.tableId="",this.workFlowVariable={},this.status=0},getStatusText:function(){switch(this.status){case 0:return"编辑";case 1:return"详情";case 2:return"审核";case 3:return"修改";case 4:return"取回";default:return""}}}},h=p,m=(r("2190"),r("2877")),g=Object(m["a"])(h,a,n,!1,null,"3f2d322c",null);e["default"]=g.exports},"15de":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{staticClass:"mainCard",attrs:{bordered:!1,"body-style":{padding:"8px"}}},[r("m-e-s-super-query",{attrs:{fieldList:t.queryObj,saveCode:t.fileName,type:"queryList"},on:{ok:t.handleSuperQuery}}),r("div",{staticClass:"tableDiv"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,expand:!1,data:t.loadData,tableColumn:t.columns,"table-height":"auto","header-align":"center"}})],1)],1)},n=[],i=(r("6eb7"),r("0fea")),o=r("ac0d"),s=r("0a5e"),c=r("6fa9"),l={name:"BidrecordQuery",mixins:[s["a"],o["b"]],description:"b_compar_config管理页面",components:{MESSuperQuery:c["default"]},data:function(){var t=this;return{url:{bidrecordQuery:"/compare/bComparPart/bidrecordQuery"},loadData:function(e){return Object(i["e"])(t.url.bidrecordQuery,Object.assign(e,t.queryParam)).then((function(t){return t.result}))},dictOptions:{},fileName:"BComparConfigList",queryObj:[{type:"input",value:"corpCode",label:"企业名称"}],columns:[{title:"单位名称",headerAlign:"left",align:"left",field:"corpName"},{headerAlign:"center",title:"联系人",align:"center",field:"contacts",width:130},{headerAlign:"center",title:"联系电话",align:"center",field:"contactNumber",width:"200px",type:"input"},{headerAlign:"right",title:"报价",align:"right",field:"corpPrice",width:"200px",type:"amount",formatter:"amount"}]}},created:function(){},methods:{}},u=l,d=(r("49da"),r("2877")),f=Object(d["a"])(u,a,n,!1,null,"2e21f0ca",null);e["default"]=f.exports},"16c1":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",{style:"color: "+t.color},[t._v(t._s(t.content))])},n=[],i={data:function(){return{content:""}},props:{color:{type:String,default:"rgba(0, 0, 0, 0.65)"},date:{type:String,default:(new Date).toString()},time:{type:Number,default:0,dateTimeStamp:""}},mounted:function(){this.diffTime()},methods:{diffTime:function(){if(this.dateTimeStamp=this.time,!this.dateTimeStamp){if(!this.date)return"刚刚";this.dateTimeStamp=new Date(this.date).getTime()}var t=6e4,e=60*t,r=24*e,a=30*r,n=(new Date).getTime(),i=n-this.dateTimeStamp,o=i/a,s=i/r,c=i/e,l=i/t;parseInt(o)>=1?this.content=parseInt(o)+"个月前":parseInt(s)>1?this.content=parseInt(s)+"天前":1===parseInt(s)?this.content="昨天":parseInt(c)>=1?this.content=parseInt(c)+"小时前":parseInt(l)>=1?this.content=parseInt(l)+"分钟前":this.content="刚刚"}}},o=i,s=r("2877"),c=Object(s["a"])(o,a,n,!1,null,"c6866444",null);e["default"]=c.exports},"171c":function(t,e,r){},1821:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-spin",{attrs:{spinning:t.confirmLoading}},[r("div",{staticClass:"padding8"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!1,bordered:"",stripe:!0,"table-height":null,"max-height":500,expand:!1,"show-pagination":!0,"header-align":"center",ifInitQuery:!1,data:t.loadData,tableColumn:t.columns},scopedSlots:t._u([{key:"comparName",fn:function(e){var r=e.text;e.row;return[t._l(t.compositeComparDict,(function(e){return[e.value===r?[t._v("\n              "+t._s(e.text)+"\n            ")]:t._e()]}))]}}])})],1)])},n=[],i=r("821c"),o=r("0a5e"),s=r("0fea"),c=r("d8a5"),l={name:"ComparpartPriceDetail",components:{HouseDetailComp:i["default"]},mixins:[o["a"]],props:{disabled:{type:Boolean,default:!1,required:!1}},data:function(){var t=this;return{compositeComparDict:[],model:{},loadData:function(e){return Object(s["e"])(t.url.list,Object.assign(e,{partId:t.model.partId})).then((function(t){return t.result}))},confirmLoading:!1,columns:[{title:"指标名称",align:"center",headerAlign:"center",field:"comparName",slot:!0},{title:"得分",align:"center",headerAlign:"center",width:"400px",field:"score"}],url:{list:"/compare/bComparScoreInfo/getScoreDetail"}}},methods:{showByPartId:function(t){this.model.partId=t,this.queryPage()}},created:function(){var t=this;Object(c["g"])("composite_compar").then((function(e){t.compositeComparDict=e.result}))}},u=l,d=(r("9fee"),r("2877")),f=Object(d["a"])(u,a,n,!1,null,"b7925644",null);e["default"]=f.exports},1987:function(t,e,r){"use strict";r("c5d9")},"1a8a":function(t,e,r){},"1bed":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-row",{attrs:{gutter:10}},[r("a-col",{attrs:{md:4,sm:24}},[r("a-card",{attrs:{bordered:!1}},[r("div",{staticStyle:{background:"#fff","padding-left":"16px",height:"100%","margin-top":"5px"}},[r("a-input-search",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入名称"},on:{search:t.onSearch}}),r("a-col",{attrs:{md:5,sm:24}},[[r("a-tree",{attrs:{checkable:"",multiple:"",selectedKeys:t.selectedKeys,checkedKeys:t.checkedKeys,treeData:t.departTree,checkStrictly:t.checkStrictly,expandedKeys:t.iExpandedKeys,autoExpandParent:t.autoExpandParent},on:{check:t.onCheck,rightClick:t.rightHandle,expand:t.onExpand}})]],2)],1)])],1),r("a-col",{attrs:{md:20,sm:24}},[r("a-card",{attrs:{bordered:!1}},[r("a-form",{attrs:{form:t.form,colon:!1}},[r("div",{staticClass:"anty-form-btn"},[r("a-button",{attrs:{type:"primary",htmlType:"button",icon:"form"},on:{click:t.submitCurrForm}},[t._v("发布")]),r("a-button",{attrs:{type:"default",htmlType:"button",icon:"sync"},on:{click:t.emptyCurrForm}},[t._v("重置")])],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"标题"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contentTitle",t.validatorRules.title],expression:"['contentTitle', validatorRules.title]"}],attrs:{placeholder:"请输入标题"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"副标题"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["secondTitle",{}],expression:"['secondTitle', {}]"}],attrs:{placeholder:"请输入副标题"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"肩标题"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["shoulderTitle",{}],expression:"['shoulderTitle', {}]"}],attrs:{placeholder:"请输入肩标题"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"辅标题"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["subTitle",{}],expression:"['subTitle', {}]"}],attrs:{placeholder:"请输入辅标题"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"关键字"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["keyword",{}],expression:"['keyword', {}]"}],attrs:{placeholder:"请输入关键字"}})],1),"Y"==t.isPermission?r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"选择用户"}},[r("content-person",{ref:"ContentPerson",staticStyle:{width:"100%"}})],1):t._e(),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"是否范围查看"}},[r("a-radio-group",{attrs:{value:this.isPermission},model:{value:t.isPermission,callback:function(e){t.isPermission=e},expression:"isPermission"}},[r("a-radio",{attrs:{value:"Y"}},[t._v("\n              是\n            ")]),r("a-radio",{attrs:{value:"N"}},[t._v("\n              否\n            ")])],1)],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"是否置顶"}},[r("a-radio-group",{attrs:{value:this.isTop},model:{value:t.isTop,callback:function(e){t.isTop=e},expression:"isTop"}},[r("a-radio",{attrs:{value:"Y"}},[t._v("\n              是\n            ")]),r("a-radio",{attrs:{value:"N"}},[t._v("\n              否\n            ")])],1)],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"图片新闻"}},[r("a-radio-group",{attrs:{value:this.isImage},model:{value:t.isImage,callback:function(e){t.isImage=e},expression:"isImage"}},[r("a-radio",{attrs:{value:"Y"}},[t._v("\n              是\n            ")]),r("a-radio",{attrs:{value:"N"}},[t._v("\n              否\n            ")])],1)],1),"Y"===this.isImage?r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"图片"}},[r("a-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadAction,headers:t.headers,showUploadList:!1,"list-type":"picture-card",multiple:!0},on:{change:t.handleChange}},[this.sysFileList.length>0?r("img",{staticStyle:{width:"100%"},attrs:{src:t.buildPath(this.sysFileList[0].filePath)}}):r("div",[r("a-icon",{attrs:{type:t.uploadLoading?"loading":"plus"}}),r("div",{staticClass:"ant-upload-text"},[t._v("上传")])],1)])],1):t._e(),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"超链接"}},[r("a-radio-group",{attrs:{value:this.isUrl},model:{value:t.isUrl,callback:function(e){t.isUrl=e},expression:"isUrl"}},[r("a-radio",{attrs:{value:"Y"}},[t._v("\n              是\n            ")]),r("a-radio",{attrs:{value:"N"}},[t._v("\n              否\n            ")])],1)],1),"Y"===this.isUrl?r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"链接地址"}},[r("a-input",{attrs:{placeholder:"请输入链接地址"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1):t._e(),"Y"!==t.isUrl?r("avue-ueditor",{staticStyle:{width:"100%"},attrs:{options:t.options},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}):t._e(),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"附件上传"}},[r("div",{staticStyle:{"margin-top":"11px"}},[r("universal-enclosure",{ref:"UniversalEnclosure",attrs:{title:t.uploadDescribe,isDetail:!1},on:{change:t.onFileChange},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1)]),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"摘要"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["abstractText",{}],expression:"['abstractText', {}]"}],attrs:{placeholder:"请输入摘要"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"来源"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["source",{}],expression:"['source', {}]"}],attrs:{placeholder:"请输入来源"}})],1),r("div",{staticClass:"anty-form-btn"},[r("a-button",{attrs:{type:"primary",htmlType:"button",icon:"form"},on:{click:t.submitCurrForm}},[t._v("发布")]),r("a-button",{attrs:{type:"default",htmlType:"button",icon:"sync"},on:{click:t.emptyCurrForm}},[t._v("重置")])],1)],1)],1)],1)],1)},n=[],i=r("fd65"),o=r("88bc"),s=r.n(o),c=r("d359"),l=r("4ec3"),u=r("0fea"),d=r("b65a"),f=r("e610"),p=r("cf74"),h=r("9fb0"),m=r("2b0e"),g={name:"FBZXList",mixins:[d["a"]],components:{ContentPerson:i["default"],JImageUpload:f["default"],JUpload:p["default"],UniversalEnclosure:c["default"]},data:function(){return{headers:{},options:{headers:{"X-Access-Token":m["default"].ls.get("Access-Token"),sourceName:m["default"].ls.get(h["A"]),redisIndex:m["default"].ls.get(h["x"])},action:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=control&uploadType=5",customConfig:{lineHeights:["1","1.15","1.6","2","2.5","3"]},props:{res:"result",url:"urlPath"}},uploadLoading:!1,iExpandedKeys:[],loading:!1,autoExpandParent:!0,currFlowId:"",currFlowName:"",disable:!0,showArrow:!1,treeData:[],visible:!1,departTree:[],rightClickSelectedKey:"",hiding:!0,model:{},dropTrigger:"",depart:{},fileList:[],uploadDescribe:"",disableSubmit:!1,checkedKeys:[],selectedKeys:[],autoIncr:1,currSelected:{},allTreeKeys:[],checkStrictly:!0,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:22}},graphDatasource:{nodes:[],edges:[]},validatorRules:{title:{rules:[{required:!0,message:"请输入标题!"}]}},url:{add:"/content/contentBaseInfo/add",edit:"/content/contentBaseInfo/edit",queryById:"/content/contentType/queryById",queryTreeList:"/content/contentType/queryTreeList",fileUpload:window._CONFIG["domianURL"]+"/common/file/uploadImg?parenPath=content&uploadType=0",content:"/content/contentBaseInfo/queryById"},isPermission:"N",isTop:"N",isImage:"N",isUrl:"N",message:"",imageId:"",sysFileList:[]}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)},uploadAction:function(){return this.url.fileUpload}},methods:{close:function(){this.$refs.ContentPerson.receptionList0=[],this.$refs.ContentPerson.$forceUpdate()},initHeaders:function(){this.headers={"X-Access-Token":m["default"].ls.get("Access-Token"),sourceName:m["default"].ls.get(h["A"]),redisIndex:m["default"].ls.get(h["x"])}},buildPath:function(t){return window._CONFIG["staticDomainURL"]+"/"+t},handleChange:function(t){t.fileList;if("uploading"!==t.file.status&&t.file.response){var e={};e.fileId=(new Date).getTime().toString(),e.originalName=t.file.response.result.originalName,e.fileName=t.file.response.result.fileName.split(".")[1],e.filePath=t.file.response.result.filePath,e.fileId=t.file.response.result.id,this.sysFileList=[],this.sysFileList.push(e),this.imageId=e.fileId}},deleteFile:function(t){for(var e=0;e<this.sysFileList.length;e++)this.sysFileList[e].fileId==t&&(this.sysFileList.splice(e,1),this.imageId=null)},buildFilePath:function(t){return window._CONFIG["staticDomainURL"]+"/"+t},onFileChange:function(t){this.fileList=t},validateCode:function(t,e,r){var a={tableName:"content_type",fieldName:"type_num",fieldVal:e};Object(l["s"])(a).then((function(t){t.success?r():r("类别编码已存在!")}))},loadTree:function(){var t=this,e=this;e.treeData=[],e.departTree=[],Object(u["e"])(e.url.queryTreeList).then((function(r){if(r.success){for(var a=0;a<r.result.length;a++){var n=r.result[a];e.treeData.push(n),e.departTree.push(n),e.setThisExpandedKeys(n),e.getAllKeys(n)}t.loading=!1}}))},setThisExpandedKeys:function(t){if(t.children&&t.children.length>0){this.iExpandedKeys.push(t.key);for(var e=0;e<t.children.length;e++)this.setThisExpandedKeys(t.children[e])}},refresh:function(){this.loading=!0,this.isTop="N",this.isImage="N",this.isUrl="N",this.imageId="",this.sysFileList=[],this.fileList=[],this.$refs.UniversalEnclosure.initData([]),this.form.resetFields(),this.message="",this.loadTree()},rightHandle:function(t){this.dropTrigger="contextmenu",this.rightClickSelectedKey=t.node.eventKey},onExpand:function(t){this.iExpandedKeys=t,this.autoExpandParent=!1},backFlowList:function(){this.$router.back(-1)},dropStatus:function(t){0==t&&(this.dropTrigger="")},closeDrop:function(){this.dropTrigger=""},batchDel:function(){if(this.checkStrictly=!1,this.checkedKeys.length<=0)this.$message.warning("请选择一条记录！");else{for(var t="",e=0;e<this.checkedKeys.length;e++)t+=this.checkedKeys[e]+",";var r=this;this.$confirm({title:"确认删除",content:"确定要删除所选中的 "+this.checkedKeys.length+" 条数据，以及子节点数据吗?",onOk:function(){Object(u["a"])(r.url.deleteBatch,{ids:t}).then((function(t){t.success?(r.$message.success(t.message),r.loadTree(),r.onClearSelected()):r.$message.warning(t.message)}))}})}},loadData:function(){this.loadTree()},onSearch:function(t){var e=this;t?Object(u["e"])(e.url.queryTreeList,{name:t}).then((function(t){if(t.success){e.departTree=[];for(var r=0;r<t.result.length;r++){var a=t.result[r];e.departTree.push(a)}}else e.$message.warning(t.message)})):e.loadTree()},nodeModalOk:function(){this.loadTree()},nodeModalClose:function(){},hide:function(){this.visible=!1},onCheck:function(t,e){this.hiding=!1,this.checkStrictly?this.checkedKeys=t.checked:this.checkedKeys=t},setValuesToForm:function(t){this.form.getFieldDecorator("fax",{initialValue:""}),this.form.setFieldsValue(s()(t,"typeName","typeNum","isShow","orderNum"))},getCurrSelectedTitle:function(){return this.currSelected.title?this.currSelected.title:""},onClearSelected:function(){this.hiding=!0,this.checkedKeys=[],this.currSelected={},this.form.resetFields(),this.selectedKeys=[]},handleNodeTypeChange:function(t){this.currSelected.nodeType=t},notifyTriggerTypeChange:function(t){this.currSelected.notifyTriggerType=t},receiptTriggerTypeChange:function(t){this.currSelected.receiptTriggerType=t},submitCurrForm:function(){var t=this;0!==this.checkedKeys.length?this.form.validateFields((function(e,r){if(!e){var a;r.checkedKeys=t.checkedKeys,r.isUrl||(r.message=t.message),r.imageId=t.imageId,r.isUrl=t.isUrl,r.isImage=t.isImage,r.isTop=t.isTop,a="Y"==t.isPermission?t.$refs.ContentPerson.receptionList0:null;var n=[];if(a)for(var i=t.$refs.ContentPerson.ids.split(","),o=0;o<a.length;o++)n.push(i[o]);r.userIds=n;var s=Object.assign(t.model,r);s.fileList=t.fileList,Object(u["i"])(t.url.add,s,"post").then((function(e){e.success?t.$message.success("发布成功!"):t.$message.error(e.message)})),t.refresh()}})):this.$message.error("请至少选择一个栏目！")},emptyCurrForm:function(){this.form.resetFields(),this.message=null,this.fileList=[],this.$refs.UniversalEnclosure.initData([])},nodeSettingFormSubmit:function(){this.form.validateFields((function(t,e){}))},openSelect:function(){this.$refs.sysDirectiveModal.show()},selectDirectiveOk:function(t){this.nodeSettingForm.setFieldsValue({directiveCode:t.directiveCode}),this.currSelected.sysCode=t.sysCode},getFlowGraphData:function(t){if(this.graphDatasource.nodes.push({id:t.id,text:t.flowNodeName}),t.children.length>0)for(var e=0;e<t.children.length;e++){var r=t.children[e];this.graphDatasource.edges.push({source:t.id,target:r.id}),this.getFlowGraphData(r)}},expandAll:function(){this.iExpandedKeys=this.allTreeKeys},closeAll:function(){this.iExpandedKeys=[]},checkALL:function(){this.checkStriccheckStrictlytly=!1,this.checkedKeys=this.allTreeKeys},cancelCheckALL:function(){this.checkedKeys=[]},switchCheckStrictly:function(t){1==t?this.checkStrictly=!1:2==t&&(this.checkStrictly=!0)},getAllKeys:function(t){if(this.allTreeKeys.push(t.key),t.children&&t.children.length>0)for(var e=0;e<t.children.length;e++)this.getAllKeys(t.children[e])}},created:function(){this.initHeaders(),this.currFlowId=this.$route.params.id,this.currFlowName=this.$route.params.name}},v=g,y=(r("fc72"),r("2877")),b=Object(y["a"])(v,a,n,!1,null,"026a853c",null);e["default"]=b.exports},"1f23":function(t,e,r){"use strict";r("b1c3")},"1fa1":function(t,e,r){},2086:function(t,e,r){},2142:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("j-modal",{attrs:{title:t.title,width:t.width,visible:t.visible,footer:t.disableSubmit?null:void 0},on:{ok:t.handleOk,cancel:t.handleCancel}},[r("a-row",{ref:"formRow",staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{attrs:{span:24}},["1"==t.comparPart.isBidding&&""==t.comparPart.bidReason?r("a-textarea",{attrs:{disabled:t.disableSubmit,placeholder:"无",rows:4},model:{value:t.comparPart.bidReason,callback:function(e){t.$set(t.comparPart,"bidReason",e)},expression:"comparPart.bidReason"}}):r("a-textarea",{attrs:{disabled:t.disableSubmit,placeholder:"请输入选择该企业的原因",rows:4},model:{value:t.comparPart.bidReason,callback:function(e){t.$set(t.comparPart,"bidReason",e)},expression:"comparPart.bidReason"}})],1)],1)],1)},n=[],i={name:"BiddingReasonModel",props:{disableSubmit:{type:Boolean,default:!0}},data:function(){return{title:"中标理由",visible:!1,width:600,comparPart:{}}},methods:{show:function(t){this.visible=!0,this.comparPart=t},hidden:function(){this.visible=!1},handleOk:function(){this.$emit("ok",this.comparPart),this.hidden()},handleCancel:function(){this.hidden()}}},o=i,s=(r("41d7"),r("2877")),c=Object(s["a"])(o,a,n,!1,null,"7a5bc3a1",null);e["default"]=c.exports},2190:function(t,e,r){"use strict";r("64fe")},2601:function(t,e,r){},2775:function(t,e,r){},2840:function(t,e,r){"use strict";r("2f47")},"2f47":function(t,e,r){},"31a9":function(t,e,r){},3298:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("content-view",{attrs:{title:"审批信息"}},[t._t("default"),r("j-form-container",{ref:"formRow",attrs:{rules:t.rules,model:t.model,disabled:!1,border:!1}},[r("a-row",{ref:"formOwnRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{span:4}},[t._v("审批结果")]),r("a-col",{attrs:{span:20}},[r("a-radio-group",{attrs:{options:t.flagOptions,"default-value":1},on:{change:t.onChange}})],1),r("a-col",{attrs:{span:4}},[t._v("审核人")]),r("a-col",{attrs:{span:8}},[r("a-input",{staticClass:"disabledText",attrs:{disabled:!0},model:{value:t.model.createBy,callback:function(e){t.$set(t.model,"createBy",e)},expression:"model.createBy"}})],1),r("a-col",{attrs:{span:4}},[t._v("审核日期")]),r("a-col",{attrs:{span:8}},[r("a-input",{staticClass:"disabledText",attrs:{disabled:!0},model:{value:t.model.createTimeText,callback:function(e){t.$set(t.model,"createTimeText",e)},expression:"model.createTimeText"}})],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("审批意见\n        ")]),r("a-col",{attrs:{span:20,"data-prop":"comment"}},[r("a-textarea",{attrs:{placeholder:"请输入审批意见",autoSize:{minRows:5,maxRows:8}},model:{value:t.model.comment,callback:function(e){t.$set(t.model,"comment",e)},expression:"model.comment"}})],1)],1)],1)],2)],1)},n=[],i=r("dc9a"),o=r("c1df"),s=r.n(o),c=r("2b0e"),l=r("9fb0"),u={name:"WorkFlowApprovalBatch",components:{ContentView:i["default"]},data:function(){return{activeKey:"1",comment:"",model:{comment:"同意",flag:1},flagOptions:[{label:"同意",value:1},{label:"不同意",value:3},{label:"打回",value:0}],rules:{comment:[{required:!0,message:"请输入审批意见",trigger:"change"}]}}},created:function(){this.model.createTimeText=s()(new Date).format("YYYY-MM-DD"),this.model.createBy=c["default"].ls.get(l["J"]).realname,this.$forceUpdate()},methods:{removeBackBut:function(t){for(var e=0;e<this.flagOptions.length;e++)t==this.flagOptions[e].value&&this.flagOptions.splice(e,1)},onChange:function(t){t&&(this.model.flag=t.target.value,1===this.model.flag||"1"===this.model.flag?this.model.comment="同意":3===this.model.flag||"3"===this.model.flag?this.model.comment="不同意":0!==this.model.flag&&"0"!==this.model.flag||(this.model.comment="打回"))},checkData:function(){var t=this.$refs.formRow.validaRowMsg(this.$refs.formOwnRow);return t.valida},getApproveInfo:function(){return this.model}}},d=u,f=(r("ea341"),r("2877")),p=Object(f["a"])(d,a,n,!1,null,"7b45dece",null);e["default"]=p.exports},3786:function(t,e,r){"use strict";r("2601")},"393d":function(t,e,r){"use strict";r("4b91")},"39cd":function(t,e,r){"use strict";r("f630")},"3a8c":function(t,e,r){},"3bb4":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"height-100"},[r("corp-maintain-model",{ref:"corpMaintain",attrs:{busiType:"take"}})],1)},n=[],i=r("78b86"),o={name:"TakePartList",components:{CorpMaintainModel:i["default"]},data:function(){return{description:"企业已参与列表"}}},s=o,c=(r("6c88"),r("2877")),l=Object(c["a"])(s,a,n,!1,null,"58ab77da",null);e["default"]=l.exports},"3cda":function(t,e,r){},"3dfe":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editModalDiv"},[a("a-spin",{staticClass:"editModalSpin",attrs:{spinning:0!==t.loadingNum,tip:"加载中..."}},[t.query&&!0===t.query.showOnlyThis?t._e():a("div",{ref:"page_tabs",staticClass:"page_tabs"},[a("div",{staticClass:"myTabs"},[t._l(t.elementsArr,(function(e,r){return[!1!==e.isShow?a("div",{key:"tab"+r,staticClass:"myTabItem",class:{active:t.current==r,isSelect:2===r,disabled:t.isDisableTab(e)},on:{click:function(a){!t.isDisableTab(e)&&t.onChange(r)}}},[a("span",[t._v("\n              "+t._s(e.title)+"\n              ")])]):t._e()]}))],2)]),t.showCommentContent&&""!==t.showCommentContent?a("div",{staticClass:"myAlert transformAlert",class:{close:!t.alertVisible},style:t.alertStyle,on:{click:t.alertClick}},[a("a-icon",{staticClass:"myAlertIcon",attrs:{type:"info-circle"}}),a("span",{staticClass:"myAlertMessage"},[t._v(t._s(t.showCommentContent))]),a("a-icon",{staticClass:"myAlertClose",attrs:{type:"close"}})],1):t._e(),a("div",{ref:"page_content",staticClass:"page_content"},[[t._l(t.getComList("1"),(function(e,n){return t.fixCom?t._e():a(r("a8c4")("./views"+e.comPath).default,{key:n+"1",ref:e.comPath+e.sort,refInFor:!0,tag:"component",style:{marginTop:0===n?"0":"5px"},attrs:{pageStatus:t.record.id||0!==t.status?t.status:-1,isDetail:"boolean"===typeof e.isDetail?e.isDetail:t.isDetail,isDoing:t.isDoing,id:n+"1"},on:{addParameter:t.addParameter,startLoading:t.onStartLoading,endLoading:t.onEndLoading,closeModal:t.handleCancel,approval:t.onApproval,"hide-footer":t.hideFooter,"compar-footer":t.comparFooter}})})),t.fixCom?[a(r("a8c4")("./views"+t.fixCom.comName).default,{ref:t.fixCom.comName,tag:"component",attrs:{pageStatus:t.record.id||0!==t.status?t.status:-1,isDetail:void 0!==t.elementsArr[t.current].isDetail?t.elementsArr[t.current].isDetail:t.isDetail,isDoing:t.isDoing,showFlag:!!t.fixCom.showFlag&&t.fixCom.showFlag},on:{closeModal:t.handleCancel,updateProInfo:t.updateProInfo,"hide-footer":t.hideFooter}})]:t._e()]],2),t.footerShowFlag&&t.childControlFlag?a("div",{staticClass:"actionButtons"},[t.revokeBtnFlag?a("a-button",{on:{click:t.revokeNode}},[t._v("撤回")]):t._e(),t.saveBtnFlag?a("a-button",{attrs:{size:"default",type:t.isWorkflow?"":"primary",loading:0!==t.loadingNum},on:{click:function(e){return t.handleOk(!1)}}},[t._v("\n        保存\n      ")]):t._e(),t.isWorkflow?a("a-button",{attrs:{size:"default",type:"primary",loading:0!==t.loadingNum},on:{click:function(e){return t.handleOk(!0)}}},[t._v("\n        提交\n      ")]):t._e()],1):t._e()]),a("pro-roll-back-modal",{ref:"prbm",on:{ok:t.proRollBack}}),t.showHistory?a("work-flow-history",{ref:"WorkFlowHistory"}):t._e()],1)},n=[],i=r("0fea"),o=r("c7b6"),s=r("9265"),c=r("6e86"),l=r("17a8"),u=r("2b0e"),d=r("2f62"),f=r("d8a5");function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(t){return y(t)||v(t)||g(t)||m()}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(t,e){if(t){if("string"==typeof t)return b(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}function v(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function y(t){if(Array.isArray(t))return b(t)}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function w(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */w=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,a){var i=e&&e.prototype instanceof y?e:y,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f="suspendedStart",h="suspendedYield",m="executing",g="completed",v={};function y(){}function b(){}function _(){}var x={};l(x,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(x=C);var L=_.prototype=y.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,s){var c=d(t[n],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==p(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(u).then((function(t){l.value=t,o(l)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=f;return function(i,o){if(n===m)throw Error("Generator is already running");if(n===g){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===v)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===f)throw n=g,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=m;var l=d(e,r,a);if("normal"===l.type){if(n=a.done?g:h,l.arg===v)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=g,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;var i=d(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(p(e)+" is not iterable")}return b.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:b,configurable:!0}),b.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,l(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),l(D.prototype,s,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),l(L,c,"Generator"),l(L,o,(function(){return this})),l(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function _(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function x(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){_(i,a,n,o,s,"next",t)}function s(t){_(i,a,n,o,s,"throw",t)}o(void 0)}))}}function k(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){L(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function L(t,e,r){return(e=S(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S(t){var e=D(t,"string");return"symbol"==p(e)?e:e+""}function D(t,e){if("object"!=p(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=p(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var P={name:"EditModal",components:{EditModalTabs:c["default"],WorkFlowHistory:o["default"],WorkFlowApproval:s["default"],ProRollBackModal:l["default"]},props:{query:{type:Object,default:function(){return this.$route_query}},approvalFunction:{type:Function,default:function(){return function(){}}},pageType:{type:String,default:"page"}},provide:function(){var t=this;return{projMainData:function(){return t.mainData},comData:function(){return t.comData},nodeId:function(){return t.nodeId},getContainer:function(){return t.$refs.page_content},nowNodeInfo:function(){return t.nowNodeInfo},newEditModal:function(){return t}}},inject:["closeCurrent","routeReload"],data:function(){return{isDoing:!1,comaprShowSaveButtonFlag:!0,comaprShowRevokeButtonFlag:!0,childControlFlag:!0,loginUser:u["default"].ls.get("Login_Userinfo"),alertStyle:{},alertVisible:!0,showCommentContent:null,showHistory:!1,tagColor:["#f50","#2db7f5","#87d068","#108ee9"],fullscreen:!1,currentTab:"1",loadingNum:0,status:0,current:0,record:{},mainData:{},isDetail:!1,processOrderDict:[],overheadShowStatus:!0,visible:!1,isUpload:!1,dropTitle:!0,comData:{},workFlowVariable:{},workFlowRecord:{},tableId:"",nodeId:"finish",taskId:"",businessKey:"",elementsArr:[{title:"项目审核",value:"e",comName:this.query.busiKey&&-1!==this.query.busiKey.indexOf("insurance_process")?"/jsmf/use/components/SerProjectReviewInsure":"/jsmf/use/components/SerProjectReview",isShow:!1},{title:"计划审核",value:"f",comName:"/jsmf/use/components/SerPlanReview",isShow:!1},{title:"拨款管理",value:"b",comName:this.query.busiKey&&-1!==this.query.busiKey.indexOf("insurance_process")?"/jsmf/use/modules/InsuranceMiniFundProgList":"/jsmf/use/components/FundProgressManage",isShow:!(this.query.busiKey&&-1!==this.query.busiKey.indexOf("plan_process"))},{title:"竣工验收",value:"c",comName:"/jsmf/use/components/WarrantyInfoComp",isShow:!(this.query.busiKey&&-1!==this.query.busiKey.indexOf("plan_process"))},{title:"维修过程监督",value:"a",comName:"/jsmf/use/components/FieldSiteInfoComp",isShow:!(this.query.busiKey&&-1!==this.query.busiKey.indexOf("insurance_process"))&&!(-1!==this.query.busiKey.indexOf("plan_process"))},{title:"项目附件",value:"d",comName:"/jsmf/use/components/DrawFileInfo",isShow:!0,isDetail:!1},{title:"项目评价",value:"g",comName:"/jsmf/use/components/ProjEvaluate",isShow:!0}],fixCom:null,dynamicTabs:[],nowNode:{title:"基本信息",value:1,comName:"BaseInfo"},isSave:!0,isWork:!1,startFlowFlag:!1,nowNodeInfo:{},matterList:[],isAdmin:!1,routeQuery:{},url:{getMatterByCode:"/components/comMatter/queryByCode",saveOrEditForm:"/form/joinFormDataStructure/saveOrEditForm",queryDataStructureByCode:"/form/joinFormDataStructure/queryDataStructureByCode",queryStructureId:"/form/joinFormStructure/queryByCode",getNowNode:"/act/task/getNowNode",getByIdUrl:"/use/serviceProj/queryProj",getByIdUrlPlan:"/use/projPlan/queryPlanById",backToLastTask:"/handle/backToLastTask",queryAllMatter:"/components/comMatter/queryAllMatter",addProjForPublicUrl:"/use/serviceProj/addProjForPublic",checkUserIsCorp:"/sys/sysDepart/checkUserIsCorp"}}},computed:C(C({},Object(d["c"])(["isKeepAlive"])),{},{isWorkflow:function(){return this.comData&&this.comData.workflowCode&&""!==this.comData.workflowCode},closeCurrentPage:function(){return this.closeCurrent},routeReloadPage:function(){return this.routeReload},dynamicOptions:function(){var t=this;return this.dynamicTabs.filter((function(e){return!t.elementsArr.find((function(t){return t.value==e.value}))}))},footerShowFlag:function(){return!this.isDetail&&3!==this.status&&"preTrial"!==this.nowNodeInfo.formKey},revokeBtnFlag:function(){return this.isSave&&0!==this.current&&"finish"!==this.nowNodeInfo.taskDefKey&&(!this.nowNodeInfo||"preTrial"!==this.nowNodeInfo.formKey)&&this.comaprShowRevokeButtonFlag&&this.isAdmin},saveBtnFlag:function(){return this.isSave&&!this.isWorkflow&&(!this.nowNodeInfo||"preTrial"!==this.nowNodeInfo.formKey)&&this.comaprShowSaveButtonFlag},isCompletion:function(){try{return void 0===this.mainData.completionFlag||0==this.mainData.completionFlag}catch(t){return!0}}}),created:function(){this.queryProcessOrder(),this.isKeepAlive||this.initDataFun()},activated:function(){var t=x(w().mark((function t(){var e,r,a,n,i;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.isKeepAlive){t.next=14;break}if(e=JSON.parse(JSON.stringify(this.$route_query)),r=!1,Object.keys(e).length!==Object.keys(this.routeQuery).length&&(r=!0),r){t.next=13;break}t.t0=w().keys(e);case 6:if((t.t1=t.t0()).done){t.next=13;break}if(a=t.t1.value,e[a]===this.routeQuery[a]){t.next=11;break}return r=!0,t.abrupt("break",13);case 11:t.next=6;break;case 13:if(r){for(i in n=this.$options.data.call(this),n.routeQuery=JSON.parse(JSON.stringify(e)),this.query=this.$route_query,n)this[i]=n[i];this.initDataFun()}case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{initDataFun:function(){var t=x(w().mark((function t(){var e,r=this;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.queryProcessOrder(),this.onStartLoading(),t.next=4,Object(i["e"])(this.url.queryAllMatter,{});case 4:if(e=t.sent,e.success&&(this.matterList=e.result),"page"!==this.pageType){t.next=9;break}return t.next=9,this.initModelElements(this.query.modelId);case 9:this.onEndLoading(),Object(i["e"])(this.url.checkUserIsCorp).then((function(t){t.success||(r.isAdmin=!0)}));case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),isDisableTab:function(t){return t.disabled||"项目评价"===t.title&&this.isCompletion&&this.checkEvaluate()},checkEvaluate:function(){},queryProcessOrder:function(){var t=this;Object(f["g"])("declaration_process_order").then((function(e){if(e&&e.success&&e.result.length>0){t.processOrderDict=e.result;var r=new Map;t.processOrderDict.forEach((function(t){r.set(t.text,t.value)})),t.elementsArr.sort((function(t,e){var a=r.get(t.title),n=r.get(e.title);return void 0===a&&void 0===n?0:void 0===a?-1:void 0===n?1:a-n}))}}))},comparFooter:function(t){t&&"0"===t?(this.comaprShowSaveButtonFlag=!1,this.comaprShowRevokeButtonFlag=!0,this.hideFooter(!0)):t&&"3"===t?(this.comaprShowSaveButtonFlag=!0,this.comaprShowRevokeButtonFlag=!1,this.hideFooter(!0)):(this.hideFooter(!1),this.comaprShowSaveButtonFlag=!1,this.comaprShowRevokeButtonFlag=!1)},alertClick:function(){var t=this.$el.querySelector(".myTabItem.active"),e=t.getBoundingClientRect(),r=e.left,a=e.width,n=e.top,i=e.height,o=this.$refs.page_tabs.getBoundingClientRect(),s=o.left,c=o.top;this.alertStyle={"--closeLeft":r+a-s+"px","--closeTop":n+i-c-35+"px"},this.alertVisible=!this.alertVisible},initNowNode:function(t){var e=this;this.isDoing=!1,this.onStartLoading(),Object(i["e"])(this.url.getNowNode+"/"+t,"",{"tenant-id":this.query.sysOrgCode}).then((function(t){if(t.success&&t.result){e.nowNodeInfo=t.result;var r=!1;if(t.result.endTime)e.nodeId="finish",e.initWithoutFlow();else{var a;e.nodeId=t.result.taskDefKey,e.dynamicTabs.forEach((function(r){if(r.resourceId===t.result.taskDefKey&&(a=r),a){var n=!1;e.elementsArr.forEach((function(t){n&&"a"!=t.value&&"d"!=t.value&&"g"!=t.value&&(t.disabled=!0),r.resourceId===t.resourceId&&(n=!0)}))}}));for(var n=0;n<e.elementsArr.length;n++)e.elementsArr[n].value!=a.value||a.resourceId&&e.elementsArr[n].resourceId!==a.resourceId||(e.current=n,e.updateIsDoing(e.elementsArr[n].resourceId));e.workFlowRecord.editUrl=t.result.formKey,e.initData(a.value,{id:e.query.id},r)}}else e.initData(e.elementsArr[0].value,{id:e.query.id},!0);e.onEndLoading()}))},updateIsDoing:function(t){this.nowNodeInfo.taskDefKey===t?this.isDoing=!0:this.isDoing=!1},onChange:function(t){var e=this;this.$set(this.comData,"comMatterDetailList",[]),this.$set(this,"fixCom",void 0);var r=this;r.childControlFlag=!0,this.current=t;var a=!0;a=this.nodeId?"finish"===this.nodeId||this.nodeId&&this.elementsArr[t].resourceId!==this.nodeId:0!==t,this.updateIsDoing(this.elementsArr[t].resourceId),this.elementsArr[t].resourceId==this.nodeId?(this.isDetail=!1,this.fixCom=null,this.initData(this.elementsArr[t].value,{id:this.query.id},a)):(r.fixCom=null,r.$nextTick((function(){"05"==r.mainData.baseType&&"9"==r.mainData.state&&1==e.elementsArr[t].value?e.isDetail=!1:r.isDetail=!0,r.elementsArr[t].showFlag=!0,r.fixCom=r.elementsArr[t]})))},dropBoxChange:function(t){this.current=2,this.isDetail=!1,this.fixCom=null,this.initData(t,{id:this.query.id},!0)},initData:function(t,e,r){this.queryProcessOrder(),this.nowNodeInfo.assigneeIdList&&this.nowNodeInfo.assigneeIdList.length>0&&!this.nowNodeInfo.assigneeIdList.includes(this.loginUser.id)&&(r=!0,this.nowNodeInfo.formKey&&"preTrial"===this.nowNodeInfo.formKey&&this.$message.info("请等待项目预审通过后继续办理")),this.record=e,this.isDetail=r,this.status=r?1:0,e.overheadShowStatus&&(this.overheadShowStatus=!1!==e.overheadShowStatus),this.init(t,e)},initWorkFlow:function(t,e,r){var a=this;this.businessKey=t.businessKey,this.taskId=t.id,this.tableId=t.tableId,this.workFlowVariable=t.variables,this.workFlowRecord=t,this.tmpData=r;var n={id:t.tableId};!0===e?(this.isDetail=!0,this.status=4):void 0===e&&-1===(t.editUrl+"").indexOf("edit")?(this.isDetail=!0,this.status=2):(this.isDetail=!1,this.status=3);var i=this.workFlowVariable.matterCode;t.value&&""!==t.value&&(i=t.value),this.init(i,n),r&&this.$nextTick((function(){a.$refs.TakeBackInformation.initData(r)}))},getComList:function(t){return this.comData.comMatterDetailList&&this.comData.comMatterDetailList.length>0?this.comData.comMatterDetailList.filter((function(e){return e.comPosition||(e.comPosition="1"),e.comPosition===t})):[]},initModelElements:function(){var t=x(w().mark((function t(e){var r,a=this;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=this,this.mainData={id:this.query.id},this.isWork=!0,this.onStartLoading(),"05"!=this.query.baseType){t.next=9;break}r.elementsArr.unshift({title:"基本信息",value:1,comName:"/jsmf/use/components/ServiceProAuditInfoComp",isShow:!0}),r.initWithoutFlow(),t.next=11;break;case 9:return t.next=11,Object(i["e"])("/service/model/"+e+"/json").then((function(t){if(t){var e,n=t.model.childShapes.find((function(t){return"StartNoneEvent"==t.stencil.id})),i=[n];r.sortNode(t.model.childShapes,i),r.dynamicTabs=[],i.map((function(t){if("UserTask"==t.stencil.id){var e={value:t.properties.customform,title:t.properties.name,isShow:!0,resourceId:t.resourceId};r.matterList.forEach((function(t){t.matterCode==e.value&&(e.comName=t.comPath)})),r.dynamicTabs.push(e)}})),r.dynamicTabs.shift(),(e=r.elementsArr).unshift.apply(e,h(r.dynamicTabs)),r.query.key?r.initWithoutFlow():r.query.busiKey?r.initNowNode(a.query.busiKey):r.$message.error("流程异常，请联系管理员！")}}));case 11:this.onEndLoading();case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),sortNode:function(t,e){var r=e[e.length-1];if(r&&r.outgoing&&r.outgoing.length>0){var a="";r.outgoing.length>1?r.outgoing.forEach((function(e){var r=t.find((function(t){return t.resourceId===e.resourceId}));if(r.properties){var n=(r.properties.conditionsequenceflow+"").replaceAll(" ","");"${flow==1}"!==n&&-1===n.indexOf("1")||(a=r.outgoing[0].resourceId)}})):a=r.outgoing[0].resourceId;var n=t.find((function(t){return t.resourceId===a}));n&&(e.push(n),this.sortNode(t,e))}},initWithoutFlow:function(){for(var t,e=this,r=this,a=0;a<r.elementsArr.length;a++){if(r.query.key==r.elementsArr[a].value){t=a;break}t=0}var n=this.url.getByIdUrl;this.query.planFlag&&(n=this.url.getByIdUrlPlan),this.isDoing=!1,this.onStartLoading(),"05"!==this.query.baseType&&Object(i["e"])(this.url.getNowNode+"/"+this.query.busiKey,"",{"tenant-id":this.query.sysOrgCode}).then((function(t){t.success&&t.result&&(e.nowNodeInfo=t.result,e.isDoing=!0),e.onEndLoading()})),this.onEndLoading(),this.onStartLoading(),Object(i["e"])(n,{id:this.query.id}).then((function(a){a.success&&a.result&&(e.mainData=a.result),e.elementsArr.forEach((function(t){"c"==t.value&&"04"==e.mainData.baseType&&(t.isShow=!1),9==e.mainData.state||8==e.mainData.state?("b"!=t.value&&"c"!=t.value||(t.disabled=!0),"c"==t.value&&"04"==e.mainData.baseType&&e.$nextTick((function(){t.isShow=!1}))):"5"==e.mainData.state&&("b"!=t.value&&"c"!=t.value&&"e"!=t.value||(t.disabled=!0))})),r.fixCom=r.elementsArr[t],e.status=5,"05"==r.mainData.baseType&&"9"==r.mainData.state?e.isDetail=!1:e.isDetail=!0,e.elementsArr[t].isShow=!0,e.current=t,e.updateIsDoing(e.elementsArr[t].resourceId),e.onEndLoading()}))},init:function(){var t=x(w().mark((function t(e,r){var a=this;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.isUpload=!1,this.tableId="",this.visible=!0,this.loadingNum=1,Object(i["e"])(this.url.getMatterByCode,{code:e,id:r.id}).then(function(){var t=x(w().mark((function t(e){var n;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.success||!e.result){t.next=17;break}if(e.result.workflowCode&&(a.startFlowFlag=!0),n={},!r||!r.id){t.next=12;break}if(a.tableId=r.id,!e.result.getByIdUrl){t.next=10;break}return a.onStartLoading(),t.next=9,Object(i["e"])(e.result.getByIdUrl,{id:r.id},{"tenant-id":a.query.sysOrgCode}).then((function(t){t.success&&t.result&&(n=t.result,a.startFlowFlag&&!n.preTrialBusinessKey&&n.preTrialComment?a.showCommentContent=n.preTrialComment:a.startFlowFlag&&n.preTrialBusinessKey&&""!==n.preTrialBusinessKey?(a.isDetail=!0,a.showHistory=!0,a.$message.info("请完成预审流程后继续办理"),a.$nextTick((function(){a.$refs.WorkFlowHistory.title="预审流程进度",a.$refs.WorkFlowHistory.getHistory(n.preTrialBusinessKey,!0)}))):a.startFlowFlag&&8==n.state?(a.isDetail=!0,a.$message.info("请完成维修审核流程后继续办理")):5!=n.state&&6!=n.state&&"N"!=n.state&&"X"!=n.state||(a.isDetail=!0),a.elementsArr.find((function(t){"c"==t.value&&"04"==n.baseType&&(t.isShow=!1)})),9!=n.state&&8!=n.state||a.elementsArr.find((function(t){"b"!=t.value&&"c"!=t.value||(t.disabled=!0),"c"==t.value&&"04"==n.baseType&&a.$nextTick((function(){t.isShow=!1}))})),n.businessKey=n.businessKey?n.businessKey:e.result.workflowCode+"."+r.id)}));case 9:a.onEndLoading();case 10:t.next=13;break;case 12:n=r||{};case 13:a.mainData=n,a.$nextTick((function(){a.comData=e.result;for(var t=0;a.comData.comMatterDetailList&&a.comData.comMatterDetailList.length>0&&t<a.comData.comMatterDetailList.length;t++){var o=a.comData.comMatterDetailList[t],s={};if(o.comVar&&""!==o.comVar&&(s=JSON.parse(o.comVar),o.tmpParameters=s),s.workFlowName&&""!==s.workFlowName?0===a.status||r.state&&"1"===r.state&&a.isDetail?(a.comData.comMatterDetailList.splice(t,1),t--):(1!==a.status||e.result.comMap.includes(s.workFlowName))&&(2!==a.status&&3!==a.status||-1!==(a.workFlowRecord.editUrl+"").indexOf(s.workFlowName))||(a.comData.comMatterDetailList.splice(t,1),t--):!s.onlyEditPage||0===a.status||1===a.status&&"0"===r.state||(a.comData.comMatterDetailList.splice(t,1),t--),s.hideState&&(a.comData.comMatterDetailList.splice(t,1),t--),s.workFlowName&&""!==s.workFlowName&&-1!==(a.workFlowRecord.editUrl+"").indexOf("!"+s.workFlowName)?o.isDetail=!1:o.isDetail=s.isDetail,delete s.isDetail,s.workFlowName&&""!==s.workFlowName&&-1!==(a.workFlowRecord.editUrl+"").indexOf(s.workFlowName+"."))for(var c=(a.workFlowRecord.editUrl+"").split(","),l=0;c&&c.length>0&&l<c.length;l++)if(-1!==(c[l]+"").indexOf(s.workFlowName+".")){var u=(c[l]+"").substring((c[l]+"").indexOf(".")+1,(c[l]+"").indexOf("=")),d=(c[l]+"").substring((c[l]+"").indexOf("=")+1,(c[l]+"").length);u&&""!==u&&("isDetail"===u?o.isDetail="true"===d||"false"!==d&&d:"position"===u?o.comPosition=d:s[u]="true"===d||"false"!==d&&d)}}a.$nextTick((function(){for(var t=function(){var t=a.comData.comMatterDetailList[e];if(t.tmpParameters)for(var r=Object.keys(t.tmpParameters),n=0;a.$refs[t.comPath+t.sort]&&r&&r.length>0&&n<r.length;n++)a.$refs[t.comPath+t.sort][0][r[n]]=t.tmpParameters[r[n]];t.slotDynamicCode&&""!==t.slotDynamicCode&&(t.refreshState=!1,t.widgetFormPreview="",t.dataStructureId="",t.formModal={},t.dataFormId=t.slotDynamicCode,t.tpFormInfo={},Object(i["e"])(a.url.queryStructureId,{code:t.dataFormId}).then((function(e){if(e.success&&(t.refreshState=!0,t.tpFormInfo=e.result.tpFormInfo,t.widgetFormPreview=JSON.parse(e.result.formStructure),a.tableId)){var r={code:t.dataFormId,planId:a.tableId};Object(i["e"])(a.url.queryDataStructureByCode,r).then((function(e){e.success&&(t.dataStructureId=e.result.id,t.formModal=JSON.parse(e.result.dataStructure))}))}})));try{a.$refs[t.comPath+t.sort][0].initData(t.sort)}catch(o){}a.$forceUpdate()},e=0;a.comData.comMatterDetailList&&a.comData.comMatterDetailList.length>0&&e<a.comData.comMatterDetailList.length;e++)t();a.$refs.WorkFlowHistory&&a.$refs.WorkFlowHistory.initData(n),a.loadingNum=0}))})),t.next=18;break;case 17:a.$message.warn("事项加载失败，请稍后重试");case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}(),onTakeBack:function(){var t=this;this.loadingNum=1,this.$refs.TakeBackInformation.checkData().then((function(e){var r=t.tmpData;r.takeBackReason=e.data.takeBackReason,r.sign=e.data.sign,r.taskId=t.taskId,Object(i["l"])("/zlbt/takeBack/saveTakeBack",r).then((function(e){e.success?(t.$message.success(e.message),t.handleCancel(),t.$emit("ok")):(t.loadingNum=0,t.$message.warning(e.message))})).catch((function(e){t.loadingNum=0}))}))},onStartLoading:function(){this.loadingNum++},onEndLoading:function(){this.loadingNum--,this.loadingNum<0&&(this.loadingNum=0)},handleOk:function(){var t=x(w().mark((function t(e){var r,a,n,o,s,c,l,d;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=this,r.loadingNum=1,a=w().mark((function t(){var a,n;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=!0,n=r.comData.comMatterDetailList[o],!(r.$refs[n.comPath+n.sort]&&r.$refs[n.comPath+n.sort].length>0&&"function"===typeof r.$refs[n.comPath+n.sort][0].checkData)){t.next=8;break}return t.next=5,r.$refs[n.comPath+n.sort][0].checkData(e).then((function(){})).catch((function(t){r.$refs[n.comPath+n.sort][0].$el.scrollIntoView({block:"center",behavior:"smooth"}),a=!1}));case 5:if(a){t.next=8;break}return r.loadingNum=0,t.abrupt("return",{v:!1});case 8:case"end":return t.stop()}}),t)})),o=0;case 4:if(!(r.comData.comMatterDetailList&&r.comData.comMatterDetailList.length>0&&o<r.comData.comMatterDetailList.length)){t.next=12;break}return t.delegateYield(a(),"t0",6);case 6:if(n=t.t0,!n){t.next=9;break}return t.abrupt("return",n.v);case 9:o++,t.next=4;break;case 12:if(s=!0,3!==r.status){t.next=18;break}return t.next=16,r.onApproval(1,"编辑完成").catch((function(t){s=!1}));case 16:t.next=48;break;case 18:if(r.mainData.isSubmit=e?"1":"0",r.isUpload&&(r.mainData.saveFlag="1"),r.mainData.matterCode=r.comData.matterCode,!r.mainData.id){t.next=46;break}if(c={headers:{"X-Access-Token":u["default"].ls.get("Access-Token"),"tenant-id":r.query.sysOrgCode,sourceName:u["default"].ls.get("SOURCE_NAME"),redisIndex:u["default"].ls.get("REDIS_INDEX")}},!this.mainData.baseType||"05"!=this.mainData.baseType){t.next=42;break}if(this.mainData.basicFlag=!0,this.mainData.isSubmit="1","0"!=this.mainData.publicFlag){t.next=33;break}if(l=this.mainData.publicList.reduce((function(t,e){return t+Number(e.publicCorpAmount)}),0),l===Number(this.mainData.budgetCost)){t.next=31;break}return r.loadingNum=0,t.abrupt("return",this.$message.error("请检查预算总额是否与公房单位金额总和一致!"));case 31:t.next=38;break;case 33:if("2"!=this.mainData.publicFlag){t.next=38;break}if(d=this.mainData.bldSelectedList.reduce((function(t,e){return t+Number(e.publicBldAmount)}),0),d===Number(this.mainData.budgetCost)){t.next=38;break}return r.loadingNum=0,t.abrupt("return",this.$message.error("请检查预算总额是否与已选自然幢金额总和一致!"));case 38:return t.next=40,axios.post(window._CONFIG["domianURL"]+this.url.addProjForPublicUrl,r.mainData,c).then((function(t){t.data.success?(r.startFlowFlag?r.$message.success(t.message||"操作成功"):r.$message.success("操作成功"),r.startFlowFlag||r.initData(r.elementsArr[r.current].value,{id:r.query.id},!0)):(r.$message.error(t.data.message),s=!1)}));case 40:t.next=44;break;case 42:return t.next=44,axios.put(window._CONFIG["domianURL"]+r.comData.editUrl,r.mainData,c).then((function(t){t.data.success?(r.startFlowFlag?r.$message.success(t.message||"操作成功"):r.$message.success("操作成功"),r.startFlowFlag||r.initData(r.elementsArr[r.current].value,{id:r.query.id},!0)):(r.$message.error(t.data.message),s=!1)}));case 44:t.next=48;break;case 46:return t.next=48,Object(i["j"])(r.comData.addUrl,r.mainData).then((function(t){t.success?(r.$message.success("操作成功"),r.initData(r.elementsArr[r.current].value,{id:r.query.id},!0)):(r.$message.error(t.message),s=!1)}));case 48:if(s){t.next=51;break}return r.loadingNum=0,t.abrupt("return",!1);case 51:r.visible=!1,r.loadingNum=0,r.$emit("ok"),r.startFlowFlag?(this.closeCurrentPage(),r.$route.params&&r.$route.params._FromRoute&&r.$router.replace({path:r.$route.params._FromRoute.path})):r.$nextTick((function(){r.routeReloadPage(!0)}));case 55:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),revokeNode:function(t){var e=this;7==this.mainData.state?this.$confirm({title:"目前项目已经完成审核，若要撤回到上一节点，需要发起项目审核撤销申请，是否发起申请",content:"",okText:"是",cancelText:"否",onOk:function(){var t=e.mainData.describe+"_项目审核撤销",r=Object.assign({},{projNo:e.mainData.code,id:e.mainData.reqId,reqDescribe:t,reqNo:e.mainData.reqNo});e.$refs.prbm.title=t,e.$refs.prbm.initViews(r)},onCancel:function(){}}):this.$confirm({title:t?"是否撤回到上一步节点?":"驳回将会回到上一节点，是否确认驳回？",content:"",okText:"确认",cancelText:"取消",onOk:function(){return new Promise(function(){var t=x(w().mark((function t(r){var a,n,i,o,s,c,l;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=w().mark((function t(){var a,n;return w().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=!0,n=e.comData.comMatterDetailList[i],!e.$refs[n.comPath+n.sort]||"function"!==typeof e.$refs[n.comPath+n.sort][0].revocation){t.next=8;break}return t.next=5,e.$refs[n.comPath+n.sort][0].revocation().then((function(){})).catch((function(t){e.$refs[n.comPath+n.sort][0].$el.scrollIntoView({block:"center",behavior:"smooth"}),a=!1}));case 5:if(a){t.next=8;break}return r(),t.abrupt("return",{v:!1});case 8:case"end":return t.stop()}}),t)})),i=0;case 2:if(!(e.comData.comMatterDetailList&&e.comData.comMatterDetailList.length>0&&i<e.comData.comMatterDetailList.length)){t.next=10;break}return t.delegateYield(a(),"t0",4);case 4:if(n=t.t0,!n){t.next=7;break}return t.abrupt("return",n.v);case 7:i++,t.next=2;break;case 10:e.loadingNum++,o=e.nowNodeInfo,s=o.id,c=o.lastTaskId,l={headers:{"X-Access-Token":u["default"].ls.get("Access-Token"),"tenant-id":e.$route_query.sysOrgCode,sourceName:u["default"].ls.get("SOURCE_NAME"),redisIndex:u["default"].ls.get("REDIS_INDEX")}},null!=e.mainData.beforeExamine&&""!==e.mainData.beforeExamine||(e.mainData.beforeExamine={}),axios.post(window._CONFIG["domianURL"]+"/use/serviceProj/backToLastTask/".concat(s,"/").concat(c),e.mainData.beforeExamine,l).then((function(t){t.data.success?(e.$message.success("撤回成功"),e.routeReloadPage(!0)):(e.loadingNum=0,e.$message.warning(t.data.message))})).then((function(){r()}));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onCancel:function(){}})},buildData:function(t,e){if(t&&t.data)if(t.path&&""!==t.path){var r=t.path.split("."),a=e;if(r.length>1)for(var n=0;n<r.length-1;n++)a[r[n]]||(a[r[n]]={}),a=a[r[n]];a[r[r.length-1]]&&Array.isArray(a[r[r.length-1]])?a[r[r.length-1]].concat(t.data):a[r[r.length-1]]?a[r[r.length-1]]=Object.assign(a[r[r.length-1]],a[r[r.length-1]]):a[r[r.length-1]]=t.data}else for(var i=Object.keys(t.data),o=0;i&&i.length>0&&o<i.length;o++)if(e[i[o]]&&Array.isArray(e[i[o]]))for(var s=0;s<t.data[i[o]].length;s++)t.data[i[o]][s]&&-1===e[i[o]].indexOf(t.data[i[o]][s])&&e[i[o]].push(t.data[i[o]][s]);else e[i[o]]=t.data[i[o]]},onApproval:function(t,e){var r=this;return new Promise(function(){var a=x(w().mark((function a(n,o){var s,c,l,u,d;return w().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r.approvalFunction){a.next=5;break}return a.next=3,r.approvalFunction(t,e);case 3:return n(),a.abrupt("return");case 5:if(s=!0,r.tableId&&""!==r.tableId){a.next=10;break}return r.$message.warning("没有工作流任务ID"),o(),a.abrupt("return",!1);case 10:if(t+="",""===t&&(t="1"),!(r.getComList("0").length>0)){a.next=31;break}c=w().mark((function e(){var a,n;return w().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=!0,n=r.getComList("0")[u],"1"!==t){e.next=7;break}if(!r.$refs[n.comPath+n.sort]||"function"!==typeof r.$refs[n.comPath+n.sort][0].checkPass){e.next=7;break}if(r.$refs[n.comPath+n.sort][0].checkPass()){e.next=7;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 7:if("function"!==typeof r.$refs[n.comPath+n.sort][0].checkData){e.next=13;break}return e.next=10,r.$refs[n.comPath+n.sort][0].checkData().then((function(){})).catch((function(t){a=!1}));case 10:if(a){e.next=13;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 13:case"end":return e.stop()}}),e)})),u=0;case 15:if(!(u<r.getComList("0").length)){a.next=23;break}return a.delegateYield(c(),"t0",17);case 17:if(l=a.t0,!l){a.next=20;break}return a.abrupt("return",l.v);case 20:u++,a.next=15;break;case 23:return r.mainData.saveFlag="1",r.mainData.state=t,r.mainData.workflowNode=r.workFlowRecord?r.workFlowRecord.name:"",a.next=28,Object(i["l"])(r.comData.editUrl,r.mainData).then((function(t){t.success||(r.$message.error(t.msg),s=!1)}));case 28:if(s){a.next=31;break}return r.loadingNum=0,a.abrupt("return",!1);case 31:return r.loadingNum=1,d=btoa(encodeURIComponent(e&&""!==e?e:"审批通过")),a.next=35,Object(i["j"])("/handle/task/complete/"+r.taskId+"/"+t+"/"+d+"/0/0/0/0",r.workFlowVariable).then((function(t){t.success?(r.$emit("ok"),r.$message.success("操作成功"),n(),r.handleCancel()):(r.loadingNum=0,r.$message.warning("操作失败"),o())}));case 35:case"end":return a.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}())},onEditOk:function(t,e){var r=this;return new Promise(function(){var a=x(w().mark((function a(n,o){var s,c,l,u,d,f;return w().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=!0,r.tableId&&""!==r.tableId){a.next=5;break}return r.$message.warning("没有工作流任务ID"),o(),a.abrupt("return",!1);case 5:if(t+="",""===t&&(t="1"),c=[].concat(r.getComList("1")).concat(r.getComList("2")),!(c.length>0)){a.next=28;break}l=w().mark((function e(){var a,n;return w().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=!0,n=c[d],"1"!==t){e.next=7;break}if(!r.$refs[n.comPath+n.sort]||"function"!==typeof r.$refs[n.comPath+n.sort][0].checkPass){e.next=7;break}if(r.$refs[n.comPath+n.sort][0].checkPass()){e.next=7;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 7:if("function"!==typeof r.$refs[n.comPath+n.sort][0].checkData){e.next=13;break}return e.next=10,r.$refs[n.comPath+n.sort][0].checkData().then((function(){})).catch((function(t){a=!1}));case 10:if(a){e.next=13;break}return r.loadingNum=0,e.abrupt("return",{v:!1});case 13:case"end":return e.stop()}}),e)})),d=0;case 11:if(!(d<c.length)){a.next=19;break}return a.delegateYield(l(),"t0",13);case 13:if(u=a.t0,!u){a.next=16;break}return a.abrupt("return",u.v);case 16:d++,a.next=11;break;case 19:return r.mainData.saveFlag="1",r.mainData.state=t,r.mainData.workflowNode=r.workFlowRecord?r.workFlowRecord.name:"",r.mainData.matterCode=r.comData.matterCode,a.next=25,Object(i["l"])(r.comData.editUrl,r.mainData).then((function(t){t.success||(r.$message.error(t.msg),s=!1)}));case 25:if(s){a.next=28;break}return r.loadingNum=0,a.abrupt("return",!1);case 28:return r.loadingNum=1,f=btoa(encodeURIComponent(e&&""!==e?e:"审批通过")),a.next=32,Object(i["j"])("/handle/task/complete/"+r.taskId+"/"+t+"/"+f+"/0/0/0/0",r.workFlowVariable).then((function(t){t.success?(r.$emit("ok"),r.$message.success("操作成功"),n(),r.handleCancel()):(r.loadingNum=0,r.$message.warning("操作失败"),o())}));case 32:case"end":return a.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}())},addParameter:function(t){this.workFlowVariable=Object.assign(this.workFlowVariable,t)},handleCancel:function(){this.currentTab="1",this.loadingNum=0,this.visible=!1,this.businessKey="",this.taskId="",this.tableId="",this.workFlowVariable={},this.status=0},hideFooter:function(t){this.childControlFlag=t},updateProInfo:function(t){this.mainData=t},getStatusText:function(){switch(this.status){case 0:return"编辑";case 1:return"详情";case 2:return"审核";case 3:return"修改";case 4:return"取回";default:return""}},proRollBack:function(){this.$message.success("已发起项目审核撤销流程"),this.closeCurrent()}}},T=P,I=(r("516b"),r("2877")),j=Object(I["a"])(T,a,n,!1,null,"4844c63b",null);e["default"]=j.exports},4037:function(t,e,r){},"40d06":function(t,e,r){},"416e":function(t,e,r){"use strict";r("7936")},"41d7":function(t,e,r){"use strict";r("f89d")},"46f2":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[r("div",{staticClass:"content_header"},[r("h4",[t._v(t._s(t.title))]),t.isDetail?t._e():r("a-icon",{staticClass:"cursor-pointer",attrs:{type:"plus-circle"},on:{click:t.openModalFun}})],1),r("div",{staticClass:"content_body"},t._l(t.infoList,(function(e){return r("div",{key:e.id},[r("a-space",{attrs:{size:6}},[r("span",[t._v(t._s(e.supervisionBy))]),r("span",[t._v(t._s(e.supervisionDate))]),r("span",{staticClass:"describe"},[t._v(t._s(e.describe))]),t.isDetail?t._e():r("a-icon",{staticClass:"cursor-pointer",attrs:{type:"edit"},on:{click:function(r){return t.openModalFun(e)}}})],1),r("div",{staticClass:"py-10"},[e.fileManageList&&e.fileManageList.length>0?r("img-list",{attrs:{"img-list":e.fileManageList,"is-detail":!0,size:120}}):t._e(),t._e()],1)],1)})),0),r("a-modal",{attrs:{title:t.modelTitle,destroyOnClose:"",width:"1200px"},on:{cancel:t.closeModalFun,ok:t.add},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("j-form-container",{ref:"formRow",attrs:{rules:t.rules,model:t.model,border:!1,formRef:"formRow"}},[r("a-row",{ref:"formBpSurRow",staticClass:"houseInfo",attrs:{slot:"edit"},slot:"edit"},[r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("监督人")]),r("a-col",{attrs:{span:4,"data-prop":"supervisionBy"}},[r("a-input",{attrs:{placeholder:"请输入监督人"},model:{value:t.model.supervisionBy,callback:function(e){t.$set(t.model,"supervisionBy",e)},expression:"model.supervisionBy"}})],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("监督日期")]),r("a-col",{attrs:{span:4,"data-prop":"supervisionDate"}},[r("a-date-picker",{attrs:{format:"YYYY-MM-DD",placeholder:"请选择监督日期","disabled-date":t.disabledDate},model:{value:t.model.supervisionDate,callback:function(e){t.$set(t.model,"supervisionDate",e)},expression:"model.supervisionDate"}})],1),r("a-col",{attrs:{span:4}}),r("a-col",{attrs:{span:4}}),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("监督描述")]),r("a-col",{attrs:{span:20,"data-prop":"describe"}},[r("a-textarea",{attrs:{autoSize:{minRows:4,maxRows:4},placeholder:"请输入监督描述"},model:{value:t.model.describe,callback:function(e){t.$set(t.model,"describe",e)},expression:"model.describe"}})],1)],1)],1),r("type-attachment-upload",{ref:"fileUpload",attrs:{busiType:"20",busiTypeDetail:"2030","busi-no":t.model.id},on:{change:t.fileChange}})],1)],1)},n=[],i=r("4a12"),o=r("9fbd"),s=r("0fea"),c=r("2b0e"),l=r("c1df"),u=r.n(l),d={},f={components:{TypeAttachmentUpload:o["default"],ImgList:i["default"]},props:{title:{type:String,default:"现场勘察记录"},isDetail:{type:Boolean,default:!0},infoList:{type:Array,default:function(){return[]}},projectId:{type:String,default:function(){return""}}},data:function(){return{visible:!1,model:{supervisionBy:"",supervisionDate:"",describe:"",fileIdList:[]},modelTitle:"新增",url:{getSuperviseInfo:"/use/processSupervision/getBpSurByProjId",add:"/use/processSupervision/saveBpSurInfo"},rules:{supervisionBy:[{required:!0,message:"请输入监督人",trigger:"change"}],supervisionDate:[{required:!0,message:"请选择监督日期",trigger:"change"}],describe:[{required:!0,message:"请输入监督描述",trigger:"change"}]}}},created:function(){d=JSON.parse(JSON.stringify(this.model))},methods:{closeModalFun:function(){this.model=Object.assign({},this.model,d),this.visible=!1},openModalFun:function(t){var e=this;t&&t.id?(this.modelTitle="编辑",this.model=Object.assign({},this.model,JSON.parse(JSON.stringify(t)))):(this.model=Object.assign({},this.model,JSON.parse(JSON.stringify(d))),this.model.supervisionBy=c["default"].ls.get("Login_Userinfo").realname,this.modelTitle="新增"),this.visible=!0,this.$nextTick((function(){e.$refs.fileUpload.initData(!1,e.model.id)}))},add:function(){var t=this;this.checkData()&&(this.model.projId=this.projectId,this.model.fileIdList=this.$refs.fileUpload.fileValue.map((function(t){return t.id})),this.model.state="1",this.model.processStage="01",Object(s["j"])(this.url.add,this.model).then((function(e){e.success&&(t.closeModalFun(),t.$emit("getSuperviseInfo"))})))},fileChange:function(t){},checkData:function(){var t=this.$refs.formRow.validaRowMsg(this.$refs.formBpSurRow);return t.valida},disabledDate:function(t){return t&&t>u()().endOf("day")}}},p=f,h=(r("6b19"),r("a269"),r("2877")),m=Object(h["a"])(p,a,n,!1,null,"f562a208",null);e["default"]=m.exports},4856:function(t,e,r){},4880:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cardContain"},[t.comparProj.comparStart?t._e():[r("j-form-container",{ref:"form",attrs:{rules:t.validatorRules,model:t.model,disabled:!1,formRef:"formOwnRow",border:!1}},[r("a-row",{ref:"formOwnRow",staticClass:"baseInfo houseInfo",attrs:{slot:"edit",type:"flex",justify:"start",align:"middle"},slot:"edit"},[r("a-col",{attrs:{span:2}},[r("span",{staticClass:"required"},[t._v("报价开始时间")])]),r("a-col",{attrs:{span:4,"data-prop":"comparStart"}},[r("a-date-picker",{attrs:{"show-time":{formant:"HH:mm:ss"},valueFormat:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择开始时间"},model:{value:t.model.comparStart,callback:function(e){t.$set(t.model,"comparStart",e)},expression:"model.comparStart"}})],1),r("a-col",{attrs:{span:2}},[r("span",{staticClass:"required"},[t._v("报价结束时间")])]),r("a-col",{attrs:{span:4,"data-prop":"comparEnd"}},[r("a-date-picker",{attrs:{"show-time":{formant:"HH:mm:ss"},valueFormat:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择结束时间"},model:{value:t.model.comparEnd,callback:function(e){t.$set(t.model,"comparEnd",e)},expression:"model.comparEnd"}})],1),r("a-col",{attrs:{span:2}},[r("span",{staticClass:"required",attrs:{title:"<="}},[t._v("期望工期 ")])]),r("a-col",{attrs:{span:4,"data-prop":"expDays"}},[r("amount-input",{attrs:{"addon-after":"天","format-due":"04","minus-flag":!1},model:{value:t.model.expDays,callback:function(e){t.$set(t.model,"expDays",e)},expression:"model.expDays"}})],1),r("a-col",{attrs:{span:2}},[r("span",{staticClass:"required"},[t._v("比选方式")])]),r("a-col",{attrs:{span:4,"data-prop":"configId"}},[r("a-select",{attrs:{placeholder:"请选择比选方式"},model:{value:t.model.configId,callback:function(e){t.$set(t.model,"configId",e)},expression:"model.configId"}},[r("a-select-option",{attrs:{value:void 0}},[t._v("请选择")]),t._l(t.comparTypes,(function(e,a){return r("a-select-option",{key:a,attrs:{value:e.id}},[t._v("\n              "+t._s(e.comparName)+"\n            ")])}))],2)],1),r("a-col",{attrs:{span:2}},[r("span",[t._v("项目维修范围")])]),r("a-col",{attrs:{span:4}},[t._l(t.repairRange,(function(e){return[e.value===t.scope?r("span",[t._v(t._s(e.text))]):t._e()]}))],2)],1)],1),r("a-row",[r("a-col",{staticStyle:{"margin-bottom":"15px"},attrs:{span:12}},[r("div",{staticClass:"cg_button"},[r("a-button",{staticStyle:{"margin-left":"15px"},attrs:{icon:"snippets",type:"primary"},on:{click:t.submit}},[t._v("\n            发布比选公告\n          ")])],1)])],1)],t.comparProj.comparStart?[r("a-row",{staticClass:"baseInfo houseInfo",attrs:{type:"flex",justify:"start",align:"middle"}},[r("a-col",{attrs:{span:2}},[r("span",[t._v("报价开始时间")])]),r("a-col",{attrs:{span:4}},[r("span",[t._v(t._s(t.comparProj.comparStart))])]),r("a-col",{attrs:{span:2}},[r("span",[t._v("报价结束时间")])]),r("a-col",{attrs:{span:4}},[r("span",[t._v(t._s(t.comparProj.comparEnd))])]),r("a-col",{attrs:{span:2}},[r("span",{attrs:{title:"<="}},[t._v("期望工期 ")])]),r("a-col",{attrs:{span:4}},[r("span",[t._v(t._s(t.comparProj.expDays)+" 天")])]),r("a-col",{attrs:{span:2}},[t._v("比选方式")]),r("a-col",{attrs:{span:4}},[t._l(t.comparTypes,(function(e){return[e.id==t.comparProj.configId?[t._v("\n            "+t._s(e.comparName)+"\n          ")]:t._e()]}))],2),r("a-col",{attrs:{span:2}},[r("span",[t._v("项目维修范围")])]),r("a-col",{attrs:{span:4}},[t._l(t.repairRange,(function(e){return[e.value===t.scope?r("span",[t._v(t._s(e.text))]):t._e()]}))],2)],1)]:t._e(),r("div",{staticClass:"fieldSiteInfo"},[t.isRouterAlive?r("supervise-info-collapse",{ref:"infoCollapse",attrs:{scope:t.scope,projFilesList:t.projFilesList},on:{getSuperviseInfo:t.getSuperviseInfo}}):t._e()],1)],2)},n=[],i=r("0fea"),o=r("670e"),s=r("da05"),c=r("290c"),l=r("f64c"),u=r("7c3f"),d=r("4aae"),f=r("d8a5"),p=r("8697");function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function m(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */m=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f="suspendedStart",p="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function _(){}var x={};l(x,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(x=C);var L=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,s){var c=d(t[n],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==h(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(u).then((function(t){l.value=t,o(l)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=f;return function(i,o){if(n===g)throw Error("Generator is already running");if(n===v){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===f)throw n=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=g;var l=d(e,r,a);if("normal"===l.type){if(n=a.done?v:p,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=v,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=d(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(h(e)+" is not iterable")}return w.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,l(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),l(D.prototype,s,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),l(L,c,"Generator"),l(L,o,(function(){return this})),l(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function g(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){g(i,a,n,o,s,"next",t)}function s(t){g(i,a,n,o,s,"throw",t)}o(void 0)}))}}var y={name:"Competerule",components:{ARow:c["a"],ACol:s["b"],message:l["a"],FieldSiteInfoComp:u["default"],AmountInput:d["default"],initDictOptions:f["g"],SuperviseInfoCollapse:p["default"]},mixins:[o["a"]],inject:{projMainData:{default:{}}},props:{scope:{type:String,default:""},comparTypes:[],comparProj:{type:Object,default:function(){return{}}},projectId:{type:String,default:function(){return""}},projectIds:{type:Array,default:function(){return[]}}},data:function(){return{isRouterAlive:!0,projFilesList:[],repairRange:[],validatorRules:{comparStart:[{required:!0,message:"请选择报价开始时间！"},{validator:this.validatorComparStart}],comparEnd:[{required:!0,message:"请选择报价结束时间！"},{validator:this.validatorComparEnd}],configId:[{required:!0,message:"请选择比选方式！"}],expDays:[{required:!0,message:"请设置预计工期！"}]},model:{comparStart:"",comparEnd:""},corpArr:[],url:{updateCompar:"/compare/bComparProj/release",getSuperviseInfo:"/use/processSupervision/getBpSurByProjId"}}},mounted:function(){},created:function(){var t=this;Object(f["g"])("repair_range").then((function(e){e.success&&(t.repairRange=e.result)})),this.getSuperviseInfo()},methods:{reload:function(){this.isRouterAlive=!1,this.$nextTick((function(){this.isRouterAlive=!0}))},getSuperviseInfo:function(){var t=this;Object(i["j"])(this.url.getSuperviseInfo+"/"+this.projectId).then((function(e){e.success?(e.result.forEach((function(t){var e=[];for(var r in t.processSupervision)t.processSupervision[r]&&(e=[].concat(t.processSupervision[r]));t.fileList=e.filter((function(e){return"01"==e.processStage&&"01"==e.processStage&&(!t.aduitTime||e.createTime>t.aduitTime)}))})),t.projFilesList=e.result,t.reload()):t.$message.error("获取现场勘察记录失败！")}))},validatorComparStart:function(t,e,r){this.model.comparEnd&&e>=this.model.comparEnd&&r("比选开始时间必须小于比选结束时间！"),r()},validatorComparEnd:function(t,e,r){this.model.comparEnd&&e<=this.model.comparStart&&r("比选结束时间必须大于比选开始时间！"),r()},valida:function(){var t=this.$refs.form.validaRowMsg(this.$refs.formOwnRow);return t.valida},submit:function(){var t=this;if(this.valida()){this.projectIds=[],this.projMainData().children&&this.projMainData().children.length>0?this.projMainData().children.forEach((function(e){t.projectIds.push(e.id)})):this.projectIds.push(this.projMainData().id);var e=this;this.$confirm({content:"请注意,发布后将不可撤销！",onOk:function(){e.model.id=e.comparProj.id,e.model.projectIds=t.projectIds,e.model.pid=t.projectId;var r=e.model;r.corpArr=e.corpArr,Object(i["j"])(e.url.updateCompar,r).then(function(){var r=v(m().mark((function r(a){return m().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!a.success||!a.result||200!==a.code){r.next=8;break}return r.next=3,t.$emit("getComparProj");case 3:e.comparProj.comparState=a.result,e.model={},e.$message.success("发布成功"),r.next=9;break;case 8:e.$message.error("发布失败！");case 9:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())}})}},getCorpCodes:function(t){this.corpArr=t}}},b=y,w=(r("02a5"),r("baea"),r("2877")),_=Object(w["a"])(b,a,n,!1,null,"12aff122",null);e["default"]=_.exports},"49da":function(t,e,r){"use strict";r("bba1")},"4b91":function(t,e,r){},"4c8e":function(t,e,r){},"4e8e":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("j-modal",{attrs:{title:t.title,width:1200,visible:t.visible,maskClosable:!1,switchFullscreen:""},on:{ok:t.handleOk,cancel:t.handleCancel}},[r("com-matter-form",{ref:"realForm",on:{ok:t.submitCallback}})],1)},n=[],i=r("d361"),o={name:"ComMatterModal",components:{ComMatterForm:i["default"]},data:function(){return{title:"",visible:!1,disableSubmit:!1}},methods:{add:function(){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.realForm.add()}))},edit:function(t){var e=this;this.visible=!0,this.$nextTick((function(){e.$refs.realForm.edit(t)}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){this.$refs.realForm.handleOk()},submitCallback:function(){this.$emit("ok"),this.visible=!1},handleCancel:function(){this.close()}}},s=o,c=r("2877"),l=Object(c["a"])(s,a,n,!1,null,"2a4cfa58",null);e["default"]=l.exports},"4f4f":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"corpUploadFileCheck"},[r("div",{staticClass:"checkBody"},[r("content-view",{attrs:{title:"项目信息"}},[r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("项目描述")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projInfo.describe))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("申报小区")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projInfo.communityName))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("项目类型")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.getBaseTypeText(t.projInfo.baseType)))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("分摊方式")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[r("j-d-dict-select-tag",{attrs:{align:"left",dictCode:"allocation_method",readOnly:"",type:"select"},model:{value:t.projInfo.allotMode,callback:function(e){t.$set(t.projInfo,"allotMode",e)},expression:"projInfo.allotMode"}})],1),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("联系人")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projInfo.reqMan))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("联系电话")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projInfo.reqPhone))]),"1"==t.projInfo.comparAble&&"1"!=t.projInfo.hisFlag?[r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("维修范围")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._l(t.repairRange,(function(e,a){return[e.value===t.projInfo.projScope?r("span",{key:"scope"+a},[t._v(t._s(e.text))]):t._e()]}))],2),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("施工单位")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projInfo.biddingCorpName))]),9!=t.projMainData().state?[r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("专项维修资金使用审批表")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[r("a",{on:{click:function(e){return e.stopPropagation(),t.print()}}},[r("a-icon",{attrs:{type:"printer"}}),t._v(" 打印")],1)])]:t._e()]:t._e()],2)],1),r("content-view",{attrs:{title:"附件上传"}},[r("type-attachment-upload",{ref:"fileupload",attrs:{"is-show-header":!1,busiType:"20",busiTypeDetail:"202G","is-load-init-data":!0,busiNo:t.projMainData().id,isDetail:!0,"body-style":{height:"300px"}},on:{change:t.getFileList}})],1),t._v("\n      "+t._s(t.isDoing)+t._s(t.currentNodeInfo.assigneeIdList.includes(t.loginUser.id))+t._s(t.projMainData.state)+"\n      "),!t.isDoing||!t.currentNodeInfo.assigneeIdList.includes(t.loginUser.id)||t.projMainData.state&&"9"!=t.projMainData.state?t._e():r("content-view",{attrs:{title:"审批结果"}},[r("j-form-container",[r("a-form-model",{ref:"formModel",attrs:{slot:"edit",model:t.corpCheck,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol},slot:"edit"},[r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{class:{required:t.isDoing},attrs:{span:4}},[t._v("预审选项")]),r("a-col",{attrs:{span:20}},[r("a-form-model-item",{staticClass:"width-100",attrs:{prop:"flow"}},[r("a-radio-group",{attrs:{disabled:!t.isDoing},model:{value:t.corpCheck.flow,callback:function(e){t.$set(t.corpCheck,"flow",e)},expression:"corpCheck.flow"}},[r("a-radio",{attrs:{value:"1"}},[t._v("通过")]),r("a-radio",{attrs:{value:"0"}},[t._v("驳回")])],1)],1)],1)],1)],1)],1)],1)],1),t.isDoing?r("div",{staticClass:"checkFooter"},[!t.isDoing||!t.currentNodeInfo.assigneeIdList.includes(t.loginUser.id)||t.projMainData.state&&"9"!=t.projMainData.state?t._e():r("a-button",{attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("保存")])],1):t._e(),r("print-report-comp",{ref:"print"})],1)},n=[],i=r("9fbd"),o=r("dc9a"),s=r("7d9a"),c=r("c681"),l=r("eccd"),u=r("0c8a"),d=r("d8a5"),f=r("6d5b"),p=r("2b0e"),h=(r("c1df"),r("0fea")),m=r("9bed"),g={name:"CorpUploadFileCheck",components:{PrintReportComp:m["default"],ShareDetailComp:f["default"],JDDictSelectTag:l["default"],JDictRadioButton:s["default"],ContentView:o["default"],TypeAttachmentUpload:i["default"],JFormContainer:c["default"]},inject:{projMainData:{default:function(){}},nowNodeInfo:{default:function(){}},newEditModal:{default:function(){}},routeReload:{default:function(){}}},props:{isDoing:{type:Boolean,default:!1}},data:function(){return{loginUser:p["default"].ls.get("Login_Userinfo"),option:[{label:"同意",value:"1"},{label:"不同意",value:"3"},{label:"打回",value:"0"}],showModel:!0,formPage:"",doneFlag:!1,repairRange:[],corpCheck:{},rules:{flow:[{required:!0,message:"请选择预审选项！"}],advice:[{required:!0,message:"请输入预审意见！"}]},labelCol:{span:0},wrapperCol:{span:24},corpBaseType:""}},computed:{projInfo:function(){try{return this.projMainData()||{}}catch(t){return{}}},_editModal:function(){try{return this.newEditModal()}catch(t){return{}}},currentNodeInfo:function(){try{return this.nowNodeInfo()}catch(t){return{}}},routeReloadPage:function(){return this.routeReload}},created:function(){var t=this;this.$emit("hide-footer",!1),this.$nextTick((function(){t.$refs.fileupload.initData()})),Object(d["g"])("repair_range").then((function(e){e.success&&(t.repairRange=e.result)})),this.getLoginCorpInfo()},methods:{print:function(){var t=this.projMainData().id;this.$refs.print.type="print",this.$refs.print.print("use_check",{projId:t})},getBaseTypeText:u["getBaseTypeText"],onChange:function(t){t&&(this.projInfo.flag=t,1===this.projInfo.flag||"1"===this.projInfo.flag?this.projInfo.comment="同意":3===this.projInfo.flag||"3"===this.projInfo.flag?this.projInfo.comment="不同意":0!==this.projInfo.flag&&"0"!==this.projInfo.flag||(this.projInfo.comment="打回"))},getFileList:function(t){if(this.fileIdList=[],t){var e=this;t.forEach((function(t){e.fileIdList.push(t.id)}))}},handleOk:function(){var t=this;this.$refs.formModel.validate().then((function(e){"1"===t.corpCheck.flow?t._editModal.handleOk("1"):"0"===t.corpCheck.flow&&t.$confirm({title:"是否确认驳回？",onOk:function(){t.$store.commit("SET_PAGE_LOAD_STATE",{state:!0});var e=t.nowNodeInfo(),r=e.id,a=e.lastTaskId;Object(h["j"])("/use/serviceProj/backToLastTask/".concat(r,"/").concat(a),{}).then((function(e){e.success?(t.$message.success("驳回成功"),t.routeReloadPage(!0)):(t.loadingNum=0,t.$message.warning(e.message))})).finally((function(){t.$store.commit("SET_PAGE_LOAD_STATE",{state:!1})}))},onCancel:function(){}})}))},getLoginCorpInfo:function(){var t=p["default"].ls.get("Login_CorpInfo");t&&"03"==t.baseType&&(this.corpBaseType="03")}}},v=g,y=(r("e6ca"),r("2877")),b=Object(y["a"])(v,a,n,!1,null,"7269e8c3",null);e["default"]=b.exports},"50ba":function(t,e,r){"use strict";r("8f5f")},"50c3":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{attrs:{bordered:!1}},[r("m-e-s-super-query",{attrs:{fieldList:t.queryObj,saveCode:t.fileName,type:"queryList"},on:{ok:t.handleSuperQuery}}),r("div",[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,checkbox:!0,"show-pagination":!1,"tree-config":{children:"children",indent:"60"},selectChangeEvent:t.selectChangeEvent,"select-all-event":t.selectAllEvent,expand:!1,data:t.loadData,tableColumn:t.columns},scopedSlots:t._u([{key:"buttons",fn:function(){return[r("div",{staticClass:"vxetable-operator"},[r("a-button",{attrs:{icon:"plus",type:"primary"},on:{click:t.handleAdd}},[t._v("新建")]),t.selectedRowKeys.length>0?r("a-dropdown",[r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",{key:"1",on:{click:t.batchDel}},[r("a-icon",{attrs:{type:"delete"}}),t._v("删除")],1)],1),r("a-button",{staticStyle:{"margin-left":"8px"}},[t._v(" 批量操作 "),r("a-icon",{attrs:{type:"down"}})],1)],1):t._e()],1)]},proxy:!0},{key:"weight",fn:function(e){var a=e.text,n=e.row;return[n.parentId?r("span",[t._v("\n          "+t._s(a)+"%\n        ")]):t._e()]}},{key:"targetName",fn:function(e){var r=e.text;e.row;return[t._l(t.compositeComparDict,(function(e){return[e.value===r?[t._v("\n            "+t._s(e.text)+"\n          ")]:t._e()]}))]}},{key:"sysOrgCode",fn:function(e){e.text;var a=e.row;return[r("div",[t._v(t._s(a.sysOrgCode))])]}},{key:"utilityIds",fn:function(e){e.text;var r=e.row;return[t._v("\n        "+t._s(t.getUtilityNameByIds(r.utilityIds))+"\n      ")]}},{key:"action",fn:function(e){e.text;var a=e.row;return[a.parentId?t._e():r("div",[r("a",{on:{click:function(e){return t.handleEdit(a)}}},[r("a-icon",{attrs:{type:"edit"}}),t._v(" 编辑")],1),r("a-divider",{attrs:{type:"vertical"}}),r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.handleDelete(a.id)}}},[r("a",[r("a-icon",{attrs:{type:"delete"}}),t._v(" 删除")],1)]),r("span",[r("a-divider",{attrs:{type:"vertical"}}),r("a",{on:{click:function(e){return t.addChild(a)}}},[r("a-icon",{attrs:{type:"plus-square"}}),t._v(" 配置子级")],1)],1)],1)]}}])})],1),r("b-compar-config-modal",{ref:"modalForm",on:{ok:t.modalFormOk}}),r("b-compar-config-child-modal",{ref:"addChildsForm",on:{ok:t.addChildsFormOk,cancel:t.handleCancel}})],1)},n=[],i=r("b65a"),o=(r("6eb7"),r("0fea")),s=r("ac0d"),c=r("0a5e"),l=r("6fa9"),u=r("d8a5"),d=r("165b"),f=r("70b7"),p=r("02bd"),h={name:"BComparConfigList",mixins:[c["a"],s["b"],d["BatchChange"],i["a"]],components:{BComparConfigModal:f["default"],MESSuperQuery:l["default"],BComparConfigChildModal:p["default"]},data:function(){return{visible:!1,utilityList:[],compositeComparDict:[],comparTypeDict:[],fileName:"BComparConfigList",description:"b_compar_config管理页面",queryObj:[{type:"input",value:"comparName",label:"比选名称"},{type:"input",value:"targetName",label:"指标名称"},{type:"input",value:"remark",label:"备注"}],columns:[{title:"比选名称",align:"center",field:"comparName",treeNode:!0},{title:"指标名称",align:"center",field:"targetName",width:150,slot:!0},{title:"权重",align:"center",field:"weight",slot:!0},{title:"备注",align:"center",field:"remark"},{title:"主管单位",align:"center",field:"sysOrgCode",slot:!0},{title:"设施设备",align:"center",field:"utilityIds",slot:!0},{title:"操作",field:"action",align:"center",fixed:"right",width:240,slot:!0}],url:{list:"/compare/bComparConfig/queryList",delete:"/compare/bComparConfig/delete",deleteBatch:"/compare/bComparConfig/deleteBatch",getUtilityList:"/business/utility/getUtilityList"},dictOptions:{}}},created:function(){this.initDictData()},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)}},methods:{getUtilityNameByIds:function(t){var e=this;if(null==t||""===t)return"";var r=[],a=t.split(",");return a.forEach((function(t){e.utilityList.forEach((function(e){e.value===t&&r.push(e.label)}))})),r.toString()},initDictData:function(){var t=this;Object(u["g"])("compar_type").then((function(e){t.comparTypeDict=e.result})),Object(u["g"])("composite_compar").then((function(e){t.compositeComparDict=e.result})),this.getUtilityList()},addChild:function(t){this.$refs.addChildsForm.title="配置子级",this.$refs.addChildsForm.visible=!0,this.$refs.addChildsForm.edit(t.children,t.id)},addChildsFormOk:function(){this.queryPage()},getUtilityList:function(){var t=this;Object(o["e"])(this.url.getUtilityList).then((function(e){e.success&&e.result.forEach((function(e){t.utilityList.push({label:e.utilityName,value:e.id})}))}))}}},m=h,g=(r("5ca2"),r("2877")),v=Object(g["a"])(m,a,n,!1,null,"266a81e3",null);e["default"]=v.exports},"50fe":function(t,e,r){},"516b":function(t,e,r){"use strict";r("1a8a")},"579c":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-row",{attrs:{gutter:10}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-card",{attrs:{bordered:!1}},[r("a-row",{staticStyle:{"margin-left":"14px"}},[r("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleAdd(2)}}},[t._v("添加子级")]),r("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleAdd(1)}}},[t._v("添加一级")]),r("a-button",{attrs:{title:"删除多条数据",type:"default"},on:{click:t.batchDel}},[t._v("批量删除")])],1),r("div",{staticStyle:{background:"#fff","padding-left":"16px",height:"100%","margin-top":"5px"}},[r("a-alert",{staticClass:"alertInfo",attrs:{type:"info",showIcon:!0}},[r("span",{attrs:{slot:"message"},slot:"message"},[t._v("\n            当前选择："),this.currSelected.title?r("span",[t._v(t._s(t.getCurrSelectedTitle()))]):t._e(),this.currSelected.title?r("a",{staticStyle:{"margin-left":"10px"},on:{click:t.onClearSelected}},[t._v("取消选择")]):t._e()])]),r("a-input-search",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{placeholder:"请输入名称"},on:{search:t.onSearch}}),r("a-col",{attrs:{md:10,sm:24}},[[r("a-dropdown",{attrs:{trigger:[this.dropTrigger]},on:{visibleChange:t.dropStatus}},[r("span",{staticStyle:{"user-select":"none"}},[r("a-tree",{attrs:{selectedKeys:t.selectedKeys,checkedKeys:t.checkedKeys,treeData:t.departTree,checkStrictly:t.checkStrictly,expandedKeys:t.iExpandedKeys,autoExpandParent:t.autoExpandParent,checkable:"true"},on:{select:t.onSelect,check:t.onCheck,rightClick:t.rightHandle,expand:t.onExpand}})],1),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",{key:"1",on:{click:function(e){return t.handleAdd(3)}}},[t._v("添加")]),r("a-menu-item",{key:"2",on:{click:t.handleDelete}},[t._v("删除")]),r("a-menu-item",{key:"3",on:{click:t.closeDrop}},[t._v("取消")])],1)],1)]],2)],1)],1),r("div",{staticClass:"drawer-bootom-button"},[r("a-dropdown",{attrs:{trigger:["click"],placement:"topCenter"}},[r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",{key:"1",on:{click:function(e){return t.switchCheckStrictly(1)}}},[t._v("父子关联")]),r("a-menu-item",{key:"2",on:{click:function(e){return t.switchCheckStrictly(2)}}},[t._v("取消关联")]),r("a-menu-item",{key:"3",on:{click:t.checkALL}},[t._v("全部勾选")]),r("a-menu-item",{key:"4",on:{click:t.cancelCheckALL}},[t._v("取消全选")]),r("a-menu-item",{key:"5",on:{click:t.expandAll}},[t._v("展开所有")]),r("a-menu-item",{key:"6",on:{click:t.closeAll}},[t._v("合并所有")])],1),r("a-button",[t._v("\n          树操作 "),r("a-icon",{attrs:{type:"up"}})],1)],1)],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-card",{attrs:{bordered:!1}},[r("a-form",{attrs:{form:t.form,colon:!1}},[r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"上一级"}},[r("a-tree-select",{staticStyle:{width:"100%"},attrs:{dropdownStyle:{maxHeight:"200px",overflow:"auto"},treeData:t.treeData,disabled:t.disable,showArrow:t.showArrow,placeholder:"无"},model:{value:t.model.parentId,callback:function(e){t.$set(t.model,"parentId",e)},expression:"model.parentId"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["typeName",t.validatorRules.typeName],expression:"['typeName', validatorRules.typeName ]"}],attrs:{placeholder:"请输入栏目名称"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"编码"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["typeNum",t.validatorRules.typeNum],expression:"['typeNum', validatorRules.typeNum ]"}],attrs:{placeholder:"请输入栏目编码"}})],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"是否显示"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["isShow",{}],expression:"['isShow', {}]"}],attrs:{placeholder:"请选择是否显示",defaultValue:"Y"}},[r("a-select-option",{attrs:{value:"Y"}},[t._v("显示")]),r("a-select-option",{attrs:{value:"N"}},[t._v("不显示")])],1)],1),r("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"排序"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["orderNum",{}],expression:"[ 'orderNum', {}]"}],staticStyle:{width:"100%"},attrs:{max:999999999,precision:0,min:"0",placeholder:"请输入排序序号"}})],1)],1),r("div",{staticClass:"anty-form-btn"},[r("a-button",{attrs:{type:"default",htmlType:"button",icon:"sync"},on:{click:t.emptyCurrForm}},[t._v("重置")]),r("a-button",{attrs:{type:"primary",htmlType:"button",icon:"form"},on:{click:t.submitCurrForm}},[t._v("修改并保存")])],1)],1),r("add-modal",{ref:"addModal",attrs:{info:t.type,treeData:t.treeData},on:{ok:t.loadTree}})],1)],1)},n=[],i=r("88bc"),o=r.n(i),s=r("4ec3"),c=r("0fea"),l=r("b65a"),u=r("532b"),d={name:"LMGLList",mixins:[l["a"]],components:{AddModal:u["default"]},data:function(){return{iExpandedKeys:[],loading:!1,autoExpandParent:!0,currFlowId:"",currFlowName:"",disable:!0,showArrow:!1,treeData:[],visible:!1,departTree:[],rightClickSelectedKey:"",hiding:!0,model:{},dropTrigger:"",depart:{},disableSubmit:!1,checkedKeys:[],selectedKeys:[],autoIncr:1,currSelected:{},allTreeKeys:[],checkStrictly:!0,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},graphDatasource:{nodes:[],edges:[]},validatorRules:{typeName:{rules:[{required:!0,message:"请输入栏目名称!"}]},typeNum:{rules:[{required:!0,message:"请输入栏目编码!"},{validator:this.validateCode}]}},url:{queryById:"/content/contentType/queryById",deleteBatch:"/content/contentType/deleteBatch",delete:"/content/contentType/delete",queryTreeList:"/content/contentType/queryTreeList",edit:"/content/contentType/edit",exportXlsUrl:"/content/contentType/exportXls",importExcelUrl:"/content/contentType/importExcel"},orgCategoryDisabled:!1,type:"0",userId:""}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)}},methods:{validateCode:function(t,e,r){var a={tableName:"content_type",fieldName:"type_num",fieldVal:e,dataId:this.userId};Object(s["s"])(a).then((function(t){if(t.success)r();else{var e="类别编码已存在!";r(e)}}))},loadData:function(){this.refresh()},loadTree:function(){var t=this,e=this;e.treeData=[],e.departTree=[],Object(c["e"])(e.url.queryTreeList).then((function(r){if(r.success){for(var a=0;a<r.result.length;a++){var n=r.result[a];e.treeData.push(n),e.departTree.push(n),e.setThisExpandedKeys(n),e.getAllKeys(n)}t.loading=!1}}))},setThisExpandedKeys:function(t){if(t.children&&t.children.length>0){this.iExpandedKeys.push(t.key);for(var e=0;e<t.children.length;e++)this.setThisExpandedKeys(t.children[e])}},refresh:function(){this.loading=!0,this.loadTree()},rightHandle:function(t){this.dropTrigger="contextmenu",this.rightClickSelectedKey=t.node.eventKey},onExpand:function(t){this.iExpandedKeys=t,this.autoExpandParent=!1},backFlowList:function(){this.$router.back(-1)},dropStatus:function(t){0==t&&(this.dropTrigger="")},closeDrop:function(){this.dropTrigger=""},batchDel:function(){if(this.checkStrictly=!1,this.checkedKeys.length<=0)this.$message.warning("请选择一条记录！");else{for(var t="",e=0;e<this.checkedKeys.length;e++)t+=this.checkedKeys[e]+",";var r=this;this.$confirm({title:"确认删除",content:"确定要删除所选中的 "+this.checkedKeys.length+" 条数据，以及子节点数据吗?",onOk:function(){Object(c["a"])(r.url.deleteBatch,{ids:t}).then((function(t){t.success?(r.$message.success(t.message),r.loadTree(),r.onClearSelected()):r.$message.warning(t.message)}))}})}},onSearch:function(t){var e=this;t?Object(c["e"])(e.url.queryTreeList,{name:t}).then((function(t){if(t.success){e.departTree=[];for(var r=0;r<t.result.length;r++){var a=t.result[r];e.departTree.push(a)}}else e.$message.warning(t.message)})):e.loadTree()},nodeModalOk:function(){this.loadTree()},hide:function(){this.visible=!1},onCheck:function(t,e){this.hiding=!1,this.checkStrictly?this.checkedKeys=t.checked:this.checkedKeys=t},onSelect:function(t,e){this.hiding=!1;var r=e.node.dataRef;this.currSelected=Object.assign({},r),this.model=this.currSelected,this.selectedKeys=[r.key],this.setValuesToForm(r),this.userId=this.model.id},setValuesToForm:function(t){"1"==t.orgCategory?this.orgCategoryDisabled=!0:this.orgCategoryDisabled=!1,this.form.getFieldDecorator("fax",{initialValue:""}),this.form.setFieldsValue(o()(t,"typeName","typeNum","isShow","orderNum"))},getCurrSelectedTitle:function(){return this.currSelected.title?this.currSelected.title:""},onClearSelected:function(){this.hiding=!0,this.checkedKeys=[],this.currSelected={},this.form.resetFields(),this.selectedKeys=[]},handleNodeTypeChange:function(t){this.currSelected.nodeType=t},notifyTriggerTypeChange:function(t){this.currSelected.notifyTriggerType=t},receiptTriggerTypeChange:function(t){this.currSelected.receiptTriggerType=t},submitCurrForm:function(){var t=this;this.form.validateFields((function(e,r){if(!e){var a=Object.assign(t.currSelected,r);Object(c["i"])(t.url.edit,a,"put").then((function(e){e.success?(t.$message.success("保存成功!"),t.loadTree()):t.$message.error(e.message)}))}}))},emptyCurrForm:function(){this.form.resetFields()},nodeSettingFormSubmit:function(){this.form.validateFields((function(t,e){}))},openSelect:function(){this.$refs.sysDirectiveModal.show()},handleAdd:function(t){if(1==t)this.$refs.addModal.add(""),this.$refs.addModal.title="添加一级";else if(2==t){var e=this.currSelected.key;if(!e)return this.$message.warning("请先选中一条记录!"),!1;this.$refs.addModal.add(this.selectedKeys[0]),this.$refs.addModal.title="添加子级"}else this.$refs.addModal.add(this.rightClickSelectedKey),this.$refs.addModal.title="添加子级"},handleDelete:function(){var t=this;Object(c["a"])(this.url.delete,{id:this.rightClickSelectedKey}).then((function(e){e.success?(t.$message.success("删除成功!"),t.loadTree()):t.$message.warning("删除失败!")}))},selectDirectiveOk:function(t){this.nodeSettingForm.setFieldsValue({directiveCode:t.directiveCode}),this.currSelected.sysCode=t.sysCode},getFlowGraphData:function(t){if(this.graphDatasource.nodes.push({id:t.id,text:t.flowNodeName}),t.children.length>0)for(var e=0;e<t.children.length;e++){var r=t.children[e];this.graphDatasource.edges.push({source:t.id,target:r.id}),this.getFlowGraphData(r)}},expandAll:function(){this.iExpandedKeys=this.allTreeKeys},closeAll:function(){this.iExpandedKeys=[]},checkALL:function(){this.checkStriccheckStrictlytly=!1,this.checkedKeys=this.allTreeKeys},cancelCheckALL:function(){this.checkedKeys=[]},switchCheckStrictly:function(t){1==t?this.checkStrictly=!1:2==t&&(this.checkStrictly=!0)},getAllKeys:function(t){if(this.allTreeKeys.push(t.key),t.children&&t.children.length>0)for(var e=0;e<t.children.length;e++)this.getAllKeys(t.children[e])}},created:function(){this.currFlowId=this.$route.params.id,this.currFlowName=this.$route.params.name}},f=d,p=(r("dd45"),r("2877")),h=Object(p["a"])(f,a,n,!1,null,"033f37f0",null);e["default"]=h.exports},"58b3":function(t,e,r){},"5ca2":function(t,e,r){"use strict";r("1fa1")},"5f39":function(t,e,r){"use strict";r("f986")},"5fe2":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{staticStyle:{height:"100%"},attrs:{"body-style":{height:"100%"}}},[r("div",{staticClass:"cardContent"},[r("a-collapse",{attrs:{bordered:!1,expandIconPosition:"right"},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-collapse-panel",{key:"1",staticStyle:{"background-color":"#fff"},attrs:{showArrow:!1},scopedSlots:t._u([{key:"header",fn:function(){return[r("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"100%"}},[r("div",{staticClass:"collapseTitle"},[t._v("\n                "+t._s(t.title)+"\n              ")])])]},proxy:!0}])},[r("j-form-container",{ref:"form1",attrs:{disabled:!0,border:!1,model:t.record,formRef:"formRow"}},[r("a-row",{ref:"formRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{span:4}},[t._v("维修描述")]),r("a-col",{attrs:{span:12,"data-prop":"price"}},[r("span",[t._v(" ["+t._s(t.record.code)+"]"+t._s(t.record.describe)+" ")])]),r("a-col",{attrs:{span:4}},[t._v("预计工期")]),r("a-col",{attrs:{span:4,"data-prop":"name"}},[r("span",[t._v(t._s(t.record.expDays)+" 天")])]),r("a-col",{attrs:{span:4}},[t._v("维修小区")]),r("a-col",{attrs:{span:4,"data-prop":"address"}},[r("span",[t._v(t._s(t.record.regionName))])]),r("a-col",{attrs:{span:4}},[t._v("小区地址")]),r("a-col",{attrs:{span:4,"data-prop":"address"}},[r("span",[t._v(t._s(t.record.regionAddress))])]),r("a-col",{attrs:{span:4}},[t._v("报价状态")]),r("a-col",{attrs:{span:4}},["1"==t.record.corpComparState?r("span",{staticStyle:{color:"red"}},[t._v("已报价")]):t._e(),"0"==t.record.corpComparState?r("span",{staticStyle:{color:"red"}},[t._v("未报价")]):t._e()]),r("a-col",{attrs:{span:4}},[t._v("联系人")]),r("a-col",{attrs:{span:4}},[r("span",[t._v(" "+t._s(t.record.reqMan)+" ")])]),r("a-col",{attrs:{span:4}},[t._v("联系电话")]),r("a-col",{attrs:{span:4}},[r("span",[t._v(" "+t._s(t.record.reqPhone)+" ")])]),r("a-col",{attrs:{span:4}},[t._v("竞价结束时间")]),r("a-col",{attrs:{span:4}},["1"===t.record.comparState?r("span",{staticStyle:{color:"red"}},[t._v(t._s(t.deadline))]):t._e(),"0"===t.record.comparState?r("span",{staticStyle:{color:"red"}},[t._v("竞价未开始")]):t._e(),"2"===t.record.comparState?r("span",{staticStyle:{color:"red"}},[t._v("已结束")]):t._e(),"3"===t.record.comparState?r("span",{staticStyle:{color:"red"}},[t._v("已结束")]):t._e(),"X"===t.record.comparState?r("span",{staticStyle:{color:"red"}},[t._v("已结束")]):t._e()])],1)],1)],1)],1),r("j-form-container",{ref:"form",staticClass:"px-16",attrs:{rules:t.validatorRules,model:t.pPart,formRef:"formOwnRow",border:!1}},[r("a-row",{ref:"formOwnRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{xxl:2,xl:4,span:4}},[t.disabled?t._e():r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("质保期：")]),r("a-col",{attrs:{xxl:2,xl:4,span:4,"data-prop":"period"}},[r("amount-input",{attrs:{disabled:t.disabled,width:"200px",min:t.min,"addon-after":"月","format-due":"04"},model:{value:t.pPart.period,callback:function(e){t.$set(t.pPart,"period",e)},expression:"pPart.period"}})],1),r("a-col",{attrs:{xxl:2,xl:4,span:4}},[t.disabled?t._e():r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("工期：")]),r("a-col",{attrs:{xxl:2,xl:4,span:4,"data-prop":"days"}},[r("amount-input",{attrs:{disabled:t.disabled,width:"200px",min:t.min,"addon-after":"天","format-due":"04"},model:{value:t.pPart.days,callback:function(e){t.$set(t.pPart,"days",e)},expression:"pPart.days"}})],1),r("a-col",{attrs:{xxl:2,xl:4,span:4}},[t.disabled?t._e():r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("总价：")]),r("a-col",{attrs:{xxl:3,xl:4,span:4,"data-prop":"corpPrice"}},[t._v("\n            "+t._s(t.pPart.corpPrice&&0!=t.pPart.corpPrice?t.amountFormate(t.pPart.corpPrice)+" 元":t.amountFormate(0)+" 元")+"\n          ")]),r("a-col",{attrs:{xxl:2,xl:4,span:4}},[r("span",[t.disabled?t._e():r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("施工方案：")])]),r("a-col",{attrs:{xxl:6,xl:12,span:12,"data-prop":"fileManages"}},[r("div",{staticClass:"uploadFormModelItem width100"},[t.disabled||t.getItemByName("施工方案").fileList&&0!==t.getItemByName("施工方案").fileList.length&&!t.getItemByName("施工方案").loading?t._e():[r("a-upload",{attrs:{disabled:t.disabled,showUploadList:!1,customRequest:function(e){return t.uploadFile(t.url.comparPartUrl,e,t.getItemByName("施工方案"))}},on:{change:function(e){return t.uploadChange(e,t.getItemByName("施工方案"))}}},[r("a-button",{attrs:{icon:"upload"}},[t._v("上传施工方案")])],1),t.getItemByName("施工方案").loading?t._e():r("span",{staticClass:"placeholder"},[t._v("支持格式：.rar .zip .doc .docx .pdf")])],t.getItemByName("施工方案").loading?r("a-progress",{attrs:{width:32,type:"circle",percent:t.getItemByName("施工方案").percent}}):t._e(),t.getItemByName("施工方案").fileList&&t.getItemByName("施工方案").fileList.length>0&&!t.getItemByName("施工方案").loading?r("div",{staticClass:"div_upload_show"},[r("a",{staticClass:"a_upload_fileName",staticStyle:{"line-height":"32px","pointer-events":"auto"},attrs:{allowClick:"",href:t.getFirstFileByName("施工方案").filePath,title:t.getFirstFileByName("施工方案").originalName}},[t._v(t._s(t.getFirstFileByName("施工方案").originalName))]),t.disabled?t._e():r("a-button",{staticClass:"button_upload_delete",attrs:{shape:"circle",icon:"close"},on:{click:function(e){t.clearFileItem(t.getItemByName("施工方案"))}}})],1):t._e()],2)]),r("a-col",{attrs:{xxl:3,xl:8,span:8}},[t.disabled||"1"!=t.record.comparState?t._e():r("a-button",{attrs:{loading:t.loading},on:{click:t.saveTakePart}},[t._v("保存")])],1)],1)],1),r("div",{staticClass:"mt-10 px-16"},[r("a-collapse",{attrs:{accordion:""},on:{change:t.partCollapseChange},model:{value:t.partActiveKey,callback:function(e){t.partActiveKey=e},expression:"partActiveKey"}},t._l(t.partList,(function(e,a){return r("a-collapse-panel",{key:a.toString(),attrs:{forceRender:""}},[r("template",{slot:"header"},[r("a-breadcrumb",[r("a-breadcrumb-item",[t._v(" 项目描述："+t._s(e.projDescribe)+" ")]),r("a-breadcrumb-item",[r("a",{on:{click:function(r){return r.stopPropagation(),t.showAnnex(e.projectId)}}},[r("a-icon",{attrs:{type:"eye"}}),t._v(" 现场勘察记录 ")],1)]),r("a-breadcrumb-item",[t._v(" 本项目维修费用："+t._s(t.amountFormate(e.corpPrice))+" 元 ")])],1)],1),t.gridVisibleFlag?r("vxe-grid",{key:"grid"+a,ref:"houseInfoRef"+a,refInFor:!0,staticStyle:{"flex-grow":"1"},attrs:{columns:t.columns,"checkbox-config":{showHeader:!1},"edit-config":!t.disabled&&{trigger:"manual",mode:"cell",autoClear:!1,showAsterisk:!1,showIcon:!1},height:"400px","valid-config":{autoPos:!0,message:"default"},"edit-rules":t.disabled?{}:t.editRules,"keyboard-config":{isArrow:!0,isDel:!1,isTab:!0,isEdit:!1},"mouse-config":{selected:!0},data:e.priceDetail,"span-method":t.rowspanMethod,"show-overflow":"","auto-resize":"",border:""},on:{"valid-error":function(e){return t.validError(a)}},scopedSlots:t._u([{key:"utilityPartName",fn:function(e){e.rowIndex;var r=e.row;e.column;return[[t._v("\n                  "+t._s(r.utilityPartName)+"\n                ")]]}},{key:"describe",fn:function(e){e.rowIndex;var a=e.row,n=e.column;return[r("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入费用描述"},on:{blur:function(e){return t.validaColumn(a,n,t.activiIndex)},input:function(e){return t.validaColumn(a,n,t.activiIndex)}},model:{value:a.describe,callback:function(e){t.$set(a,"describe",e)},expression:"row.describe"}})]}},{key:"materialName",fn:function(e){e.rowIndex;var a=e.row;return[r("span",[t._v(t._s(t.getMaterialName(a)))])]}},{key:"materialNameEdit",fn:function(e){e.rowIndex;var a=e.row;return[r("a-tree-select",{staticClass:"width100",attrs:{replaceFields:{key:"code"},dropdownStyle:{maxHeight:"200px"},"tree-data":t.treeData},on:{change:function(e){return t.materialTreeChange(a,e)}},model:{value:a.materialCode,callback:function(e){t.$set(a,"materialCode",e)},expression:"row.materialCode"}})]}},{key:"quantity",fn:function(e){var a=e.row,n=e.rowIndex,i=e.column;return[r("a-input-number",{staticStyle:{width:"50%"},attrs:{min:t.min,disabled:t.disabled},on:{change:function(e){return t.computeTotalPrice({row:a,rowIndex:n,column:i,activeIndex:t.activiIndex})}},model:{value:a.quantity,callback:function(e){t.$set(a,"quantity",e)},expression:"row.quantity"}}),r("a-select",{staticStyle:{width:"50%"},attrs:{disabled:t.disabled},on:{input:function(e){return t.validaColumn(a,i,t.activiIndex)},blur:function(e){return t.validaColumn(a,i,t.activiIndex)}},model:{value:a.unit,callback:function(e){t.$set(a,"unit",e)},expression:"row.unit"}},t._l(t.units,(function(e){return r("a-select-option",{key:e.value,attrs:{index:e.value}},[t._v("\n                    "+t._s(e.text)+"\n                  ")])})),1)]}},{key:"univalence",fn:function(e){var a=e.row,n=e.rowIndex,i=e.column;return[r("amount-input",{on:{change:function(e){return t.computeTotalPrice({row:a,rowIndex:n,column:i,activeIndex:t.activiIndex})}},model:{value:a.univalence,callback:function(e){t.$set(a,"univalence",e)},expression:"row.univalence"}})]}},{key:"remark",fn:function(e){var a=e.row;e.rowIndex;return[r("a-input",{model:{value:a.remark,callback:function(e){t.$set(a,"remark",e)},expression:"row.remark"}})]}},{key:"materialBrandEdit",fn:function(e){var a=e.row;e.rowIndex;return[r("a-input",{model:{value:a.brand,callback:function(e){t.$set(a,"brand",e)},expression:"row.brand"}})]}},{key:"priceTotal",fn:function(e){e.rowIndex;var a=e.row;return[r("amount-input",{on:{change:t.totalAmount},model:{value:a.priceTotal,callback:function(e){t.$set(a,"priceTotal",e)},expression:"row.priceTotal"}})]}},{key:"action",fn:function(e){e.rowIndex;var n=e.row,i=e.$rowIndex;return[t.disabled?t._e():[r("a",{on:{click:function(e){return t.addComponentRow({row:n,$rowIndex:i,partIndex:a})}}},[r("a-icon",{attrs:{type:"plus"}})],1),r("a",{on:{click:function(e){return t.delComponentRow({$rowIndex:i,partIndex:a})}}},[r("a-icon",{attrs:{type:"minus"}})],1)]]}}],null,!0)}):t._e()],2)})),1)],1)],1),r("supervise-info-model",{ref:"supmodel"}),r("select-material-modal",{ref:"selectMaterialModal",attrs:{materialTree:t.materialTree,disabledAdd:t.disabled},on:{confirm:t.confirm}}),r("a-modal",{attrs:{"body-style":{height:"calc(80vh - 55px - 61px)",overflow:"auto"},closable:!1,maskClosable:!1,keyboard:!1,centered:"","show-footer":"",width:"1000px"},scopedSlots:t._u([{key:"title",fn:function(){return[r("div",{staticClass:"modalTitle"},[r("span",[t._v("安全质量与承诺")])])]},proxy:!0},{key:"footer",fn:function(){return[r("div",{staticClass:"modalFooter"},[r("a-checkbox",{model:{value:t.agreeRead,callback:function(e){t.agreeRead=e},expression:"agreeRead"}},[t._v("已阅读确认上述提示条例")]),r("a-button",{attrs:{type:t.agreeRead?"primary":"default"},on:{click:t.closeDescModal}},[t.agreeRead?[t._v("下一步")]:[t._v("关闭")]],2)],1)]},proxy:!0}]),model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("div",{staticClass:"modalBody"},[r("div",{staticClass:"desc"},[(t.paragraphList&&t.paragraphList.length,[r("p",[t._v("施工单位您好，")]),r("p",[t._v("在提交您的报价之前，请务必注意以下重要提示并确认：")]),r("p",[t._v("1.请务必仔细阅读和理解现场勘察材料和照片，以确保您的报价基于实际情况。建议自行去现场进行勘查后报价。")]),r("p",[t._v("2.报价不应过于低于合理成本，以避免不可持续的低价竞争，应以保障工程的质量和进度为前提进行报价。")]),r("p",[t._v("3.施工方案请严格按照现场勘察表中的施工工艺和要求进行制定，提供详细的施工方案，包括工程工期、施工方法、质量控制计划等细节。这将有助于我们更好地了解您的计划和能力。")]),r("p",[t._v("4.如您被选定后放弃或限于成本偷工减料，将被在信用评价中扣分，影响后面的报价，甚至不可参与后续项目。")]),r("p",[t._v("5.施工企业应严格按照《建设工程质量管理条例》、《建设工程安全生产管理条例》、《建筑施工企业安全生产许可证管理规定》等相关规定施工。")]),r("p",[t._v("6.施工企业要健全完善从主要负责人、安全管理人员、特种作业人员到一线从业人员的安全生产责任体系。施工企业被选定后施工前需自觉上传安全管理方案，应包含：该项目施工安全管理人员的身份证复印件、安全生产考核合格证书及企业为施工人员缴纳的意外险票据等复印件，安全防护措施、安全技术交底等。")]),r("p",[t._v("7.施工企业被选定后施工前需自觉上传相关的施工材料，包括但不限于安全质量承诺、施工预算方案、施工图纸、施工资质、以及任何其他要求的文件。")]),r("p",[t._v("8.非最低价中标，中标企业以业主代表选择为准。")]),r("p",[t._v("报价前请确保您能知悉并能履行上述提示。谢谢您的合作，期待您的参与！")])])],2)])])],1)},n=[],i=r("0fea"),o=r("d8a5"),s=r("4aae"),c=r("5c11"),l=r("eb36"),u=r("7c3f"),d=r("3ed7"),f=r("e1fd"),p=r("24cf"),h=r("c1df"),m=r.n(h),g=r("6603"),v=r("2f62"),y=r("e5f6"),b=r("bc3a"),w=r.n(b);function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function x(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */x=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,a){var i=e&&e.prototype instanceof v?e:v,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};l(w,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(w=C);var L=b.prototype=v.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,s){var c=d(t[n],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==_(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(u).then((function(t){l.value=t,o(l)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=f;return function(i,o){if(n===h)throw Error("Generator is already running");if(n===m){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===g)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===f)throw n=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=h;var l=d(e,r,a);if("normal"===l.type){if(n=a.done?m:p,l.arg===g)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=m,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),g;var i=d(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_(e)+" is not iterable")}return y.prototype=b,n(L,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),l(D.prototype,s,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),l(L,c,"Generator"),l(L,o,(function(){return this})),l(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),g}},e}function k(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function C(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){k(i,a,n,o,s,"next",t)}function s(t){k(i,a,n,o,s,"throw",t)}o(void 0)}))}}function L(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=S(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function S(t,e){if(t){if("string"==typeof t)return D(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(t,e):void 0}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function T(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){I(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function I(t,e,r){return(e=j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j(t){var e=O(t,"string");return"symbol"==_(e)?e:e+""}function O(t,e){if("object"!=_(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=_(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var E={name:"TakePartModel",components:{AutoSelect:g["default"],AmountInput:s["default"],FieldSiteInfoComp:u["default"],SuperviseInfoModel:f["default"],SelectMaterialModal:p["default"]},mixins:[l["a"]],inject:["routeReload","closeCurrent"],data:function(){var t=this,e=function(t){t.cellValue;var e=t.row;return new Promise((function(t,r){var a=Number(e.priceTotal);return a?a<=0?r(new Error("费用必须大于0!")):t():r(new Error("请输入费用!"))}))},r=function(e,r,a){Number(r)||a("请输入工期"),Number(r)>t.record.expDays?a("工期必须小于预计工期"):a()},a={describe:[{required:!0,message:"请输入描述!"}],priceTotal:[{required:!0,message:"请输入费用!"},{validator:e}]},n={period:[{required:!0,message:"请输入质保期!"}],days:[{required:!0,message:"请输入工期!"},{validator:r}],corpPrice:[{required:!0,message:"总价!"}],fileManages:[{required:!0,message:"请上传施工方案",trigger:"change"}]};return{materialColumns:[{field:"name",title:"材料名称",slots:{default:"name"}},{field:"quantity",title:"数量",align:"right"},{field:"unitPrice",title:"单价",align:"right"},{field:"model",title:"型号"},{field:"brand",title:"品牌"}],previewPage:{current:1,size:5,total:0,showList:[],allList:[]},materialTree:[],annexVisable:!1,fileList:[{uid:"-1",name:"xxx.png",status:"done",url:"http://www.baidu.com/xxx.png"}],units:[],activiIndex:0,pPart:{},partList:[],min:0,previewImage:"",previewVisible:!1,disabled:!1,editAble:!1,comparPartUrl:"",loading:!1,costTypes:[],costTypeValues:[],editRules:a,validatorRules:n,record:{},activeKey:["1"],partActiveKey:["0"],title:"项目信息",deadline:"",formData:{},visible:!1,descBtnDisabled:!0,agreeRead:!1,url:{comparPartUrl:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=&uploadType=5&busiType=20&busiTypeDetail=202A&orderNo=1&erecordId=",getTaskList:"/compare/bComparPart/getTaskList",savePriceDetail:"/compare/bComparPriceInfo/savePriceDetail",syncNoLogin:"/compare/bComparPriceInfo/syncNoLogin",updateComparState:"/compare/bComparProj/updateComparStateByComparId",getUtilityPartUrl:"/compare/bComparPriceInfo/getUtilityPartDict",getComparProj:"compare/bComparProj/queryById"},gridVisibleFlag:!0,tableData:[],columns:[{title:"设施设备-标准维修项目",align:"left",field:"costListRemark",minWidth:200},{title:"维修费用描述",align:"left",width:400,field:"describe",slots:{edit:"describe"},editRender:{type:"visible"}},{title:"费用金额",align:"right",width:200,field:"priceTotal",slots:{edit:"priceTotal"},editRender:{type:"visible"},formatter:function(t){var e=t.cellValue;t.row;return Object(d["g"])(e)+" 元"}},{field:"remark",title:"备注",width:400,slots:{edit:"remark"},editRender:{type:"visible"}},{title:"操作",field:"action",width:100,align:"center",fixed:"right",slots:{default:"action"}}],routeQuery:[],paragraphList:[]}},computed:T(T({},Object(v["c"])(["isKeepAlive"])),{},{CMaterialList:function(){var t=[];function e(r){var a,n=L(r);try{for(n.s();!(a=n.n()).done;){var i=a.value;i.children&&i.children.length>0?e(i.children):t.push(i)}}catch(o){n.e(o)}finally{n.f()}}return e(this.materialTree),t},treeData:function(){function t(e){e.forEach((function(e){e.children&&e.children.length>0?(e.selectable=!1,t(e.children)):e.selectable=!0}))}var e=JSON.parse(JSON.stringify(this.materialTree));return t(e),e}}),created:function(){this.getDifferTime(),this.isKeepAlive||this.init()},activated:function(){var t=this.$route_query;function e(t,e){for(var r in t)if(t[r]!=e[r])return!1;return!0}if(this.isKeepAlive){var r=!0;for(var a in t)if(r=!(Object.keys(this.routeQuery).length<=0)&&(Object(y["isObject"])(t[a])?e(t[a],this.routeQuery[a]):t[a]===this.routeQuery[a]),!r){this.routeQuery=this.$route_query;var n=this.$options.data.call(this);for(var i in n)this[i]=n[i];return void this.init()}}},mounted:function(){},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{closeDescModal:function(){var t=this;this.agreeRead?this.visible=!1:this.$confirm({title:"是否确认关闭",onOk:function(){t.closeCurrent(),t.visible=!1}})},init:function(){var t=C(x().mark((function t(){var e,r,a,n=this;return x().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),r=e+"/file/安全质量与承诺.txt",this.paragraphList=[],w.a.get(r).then((function(t){if(t&&t.data){var e=t.data.split("\r\n");e.forEach((function(t){n.paragraphList.push(t)}))}})).catch((function(t){})),this.record=this.$route_query.record,this.disabled=this.$route_query.disabled,this.visible="0"==this.record.corpComparState,this.disabled&&(a=this.columns.findIndex((function(t){return"action"===t.field})),a>-1&&this.columns.splice(a,1)),this.initWebSocket(),this.start(),this.getUnits(),this.$store.commit("SET_PAGE_LOAD_STATE",{state:!0}),t.next=14,this.initMaterialTree();case 14:return t.next=16,this.getTaskList();case 16:this.$store.commit("SET_PAGE_LOAD_STATE",{state:!1}),Object(o["e"])("compar_picture_ere_id").then((function(t){n.comparPartUrl=n.url.comparPartUrl+t+"&busiNo="}));case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getMaterialName:function(t){if(t.m_name)return t.m_name;var e=this.CMaterialList.find((function(e){return e.code===t.materialCode}));return e?e.title:void 0},getPreviewShowListByPage:function(t){var e=t.currentPage,r=t.pageSize;this.previewPage.size=r,this.previewPage.current=e,this.previewPage.showList=this.previewPage.allList.slice((e-1)*r,e*r)},hidePopover:function(){document.querySelectorAll(".materialPreviewPopover").forEach((function(t){t.remove()}))},addComponentRow:function(t){var e=t.row,r=t.$rowIndex,a=(t.partIndex,T({},e));a.type="selValue",this.addNextRow(r,a,this.partActiveKey)},addNextRow:function(t,e,r){this.partList[r].priceDetail.splice(t+1,0,e),this.totalAmount()},delComponentRow:function(t){var e=t.$rowIndex;t.partIndex;this.delThisRow({$rowIndex:e,partIndex:this.partActiveKey})},computeTotalPrice:function(t){var e=t.row,r=(t.rowIndex,t.column),a=t.activeIndex;e.quantity&&e.univalence?e.priceTotal=Object(d["e"])(e.quantity,e.univalence):e.priceTotal=0,this.validaColumn(e,r,a),this.totalAmount()},showPopover:function(t){this.previewPage.allList=JSON.parse(JSON.stringify(t.materialList)),this.previewPage.total=this.previewPage.allList.length,this.previewPage.current=1,this.previewPage.size=5,this.getPreviewShowListByPage({currentPage:1,pageSize:5})},confirm:function(t,e){var r,a=L(this.partList);try{for(a.s();!(r=a.n()).done;){var n=r.value;if(n.projectId==t[0].cprojId){var i,o=L(n.priceDetail);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.costListId==t[0].costListId&&(s.materialList=t[0].materialList,s.priceTotal=t[0].totalPrice)}}catch(c){o.e(c)}finally{o.f()}}}}catch(c){a.e(c)}finally{a.f()}this.totalAmount()},initMaterialTree:function(){var t=this;return this.materialTree=[],Object(i["e"])("/sys/category/loadTreeRoot",{async:!1,pcode:"material_type"}).then((function(e){e&&e.success&&e.result.length>0&&(t.materialTree=e.result)}))},showMaterialModal:function(t){var e=this;this.disabled||(this.$refs.popover&&this.$refs.popover[0].doClose(),this.$nextTick((function(){e.$refs.selectMaterialModal.comparAble=!0;var r=t.costListRemark.split("-"),a=r[r.length-1];e.$refs.selectMaterialModal.open([T(T({},t),{},{name:a})],"edit")})))},getTextByValue:function(t){var e,r=L(this.units);try{for(r.s();!(e=r.n()).done;){var a=e.value;if(t==a.value)return a.text}}catch(n){r.e(n)}finally{r.f()}return""},amountFormate:function(t){return Object(d["g"])(t)},onFileChange:function(t,e,r){e&&e.fileList.length>0&&(this.pPart.fileManages=e.fileList),e&&e.fileList.length<=0&&(this.pPart.fileManages=null)},annexCancel:function(){this.$refs.supmodel.hidden()},showAnnex:function(t){this.$refs.supmodel.show(t)},getItemByName:function(t){var e=this.enclosureList.find((function(e){return e.name===t}));return e||{}},partCollapseChange:function(t){this.activiIndex=t},getTableDataBy:function(t){return this.tableData.filter((function(e){return e.cprojId===t}))},duplicateRemoval:function(t){var e=new Map;return t.filter((function(t){return!e.has(t.cprojId)&&e.set(t.cprojId,t.cprojId)}))},handleCancel:function(){this.previewVisible=!1},handlePreview:function(t){this.previewImage=t.url||t.thumbUrl,this.previewVisible=!0},beforeUpload:function(t){var e=this;return new Promise((function(r,a){t.type.includes("image")||t.type.includes("video")?r():e.$message.warning("请上传图片或视频！")}))},materialTreeChange:function(t,e){t.materialCode=e,t["m_name"]=this.getMaterialName(t)},addMaterial:function(t){var e=t.row,r=(t.rowIndex,t.parent),a=r.priceDetailMaterial.findLastIndex((function(t,r){return t.costListRemark===e.costListRemark})),n=JSON.parse(JSON.stringify(e));for(var i in n)i.includes("m_")&&this.$set(n,i,"");r.priceDetailMaterial.splice(a+1,1,n)},delThisRow:function(t){var e=t.$rowIndex,r=t.partIndex,a=this.partList[r].priceDetail[e].costListId,n=this.partList[r].priceDetail.filter((function(t){return t.costListId===a}));!n||n.length<=1?this.$message.warning("每个标准维修项目必须保留一个费用！"):(this.partList[r].priceDetail.splice(e,1),this.totalAmount())},rowspanMethod:function(t){var e=t.row,r=t.$rowIndex,a=t.column,n=t.data,i=["costListRemark"],o=e.costListRemark;if(i.includes(a.property)){var s=n[r-1],c=n[r+1];if(s&&s.costListRemark===o)return{rowspan:0,colspan:0};var l=1;while(c&&c.costListRemark===o)c=n[++l+r];if(l>1)return{rowspan:l,colspan:1}}},footerMethod:function(t){var e=t.columns;t.data;return[e.map((function(t,e){return null}))]},footerSpanMethod:function(t){t._rowIndex;var e=t._columnIndex;return 0===e?{colspan:9}:{colspan:0}},validError:function(t){var e=this;setTimeout((function(){e.$refs["houseInfoRef"+t][0].clearValidate()}),2e3)},start:function(){this.timer&&clearInterval(this.timer),this.timer=setInterval(this.valChange,1e3)},getDifferTime:function(){var t=this;Object(i["e"])("/compare/bComparProj/getServerTime").then((function(e){var r=(new Date).getTime();t.differTime=r-e.result}))},valChange:function(){var t=this;if(this.record.comparEnd){var e=this.record.comparEnd.replaceAll("-","").replaceAll(":","").replaceAll(" ",""),r=Object(c["i"])((new Date).getTime()-this.differTime),a=r.replaceAll("-","").replaceAll(":","").replaceAll(" ","");if(a>=e&&"1"==this.record.comparState)this.gridVisibleFlag=!1,Object(i["j"])(this.url.updateComparState+"/"+this.record.comparId).then((function(e){t.record.comparState="2",t.disabled=!0,t.gridVisibleFlag=!0})),clearInterval(this.timer);else{var n=m()(this.record.comparEnd).diff(r,"seconds");this.deadline=Object(c["d"])(n)}}},validaColumn:function(t,e,r){this.$refs["houseInfoRef"+r][0].updateStatus({row:t,column:e})},changeAmount:function(t){t.quantity&&t.univalence?t.priceTotal=Object(d["e"])(Number(t.univalence)*Number(t.quantity)):t.priceTotal=0,this.totalAmount()},totalAmount:function(){var t=0;this.partList.forEach((function(t){t.corpPrice=t.priceDetail.reduce((function(t,e,r,a){return e.priceTotal||(e.priceTotal=0),Object(d["c"])(t,e.priceTotal)}),0)})),this.partList.forEach((function(e){t=Object(d["c"])(t,e.corpPrice)})),this.pPart.corpPrice=t},getTaskList:function(){var t=this;return Object(i["j"])(this.url.getTaskList,this.record).then((function(e){var r=[];e.success&&(t.partList=e.result.cParts.taskList,t.pPart=e.result.pPart,t.totalAmount(),t.pPart.file?(t.pPart.fileManages=[t.pPart.file],r.push({name:"施工方案",fileList:[t.pPart.file],fileType:["rar","zip","doc","docx","pdf"]})):r.push({name:"施工方案",fileList:[],fileType:["rar","zip","doc","docx","pdf"]}),t.initUploadFile(r))}))},checkData:function(){var t=this;return new Promise((function(e,r){var a=t.partList.findIndex((function(t,e){return t.priceDetail.some((function(t,e){if(!t.describe||Number(t.priceTotal)<=0)return!0}))}));if(a<0)return e(!0);t.partActiveKey=[a.toString()],t.activiIndex=a.toString(),setTimeout((function(){t.$refs["houseInfoRef"+a][0].validate(t.partList[a].priceDetail,(function(t){e(!1)}))}),300)}))},getUnits:function(){var t=this;Object(o["g"])("compar_unit").then((function(e){t.units=e.result}))},saveTakePart:function(){var t=this;if(this.valida()){this.loading=!0;var e=this;this.checkData().then((function(r){if(r){var a={};a.partVos=e.partList,a.comparPart=e.pPart,a.fileManages=e.pPart.fileManages,Object(i["j"])(e.url.savePriceDetail,a).then((function(r){r.success?(e.$message.success("保存成功"),t.getTaskList(),e.record.corpComparState=r.result,Object(i["e"])(t.url.syncNoLogin,{flag:"corp",comparId:e.record.comparId}).then((function(e){t.totalAmount()}))):e.$message.error(r.message)})).finally((function(){t.loading=!1}))}else t.loading=!1}))}},valida:function(){var t=this.$refs.form.validaRowMsg(this.$refs.formOwnRow);return t.valida},initWebSocket:function(){this.websock&&this.websock.close();var t=window._CONFIG["domianURL"].replace("https://","wss://").replace("http://","ws://")+"/websocket/"+this.record.comparId;this.websock=new WebSocket(t),this.websock.onopen=this.websocketOnopen,this.websock.onerror=this.websocketOnerror,this.websock.onmessage=this.websocketOnmessage,this.websock.onclose=this.websocketOnclose},websocketOnopen:function(){},heartCheckFun:function(){var t=this;t.heartCheck={timeout:2e4,timeoutObj:null,serverTimeoutObj:null,reset:function(){return clearTimeout(this.timeoutObj),this},start:function(){this.timeoutObj=setTimeout((function(){t.websocketSend("HeartBeat")}),this.timeout)}}},websocketOnerror:function(){this.reconnect()},reconnect:function(){var t=this;if(t.lockReconnect)return clearTimeout(this.websocketTimer),void(this.websocketTimer=null);t.lockReconnect=!0,this.websocketTimer=setTimeout((function(){t.initWebSocket(),t.lockReconnect=!1}),5e3)},websocketOnmessage:function(t){this.updateComparEnd()},websocketOnclose:function(t){},updateComparEnd:function(){var t=this;Object(i["e"])(this.url.getComparProj,{id:this.record.comparId}).then((function(e){e.success&&(t.record.comparEnd=e.result.comparEnd)}))},websocketSend:function(t){try{this.websock.send(t)}catch(e){}},getDefaultData:function(){return{previewPage:{current:1,size:5,total:0,showList:[],allList:[]},materialTree:[],annexVisable:!1,fileList:[{uid:"-1",name:"xxx.png",status:"done",url:"http://www.baidu.com/xxx.png"}],units:[],activiIndex:0,pPart:{},partList:[],min:0,previewImage:"",previewVisible:!1,disabled:!1,editAble:!1,comparPartUrl:"",loading:!1,costTypes:[],costTypeValues:[],record:{},activeKey:["1"],partActiveKey:["0"],title:"项目信息",deadline:"",formData:{},visible:!1,descBtnDisabled:!0,gridVisibleFlag:!0,tableData:[],columns:[{title:"设施设备-标准维修项目",align:"left",field:"costListRemark",minWidth:200},{title:"维修费用描述",align:"left",width:400,field:"describe",slots:{edit:"describe"},editRender:{type:"visible"}},{title:"费用金额",align:"right",width:200,field:"priceTotal",slots:{edit:"priceTotal"},editRender:{type:"visible"},formatter:function(t){var e=t.cellValue;t.row;return Object(d["g"])(e)+" 元"}},{field:"remark",title:"备注",width:400,slots:{edit:"remark"},editRender:{type:"visible"}},{title:"操作",field:"action",width:100,align:"center",fixed:"right",slots:{default:"action"}}]}}}},N=E,$=(r("a991"),r("2840"),r("2877")),F=Object($["a"])(N,a,n,!1,null,"e5cdf634",null);e["default"]=F.exports},"64fe":function(t,e,r){},"66e8":function(t,e,r){"use strict";r("6b69")},"6b19":function(t,e,r){"use strict";r("ea8d")},"6b69":function(t,e,r){},"6c88":function(t,e,r){"use strict";r("e93e")},"6e86":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"editModalTab",class:"top"===t.direction?"editModalTabTop":"editModalTabLeft"},[r("div",{staticClass:"tabPane"},t._l(t.tabList,(function(e,a){return r("div",{key:a,staticClass:"tabPaneItem",class:{tabPaneActive:t.current===a},on:{click:function(r){return t.changeTab(e,a)}}},[t._v("\n      "+t._s(e.name)+"\n    ")])})),0),r("div",{staticClass:"tabContent"},[t._t("default")],2)])},n=[],i={name:"EditModalTabs",props:{direction:{type:String,default:"left"},tabList:{type:Array,default:function(){return[]}},changeTabIndex:{type:Number,default:0}},model:{prop:"changeTabIndex",event:"change.tabIndex"},watch:{changeTabIndex:function(t){this.current=t}},data:function(){return{current:this.changeTabIndex}},methods:{changeTab:function(t,e){this.current!==e&&(this.current=e,this.$emit("change.tabIndex",e),this.$emit("change",e,t))}}},o=i,s=(r("5f39"),r("2877")),c=Object(s["a"])(o,a,n,!1,null,"5c5cbf48",null);e["default"]=c.exports},"70b7":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("j-modal",{attrs:{title:t.title,width:t.width,visible:t.visible,switchFullscreen:"",okButtonProps:{class:{"jee-hidden":t.disableSubmit}},cancelText:"关闭"},on:{ok:t.handleOk,cancel:t.handleCancel}},[r("b-compar-config-form",{ref:"realForm",attrs:{disabled:t.disableSubmit},on:{ok:t.submitCallback}})],1)},n=[],i=r("aae5"),o={name:"BComparConfigModal",components:{BComparConfigForm:i["default"]},data:function(){return{title:"",width:800,visible:!1,disableSubmit:!1}},methods:{addChild:function(t){var e=this;this.visible=!0,this.$nextTick((function(){t&&(e.$refs.realForm.isParent=!1),e.$refs.realForm.addChild(t)}))},add:function(){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.realForm.add()}))},edit:function(t){var e=this;this.visible=!0,this.$nextTick((function(){!t||null!=t.comparName&&""!==t.comparName&&void 0!==t.comparName||(e.$refs.realForm.isParent=!1),e.$refs.realForm.isEdit=!0,e.$refs.realForm.edit(t)}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){this.$refs.realForm.submitForm()},submitCallback:function(){this.$emit("ok"),this.visible=!1},handleCancel:function(){this.close()}}},s=o,c=r("2877"),l=Object(c["a"])(s,a,n,!1,null,null,null);e["default"]=l.exports},7240:function(t,e,r){},"72b6":function(t,e,r){},7728:function(t,e,r){"use strict";r("dc76")},"78b86":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{staticClass:"mainCard",attrs:{bordered:!1,"body-style":{padding:"8px"}}},[r("m-e-s-super-query",{attrs:{fieldList:t.queryObj,saveCode:t.fileName,type:"queryList"},on:{ok:t.handleSuperQuery},scopedSlots:t._u(["take"==t.busiType?{key:"comparState",fn:function(e){var a=e.row;return[r("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择比选状态"},model:{value:a.val,callback:function(e){t.$set(a,"val",e)},expression:"row.val"}},[r("a-select-option",{attrs:{value:"1"}},[t._v("\n          报价中\n        ")]),r("a-select-option",{attrs:{value:"2"}},[t._v("\n          待中标确认\n        ")])],1)]}}:null],null,!0)}),r("div",{staticClass:"tableDiv"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"","table-height":"auto",stripe:!0,expand:!1,data:t.loadData,tableColumn:t.columns,"header-align":"center"},scopedSlots:t._u([{key:"code",fn:function(e){var a=e.text,n=e.row;return["unbidd"!=t.busiType||"X"!=n.comparState&&"1"==n.corpComparState?r("a",{on:{click:function(e){return t.toDetail(n)}}},[t._v(t._s(a))]):r("span",[t._v(t._s(a))])]}},{key:"corpComparState",fn:function(e){var a=e.text;e.row;return["0"==a?r("span",[t._v("否")]):t._e(),"1"==a?r("span",[t._v("是")]):t._e()]}},{key:"projState",fn:function(e){var a=e.text;e.row;return["0"==a?r("span",[t._v(t._s("已完成全部拨付"))]):t._e(),"1"==a?r("span",[t._v(t._s("已完成部分拨付"))]):t._e(),"2"==a?r("span",[t._v(t._s("拨付申请"))]):t._e(),"5"==a?r("span",[t._v(t._s("待撤销"))]):t._e(),"6"==a?r("span",[t._v(t._s("待办结"))]):t._e(),"7"==a?r("span",[t._v(t._s("项目审核通过"))]):t._e(),"8"==a?r("span",[t._v(t._s("项目待审核"))]):t._e(),"9"==a?r("span",[t._v(t._s("新建项目"))]):t._e(),"N"==a?r("span",[t._v(t._s("项目办结"))]):t._e(),"X"==a?r("span",[t._v(t._s("项目已撤销"))]):t._e()]}},{key:"comparState",fn:function(e){var a=e.text;e.row;return["0"==a?r("span",[r("a-badge",{attrs:{color:"#FF0000",text:"未开始"}})],1):t._e(),"1"==a?r("span",[r("a-badge",{attrs:{color:"#87d068",text:"报价中"}})],1):t._e(),"2"==a?r("span",[r("a-badge",{attrs:{color:"#FFA500",text:"待中标确认"}})],1):t._e(),"3"==a?r("span",[r("a-badge",{attrs:{color:"#FFA500",text:"已结束"}})],1):t._e(),"X"==a?r("span",[r("a-badge",{attrs:{color:"#FF0000",text:"作废"}})],1):t._e()]}},{key:"action",fn:function(e){e.text;var a=e.row;return["take"===t.busiType?[r("a",{on:{click:function(e){return t.toDetail(a)}}},[r("a-icon",{attrs:{type:"eye"}}),t._v(" 详情")],1)]:"bidd"===t.busiType?[r("a",{on:{click:function(e){return t.uploadFile(a)}}},[t._v("上传附件")])]:t._e()]}}])})],1),r("vxe-modal",{attrs:{position:{top:20,left:"center"},"destroy-on-close":"",width:"900px",title:"上传附件"},model:{value:t.fileModelVisible,callback:function(e){t.fileModelVisible=e},expression:"fileModelVisible"}},[r("content-view",{attrs:{title:"基本信息"}},[r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("项目描述")]),r("a-col",{attrs:{span:8}},[t._v(t._s(t.projInfo.describe))]),r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("申报小区")]),r("a-col",{attrs:{span:8}},[t._v(t._s(t.projInfo.communityName))]),r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("项目类型")]),r("a-col",{attrs:{span:8}},[t._v(t._s(t.getBaseTypeText(t.projInfo.baseType)))]),r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("分摊方式")]),r("a-col",{attrs:{span:8}},[r("j-d-dict-select-tag",{attrs:{readOnly:"",align:"left",type:"select",dictCode:"allocation_method"},model:{value:t.projInfo.allotMode,callback:function(e){t.$set(t.projInfo,"allotMode",e)},expression:"projInfo.allotMode"}})],1),r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("联系人")]),r("a-col",{attrs:{span:8}},[t._v(t._s(t.projInfo.reqMan))]),r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("联系电话")]),r("a-col",{attrs:{span:8}},[t._v(t._s(t.projInfo.reqPhone))]),"1"==t.projInfo.comparAble&&"1"!=t.projInfo.hisFlag?[r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("维修范围")]),r("a-col",{attrs:{span:8}},[t._l(t.repairRange,(function(e,a){return[e.value===t.projInfo.projScope?r("span",{key:a},[t._v(t._s(e.text))]):t._e()]}))],2),r("a-col",{staticClass:"formLabel",attrs:{span:4}},[t._v("施工单位")]),r("a-col",{attrs:{span:8}},[t._v(t._s(t.projInfo.biddingCorpName))])]:t._e()],2)],1),r("content-view",{staticStyle:{"margin-bottom":"50px"},attrs:{title:"附件上传"}},[r("type-attachment-upload",{ref:"fileupload",attrs:{"is-show-header":!1,busiType:"20",busiTypeDetail:"202G",busiNo:t.projInfo.id}})],1)],1)],1)},n=[],i=(r("6eb7"),r("0fea")),o=r("ac0d"),s=r("0a5e"),c=r("6fa9"),l=r("0c8a"),u=r("eccd"),d=r("dc9a"),f=r("9fbd"),p={name:"CorpMaintainModel",mixins:[s["a"],o["b"]],props:{busiType:{type:String,default:""}},components:{MESSuperQuery:c["default"],JDDictSelectTag:u["default"],ContentView:d["default"],TypeAttachmentUpload:f["default"]},created:function(){},data:function(){return{showPart:!1,fileModelVisible:!1,projInfo:{},fileName:"CorpMaintainModel",queryObj:[{type:"input",value:"comparinfo.region_name",label:"小区名称",queryType:"like"},{type:"input",value:"comparinfo.code",label:"项目编号",queryType:"like"},{type:"input",value:"comparinfo.describe",label:"维修描述",queryType:"like"},{type:"slot",value:"comparinfo.comparState",label:"比选状态",slotName:"comparState",showInQueryList:"take"==this.busiType},{type:"rangeDate",value:"comparinfo.comparStart",label:"报价开始",queryType:"like",showInQueryList:!1},{type:"rangeDate",value:"comparinfo.comparEnd",label:"报价截止",queryType:"like",showInQueryList:!1}],columns:[{title:"小区名称",headerAlign:"left",align:"left",field:"regionName",width:180},{title:"项目编号",align:"center",headerAlign:"center",field:"code",width:170,type:"input",slot:!0},{title:"维修描述",align:"left",headerAlign:"left",field:"describe"},{title:"项目状态",headerAlign:"center",align:"center",field:"projState",width:80,hidden:"bidd"!==this.busiType,slot:!0},{title:"比选状态",headerAlign:"left",align:"left",field:"comparState",width:110,hidden:"take"!==this.busiType,slot:!0},{title:"维修报价（元）",headerAlign:"right",align:"right",field:"corpPrice",width:140,formatter:"amount",hidden:"take"===this.busiType},{title:"质保期（月）",headerAlign:"right",align:"right",field:"period",width:120,hidden:"take"===this.busiType},{title:"工期（天）",headerAlign:"right",align:"right",field:"days",width:100,hidden:"take"===this.busiType},{title:"报价时间",align:"center",headerAlign:"center",width:160,field:"createTime",hidden:"take"===this.busiType},{title:"比选得分",headerAlign:"right",align:"right",field:"scoreTotal",width:80,hidden:"take"===this.busiType},{title:"名次",headerAlign:"center",align:"center",field:"ranking",width:80,hidden:"take"===this.busiType},{title:"报价开始时间",align:"center",headerAlign:"center",width:160,field:"comparStart",hidden:"bidd"===this.busiType||"unbidd"===this.busiType},{title:"报价截止时间",align:"center",headerAlign:"center",width:160,field:"comparEnd",hidden:"bidd"===this.busiType||"unbidd"===this.busiType},{title:"是否报价",align:"center",headerAlign:"center",width:80,field:"corpComparState",hidden:"bidd"===this.busiType||"unbidd"===this.busiType,slot:!0},{title:"操作",align:"center",headerAlign:"center",width:80,field:"action",hidden:"unbidd"===this.busiType,slot:!0}],url:{list:"/compare/bComparPart/getCorpMaintainInfo",getProInfoById:"/use/serviceProj/queryProj"}}},methods:{getBaseTypeText:l["getBaseTypeText"],loadData:function(t){return this.queryParam.flag=this.busiType,Object(i["e"])(this.url.list,Object.assign(t,this.queryParam)).then((function(t){return t.result}))},toDetail:function(t){this.showPart=!0;var e=!0;"take"===this.busiType?("1"==t.comparState&&(e=!1),this.$router.push({path:"/compare/corporation/modules/TakePartModel",query:{record:t,disabled:e}})):this.$router.push({path:"/compare/corporation/modules/TakePartModel",query:{record:t,disabled:!0}})},uploadFile:function(t){var e=this;this.$store.commit("SET_PAGE_LOAD_STATE",{state:!0}),Object(i["e"])(this.url.getProInfoById,{id:t.projId}).then((function(t){t&&t.success?(e.projInfo=t.result,e.fileModelVisible=!0,e.$nextTick((function(){e.$refs.fileupload.initData(!1,{"tenant-id":t.result.sysOrgCode})}))):e.$message.warning("项目信息获取失败")})).finally((function(){e.$store.commit("SET_PAGE_LOAD_STATE",{state:!1})}))}}},h=p,m=(r("b25f"),r("2b0a"),r("3786"),r("2877")),g=Object(m["a"])(h,a,n,!1,null,"6eacc6ce",null);e["default"]=g.exports},7936:function(t,e,r){},"7cee":function(t,e,r){"use strict";r("31a9")},"7d22":function(t,e,r){"use strict";r("58b3")},"7fa2":function(t,e,r){"use strict";r("2775")},8288:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"height-100",staticStyle:{"background-color":"#ffffff"}},[r("a-tabs",{staticClass:"tabsContent",attrs:{"default-active-key":"1"},on:{change:t.callback}},[r("a-tab-pane",{key:"1",attrs:{tab:"已中标"}},[r("corp-maintain-model",{ref:"bidd",attrs:{busiType:"bidd"}})],1),r("a-tab-pane",{key:"2",attrs:{tab:"未中标","force-render":""}},[r("corp-maintain-model",{ref:"unbidd",attrs:{busiType:"unbidd"}})],1)],1)],1)},n=[],i=r("78b86"),o={name:"BiddPartList",components:{CorpMaintainModel:i["default"]},data:function(){return{description:"企业已中标列表"}},methods:{callback:function(t){"1"===t&&this.$refs.bidd.queryPage(),"2"===t&&this.$refs.unbidd.queryPage()}}},s=o,c=(r("b7b0"),r("2877")),l=Object(c["a"])(s,a,n,!1,null,"5b820974",null);e["default"]=l.exports},8697:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-collapse",{model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[t._l(t.projFilesList,(function(e,a){return[r("a-collapse-panel",{key:a+""},[r("template",{slot:"header"},[r("a-breadcrumb",[r("a-breadcrumb-item",[t._v(" "+t._s(e.describe)+" ")])],1)],1),r("supervise-info",{attrs:{infoList:e.fileList,isDetail:!1,projectId:e.id},on:{getSuperviseInfo:t.getSuperviseInfo}})],2)]})),r("print-report-comp",{ref:"print",attrs:{zIndex:t.zIndex+1}})],2)},n=[],i=r("46f2"),o=r("9bed"),s=r("2b0e"),c={name:"SuperviseInfoCollapse",components:{SuperviseInfo:i["default"],PrintReportComp:o["default"]},props:{projFilesList:{type:Array,default:function(){return[]}},scope:{type:String,default:""}},data:function(){return{visable:!1,activeKey:["0"],userInfo:{}}},methods:{print:function(t,e,r){this.$refs.print.type="print","3"===t?this.$refs.print.print("fire_device_explore_report",{projId:e,orgCodeTxt:r}):"4"===t||"5"===t?this.$refs.print.print("lift_device_explore_report",{projId:e,orgCodeTxt:r}):"2"===t?this.$refs.print.print("waterproof_device_explore_report",{projId:e,orgCodeTxt:r}):this.$refs.print.print("public_device_explore_report",{projId:e,orgCodeTxt:r})},hidden:function(){this.visable=!1},show:function(t){var e=this;this.visable=!0,this.$nextTick((function(){e.$refs.supinfo.initSuperviseInfo(t)}))},getSuperviseInfo:function(){this.$emit("getSuperviseInfo")}},created:function(){this.userInfo=s["default"].ls.get("Login_Userinfo")}},l=c,u=r("2877"),d=Object(u["a"])(l,a,n,!1,null,null,null);e["default"]=d.exports},"894f":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-collapse",{model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-collapse-panel",{key:"0",attrs:{header:t.title,"show-arrow":!1}},[t.refreshState?r("avue-form",{attrs:{option:t.widgetFormPreview},model:{value:t.formModal,callback:function(e){t.formModal=e},expression:"formModal"}}):t._e()],1)],1)},n=[],i=r("0f1e"),o=r("2ed4");function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */c=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,r){return t[e]=r}}function f(t,e,r,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",m="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function _(){}var x={};d(x,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(x=C);var L=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,c){var l=p(t[n],t,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==s(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,o,c)}),(function(t){r("throw",t,o,c)})):e.resolve(d).then((function(t){u.value=t,o(u)}),(function(t){return r("throw",t,o,c)}))}c(l.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=h;return function(i,o){if(n===g)throw Error("Generator is already running");if(n===v){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===h)throw n=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=g;var l=p(e,r,a);if("normal"===l.type){if(n=a.done?v:m,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=v,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=p(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:w,configurable:!0}),w.displayName=d(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,d(t,u,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),d(D.prototype,l,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(f(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),d(L,u,"Generator"),d(L,o,(function(){return this})),d(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function l(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){l(i,a,n,o,s,"next",t)}function s(t){l(i,a,n,o,s,"throw",t)}o(void 0)}))}}var d={mixins:[i["a"]],name:"DynamicForm",props:{isDetail:{type:Boolean,default:!1}},data:function(){return{title:"",activeKey:"0",code:"",mainData:{}}},methods:{initData:function(t,e){this.mainData=t,this.initUniversalDynamicForm(t?t.id:"",this.code,this.isDetail)},checkData:function(){var t=this;return new Promise(function(){var e=u(c().mark((function e(r,a){var n,i;return c().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object(o["a"])(t.widgetFormPreview,t.formModal),!(n.length>0)){e.next=10;break}e.t0=c().keys(n);case 3:if((e.t1=e.t0()).done){e.next=10;break}return i=e.t1.value,t.$message.warning((n[i].index?"第"+(parseInt(n[i].index)+1)+"条的":"")+n[i].text+"不能为空"),a(),e.abrupt("return",!1);case 10:return e.next=12,t.saveUniversalDynamicForm(t.mainData.id);case 12:r("",{});case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}}},f=d,p=r("2877"),h=Object(p["a"])(f,a,n,!1,null,"4aa80c4f",null);e["default"]=h.exports},"899b":function(module,__webpack_exports__,__webpack_require__){"use strict";var _components_tools_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("4a6a"),_api_manage__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("0fea"),vue__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("2b0e"),_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("9fb0"),_utils_request__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("b775"),_components_tools_PreviewPicture__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("b7a8"),_components_tools_ScannerModal__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("4686");function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _regeneratorRuntime(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,a){var i=e&&e.prototype instanceof v?e:v,o=Object.create(i.prototype),s=new I(a||[]);return n(o,"_invoke",{value:S(t,r,s)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function b(){}var w={};l(w,o,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(j([])));x&&x!==r&&a.call(x,o)&&(w=x);var k=b.prototype=v.prototype=Object.create(w);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(n,i,o,s){var c=d(t[n],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==_typeof(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(u).then((function(t){l.value=t,o(l)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function S(e,r,a){var n=f;return function(i,o){if(n===h)throw Error("Generator is already running");if(n===m){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=D(s,a);if(c){if(c===g)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===f)throw n=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=h;var l=d(e,r,a);if("normal"===l.type){if(n=a.done?m:p,l.arg===g)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=m,a.method="throw",a.arg=l.arg)}}}function D(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),g;var i=d(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return y.prototype=b,n(k,"constructor",{value:b,configurable:!0}),n(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},C(L.prototype),l(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new L(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},C(k),l(k,c,"Generator"),l(k,o,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=j,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:j(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),g}},e}function asyncGeneratorStep(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){asyncGeneratorStep(i,a,n,o,s,"next",t)}function s(t){asyncGeneratorStep(i,a,n,o,s,"throw",t)}o(void 0)}))}}__webpack_exports__["a"]={name:"FileUpload",components:{ScannerModal:_components_tools_ScannerModal__WEBPACK_IMPORTED_MODULE_6__["default"],PreviewPicture:_components_tools_PreviewPicture__WEBPACK_IMPORTED_MODULE_5__["default"]},props:{isDetail:{type:Boolean,default:void 0}},data:function(){return{activeKey:["0"],uploadCode:"",tip:"正在处理中",SpinfileLoading:!1,fileLoading:!1,isNeedSetup:!1,imgWidth:500,perFileId:"",headers:{},cameraIndex:null,enclosureId:"",refresh:!0,previewVisible:!1,previewImageName:"",previewFileList:[],previewNum:0,enclosureList:[],invoiceList:[],modalVisible:!1,showList:[],sFileList:[],showImg:!1,imgSrc:null,jieTu:0,url:{getUploadCode:window._CONFIG["domianURL"]+"/qr/uploadCode",fileUploadImg:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=control&uploadType=5",fileUploadFile:window._CONFIG["domianURL"]+"/control/file/uploadImg?parenPath=control&uploadType=5",fileUpdateFile:window._CONFIG["domianURL"]+"/control/file/updateImg?parenPath=control&uploadType=5&fileId=",getFileList:"/components/comMatter/getFileList",getNewFileList:"/zlbt/applicationBuss/getFileList",getUploadCodeFile:"/qr/getUploadCodeFile"},heartCheck:null,websock:null,isOther:!1}},computed:{uploadActionImg:function(){return this.url.fileUploadImg},uploadActionFile:function(){return this.url.fileUploadFile},width:function(){return window.innerWidth}},created:function(){var t=this;this.initHeaders(),this.$bus.$on("setRequire",(function(e,r){for(var a=0;a<t.enclosureList.length;a++)e&&e===t.enclosureList[a].itemName&&(t.enclosureList[a].isRequire=r);t.$forceUpdate()}))},mounted:function(){},beforeDestroy:function(){this.websock&&this.websock.close()},methods:{initWebSocket:function(){this.websock&&this.websock.close();var t=vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get("Login_Userinfo"),e=window._CONFIG["domianURL"].replace("https://","wss://").replace("http://","ws://")+"/websocket/uploadCode"+t.id;this.websock=new WebSocket(e),this.websock.onopen=this.websocketOnopen,this.websock.onerror=this.websocketOnerror,this.websock.onmessage=this.websocketOnmessage,this.websock.onclose=this.websocketOnclose},websocketOnopen:function(){this.heartCheck.reset().start()},websocketOnerror:function(t){this.reconnect()},websocketOnmessage:function websocketOnmessage(e){var data=eval("("+e.data+")");if("uploadCode"==data.cmd){for(var index=0,i=0;i<this.enclosureList.length;i++)if(data.id===this.enclosureList[i].uploadCode){index=i;break}this.uploadCodeTask(data.id,index)}this.heartCheck.reset().start()},websocketOnclose:function(t){},websocketSend:function(t){try{this.websock.send(t)}catch(e){}},heartCheckFun:function(){var t=this;t.heartCheck={timeout:2e4,timeoutObj:null,serverTimeoutObj:null,reset:function(){return clearTimeout(this.timeoutObj),this},start:function(){this.timeoutObj=setTimeout((function(){t.websocketSend("HeartBeat")}),this.timeout)}}},onUpload:function(t){for(var e={},r=0,a=0;a<this.enclosureList.length;a++)if(this.enclosureList[a].id===this.enclosureId){e=this.enclosureList[a],r=a;break}for(var n=0;n<t.length;n++)this.uploadFile(t[n],e,r)},close:function(){for(var t=0;t<this.enclosureList.length;t++)if(this.enclosureList[t].showList&&this.enclosureList[t].showList.length>0)for(var e=0;e<this.enclosureList[t].showList.length;e++)if(this.enclosureList[t].showList[e].status&&"uploading"===this.enclosureList[t].showList[e].status)return this.$message.warning("请等待图片或附件处理完成!"),!1;this.fileModalVis=!1},uploadFile:function(t,e,r){var a=this;this.tip="正在上传文件",e.showList||(e.showList=[]),e.showList.push({uid:t.file.uid,name:t.file.name,status:"uploading"});var n=new FormData;n.append("file",t.file);var i={headers:{"Content-Type":"multipart/form-data",sourceName:vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get("SOURCE_NAME"),redisIndex:vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get("REDIS_INDEX"),"X-Access-Token":vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get("Access-Token")},timeout:6e4},o=this,s={percent:1},c=setInterval((function(){s.percent<95?(s.percent+=2,t.onProgress(s),o.$forceUpdate()):clearInterval(c)}),100);_utils_request__WEBPACK_IMPORTED_MODULE_4__["b"].post(this.url.fileUploadImg,n,i).then((function(n){if(n.success){var i={file:{status:"done",response:n,uid:t.file.uid}};a.handleChangeImageEnclosure(i,e,r),t.onSuccess(n)}else{var o={file:{status:"error",response:n,uid:t.file.uid}};a.handleChangeImageEnclosure(o,e,r),t.onError(n)}})).catch((function(n){var i={file:{status:"error",response:n,uid:t.file.uid}};a.handleChangeImageEnclosure(i,e,r),t.onError(n)}))},findInList:function(t,e){if(!t||0===t.length)return!1;for(var r=0;r<t.length;r++)if(t[r]===e)return!0;return!1},openModal:function(t){this.eidList=t,this.fileModalVis=!0},openAmountModal:function(t){this.eidAmountList=t},collectTo:function(t,e){for(var r=0;this.enclosureList&&this.enclosureList.length>0&&r<this.enclosureList.length;r++)if(this.enclosureList[r].id===t){for(var a=[].concat(this.enclosureList[r].fileList),n=function(t){var r=a.filter((function(r){return r.fileId===e[t].fileId}));r&&0!==r.length||a.push(e[t])},i=0;e&&i<e.length;i++)n(i);this.enclosureList[r].fileList=a,this.buildShowList(this.enclosureList[r])}},copyTo:function(t,e){for(var r=0;this.enclosureList&&this.enclosureList.length>0&&r<this.enclosureList.length;r++)this.enclosureList[r].id===t&&(this.enclosureList[r].fileList=[].concat(e),this.buildShowList(this.enclosureList[r]))},deleteTo:function(t,e){for(var r=0;this.enclosureList&&this.enclosureList.length>0&&r<this.enclosureList.length;r++)if(this.enclosureList[r].id===t){for(var a=0;e&&e.length>0&&a<e.length;a++)for(var n=0;this.enclosureList[r].fileList&&this.enclosureList[r].fileList.length>0&&n<this.enclosureList[r].fileList.length;n++)e[a].fileId===this.enclosureList[r].fileList[n].fileId&&this.enclosureList[r].fileList.splice(n,1);this.buildShowList(this.enclosureList[r])}},getFileList:function(t){for(var e=0;this.enclosureList&&this.enclosureList.length>0&&e<this.enclosureList.length;e++)if(this.enclosureList[e].id===t)return[].concat(this.enclosureList[e].fileList)},checkData:function(t){var e=this;return new Promise((function(r,a){if(e.fileLoading)return e.$message.warning("请等待图片或附件处理完成!"),a(),!1;if(t)for(var n=0;n<e.enclosureList.length;n++){if(e.enclosureList[n].showList&&e.enclosureList[n].showList.length>0)for(var i=0;i<e.enclosureList[n].showList.length;i++)if(e.enclosureList[n].showList[i].status&&"uploading"===e.enclosureList[n].showList[i].status)return e.$message.warning("请等待图片或附件处理完成!"),a(),!1;if("Y"===e.enclosureList[n].isRequire&&0===e.enclosureList[n].fileList.length&&!e.enclosureList[n].collectTo)return e.$message.warning(e.enclosureList[n].itemName+"的文件不能为空！"),a(),!1}r({path:"comMatterFileList",data:e.enclosureList})}))},numChange:function(t){this.previewNum=t},uploadCodeTask:function(t,e){var r=this;Object(_api_manage__WEBPACK_IMPORTED_MODULE_1__["e"])(this.url.getUploadCodeFile,{id:t}).then((function(t){if(t.success)for(var a=0;a<t.result.length;a++){for(var n=!1,i=0;i<r.enclosureList[e].fileList.length;i++)(r.enclosureList[e].fileList[i].fileId===t.result[a].id||r.enclosureList[e].fileList[i].fileOriginalId&&r.enclosureList[e].fileList[i].fileOriginalId===t.result[a].id)&&(n=!0);if(!n){var o=Object.create(t.result[a]);o.fileId=t.result[a].id,o.time=t.result[a].fileName.substring(t.result[a].fileName.lastIndexOf("_")+1,t.result[a].fileName.lastIndexOf(".")),r.enclosureList[e].fileList.push(o);var s=0;if(r.enclosureList[e].collectTo&&""!==r.enclosureList[e].collectTo){for(var c=0;c<r.enclosureList.length;c++)if(r.enclosureList[c].id===r.enclosureList[e].collectTo){s=c;break}r.enclosureList[s].fileList.push(o)}r.enclosureList[e].collectTo&&""!==r.enclosureList[e].collectTo&&r.buildShowList(r.enclosureList[s]),r.buildShowList(r.enclosureList[e]),r.$forceUpdate()}}}))},getUploadCode:function(t){var e=this;this.initWebSocket();var r=vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get(_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__["a"]),a=(vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get(_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__["A"]),vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get(_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__["x"])),n=window.location.protocol+"//"+window.location.host+"/UploadCodePage?token="+r+"&id=";Object(_api_manage__WEBPACK_IMPORTED_MODULE_1__["e"])(this.url.getUploadCode,{url:n}).then((function(r){if(r.success){var n=document.getElementById("qrcode"+t.id);n.innerHTML="",new QRCode(n,{text:window._CONFIG["domianURL"]+"/qr/goUploadCodePage?id="+r.message+"&r="+a,errorCorrectionLevel:"L",width:180,height:180}),t.uploadCode=r.message,e.$forceUpdate()}}))},handleRotate:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e,r){var a;return _regeneratorRuntime().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.handleCancel(),this.SpinfileLoading=!0,this.previewVisible=!1,a=this.dataURLtoFile(e,r.name),r.response?a.uid=r.response.result.id:a.uid=r.uid,t.next=7,this.imgChangeOK(a);case 7:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}(),onRemove:function(t,e){var r=this;this.enclosureId=e.id,this.fileLoading=!0;var a="";if(a=t.response?t.response.result.id:t.uid,this.enclosureList.forEach((function(t,e){if(r.enclosureList[e].fileList)for(var n=0;n<r.enclosureList[e].fileList.length;n++)if(r.enclosureList[e].fileList[n].fileId===a){r.enclosureList[e].fileList.splice(n,1);break}if(r.enclosureList[e].showList)for(var i=0;i<r.enclosureList[e].showList.length;i++)if(r.enclosureList[e].showList[i].uid===a){r.enclosureList[e].showList.splice(i,1);break}})),e.collectTo&&""!==e.collectTo){for(var n=0;n<this.enclosureList.length;n++)if(this.enclosureList[n].id===e.collectTo){if(this.enclosureList[n].fileList)for(var i=0;i<this.enclosureList[n].fileList.length;i++)if(this.enclosureList[n].fileList[i].fileId===a){this.enclosureList[n].fileList.splice(i,1);break}if(this.enclosureList[n].showList)for(var o=0;o<this.enclosureList[n].showList.length;o++){var s="";if(s=this.enclosureList[n].showList[o].response?this.enclosureList[n].showList[o].response.result.id:this.enclosureList[n].showList[o].uid,s===a){this.enclosureList[n].showList.splice(o,1);break}}break}}else{for(var c=[],l=0;l<this.enclosureList.length;l++)this.enclosureList[l].collectTo===e.id&&c.push(l);for(var u=0;u<c.length;u++){if(this.enclosureList[c[u]].fileList)for(var d=0;d<this.enclosureList[c[u]].fileList.length;d++)if(this.enclosureList[c[u]].fileList[d].fileId===a){this.enclosureList[c[u]].fileList.splice(d,1);break}if(this.enclosureList[c[u]].showList)for(var f=0;f<this.enclosureList[c[u]].showList.length;f++){var p="";if(p=this.enclosureList[c[u]].showList[f].response?this.enclosureList[c[u]].showList[f].response.result.id:this.enclosureList[c[u]].showList[f].uid,p===a){this.enclosureList[c[u]].showList.splice(f,1);break}}}}this.invoiceList.slice().reverse().forEach((function(t,e,r){t.fileId==a&&this.invoiceList.splice(r.length-1-e,1)})),this.fileLoading=!1,this.$emit("comMatterFileList",this.enclosureList),this.$bus.$emit("comMatterFileList",this.enclosureList)},onBeforeUploadImage:function(t){var e=this;return new Promise(function(){var r=_asyncToGenerator(_regeneratorRuntime().mark((function r(a,n){return _regeneratorRuntime().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.tip="正在进行前置处理",e.fileLoading=!0,"application/pdf"!==t.type){r.next=6;break}a(t),r.next=12;break;case 6:if(""!==t.type&&("image/JPG"===t.type||"image/bmp"===t.type||"image/png"===t.type||"image/jpg"===t.type||"image/jpeg"===t.type)){r.next=10;break}a(t),r.next=12;break;case 10:return r.next=12,_components_tools_tools__WEBPACK_IMPORTED_MODULE_0__["a"].imgCompression(t).then((function(t){a(t)}));case 12:case"end":return r.stop()}}),r)})));return function(t,e){return r.apply(this,arguments)}}())},onBeforeUpload:function(t){var e=this,r=t.size<10485760;return new Promise((function(a,n){-1!=t.type.indexOf("image")||-1!=t.type.indexOf("pdf")?(e.$message.warning("请使用图片上传处上传此类附件!"),n(t)):r?(e.fileLoading=!0,a(t)):(e.$message.warning("单个文件大小不能超过10MB!"),n(t))}))},giveShowList:function(t){for(var e=this,r=function(){if(e.enclosureList[a].id==e.enclosureId){null!=e.enclosureList[a].showList&&void 0!=e.enclosureList[a].showList&&e.enclosureList[a].showList!=[]||(e.enclosureList[a].showList=[]);var r=e.enclosureList[a].showList;t.forEach((function(t){r.push(t)})),e.$set(e.enclosureList[a],"showList",r)}},a=0;a<this.enclosureList.length;a++)r()},downloadGPY:function(){window.location.href="/download/高拍仪控件V3.6.2.exe"},delImg:function(t){this.showList.splice(t,1)},imgChangeOK:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(e){var r,a,n,i,o=this;return _regeneratorRuntime().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.SpinfileLoading=!0,r=e.uid,a=this.eIndex,this.previewNum,n=new FormData,n.append("file",e),i={headers:{"Content-Type":"multipart/form-data",sourceName:vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get("SOURCE_NAME"),redisIndex:vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get("REDIS_INDEX"),"X-Access-Token":vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get(_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__["a"])}},t.next=9,_utils_request__WEBPACK_IMPORTED_MODULE_4__["b"].post(this.url.fileUpdateFile+r,n,i).then((function(t){if(t.success){for(var e=0;e<o.enclosureList[a].fileList.length;e++){var n=o.enclosureList[a].fileList[e];if(n.fileId===r){n.filePath=t.result.filePath,n.thumPath=t.result.thumPath;break}}o.buildShowList(o.enclosureList[a]);var i=0;if(o.enclosureList[a].collectTo&&""!==o.enclosureList[a].collectTo){for(var s=0;s<o.enclosureList.length;s++)if(o.enclosureList[s].id===o.enclosureList[a].collectTo){i=s;break}for(var c=0;c<o.enclosureList[i].fileList.length;c++)if(o.enclosureList[i].fileList[c].fileId===r){o.enclosureList[i].fileList[c].filePath=t.result.filePath,o.enclosureList[i].fileList[c].thumPath=t.result.thumPath;break}o.buildShowList(o.enclosureList[i])}else{for(var l=[],u=0;u<o.enclosureList.length;u++)o.enclosureList[u].collectTo===o.enclosureList[a].id&&l.push(u);for(var d=0;d<l.length;d++)if(o.enclosureList[l[d]].fileList)for(var f=0;f<o.enclosureList[l[d]].fileList.length;f++)if(o.enclosureList[l[d]].fileList[f].fileId===r){o.enclosureList[l[d]].fileList[f].filePath=t.result.filePath,o.enclosureList[l[d]].fileList[f].thumPath=t.result.thumPath,o.buildShowList(o.enclosureList[l[d]]);break}}o.$emit("comMatterFileList",o.enclosureList),o.$bus.$emit("comMatterFileList",o.enclosureList),o.$forceUpdate(),o.fileLoading=!1,o.previewVisible=!1}}));case 9:this.$forceUpdate(),this.previewVisible=!1,this.SpinfileLoading=!1;case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),dataURLtoFile:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",r=t.split(","),a=r[0].match(/:(.*?);/)[1],n=a.split("/")[1],i=atob(r[1]),o=i.length,s=new Uint8Array(o);while(o--)s[o]=i.charCodeAt(o);var c="file";return c=-1!=e.indexOf(".")?e:e+n,new File([s],c,{type:a})},clickImg:function(t){this.imgSrc="Base64IMG"==t?document.getElementById("Base64IMG").src:t,this.showImg=!0},toCamera:function(t){this.$refs.ScannerModal.initData(),this.enclosureId=t},buildPath:function(t){return t&&-1!==t.indexOf("http")?t:window._CONFIG["staticDomainURL"]+"/"+t},initHeaders:function(){this.headers={sourceName:vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get(_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__["A"]),redisIndex:vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get(_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__["x"]),"X-Access-Token":vue__WEBPACK_IMPORTED_MODULE_2__["default"].ls.get(_store_mutation_types__WEBPACK_IMPORTED_MODULE_3__["a"])}},handleCancel:function(){document.body.removeChild(this.$refs.previewDiv),this.previewVisible=!1},checkCanPreview:function(t){var e=["jpg","JPG","jpeg","gif","GIF","JPEG","png","PNG","bmp","BMP","pdf","doc","docx","xls","xlsx","mp4"],r="";r=t.response?this.buildPath(t.response.result.filePath):t.originalImage||t.filePath;var a=r.substring(r.lastIndexOf(".")+1,r.length);return!(!this.findInList(e,a)||t.url.startsWith("/img/"))||(this.$message.info("此文件暂不支持预览,将为您下载"),setTimeout((function(){var e=document.createElement("a");e.href=r,e.target="_blank",e.download=t.name,e.style.display="none",e.click()}),1e3),!1)},handlePreview:function(t,e,r){var a=this;if(!this.checkCanPreview(t))return!1;this.previewFileList=e,this.enclosureId=e.id,this.eIndex=r,this.previewNum=0;for(var n=0;n<e.showList.length;n++)if(e.showList[n].response){if(e.showList[n].response&&e.showList[n].response.result&&e.showList[n].response.result.id==t.response.result.id){this.previewNum=n;break}}else if(e.showList[n].uid==t.uid){this.previewNum=n;break}this.previewVisible=!1,this.previewVisible=!0,this.$nextTick((function(){document.body.appendChild(a.$refs.previewDiv)}))},initData:function(t,e){var r,a=this;r="applicationBuss"==e.matterCode?this.url.getNewFileList:this.url.getFileList,"contractinfoDetail"==e.matterCode&&("详情"==t.type&&(this.isDetail=!0),"上传"==t.type&&(this.isDetail=!1),t.id=t.contractId),e.matterCode.indexOf("actionableSubsidy-00")>=0||e.matterCode.indexOf("actionableSubsidy-01")>=0?(e.matterCode="applicationBuss-"+e.matterCode.split("-")[1],t.id=t.applicationBussId):e.matterCode.indexOf("takeExit-00")>=0||e.matterCode.indexOf("takeExit-01")>=0?e.matterCode="applicationBuss-"+e.matterCode.split("-")[1]:e.matterCode.indexOf("companyBussAudit")>=0&&(e.matterCode="companyInfo"),Object(_api_manage__WEBPACK_IMPORTED_MODULE_1__["e"])(r,{mainId:t?t.id:"",matterCode:e.matterCode}).then((function(t){if(t.success){for(var e=0;t.result&&t.result.length>0&&e<t.result.length;e++){t.result[e].fileList||(t.result[e].fileList=[]);for(var r=0;t.result[e].fileList&&t.result[e].fileList.length>0&&r<t.result[e].fileList.length;r++)t.result[e].fileList[r].time=t.result[e].fileList[r].fileName.substring(t.result[e].fileList[r].fileName.lastIndexOf("_")+1,t.result[e].fileList[r].fileName.lastIndexOf("."))}if(a.enclosureList=t.result,a.enclosureList)for(var n=0;n<a.enclosureList.length;n++)a.enclosureList[n].isEnclosure=!1,a.enclosureList[n].fileList&&a.buildShowList(a.enclosureList[n]);a.$emit("comMatterFileList",a.enclosureList),a.$bus.$emit("comMatterFileList",a.enclosureList),a.refresh=!0}}))},deleteFileEnclosure:function(t){this.refresh=!1;for(var e=0;e<this.enclosureList.length;e++)for(var r=0;r<this.enclosureList[e].fileList.length;r++)this.enclosureList[e].fileList[r].fileId==t&&(this.enclosureList[e].fileList.splice(r,1),r--);this.refresh=!0,this.$emit("comMatterFileList",this.enclosureList),this.$bus.$emit("comMatterFileList",this.enclosureList)},buildShowList:function(t,e){var r=[];if(e&&"error"===e.file.status){for(var a=0;a<t.showList.length;a++)if(t.showList[a].uid===e.file.uid){var n={};n.uid=e.file.uid,n.name="上传失败",n.status="error",t.showList[a]=n;break}}else if(e&&e.file.uid){for(var i=e.file.response.result,o=0;o<t.showList.length;o++)if(t.showList[o].uid===e.file.uid){var s={};s.uid=i.id,s.name=i.originalName||i.fileName,s.url=this.getFileThumbUrlTypeImgByName(i.thumPath||i.filePath),s.originalImage=this.buildPath(i.filePath),s.time=i.fileName.substring(i.fileName.lastIndexOf("_")+1,i.fileName.lastIndexOf(".")),s.pdfUrl=this.buildPath(i.updateBy||i.pdfPath),t.showList[o]=s;break}}else{for(var c=0;c<t.fileList.length;c++){var l={};l.uid=t.fileList[c].fileId,l.name=t.fileList[c].originalName||t.fileList[c].fileName,l.url=this.getFileThumbUrlTypeImgByName(t.fileList[c].thumPath||t.fileList[c].filePath),l.originalImage=this.buildPath(t.fileList[c].filePath),l.pdfUrl=this.buildPath(t.fileList[c].updateBy||t.fileList[c].pdfPath),l.time=t.fileList[c].time?t.fileList[c].time:t.fileList[c].filePath.substring(t.fileList[c].filePath.lastIndexOf("_")+1,t.fileList[c].filePath.lastIndexOf(".")),r.push(l)}t.showList=[].concat(r)}t.showList&&t.showList.length>0&&(t.showList=t.showList.sort((function(t,e){return t.time>e.time?1:t.time<e.time?-1:t.fileName<e.fileName?1:t.fileName>e.fileName?-1:0})))},handleChangeImageEnclosure:function(t,e,r){var a=this;this.tip="正在处理",this.fileLoading=!0,this.refresh=!1;var n=t.file;if("error"===n.status&&this.buildShowList(this.enclosureList[r],t),"done"===n.status){if(n.response&&n.response.success){var i={};i.fileId=t.file.response.result.id,i.filePath=t.file.response.result.filePath,i.fileName=t.file.response.result.originalName,i.thumPath=t.file.response.result.thumPath,i.time=t.file.response.result.fileName.substring(t.file.response.result.fileName.lastIndexOf("_")+1,t.file.response.result.fileName.lastIndexOf(".")),i.enclosureId=e.id,this.enclosureList[r].fileList.push(i),this.buildShowList(this.enclosureList[r],t)}else a.$message.error(n.response.message?n.response.message:"上传失败");a.fileLoading=!1}this.refresh=!0,this.fileLoading=!1,this.$emit("comMatterFileList",this.enclosureList),this.$bus.$emit("comMatterFileList",this.enclosureList)},getFileThumbUrlTypeImgByName:function(t){var e="";e=t&&-1!==t.indexOf(".")?t.substring(t.lastIndexOf(".")+1,t.length):"file";try{__webpack_require__("d109")("./"+e+".png")}catch(r){e="file"}return this.isExistThumbnail(t)?this.buildPath(t):__webpack_require__("d109")("./"+e+".png")},isExistThumbnail:function(t){return t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".bmp")||t.endsWith(".JPG")||t.endsWith(".PNG")||t.endsWith(".GIF")||t.endsWith(".gif")||t.endsWith(".jpeg")},getEnclosureId:function(t){this.enclosureId=t}}}},"8f5f":function(t,e,r){},"91ef":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.refreshState?r("avue-form",{attrs:{option:t.widgetFormPreview},model:{value:t.formModal,callback:function(e){t.formModal=e},expression:"formModal"}}):t._e()],1)},n=[],i=r("0f1e"),o=r("2ed4");function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */c=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,r){return t[e]=r}}function f(t,e,r,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",m="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function _(){}var x={};d(x,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(x=C);var L=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,c){var l=p(t[n],t,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==s(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,o,c)}),(function(t){r("throw",t,o,c)})):e.resolve(d).then((function(t){u.value=t,o(u)}),(function(t){return r("throw",t,o,c)}))}c(l.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=h;return function(i,o){if(n===g)throw Error("Generator is already running");if(n===v){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===h)throw n=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=g;var l=p(e,r,a);if("normal"===l.type){if(n=a.done?v:m,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=v,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=p(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:w,configurable:!0}),w.displayName=d(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,d(t,u,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),d(D.prototype,l,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(f(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),d(L,u,"Generator"),d(L,o,(function(){return this})),d(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function l(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){l(i,a,n,o,s,"next",t)}function s(t){l(i,a,n,o,s,"throw",t)}o(void 0)}))}}var d={mixins:[i["a"]],name:"DynamicForm",props:{isDetail:{type:Boolean,default:!1}},data:function(){return{code:"",mainData:{}}},methods:{initData:function(t,e){this.mainData=t,this.initUniversalDynamicForm(t?t.id:"",this.code,this.isDetail)},checkData:function(){var t=this;return new Promise(function(){var e=u(c().mark((function e(r,a){var n,i;return c().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object(o["a"])(t.widgetFormPreview,t.formModal),!(n.length>0)){e.next=10;break}e.t0=c().keys(n);case 3:if((e.t1=e.t0()).done){e.next=10;break}return i=e.t1.value,t.$message.warning((n[i].index?"第"+(parseInt(n[i].index)+1)+"条的":"")+n[i].text+"不能为空"),a(),e.abrupt("return",!1);case 10:return e.next=12,t.saveUniversalDynamicForm(t.mainData.id);case 12:r("",{});case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}}},f=d,p=r("2877"),h=Object(p["a"])(f,a,n,!1,null,"0c5def98",null);e["default"]=h.exports},9265:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{"margin-top":"5px"}},[r("a-collapse",{model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-collapse-panel",{key:"1",staticClass:"after",attrs:{header:"审核意见","show-arrow":!1}},[t._t("default"),r("a-textarea",{attrs:{placeholder:"请输入审批意见",autoSize:{minRows:5,maxRows:8}},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),r("a-row",{staticStyle:{"text-align":"center","margin-top":"20px"}},[r("a-button",{staticClass:"warning",staticStyle:{width:"100px"},attrs:{type:"primary",icon:"reload"},on:{click:function(e){return t.adult(0)}}},[t._v("\r\n          驳回\r\n        ")]),r("a-button",{staticStyle:{"margin-left":"20px",width:"100px"},attrs:{type:"primary",icon:"check"},on:{click:function(e){return t.adult(1)}}},[t._v("\r\n          通过\r\n        ")]),-1!==(t.workFlowRecord.editUrl+"").indexOf("noPassFlag")?r("a-button",{staticStyle:{"margin-left":"20px",width:"100px"},attrs:{type:"danger",icon:"stop"},on:{click:function(e){return t.adult(4)}}},[t._v("\r\n          不通过\r\n        ")]):t._e()],1)],2)],1)],1)},n=[],i=(r("89f2"),{name:"WorkFlowApproval",props:{workFlowRecord:{type:Object,default:{}}},data:function(){return{activeKey:"1",comment:""}},methods:{adult:function(t){if((4===t||0===t)&&(!this.comment||""===this.comment))return this.$message.warning("请填写审批意见!"),!1;this.comment&&""!==this.comment||(this.comment="审批通过"),this.$emit("approval",t+"",this.comment)}}}),o=i,s=(r("fd02"),r("2877")),c=Object(s["a"])(o,a,n,!1,null,"1766f99d",null);e["default"]=c.exports},"963d":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"height100"},[r("content-view",{attrs:{title:t.title}},[r("j-form-container",{ref:"form",attrs:{disabled:!0,border:!1,model:t.projMainData(),formRef:"formRow"}},[r("a-row",{staticClass:"houseInfo",attrs:{type:"flex"}},[r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("项目描述")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projMainData().describe))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("申报小区")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projMainData().communityName))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("项目类型")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.getBaseTypeText(t.projMainData().baseType)))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("分摊方式")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[r("j-d-dict-select-tag",{attrs:{align:"left",dictCode:"allocation_method",readOnly:"",type:"select"},model:{value:t.projMainData().allotMode,callback:function(e){t.$set(t.projMainData(),"allotMode",e)},expression:"projMainData().allotMode"}})],1),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("联系人")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projMainData().reqMan))]),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("联系电话")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projMainData().reqPhone))]),"1"==t.projMainData().comparAble&&"1"!=t.projMainData().hisFlag?[r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("维修范围")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._l(t.repairRange,(function(e,a){return[e.value===t.projMainData().projScope?r("span",{key:"scope"+a},[t._v(t._s(e.text))]):t._e()]}))],2),r("a-col",{staticClass:"formLabel",attrs:{span:12,xl:4,xxl:2}},[t._v("施工单位")]),r("a-col",{attrs:{span:12,xl:8,xxl:4}},[t._v(t._s(t.projMainData().biddingCorpName))])]:t._e()],2)],1)],1),r("content-view",{attrs:{title:"附件上传"}},[r("type-attachment-upload",{ref:"fileupload",attrs:{"is-show-header":!1,busiType:"20",busiTypeDetail:"202G","is-load-init-data":!0,busiNo:t.projMainData().id,isDetail:!t.isDoing||"03"!=t.corpBaseType},on:{change:t.getFileList}})],1)],1)},n=[],i=r("9fbd"),o=r("dc9a"),s=r("eccd"),c=r("0c8a"),l=r("d8a5"),u=r("2b0e"),d={name:"CorpUploadFile",components:{JDDictSelectTag:s["default"],ContentView:o["default"],TypeAttachmentUpload:i["default"]},inject:{projMainData:{default:{}}},props:{isDoing:{type:Boolean,default:!1}},data:function(){return{title:"项目信息",activeKey:["1"],repairRange:[],corpBaseType:""}},created:function(){var t=this;Object(l["g"])("repair_range").then((function(e){e.success&&(t.repairRange=e.result)})),this.getLoginCorpInfo()},methods:{getBaseTypeText:c["getBaseTypeText"],getFileList:function(t){if(this.fileIdList=[],t){var e=this;t.forEach((function(t){e.fileIdList.push(t.id)}))}},getLoginCorpInfo:function(){var t=u["default"].ls.get("Login_CorpInfo");t&&"03"==t.baseType&&(this.corpBaseType="03")}}},f=d,p=(r("1987"),r("2877")),h=Object(p["a"])(f,a,n,!1,null,"4b41c156",null);e["default"]=h.exports},"9b37":function(t,e,r){"use strict";r("0c21")},"9bed":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return"modal"===t.type?r("j-modal",{attrs:{title:t.title,width:1600,top:t.top,visible:t.visible,zIndex:t.zIndex,switchFullscreen:"",okButtonProps:{class:{"jee-hidden":!0}},cancelButtonProps:{class:{"jee-hidden":!0}},cancelText:"关闭"},on:{cancel:t.handleCancel}},[r("iframe",{ref:"iframe",staticStyle:{width:"100%",border:"0"},attrs:{title:"",height:t.height,src:t.router}})]):"page"===t.type?r("div",[r("a-collapse",{attrs:{bordered:!1,expandIconPosition:"right"},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-collapse-panel",{key:"1",staticStyle:{"background-color":"#fff"},scopedSlots:t._u([{key:"header",fn:function(){return[r("span",{staticClass:"collapseTitle"},[t._v("\n            "+t._s(t.headerTitle)+"\n          ")])]},proxy:!0}])},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.iframeLoading,expression:"iframeLoading"}]},[t.router?r("iframe",{ref:"iframe",staticStyle:{width:"100%",border:"0"},attrs:{title:"",height:t.iframeLoading?200:t.height,src:t.router}}):t._e()])])],1)],1):t._e()},n=[],i=r("0fea"),o=r("2b0e"),s={name:"PrintReportComp",props:{height:{type:Number,default:700},top:{type:Number,default:20},zIndex:{type:Number,default:1e3}},inject:{projMainData:{default:{}}},computed:{projObj:function(){return this.projMainData()}},data:function(){return{headerTitle:"打印",activeKey:"1",title:"打印",visible:!1,router:"",type:"modal",initFormType:"",url:{queryReport:"/ureport2/ureport2Config/queryReport"},printHtml:"",iframeLoading:!1}},methods:{handleCancel:function(){this.visible=!1},print:function(t,e){var r=this;this.router="",this.$store.commit("SET_PAGE_LOAD_STATE",{state:!0,text:"正在打开，请稍等。。。"});var a="",n="";if(e)for(var s in e)n+="&".concat(s,"=").concat(encodeURIComponent(e[s]));Object(i["e"])(this.url.queryReport,{formType:t}).then((function(t){if(t.success){var e=t.result.formTypeName,s=o["default"].ls.get("SOURCE_NAME");s&&""!==s||(s="master"),a="/ureport/preview?_u="+s+"db:"+e+n+"&_t="+t.result.reportHeaderButton+"&_i=1",r.router=_baseConfig["production"].VUE_APP_API_BASE_URL+a,"page"===r.type&&r.$nextTick((function(){var t=r.$refs.iframe;r.iframeLoading=!0,t.onload=function(){r.iframeLoading=!1},t.onerror=function(){r.iframeLoading=!1}}));var c=window.navigator.userAgent;if(!c||-1===c.indexOf("Electron")&&-1===c.indexOf("electron")){if("modal"===r.type||"page"===r.type)r.visible=!0,r.$store.commit("SET_PAGE_LOAD_STATE",{state:!1});else if("window"===r.type)window.open(r.router),r.$store.commit("SET_PAGE_LOAD_STATE",{state:!1});else if("print"===r.type){var l=a.replaceAll("/ureport/preview","/ureport/preview/loadPrintPages");Object(i["e"])(l).then((function(t){var e=document.createElement("iframe");e.style.display="none",document.body.appendChild(e);var a=document.createElement("style"),n=t.paper.paperType;"CUSTOM"===n&&(n=r.pointToMM(t.paper.width)+"mm "+r.pointToMM(t.paper.height)+"mm");var i="\n                            @media print {\n                                .page-break{\n                                    display: block;\n                                    page-break-before: always;\n                                }\n                            }\n                            @page {\n                              size: ".concat(n," ").concat(t.paper.orientation,";\n                              margin-left: ").concat(r.pointToMM(t.paper.leftMargin),"mm;\n                              margin-top: ").concat(r.pointToMM(t.paper.topMargin),"mm;\n                              margin-right:").concat(r.pointToMM(t.paper.rightMargin),"mm;\n                              margin-bottom:").concat(r.pointToMM(t.paper.bottomMargin),"mm;\n                            }\n                      ");setTimeout((function(){a.innerHTML=i+t.style;var r=document.createElement("body");r.innerHTML=t.html,e.contentWindow.document.body.append(a),e.contentWindow.document.body.append(r)}),50),setTimeout((function(){e.contentWindow.print()}),100),setTimeout((function(){document.body.removeChild(e)}),500)})).finally((function(){r.$store.commit("SET_PAGE_LOAD_STATE",{state:!1})}))}}else window.open(r.router),r.$store.commit("SET_PAGE_LOAD_STATE",{state:!1})}})).catch((function(t){r.$store.commit("SET_PAGE_LOAD_STATE",{state:!1}),r.$message.warning("打印信息错误")}))},pointToMM:function(t){var e=.352778*t;return Math.round(e)},downloadFile:function(t){var e=this,r="pdf";Object(i["b"])(t).then((function(t){if(t)if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(new Blob([t],{type:"application/pdf"}),r+".pdf");else{var a=window.URL.createObjectURL(new Blob([t],{type:"application/pdf"})),n=(new Date).getTime(),i=document.createElement("iframe");i.style.frameborder="no",i.style.display="none",i.style.pageBreakBefore="always",i.setAttribute("id","printPdf"+n),i.setAttribute("name","printPdf"+n),i.src=a,document.body.appendChild(i);var o=document.getElementById("printPdf"+n).contentWindow;setTimeout((function(){o.print()}),100),window.URL.revokeObjectURL(i.src),e.pdfButtonLoading=!1}else e.$message.warning("文件下载失败")}))},initData:function(t){this.print(this.initFormType,this.projObj)}}},c=s,l=(r("7cee"),r("50ba"),r("2877")),u=Object(l["a"])(c,a,n,!1,null,"31f7fa68",null);e["default"]=u.exports},"9eab":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cardContain"},[r("div",{staticClass:"tableDiv"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,expand:!1,data:t.loadComparCoprList,tableColumn:t.comparColumns,"table-height":null,pageSize:15,"header-align":"center"},scopedSlots:t._u([{key:"buttons",fn:function(){return[r("div",{staticClass:"vxetable-operator"},[t._l(t.repairRange,(function(e){return[e.value===t.scope?r("span",[t._v("项目维修范围："+t._s(e.text))]):t._e()]}))],2)]},proxy:!0},{key:"name",fn:function(e){var a=e.text,n=e.row;return[r("a",{on:{click:function(e){return t.handleDetail(n)}}},[t._v(t._s(a))])]}},{key:"creditLevel",fn:function(e){var a=e.text;e.row;return["A"===a?r("a-tag",{attrs:{color:"green"}},[t._v(t._s(a))]):"B"===a?r("a-tag",{attrs:{color:"blue"}},[t._v(t._s(a))]):"C"===a?r("a-tag",{attrs:{color:"orange"}},[t._v(t._s(a))]):"D"===a?r("a-tag",{attrs:{color:"red"}},[t._v(t._s(a))]):r("span",[t._v(t._s("未评级"))])]}}])})],1),r("corp-info-detail",{ref:"detailForm"})],1)},n=[],i=r("0fea"),o=r("ac0d"),s=r("0a5e"),c=r("779d"),l=r("d8a5"),u={name:"SupplierSelect",components:{CorpInfoDetail:c["default"],initDictOptions:l["g"]},mixins:[s["a"],o["b"]],inject:{projMainData:{default:{}}},data:function(){return{repairRange:[],corpArr:[],url:{getEnterpriseList:"/base/rCorpInfo/getRepairableList"},tableData:[],materialapplyid:"",comparColumns:[{title:"单位名称",headerAlign:"left",align:"left",field:"name",width:300,slot:!0},{headerAlign:"center",title:"信用等级",align:"center",field:"creditLevel",width:80,type:"input",slot:!0},{headerAlign:"left",title:"统一社会信用代码",align:"left",field:"license"},{headerAlign:"left",title:"联系人",align:"left",field:"linkMan",width:150},{headerAlign:"left",title:"联系电话",align:"left",field:"phone",width:180,type:"input"}]}},created:function(){var t=this;Object(l["g"])("repair_range").then((function(e){e.success&&(t.repairRange=e.result)}))},props:{minCorpNum:{type:Number,default:1},projectId:{type:String,default:""},projectIds:[],scope:{type:String,default:""},comparProj:{type:Object,default:function(){return{}}}},methods:{handleDetail:function(t){this.$emit("handleDetail",t.id)},loadComparCoprList:function(t){var e=this,r=this;return r.projectIds=[],this.projMainData().children&&this.projMainData().children.length>0?this.projMainData().children.forEach((function(t){e.projectIds.push(t.id)})):this.projectIds.push(this.projMainData().id),Object(i["e"])(this.url.getEnterpriseList,Object.assign({current:1,size:1e3},{projectIds:this.projectIds.toString(),pid:this.projectId})).then((function(t){r.corpArr=t.result.records.map((function(t){return t.code})),r.$emit("getCorpCodes",r.corpArr)})),Object(i["e"])(this.url.getEnterpriseList,Object.assign(t,{projectIds:r.projectIds.toString(),pid:this.projectId})).then((function(t){return"0"!=e.comparProj.comparState||t.result.records&&t.result.records.length>=e.minCorpNum?r.$emit("set-company-sufficient",!0):r.$emit("set-company-sufficient",!1),t.result}))}}},d=u,f=(r("e580"),r("2877")),p=Object(f["a"])(d,a,n,!1,null,"2f6dbf1b",null);e["default"]=p.exports},"9fee":function(t,e,r){"use strict";r("0279")},a37d:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cardContain"},[r("j-form-container",{ref:"form",attrs:{border:!1,model:t.comparProj,formRef:"formRow"}},[r("a-row",{ref:"formRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{span:4}},[t._v("项目维修范围")]),r("a-col",{attrs:{span:4}},[t._l(t.repairRange,(function(e){return[e.value===t.scope?[t._v(t._s(e.text))]:t._e()]}))],2),r("a-col",{attrs:{span:4}},[t._v("报价开始时间")]),r("a-col",{attrs:{span:4,"data-prop":"price"}},[r("span",[t._v(" "+t._s(t.comparProj.comparStart)+" ")])]),r("a-col",{attrs:{span:4}},[t._v("报价结束时间")]),r("a-col",{attrs:{span:4,"data-prop":"name"}},[r("span",[t._v(t._s(t.comparProj.comparEnd))])]),r("a-col",{attrs:{span:4}},[t._v("竞价状态")]),r("a-col",{attrs:{span:4,"data-prop":"address"}},["0"==t.comparProj.comparState?r("span",[t._v("未开始")]):t._e(),"1"==t.comparProj.comparState?r("span",[t._v("进行中")]):t._e(),"2"==t.comparProj.comparState?r("span",[t._v("已结束")]):t._e(),"3"==t.comparProj.comparState?r("span",[t._v("已结束")]):t._e(),"X"==t.comparProj.comparState?r("span",[t._v("已结束")]):t._e()]),"1"==t.comparProj.comparState?r("a-col",{attrs:{span:4}},[t._v("剩余时间")]):t._e(),"1"==t.comparProj.comparState?r("a-col",{attrs:{span:4}},[r("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(t.deadline)+" ")])]):t._e()],1)],1),r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,expand:!1,data:t.loadData,tableColumn:t.columns,"table-height":null,"page-size":15,"header-align":"center"},scopedSlots:t._u([{key:"buttons",fn:function(){return[r("div",{staticClass:"vxetable-operator"},["1"==t.comparProj.comparState?r("a-button",{attrs:{type:"primary",icon:"swap-right"},on:{click:t.openExtendModal}},[t._v("延长比选时间")]):t._e(),t.showReComparButton?r("a-button",{attrs:{type:"primary",icon:"rollback"},on:{click:t.reCompar}},[t._v("重新发起比选")]):t._e(),r("span",[t._v(" 施工单位总数："+t._s(t.comparStatic.total))]),r("a-divider",{attrs:{type:"vertical"}}),r("span",[t._v("已参与："+t._s(t.comparStatic.involved))]),r("a-divider",{attrs:{type:"vertical"}}),r("span",[t._v("未参与："+t._s(t.comparStatic.notInvolved))])],1)]},proxy:!0},{key:"corpName",fn:function(e){var a=e.text,n=e.row;return[r("a",{on:{click:function(e){return t.handleDetail(n)}}},[t._v(t._s(a))])]}},{key:"creditLevel",fn:function(e){var a=e.text;e.row;return["A"===a?r("a-tag",{attrs:{color:"green"}},[t._v(t._s(a))]):"B"===a?r("a-tag",{attrs:{color:"blue"}},[t._v(t._s(a))]):"C"===a?r("a-tag",{attrs:{color:"orange"}},[t._v(t._s(a))]):"D"===a?r("a-tag",{attrs:{color:"red"}},[t._v(t._s(a))]):r("span",[t._v(t._s("未评级"))])]}},{key:"createTime",fn:function(e){var a=e.text,n=e.row;return["1"==t.comparProj.comparState?r("span",[t._v("****\n        ")]):"0"==n.corpComparState?r("span"):r("span",[t._v(t._s(t.dateFormat(a)))])]}},{key:"corpPrice",fn:function(e){e.text;var a=e.row;return["1"==t.comparProj.comparState?r("span",[t._v("****\n        ")]):r("a",{on:{click:function(e){return t.getPriceDetail(a.id,a.corpCode)}}},[t._v(t._s(t.encryption(t.formatterAmount(a.corpPrice)))+"\n        ")])]}},{key:"corpComparState",fn:function(t){var e=t.text;t.row;return[r("a-badge","1"===e?{attrs:{status:"processing",text:"已提交"}}:{attrs:{status:"warning",text:"未提交"}})]}},{key:"days",fn:function(e){e.text;var r=e.row;return[t._v("\n        "+t._s(t.encryption(r.days?r.days:0))+"\n      ")]}},{key:"period",fn:function(e){e.text;var r=e.row;return[t._v("\n        "+t._s(t.encryption(r.period?r.period:0))+"\n      ")]}},{key:"action",fn:function(e){e.text;var a=e.row;return["1"==t.comparProj.comparState?[r("span",{staticStyle:{color:"#a3a3a3"},attrs:{title:"竞价结束后可查看"}},[r("a-icon",{attrs:{type:"eye"}}),t._v(" 施工方案")],1)]:[r("a",{on:{click:function(e){return t.openViewFilesModal(a.fileList)}}},[r("a-icon",{attrs:{type:"eye",theme:"twoTone"}}),t._v(" 施工方案")],1)]]}}])}),r("vxe-modal",{attrs:{"show-zoom":"",title:"报价详情",width:"1100px",height:"auto",position:{top:"center",left:"center"},"show-footer":""},on:{cancel:t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[r("template",{slot:"footer"},[r("div",{staticStyle:{"text-align":"center"}},[r("a-button",{on:{click:t.handleCancel}},[r("a-icon",{attrs:{type:"close-circle"}}),t._v("\n            取消\n          ")],1)],1)]),r("comparpart-price-detail",{ref:"priceDetail"})],2),r("j-modal",{attrs:{visible:t.extendModalVisible,title:"延长比选时间"},on:{ok:t.extendOk,cancel:t.hideModal}},[r("j-form-container",{ref:"form",attrs:{rules:t.validatorRules,model:t.model,disabled:!1,formRef:"formOwnRow",border:!1}},[r("a-row",{ref:"formOwnRow",staticClass:"baseInfo houseInfo",attrs:{slot:"edit",type:"flex",justify:"start",align:"middle"},slot:"edit"},[r("a-col",{attrs:{span:8}},[r("span",{staticClass:"required"},[t._v("比选结束时间")])]),r("a-col",{attrs:{span:16,"data-prop":"extendDateTime"}},[r("a-date-picker",{attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择新结束时间"},model:{value:t.model.extendDateTime,callback:function(e){t.$set(t.model,"extendDateTime",e)},expression:"model.extendDateTime"}})],1)],1)],1)],1),r("corp-info-detail",{ref:"detailForm"}),r("view-file-model",{ref:"viewFile"})],1)},n=[],i=r("0fea"),o=r("ac0d"),s=r("0a5e"),c=r("670e"),l=r("c1df"),u=r.n(l),d=r("5c11"),f=r("cbcd"),p=r("3ed7"),h=r("779d"),m=r("d8a5"),g=r("f4f7"),v=r("5a0c"),y={name:"BiddingHall",components:{ComparpartPriceDetail:f["default"],CorpInfoDetail:h["default"],initDictOptions:m["g"],viewFileModel:g["default"]},mixins:[c["a"],s["a"],o["b"]],data:function(){var t=this;return{comparStatic:{},serverTime:"",repairRange:[],model:{},formatterAmount:p["g"],activeKey:["1"],title:"项目信息",visible:!1,extendModalVisible:!1,deadline:"",url:{updateComparState:"/compare/bComparProj/updateComparStateByComparId",getEnterpriseList:"/base/rCorpInfo/list",getBComparPartList:"/compare/bComparPart/rankList",endNow:"/compare/bComparProj/endNow",extendDateTime:"/compare/bComparProj/extendDateTime",getCorpCompareStaticInfo:"/compare/bComparProj/getCorpCompareStaticInfo"},loadData:function(e){var r={};return r.comparId=t.comparProj.id,r.scope=t.scope,Object(i["e"])(t.url.getBComparPartList,Object.assign(e,r)).then((function(t){return t.result}))},columns:[{title:"单位名称",headerAlign:"left",align:"left",field:"corpName",minWidth:"180",slot:!0},{headerAlign:"left",title:"统一社会信用代码",align:"left",field:"license",minWidth:100},{headerAlign:"left",title:"联系人",align:"left",field:"contacts",width:"100",type:"input"},{headerAlign:"left",title:"联系电话",align:"left",field:"contactNumber",width:"120",type:"input"},{headerAlign:"center",title:"信用等级",align:"center",field:"creditLevel",width:"100",type:"input",slot:!0},{headerAlign:"right",title:"维修报价（元）",align:"right",field:"corpPrice",width:"120",type:"Number",formatter:"amount",slot:!0},{headerAlign:"right",title:"质保期（月）",align:"right",field:"period",width:"120",type:"Number",slot:!0},{headerAlign:"right",title:"工期（天）",align:"right",field:"days",width:"100",type:"Number",slot:!0},{headerAlign:"center",title:"报价时间",align:"center",field:"createTime",width:"200",slot:!0},{headerAlign:"center",title:"状态",align:"center",field:"corpComparState",width:100,slot:!0},{headerAlign:"center",title:"操作",align:"center",field:"action",width:150,slot:!0}],validatorRules:{extendDateTime:[{required:!0,message:"请选择比选结束时间！"}]}}},props:{minCorpNum:{type:Number,default:1},projectId:{type:String,default:""},comparProj:{type:Object,default:function(){}},scope:{type:String,default:""},projBaseType:{type:String,default:"01"}},computed:{showReComparButton:function(){return"2"==this.comparProj.comparState&&this.comparProj.comparCorpCount<this.minCorpNum}},created:function(){var t=this;this.getDifferTime(),this.start(),this.initWebSocket(),Object(m["g"])("repair_range").then((function(e){e.success&&(t.repairRange=e.result)})),this.getCorpCompareStaticInfo()},mounted:function(){this.check()},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{getCorpCompareStaticInfo:function(){var t=this;Object(i["e"])(this.url.getCorpCompareStaticInfo+"/"+this.comparProj.id+"/").then((function(e){t.comparStatic=e.result}))},check:function(){this.showReComparButton&&this.$warning({title:"报价单位不足 "+this.minCorpNum+" 家，请重新发起比选！",content:"报价单位不足，点击“重新发起比选”按钮，可以重新生成比选项目。",okText:"关闭"})},openViewFilesModal:function(t){this.$refs.viewFile.fileManageList=t,this.$refs.viewFile.showList=t,this.$refs.viewFile.show()},dateFormat:function(t){var e=new Date(t),r=e.getFullYear(),a=this.padDate(e.getMonth()+1),n=this.padDate(e.getDate()),i=this.padDate(e.getHours()),o=this.padDate(e.getMinutes()),s=this.padDate(e.getSeconds());return"".concat(r,"-").concat(a,"-").concat(n," ").concat(i,":").concat(o,":").concat(s)},padDate:function(t){return t<10?"0"+t:t},handleDetail:function(t){this.$emit("handleDetail",t.corpId)},reCompar:function(){var t=this;this.$confirm({content:"确定重新发起比选项目吗？",onOk:function(){t.$emit("re_create_compar")}})},encryption:function(t){return"1"==this.comparProj.comparState?"****":t},disabledEndDate:function(t){var e=v(this.comparProj.comparEnd,"YYYY-MM-DD HH:mm:ss");return!(!t||!e)&&e.valueOf()>=t.valueOf()},openExtendModal:function(){this.extendModalVisible=!0},extendOk:function(){var t=this;if(this.valida()){this.extendModalVisible=!1;var e=new Date(v(this.model.extendDateTime).format("YYYY-MM-DD HH:mm:ss")),r=new Date(this.comparProj.comparEnd);if(e<r)return this.$message.warning("延长时间应大于结束时间"),!1;Object(i["j"])(this.url.extendDateTime,{id:this.comparProj.id,comparEnd:v(this.model.extendDateTime).format("YYYY-MM-DD HH:mm:ss")}).then((function(e){e.success&&(t.$message.success("延长成功"),t.comparProj.comparEnd=v(t.model.extendDateTime).format("YYYY-MM-DD HH:mm:ss"),t.$emit("getComparProj"))}))}},hideModal:function(){this.extendModalVisible=!1},endNow:function(){var t=this;Object(i["l"])(this.url.endNow,this.comparProj).then((function(e){e.success&&(t.$message.success("操作成功"),t.comparProj.comparState="2")}))},handleCancel:function(){this.visible=!1},getPriceDetail:function(t,e){var r=this;this.visible=!0,this.$nextTick((function(){r.$refs.priceDetail.showByPartId(t,e)}))},start:function(){this.timer&&clearInterval(this.timer),this.timer=setInterval(this.valChange,1e3)},getDifferTime:function(){var t=this;Object(i["e"])("/compare/bComparProj/getServerTime").then((function(e){var r=(new Date).getTime();t.differTime=r-e.result}))},valChange:function(){var t=this;if(this.comparProj.comparEnd){var e=this.comparProj.comparEnd.replaceAll("-","").replaceAll(":","").replaceAll(" ",""),r=Object(d["i"])((new Date).getTime()-this.differTime),a=r.replaceAll("-","").replaceAll(":","").replaceAll(" ","");if(a>=e&&"1"==this.comparProj.comparState){this.biddingState="已结束";var n=this;Object(i["j"])(this.url.updateComparState+"/"+this.comparProj.id).then((function(e){e.success&&(t.$emit("getComparProj"),t.queryPage(),e.result<n.minCorpNum&&t.$warning({title:"报价单位不足 "+t.minCorpNum+" 家，请重新发起比选！",content:"报价单位不足，点击“重新发起比选”按钮，可以重新生成比选项目。",okText:"关闭"}))})),clearInterval(this.timer)}else{var o=u()(this.comparProj.comparEnd).diff(r,"seconds");this.deadline=Object(d["d"])(o)}}},valida:function(){var t=this.$refs.form.validaRowMsg(this.$refs.formOwnRow);return t.valida},initWebSocket:function(){this.websock&&this.websock.close();var t=window._CONFIG["domianURL"].replace("https://","wss://").replace("http://","ws://")+"/websocket/corp"+this.comparProj.id;this.websock=new WebSocket(t),this.websock.onopen=this.websocketOnopen,this.websock.onerror=this.websocketOnerror,this.websock.onmessage=this.websocketOnmessage,this.websock.onclose=this.websocketOnclose},websocketOnopen:function(){},heartCheckFun:function(){var t=this;t.heartCheck={timeout:2e4,timeoutObj:null,serverTimeoutObj:null,reset:function(){return clearTimeout(this.timeoutObj),this},start:function(){this.timeoutObj=setTimeout((function(){t.websocketSend("HeartBeat")}),this.timeout)}}},websocketOnerror:function(){this.reconnect()},reconnect:function(){var t=this;if(t.lockReconnect)return clearTimeout(this.websocketTimer),void(this.websocketTimer=null);t.lockReconnect=!0,this.websocketTimer=setTimeout((function(){t.initWebSocket(),t.lockReconnect=!1}),5e3)},websocketOnmessage:function(t){this.queryPage(),this.getCorpCompareStaticInfo()},websocketOnclose:function(t){}}},b=y,w=(r("7cd0"),r("b443"),r("2877")),_=Object(w["a"])(b,a,n,!1,null,"2ba0e202",null);e["default"]=_.exports},a62d:function(t,e,r){"use strict";r("171c")},a700:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("j-modal",{attrs:{title:t.title,width:"80%",visible:t.visible,confirmLoading:t.confirmLoading,switchFullscreen:"",cancelText:"关闭"},on:{ok:t.handleOk,cancel:t.handleCancel}},[r("a-spin",{attrs:{spinning:t.confirmLoading}},[r("a-form-model",{ref:"form",attrs:{model:t.model,rules:t.validatorRules}},[r("a-descriptions",{attrs:{bordered:"",size:"small"}},[r("a-descriptions-item",{scopedSlots:t._u([{key:"label",fn:function(){return[r("span",{staticClass:"requiredText"},[t._v("*")]),r("span",[t._v("组件名称")])]},proxy:!0}])},[r("a-form-model-item",{attrs:{prop:"comName"}},[r("a-input",{attrs:{placeholder:"请输入组件名称"},model:{value:t.model.comName,callback:function(e){t.$set(t.model,"comName",e)},expression:"model.comName"}})],1)],1),r("a-descriptions-item",{scopedSlots:t._u([{key:"label",fn:function(){return[r("span",{staticClass:"requiredText"},[t._v("*")]),r("span",[t._v("组件路径")])]},proxy:!0}])},[r("a-form-model-item",{attrs:{prop:"comPath"}},[r("a-input",{attrs:{placeholder:"请输入组件路径"},model:{value:t.model.comPath,callback:function(e){t.$set(t.model,"comPath",e)},expression:"model.comPath"}})],1)],1),r("a-descriptions-item",{attrs:{label:"组件类型"}},[r("a-select",{staticStyle:{width:"100%"},attrs:{"default-value":"00",placeholder:"请选择组件类型"},model:{value:t.model.comType,callback:function(e){t.$set(t.model,"comType",e)},expression:"model.comType"}},[r("a-select-option",{attrs:{value:"00"}},[t._v(" 业务组件 ")]),r("a-select-option",{attrs:{value:"01"}},[t._v(" 首页组件 ")])],1)],1),"01"===t.model.comType?r("a-descriptions-item",{attrs:{label:"关联角色"}},[r("j-select-role",{model:{value:t.model.roles,callback:function(e){t.$set(t.model,"roles",e)},expression:"model.roles"}})],1):t._e()],1),r("a-descriptions",{staticStyle:{"margin-top":"5px"},attrs:{bordered:"",size:"small",column:{xm:1},layout:"vertical"}},[r("a-descriptions-item",{attrs:{label:"组件预览"}},[t.comPath?r("div",{staticStyle:{"pointer-events":"none"}},[r(t.comPath.default,{tag:"component"})],1):r("a-empty",{attrs:{description:"组件不存在，请确认组件路径是否正确。"}})],1)],1)],1)],1)],1)},n=[],i=r("0fea"),o=(r("c1df"),r("1e8c")),s={name:"ComLibraryModal",components:{JSelectRole:o["default"]},computed:{comPath:function(){var t;try{t=r("a8c4")("./views".concat(this.model.comPath))}catch(e){}return t}},data:function(){return{title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,validatorRules:{comName:[{required:!0,message:"请输入组件名称"}],comPath:[{required:!0,message:"请输入组件路径"}]},url:{add:"/components/comLibrary/add",edit:"/components/comLibrary/edit"}}},created:function(){},methods:{add:function(){this.edit({})},edit:function(t){this.model=Object.assign({},t),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1,this.$refs.form.clearValidate()},handleOk:function(){var t=this,e=this;this.$refs.form.validate((function(r){if(!r)return!1;e.confirmLoading=!0;var a="",n="";t.model.id?(a+=t.url.edit,n="put"):(a+=t.url.add,n="post"),Object(i["i"])(a,t.model,n).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok")):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1,e.close()}))}))},handleCancel:function(){this.close()}}},c=s,l=(r("0c6a"),r("2877")),u=Object(l["a"])(c,a,n,!1,null,"36589d52",null);e["default"]=u.exports},a718:function(t,e,r){"use strict";r("4037")},a8a2:function(t,e,r){},a8d3:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[r("a-row",{attrs:{gutter:24}},[r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("a-form-item",[r("a-input",{attrs:{placeholder:"请输入事项名称"},model:{value:t.queryParam.matterName,callback:function(e){t.$set(t.queryParam,"matterName",e)},expression:"queryParam.matterName"}})],1)],1),r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("a-form-item",[r("a-input",{attrs:{placeholder:"请输入事项编码"},model:{value:t.queryParam.matterCode,callback:function(e){t.$set(t.queryParam,"matterCode",e)},expression:"queryParam.matterCode"}})],1)],1),r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[r("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.searchQuery}},[t._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"redo"},on:{click:t.searchReset}},[t._v("重置")])],1)])],1)],1)],1),r("div",{staticClass:"table-operator"},[r("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v("新增")]),r("a-button",{attrs:{icon:"delete"},on:{click:t.batchDel}},[t._v("批量删除")])],1),r("div",[r("div",{staticClass:"ant-alert ant-alert-info",staticStyle:{"margin-bottom":"16px"}},[r("em",{staticClass:"anticon anticon-info-circle ant-alert-icon"}),r("span",[t._v("已选择")]),r("a",{staticStyle:{"font-weight":"600"}},[t._v("\n        "+t._s(t.selectedRowKeys.length)+"\n      ")]),r("span",[t._v("项")]),r("a",{staticStyle:{"margin-left":"24px"},on:{click:t.onClearSelected}},[t._v("清空")])]),r("a-table",{ref:"table",attrs:{size:"middle",bordered:"",rowKey:"id",columns:t.columns,dataSource:t.dataSource,pagination:t.ipagination,loading:t.loading,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(e,a){return r("span",{},[r("a",{on:{click:function(e){return t.handleEdit(a)}}},[r("a-icon",{attrs:{type:"edit"}}),t._v(" 编辑")],1),r("a-divider",{attrs:{type:"vertical"}}),r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.handleDelete(a.id)}}},[r("a",[r("a-icon",{attrs:{type:"delete"}}),t._v(" 删除")],1)]),r("a-divider",{attrs:{type:"vertical"}}),r("a-popconfirm",{attrs:{title:"确定复制吗?"},on:{confirm:function(){return t.handleCopy(a.matterCode)}}},[r("a",[r("a-icon",{attrs:{type:"copy"}}),t._v(" 复制")],1)])],1)}}])})],1),r("comMatter-modal",{ref:"modalForm",on:{ok:t.modalFormOk}})],1)},n=[],i=r("b65a"),o=r("4e8e"),s=r("0fea"),c={name:"ComMatterList",mixins:[i["a"]],components:{ComMatterModal:o["default"]},data:function(){return{description:"动态组件事项主表管理页面",columns:[{title:"#",dataIndex:"",key:"rowIndex",width:60,align:"center",customRender:function(t,e,r){return parseInt(r)+1}},{title:"事项编码",align:"center",dataIndex:"matterCode"},{title:"事项名称",align:"center",dataIndex:"matterName"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],url:{list:"/components/comMatter/list",delete:"/components/comMatter/delete",copy:"/components/comMatter/copy",deleteBatch:"/components/comMatter/deleteBatch",exportXlsUrl:"components/comMatter/download",importExcelUrl:"components/comMatter/importExcel"}}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)}},methods:{handleCopy:function(t){var e=this;Object(s["j"])(this.url.copy,{matterCode:t}).then((function(t){t.success?e.$message.info(t.message):e.$message.error(t.message),e.loadData()}))},handleExportXls:function(t){var e=this;t&&"string"===typeof t||(t="导出文件");var r=this.getQueryParams();this.selectedRowKeys&&this.selectedRowKeys.length>0&&(r["selections"]=this.selectedRowKeys.join(",")),Object(s["b"])(this.url.exportXlsUrl,r).then((function(r){if(r)if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(new Blob([r],{type:"application/vnd.ms-word"}),t+".xls");else{var a=window.URL.createObjectURL(new Blob([r],{type:"application/vnd.ms-word"})),n=document.createElement("a");n.style.display="none",n.href=a,n.setAttribute("download",t+".doc"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}else e.$message.warning("文件下载失败")}))},initDictConfig:function(){}}},l=c,u=(r("0a8d"),r("2877")),d=Object(u["a"])(l,a,n,!1,null,"23a3a74a",null);e["default"]=d.exports},aae5:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-spin",{attrs:{spinning:t.confirmLoading}},[r("j-form-container",{ref:"form",attrs:{rules:t.validatorRules,model:t.model,disabled:t.formDisabled,formRef:"formOwnRow",border:!1}},[r("a-row",{ref:"formOwnRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[t.isParent?[r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v("比选类型")]),r("a-col",{attrs:{span:8,"data-prop":"comparName"}},[r("a-input",{model:{value:t.model.comparName,callback:function(e){t.$set(t.model,"comparName",e)},expression:"model.comparName"}})],1)]:t._e(),r("a-col",{attrs:{span:4}},[t._v("主管单位")]),r("a-col",{attrs:{span:8,"data-prop":"weight"}},[r("j-dict-county-tree-select",{attrs:{replaceFields:{value:"code",children:"children",title:"name"}},model:{value:t.model.sysOrgCode,callback:function(e){t.$set(t.model,"sysOrgCode",e)},expression:"model.sysOrgCode"}})],1),r("a-col",{attrs:{span:4}},[t._v("维修范围")]),r("a-col",{attrs:{span:20}},[r("a-checkbox-group",{attrs:{options:t.scopeList},model:{value:t.model.comparConfigScopes,callback:function(e){t.$set(t.model,"comparConfigScopes",e)},expression:"model.comparConfigScopes"}})],1),r("a-col",{attrs:{span:4}},[t._v("备注")]),r("a-col",{attrs:{span:20}},[r("a-textarea",{model:{value:t.model.remark,callback:function(e){t.$set(t.model,"remark",e)},expression:"model.remark"}})],1)],2)],1)],1)},n=[],i=r("0fea"),o=r("eccd"),s=r("d8a5"),c=r("db21"),l={name:"BComparConfigForm",components:{JDDictSelectTag:o["default"],JDictCountyTreeSelect:c["default"]},props:{disabled:{type:Boolean,default:!1,required:!1}},data:function(){return{checkedList:["电梯","外墙"],indeterminate:!0,checkAll:!1,scopeList:[],parentInfo:{},comparNameDictList:[],compositeComparDictList:[],isParent:!0,isEdit:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,url:{addOrEditConfig:"/compare/bComparConfig/addOrEditConfig",queryById:"/compare/bComparConfig/queryById",getComparConfigList:"/compare/bComparConfig/getComparConfigList",getCompositeComparList:"/compare/bComparConfig/getCompositeComparList",getUtilityList:"/business/utility/getUtilityList"},validatorRules:{comparName:[{required:!0,message:"请输入比选类型!"}]}}},computed:{formDisabled:function(){return this.disabled}},created:function(){this.modelDefault=JSON.parse(JSON.stringify(this.model)),this.getComparTypeList(),this.getScopeList()},methods:{getScopeList:function(){var t=this;Object(s["g"])("repair_range").then((function(e){t.scopeList=e.result.map((function(t){var e={};return e.label=t.text,e.value=t.value,e}))}))},getComparTypeList:function(){var t=this;Object(i["e"])(this.url.getComparConfigList).then((function(e){t.comparNameDictList=e.result}))},getCompositeComparList:function(){var t=this;Object(i["e"])(this.url.getCompositeComparList,{id:this.parentInfo.id}).then((function(e){t.compositeComparDictList=e.result}))},addChild:function(t){this.parentInfo=t,this.getCompositeComparList(),this.visible=!0,this.model.parentId=t.id},add:function(){this.edit(this.modelDefault)},edit:function(t){this.model=Object.assign({},t),this.visible=!0},valida:function(){var t=this.$refs.form.validaRowMsg(this.$refs.formOwnRow);return t.valida},submitForm:function(){if(this.valida()){var t=this;t.confirmLoading=!0,Object(i["j"])(this.url.addOrEditConfig,this.model).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1}))}}}},u=l,d=(r("7728"),r("2877")),f=Object(d["a"])(u,a,n,!1,null,"84f9ea54",null);e["default"]=f.exports},af2d:function(t,e,r){},b1c3:function(t,e,r){},b443:function(t,e,r){"use strict";r("dbb8")},b4c9:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cardContain"},[[r("a-row",{ref:"formRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{span:4}},[t._v("项目维修范围")]),r("a-col",{attrs:{span:4}},[t._l(t.repairRange,(function(e){return[e.value===t.scope?r("span",[t._v(t._s(e.text))]):t._e()]}))],2),r("a-col",{attrs:{span:4}},[t._v("中标单位")]),r("a-col",{attrs:{span:4,"data-prop":"name"}},[r("span",[t._v(t._s(t.biddingCorp))])]),r("a-col",{attrs:{span:4}},[t._v("中标时间")]),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"marginRight10"},[t._v(t._s(t.biddingTime))])]),r("a-col",{attrs:{span:4}},[t._v("比选方式")]),r("a-col",{attrs:{span:4}},[t._l(t.comparTypes,(function(e){return[e.id==t.comparProj.configId?[t._v("\n              "+t._s(e.comparName)+"\n            ")]:t._e()]}))],2)],1),r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,expand:!1,data:t.loadData,tableColumn:t.columns,"table-height":null,"page-size":15,"header-align":"center","if-init-query":!1,"cell-style":t.cellStyle},scopedSlots:t._u([{key:"buttons",fn:function(){return[t.comparProj.comparTime?t._e():r("div",{staticClass:"vxetable-operator"},[r("a-button",{attrs:{type:"primary"},on:{click:t.doComapr}},[t._v("开始比选")])],1)]},proxy:!0},{key:"corpName",fn:function(e){var a=e.text,n=e.row;return[r("a",{on:{click:function(e){return t.handleDetail(n)}}},[t._v(t._s(a))])]}},{key:"scoreTotal",fn:function(e){e.text;var a=e.row;return[r("a",{on:{click:function(e){return t.getScoreDetail(a.id)}}},[t._v(t._s(t.formatterAmount(a.scoreTotal))+"\n          ")])]}},{key:"corpPrice",fn:function(e){e.text;var a=e.row;return[r("a",{on:{click:function(e){return t.getPriceDetail(a.id,a.corpCode)}}},[t._v(t._s(t.formatterAmount(a.corpPrice))+"\n          ")])]}},{key:"days",fn:function(e){e.text;var r=e.row;return[t._v("\n          "+t._s(r.days?r.days:0)+"\n        ")]}},{key:"period",fn:function(e){e.text;var r=e.row;return[t._v("\n          "+t._s(r.period?r.period:0)+"\n        ")]}},{key:"action",fn:function(e){var a=e.row;return[r("get-table-action-buttons",["3"!=t.comparProj.comparState?[r("a",{on:{click:function(e){return t.openBiddingModel(a)}}},[r("a-icon",{attrs:{type:"check-circle",theme:"twoTone"}}),t._v(" 中标确认 ")],1)]:t._e(),r("a",{on:{click:function(e){return t.openViewFilesModal(a.fileList)}}},[r("a-icon",{attrs:{type:"eye",theme:"twoTone"}}),t._v(" 施工方案 ")],1),"3"==t.comparProj.comparState&&"1"==a.isBidding?[r("a",{on:{click:function(e){return t.showReason(a)}}},[r("a-icon",{attrs:{type:"eye",theme:"twoTone"}}),t._v(" 详情 ")],1)]:t._e()],2)]}},{key:"creditLevel",fn:function(e){var a=e.text;e.row;return["A"===a?r("a-tag",{attrs:{color:"green"}},[t._v(t._s(a))]):"B"===a?r("a-tag",{attrs:{color:"blue"}},[t._v(t._s(a))]):"C"===a?r("a-tag",{attrs:{color:"orange"}},[t._v(t._s(a))]):"D"===a?r("a-tag",{attrs:{color:"red"}},[t._v(t._s(a))]):r("span",[t._v(t._s("未评级"))])]}}])})],r("vxe-modal",{attrs:{"show-zoom":"",title:"价格详情",width:"1100px",height:"auto",position:{top:"center",left:"center"},"show-footer":""},on:{cancel:t.handlePriceDetailCancel},model:{value:t.showPriceDetail,callback:function(e){t.showPriceDetail=e},expression:"showPriceDetail"}},[r("template",{slot:"footer"},[r("div",{staticStyle:{"text-align":"center"}},[r("a-button",{on:{click:t.handlePriceDetailCancel}},[r("a-icon",{attrs:{type:"close-circle"}}),t._v("\n            取消\n          ")],1)],1)]),r("comparpart-price-detail",{ref:"priceDetail"})],2),r("vxe-modal",{attrs:{"show-zoom":"",title:"得分明细",width:"1100px",height:"auto","show-footer":""},on:{cancel:t.handleScoreDetailCancel},model:{value:t.showScoreDetail,callback:function(e){t.showScoreDetail=e},expression:"showScoreDetail"}},[r("template",{slot:"footer"},[r("div",{staticStyle:{"text-align":"center"}},[r("a-button",{on:{click:t.handleScoreDetailCancel}},[r("a-icon",{attrs:{type:"close-circle"}}),t._v("\n            取消\n          ")],1)],1)]),r("comparpart-score-detail",{ref:"scoreDetail"})],2),r("bidding-reason-model",{ref:"reasonModel",attrs:{disableSubmit:t.disableSubmit},on:{ok:t.reasonOk}}),r("corp-info-detail",{ref:"detailForm"}),r("view-file-model",{ref:"viewFile"})],2)},n=[],i=r("0fea"),o=r("ac0d"),s=r("0a5e"),c=r("f64c"),l=(r("c1df"),r("cbcd")),u=r("1821"),d=r("779d"),f=r("d8a5"),p=r("f4f7"),h=r("2d4c"),m=r("3ed7"),g=r("2142"),v={name:"BiddingResultTwo",components:{ComparpartPriceDetail:l["default"],ComparpartScoreDetail:u["default"],CorpInfoDetail:d["default"],initDictOptions:f["g"],viewFileModel:p["default"],GetTableActionButtons:h["default"],BiddingReasonModel:g["default"]},mixins:[s["a"],o["b"],c["a"]],props:{scope:{type:String,default:""},comparProj:{type:Object,default:function(){return{}}},comparTypes:[]},data:function(){var t=this;return{ModalText:"Content of the modal",visible:!1,confirmLoading:!1,disableSubmit:!0,viewFileVisible:!1,repairRange:[],comparTypeDict:[],comparConfig:[],formatterAmount:m["g"],showPriceDetail:!1,showScoreDetail:!1,showTable:!1,comparMode:"",biddingTime:"",biddingCorp:"",url:{getEnterpriseList:"/base/rCorpInfo/list",getBComparPartList:"/compare/bComparPart/rankList",queryComparResultList:"/compare/bComparPart/queryComparResultList",onBidding:"/compare/bComparPart/onBidding",getComparProj:"/compare/bComparProj/queryById",getComparConfigUrl:"/compare/bComparConfig/getPrimaryConf",doCompar:"/compare/bComparPart/doCompar",getBiddingInfo:"/compare/bComparPart/getBiddingInfo"},loadData:function(e){var r={};return r.comparId=t.comparProj.id,r.scope=t.scope,Object(i["e"])(t.url.queryComparResultList,Object.assign(e,r)).then((function(t){return t.result}))},columns:[{title:"单位名称",headerAlign:"left",align:"left",field:"corpName",width:180,slot:!0},{headerAlign:"left",title:"统一社会信用代码",align:"left",field:"license",minWidth:150},{headerAlign:"left",title:"联系人",align:"left",field:"contacts",width:100,type:"input"},{headerAlign:"left",title:"联系电话",align:"left",field:"contactNumber",width:130,type:"input"},{headerAlign:"center",title:"信用等级",align:"center",field:"creditLevel",width:100,slot:!0,type:"input"},{headerAlign:"right",title:"维修报价（元）",align:"right",field:"corpPrice",width:120,type:"Number",formatter:"amount",slot:!0},{headerAlign:"right",title:"质保期（月）",align:"right",field:"period",width:120,type:"Number",slot:!0},{headerAlign:"right",title:"工期（天）",align:"right",field:"days",width:100,type:"Number",slot:!0},{headerAlign:"right",title:"比选得分",align:"right",field:"scoreTotal",width:80,type:"input",slot:!0},{title:"操作",field:"action",align:"center",fixed:"right",width:200,slot:!0}]}},created:function(){var t=this;this.$store.commit("SET_PAGE_LOAD_STATE",{state:!0}),this.$emit("getComparProj"),this.getBiddingInfo(),Object(f["g"])("repair_range").then((function(e){e.success&&(t.repairRange=e.result)}))},mounted:function(){this.comparProj.comparTime&&this.queryPage()},methods:{showReason:function(t){this.disableSubmit=!0,this.$refs.reasonModel.show(t)},reasonOk:function(t){this.onBidding(t)},cellStyle:function(t){var e=t.row;t.rowIndex,t.column,t.columnIndex;if("1"==e.isBidding)return{background:"#fbd0d0"}},handleDetail:function(t){this.$emit("handleDetail",t.corpId)},handlePriceDetailCancel:function(){this.showPriceDetail=!1},handleScoreDetailCancel:function(){this.showScoreDetail=!1},getScoreDetail:function(t){var e=this;this.showScoreDetail=!0,this.$nextTick((function(){e.$refs.scoreDetail.showByPartId(t)}))},getPriceDetail:function(t,e){var r=this;this.showPriceDetail=!0,this.$nextTick((function(){r.$refs.priceDetail.showByPartId(t,e)}))},openBiddingModel:function(t){this.disableSubmit=!1,this.$refs.reasonModel.show(t)},onBidding:function(t){var e=this,r=this;this.$confirm({content:"签名页面",onOk:function(){r.$store.commit("SET_PAGE_LOAD_STATE",{state:!0}),Object(i["j"])(r.url.onBidding,t).then((function(t){t.result?(e.$emit("getComparProj"),r.$message.success("操作成功"),e.queryPage(),e.getBiddingInfo()):r.$store.commit("SET_PAGE_LOAD_STATE",{state:!1})})).catch((function(){r.$store.commit("SET_PAGE_LOAD_STATE",{state:!1})}))}})},getCompare:function(){this.queryPage()},doComapr:function(t){var e=this;Object(i["j"])(this.url.doCompar,Object.assign(t,{configId:this.comparProj.configId,id:this.comparProj.id,scope:this.scope})).then((function(t){t.success?(e.queryPage(),e.$emit("getComparProj")):e.$message.warning(t.message)}))},getBiddingInfo:function(){var t=this;Object(i["e"])(this.url.getBiddingInfo,{comparId:this.comparProj.id}).then((function(e){e.success&&e.result&&(t.biddingTime=e.result.biddingtime,t.biddingCorp=e.result.biddingcorp)}))},openViewFilesModal:function(t){this.$refs.viewFile.fileManageList=t,this.$refs.viewFile.showList=t,this.$refs.viewFile.show()}}},y=v,b=(r("d580"),r("393d"),r("2877")),w=Object(b["a"])(y,a,n,!1,null,"3095ea8e",null);e["default"]=w.exports},b7b0:function(t,e,r){"use strict";r("40d06")},bba1:function(t,e,r){},c5d9:function(t,e,r){},c7b6:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.dataSource&&t.dataSource.length>0?r("div",{staticStyle:{"margin-top":"10px"}},[r("a-collapse",{attrs:{bordered:!1,expandIconPosition:"right"},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-collapse-panel",{key:"1",staticStyle:{"background-color":"#fff"},scopedSlots:t._u([{key:"header",fn:function(){return[r("span",{staticClass:"collapseTitle",attrs:{"aria-label":"1"}},[t._v("\n          "+t._s(t.title)+"\n        ")])]},proxy:!0}],null,!1,2260987890)},[t.nodes&&t.nodes.length>0?r("a-steps",{staticStyle:{"pointer-events":"none"},attrs:{type:"default"},model:{value:t.current,callback:function(e){t.current=e},expression:"current"}},t._l(t.nodes,(function(t){return r("a-step",{attrs:{title:t.taskName}})})),1):t._e(),r("a-table",{ref:"table",staticStyle:{"padding-top":"20px"},attrs:{size:"middle",columns:t.columns,dataSource:t.dataSource,pagination:!1},scopedSlots:t._u([{key:"rowIndexBase",fn:function(e,a,n){return[r("div",{class:a.endTime?"rowIndex":"rowIndexHover"},[t._v("\n            "+t._s(""+(n+1))+"\n          ")])]}}],null,!1,1615520765)})],1)],1)],1):t._e()},n=[],i=r("0fea"),o=r("dc9a"),s={name:"WorkFlowHistory",components:{ContentView:o["default"]},inject:["comData","projMainData"],data:function(){return{title:"审批历史",current:0,nodes:[],activeKey:["0","1"],imageUrl:"",dataSource:[],columns:[{title:"序号",dataIndex:"",key:"rowIndex",width:50,scopedSlots:{customRender:"rowIndexBase"},align:"center"},{title:"任务名称",align:"center",width:160,dataIndex:"name",ellipsis:!0},{title:"处理人",align:"center",width:100,dataIndex:"assigneeName",ellipsis:!0,customRender:function(t,e){return t||e.assignee}},{title:"耗时",align:"center",width:120,dataIndex:"duration",customRender:function(t,e){var r=e.duration,a="";if(null!=r){var n=Math.floor(r/864e5);0!=n&&(a+=n+"天");var i=r%864e5,o=Math.floor(i/36e5);0!=o&&(a+=o+"小时");var s=i%36e5,c=Math.floor(s/6e4);0!=c&&(a+=c+"分");var l=Math.round(s%6e4/1e3);a+=l+"秒"}return a}},{title:"开始时间",align:"center",width:160,dataIndex:"startTime",customRender:function(t,e){return t?t.substring(10):""}},{title:"结束时间",align:"center",width:160,dataIndex:"endTime",customRender:function(t,e){return t?t.substring(10):""}},{title:"审批结果",align:"center",dataIndex:"taskFlow",width:80,customRender:function(t){return"1"==t?"通过":"0"==t?"驳回":"4"==t?"未通过":t}},{title:"审批意见",align:"center",dataIndex:"comment"}]}},methods:{getHistory:function(t,e){var r=this;this.nodes=[],Object(i["e"])("/act/taskinst/history/task/"+t).then((function(a){a.success&&(r.dataSource=a.result,e||r.getMainTaskName(t))}))},getPic:function(t){var e=this;Object(i["e"])("/handle/getPic/"+t).then((function(t){t&&t.msg?e.imageUrl="":e.imageUrl="data:image/png;base64,"+t}))},getMainTaskName:function(t){var e=this,r=t.substring(0,t.lastIndexOf("."));Object(i["e"])("/handle/getMainTaskName/",{ProcessDefinitionKey:r}).then((function(t){e.$set(e,"nodes",t.result);var r=e.dataSource[e.dataSource.length-1];r.endTime?e.current=e.dataSource.length:e.current=t.result.findIndex((function(t){if(t.taskName===r.name)return!0})),e.$set(e,"current",e.current)}))},initData:function(){}}},c=s,l=(r("e00e"),r("2877")),u=Object(l["a"])(c,a,n,!1,null,"56bc88a2",null);e["default"]=u.exports},cbcd:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-spin",{attrs:{spinning:t.confirmLoading}},[r("div",{staticClass:"padding8"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!1,bordered:"",stripe:!0,"table-height":null,"max-height":500,expand:!1,"show-pagination":!0,"span-method":t.rowspanMethod,"header-align":"center",ifInitQuery:!1,data:t.loadData,tableColumn:t.columns},scopedSlots:t._u([{key:"costListRemark",fn:function(e){e.text;var a=e.row;return[r("span",[t._v(t._s(a.costListRemark))])]}},{key:"univalence",fn:function(e){e.text;var a=e.row;return[a.univalence>0?r("span",[t._v("\n            "+t._s(Number(a.univalence).toLocaleString("zh-CN",{style:"decimal",currency:"CNY",minimumFractionDigits:2,maximumFractionDigits:2}))+"\n          ")]):r("span",[t._v("\n            -\n          ")])]}},{key:"unit",fn:function(e){var r=e.text;e.row;return[t._l(t.units,(function(e){return[e.value==r?[t._v("\n              "+t._s(e.text)+"\n            ")]:t._e()]}))]}},{key:"selectedMaterials",fn:function(e){var a=e.row;e.column,e.$rowIndex;return[a.materialList?r("el-popover",{attrs:{"popper-class":"materialPreviewPopover",placement:"left",width:"600",trigger:"hover","close-delay":200,"open-delay":200},on:{show:function(e){return t.showPopover(a)},hide:function(e){return t.hidePopover(a)}}},[r("div",{staticClass:"popoverBody"},[r("vxe-grid",{staticStyle:{width:"100%"},attrs:{"auto-resize":"","show-overflow":"tooltip",size:"mini",height:"200",data:t.previewPage.showList,columns:t.materialColumns},scopedSlots:t._u([{key:"name",fn:function(e){var a=e.row;return[r("span",[t._v(t._s(t.getMaterialName(a)))])]}}],null,!0)}),r("vxe-pager",{attrs:{total:t.previewPage.total,"page-size":t.previewPage.size,"page-sizes":[5,10,15,20],size:"mini",align:"right","current-page":t.previewPage.current,layouts:["PrevPage","Jump","PageCount","NextPage","Sizes","Total"]},on:{"page-change":t.getPreviewShowListByPage}})],1),r("a",{staticClass:"cursor-default",attrs:{slot:"reference"},slot:"reference"},[t._v("共"+t._s(a.materialList.length)+"个 "),r("a-icon",{attrs:{type:"eye"}})],1)]):r("span",[t._v("暂无已选材料")])]}},{key:"priceTotal",fn:function(e){e.text;var a=e.row;return[r("span",[t._v(t._s(Number(a.priceTotal).toLocaleString("zh-CN",{style:"decimal",currency:"CNY",minimumFractionDigits:2,maximumFractionDigits:2}))+"\n          ")])]}}])}),r("select-material-modal",{ref:"selectMaterialModal",attrs:{materialTree:t.materialTree,disabledAdd:t.disabled}})],1)])},n=[],i=r("821c"),o=r("0a5e"),s=r("0fea"),c=r("d8a5"),l=r("24cf"),u=r("3ed7");function d(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=f(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function f(t,e){if(t){if("string"==typeof t)return p(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}var h={name:"ComparpartPriceDetail",components:{HouseDetailComp:i["default"],SelectMaterialModal:l["default"]},mixins:[o["a"]],props:{disabled:{type:Boolean,default:!1,required:!1}},data:function(){var t=this;return{materialColumns:[{field:"name",title:"材料名称",slots:{default:"name"}},{field:"quantity",title:"数量",align:"right"},{field:"unitPrice",title:"单价",align:"right"},{field:"model",title:"型号"},{field:"brand",title:"品牌"}],previewPage:{current:1,size:5,total:0,showList:[],allList:[]},materialTree:[],units:[],model:{},loadData:function(e){return Object(s["e"])(t.url.list,Object.assign(e,{id:t.model.partId,corpCode:t.model.corpCode})).then((function(t){return t.result}))},confirmLoading:!1,columns:[{title:"项目描述",align:"left",field:"projDescribe",showOverflow:!1},{title:"标准维修项目名称",align:"left",headerAlign:"left",field:"costListRemark",slot:!0,showOverflow:!1},{title:"描述",align:"left",headerAlign:"left",field:"describe"},{title:"总价",align:"right",headerAlign:"right",width:"100px",field:"priceTotal",formatter:function(t){var e=t.cellValue;t.row;return Object(u["g"])(e)+" 元"}},{title:"备注",align:"brand",headerAlign:"brand",width:"100px",field:"remark"}],url:{list:"/compare/bComparPriceInfo/queryPageListExtended"}}},computed:{CMaterialList:function(){var t=[];function e(r){var a,n=d(r);try{for(n.s();!(a=n.n()).done;){var i=a.value;i.children&&i.children.length>0?e(i.children):t.push(i)}}catch(o){n.e(o)}finally{n.f()}}return e(this.materialTree),t}},created:function(){this.getUnits(),this.initMaterialTree()},methods:{getMaterialName:function(t){if(t.name)return t.name;var e=this.CMaterialList.find((function(e){return e.code===t.materialCode}));return e?e.title:void 0},getPreviewShowListByPage:function(t){var e=t.currentPage,r=t.pageSize;this.previewPage.size=r,this.previewPage.current=e,this.previewPage.showList=this.previewPage.allList.slice((e-1)*r,e*r)},hidePopover:function(){document.querySelectorAll(".materialPreviewPopover").forEach((function(t){t.remove()}))},showPopover:function(t){this.previewPage.allList=JSON.parse(JSON.stringify(t.materialList)),this.previewPage.total=this.previewPage.allList.length,this.previewPage.current=1,this.previewPage.size=5,this.getPreviewShowListByPage({currentPage:1,pageSize:5})},initMaterialTree:function(){var t=this;this.materialTree=[],Object(s["e"])("/sys/category/loadTreeRoot",{async:!1,pcode:"material_type"}).then((function(e){e&&e.success&&e.result.length>0&&(t.materialTree=e.result)}))},getTextByValue:function(t){var e,r=d(this.units);try{for(r.s();!(e=r.n()).done;){var a=e.value;if(t==a.value)return a.text}}catch(n){r.e(n)}finally{r.f()}return""},showMaterialModal:function(t){this.$refs.selectMaterialModal.open([t],"edit")},getUnits:function(){var t=this;Object(c["g"])("compar_unit").then((function(e){t.units=e.result}))},showByPartId:function(t,e){this.model.partId=t,this.model.corpCode=e,this.queryPage()},rowspanMethod:function(t){var e=t.row,r=t.$rowIndex,a=t.column,n=t.data,i=["projDescribe","costListRemark"];if(i.includes(a.property)){var o=e[a.property],s=n[r-1],c=n[r+1];if(s&&s[a.property]===o)return{rowspan:0,colspan:0};var l=1;while(c&&c[a.property]===o)c=n[++l+r];if(l>1)return{rowspan:l,colspan:1}}}}},m=h,g=(r("1f23"),r("2877")),v=Object(g["a"])(m,a,n,!1,null,"7dbfdec1",null);e["default"]=v.exports},cdb0:function(t,e,r){"use strict";r("af2d")},cf1f:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-row",{attrs:{gutter:10}},[r("a-col",{attrs:{md:4,sm:24}},[r("a-card",{attrs:{bordered:!1}},[r("div",{staticStyle:{background:"#fff","padding-left":"16px",height:"100%","margin-top":"5px"}},[r("a-input-search",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入名称"},on:{search:t.onSearch}}),r("a-col",{attrs:{md:5,sm:24}},[[r("a-tree",{attrs:{checkable:"",multiple:"",selectedKeys:t.selectedKeys,checkedKeys:t.checkedKeys,treeData:t.departTree,checkStrictly:t.checkStrictly,expandedKeys:t.iExpandedKeys,autoExpandParent:t.autoExpandParent},on:{check:t.onCheck,rightClick:t.rightHandle,expand:t.onExpand}})]],2)],1)])],1),r("a-col",{attrs:{md:20,sm:24}},[r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[r("a-row",[r("a-col",{staticStyle:{"border-right":"4px"},attrs:{span:18}},[r("a-row",{attrs:{gutter:24,type:"flex"}},[r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("a-form-item",{attrs:{label:"标题",colon:!1}},[r("a-input",{attrs:{placeholder:"请输入标题"},model:{value:t.queryParam.contentTitle,callback:function(e){t.$set(t.queryParam,"contentTitle",e)},expression:"queryParam.contentTitle"}})],1)],1)],1)],1),r("a-col",{staticStyle:{display:"flex","justify-content":"right",height:"40px"},attrs:{span:6}},[r("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left"}},[r("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.searchQuery}},[t._v("查询")]),r("a-button",{staticStyle:{"margin-left":"4px"},attrs:{type:"primary",icon:"reload"},on:{click:t.searchResetNew}},[t._v("重置")])],1)])],1)],1)],1),r("div",{staticClass:"table-operator"},[t.selectedRowKeys.length>0?r("a-dropdown",[r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",{key:"1",on:{click:t.batchDel}},[r("a-icon",{attrs:{type:"delete"}}),t._v("删除")],1)],1),r("a-button",{staticStyle:{"margin-left":"8px"}},[t._v(" 批量操作 "),r("a-icon",{attrs:{type:"down"}})],1)],1):t._e(),t.selectedRowKeys.length>0?r("span",{staticClass:"ant-alert ant-alert-info",staticStyle:{"margin-bottom":"10px","margin-right":"10px",top:"1px"}},[r("i",{staticClass:"anticon anticon-info-circle ant-alert-icon"}),t._v(" 已选择 "),r("a",{staticStyle:{"font-weight":"600"}},[t._v(t._s(t.selectedRowKeys.length))]),t._v("项\n          "),r("a",{staticStyle:{"margin-left":"24px"},on:{click:t.onClearSelected}},[t._v("清空")])]):t._e()],1),r("div",[r("a-table",{ref:"table",attrs:{size:"middle",bordered:"",rowKey:"id",columns:t.columns,dataSource:t.dataSource,pagination:t.ipagination,loading:t.loading,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange,columnWidth:40}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"detail",fn:function(e,a){return r("span",{},[r("a",{on:{click:function(e){return t.detailHistory(a)}}},[t._v(t._s(null==a.num?0:a.num)+"/"+t._s(t.systemNum))])])}},{key:"action",fn:function(e,a){return r("span",{},[r("a",{on:{click:function(e){return t.handleNewDetail(a)}}},[t._v("预览")]),r("a-divider",{attrs:{type:"vertical"}}),r("a",{on:{click:function(e){return t.handleEdit(a)}}},[t._v("编辑")]),r("a-divider",{attrs:{type:"vertical"}}),r("a-dropdown",[r("a",{staticClass:"ant-dropdown-link"},[t._v("更多 "),r("a-icon",{attrs:{type:"down"}})],1),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",[r("a",{on:{click:function(e){return t.handleType(a)}}},[t._v("调整栏目")])]),r("a-menu-item",[r("a",{on:{click:function(e){return t.handleCopy(a)}}},[t._v("复制")])]),r("a-menu-item",[r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.Delete(a.id)}}},[r("a",[t._v("删除")])])],1)],1)],1)],1)}},{key:"createTime",fn:function(e,a){return r("span",{staticStyle:{"text-align":"center"}},[r("a-tooltip",[r("template",{slot:"title"},[t._v(t._s(e))]),t._v(t._s(t.getFormatDataYMD(e)))],2)],1)}}])})],1),r("contentBaseType-modal",{ref:"modalForm",on:{close:t.modalFormclose}}),r("content-detail-modal",{ref:"detailForm",on:{ok:t.modalFormOk}}),r("content-change-type-modal",{ref:"changForm",on:{ok:t.modalFormOk}}),r("content-copy-type-modal",{ref:"copyForm",on:{ok:t.modalFormOk}}),r("content-person-list",{ref:"ContentPersonList",on:{ok:t.modalFormOk}})],1)],1)],1)},n=[],i=r("88bc"),o=r.n(i),s=r("0fea"),c=r("b65a"),l=r("4ec3"),u=r("8a64"),d=r("5b4f"),f=r("cc2b"),p=r("6d96"),h=r("b33b"),m=r("c1df"),g=r.n(m),v={name:"GLZXList",mixins:[c["a"]],components:{ContentChangeTypeModal:d["default"],ContentDetailModal:u["default"],ContentBaseTypeModal:f["default"],ContentCopyTypeModal:p["default"],ContentPersonList:h["default"]},data:function(){return{columns:[{title:"标题",align:"left",dataIndex:"contentTitle",ellipsis:!0,scopedSlots:{customRender:"contentTitle"}},{title:"栏目",align:"center",dataIndex:"typeName"},{title:"发布时间",align:"center",width:160,dataIndex:"createTime",scopedSlots:{customRender:"createTime"},sorter:!0},{title:"发布人",align:"center",width:120,dataIndex:"createBy"},{title:"查阅记录",align:"center",dataIndex:"action",width:100,scopedSlots:{customRender:"detail"}},{title:"操作",dataIndex:"action",align:"center",width:160,scopedSlots:{customRender:"action"}}],iExpandedKeys:[],loading:!1,autoExpandParent:!0,currFlowId:"",currFlowName:"",disable:!0,showArrow:!1,treeData:[],visible:!1,departTree:[],rightClickSelectedKey:"",hiding:!0,model:{},dropTrigger:"",depart:{},disableSubmit:!1,checkedKeys:[],selectedKeys:[],autoIncr:1,currSelected:{},allTreeKeys:[],checkStrictly:!0,systemNum:0,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},graphDatasource:{nodes:[],edges:[]},validatorRules:{title:{rules:[{required:!0,message:"请输入标题!"}]}},url:{list:"/content/contentBaseType/listContent",queryById:"/content/contentType/queryById",queryTreeList:"/content/contentType/queryTreeList",content:"/content/contentBaseInfo/queryById",delete:"/content/contentBaseType/delete",deleteBatch:"/content/contentBaseType/deleteBatch",exportXlsUrl:"content/contentBaseType/exportXls",importExcelUrl:"content/contentBaseType/importExcel",titleSearch:"/content/contentBaseInfo/list",listAll:"/sys/user/list",contentPersonList:"/content/contentPerson/list"},titleList:[]}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)}},methods:{getFormatDataYMD:function(t){return""!==t&&null!==t&&void 0!==t?g()(t).format("YYYY-MM-DD"):""},Delete:function(t){this.handleDelete(t),this.onClearSelect()},searchResetNew:function(){this.checkedKeys=[],this.selectedKeys=[],this.searchReset()},handleExpertSearch:function(t){var e=this;Object(s["e"])(this.url.titleSearch,{title:"*"+t+"*"}).then((function(t){t.success&&(e.titleList=t.result.records)}))},handleNewDetail:function(t){this.$refs.detailForm.title="预览",this.$refs.detailForm.edit(t)},handleType:function(t){this.$refs.changForm.edit(t)},handleCopy:function(t){this.$refs.copyForm.edit(t)},validateCode:function(t,e,r){var a={tableName:"content_type",fieldName:"type_num",fieldVal:e};Object(l["s"])(a).then((function(t){t.success?r():r("类别编码已存在!")}))},modalFormclose:function(){this.loadData()},loadTree:function(){var t=this,e=this;e.treeData=[],e.departTree=[],Object(s["e"])(e.url.queryTreeList).then((function(r){if(r.success){for(var a=0;a<r.result.length;a++){var n=r.result[a];e.treeData.push(n),e.departTree.push(n),e.setThisExpandedKeys(n),e.getAllKeys(n)}t.loading=!1}}))},setThisExpandedKeys:function(t){if(t.children&&t.children.length>0){this.iExpandedKeys.push(t.key);for(var e=0;e<t.children.length;e++)this.setThisExpandedKeys(t.children[e])}},refresh:function(){this.loading=!0,this.loadTree()},rightHandle:function(t){this.dropTrigger="contextmenu",this.rightClickSelectedKey=t.node.eventKey},onExpand:function(t){this.iExpandedKeys=t,this.autoExpandParent=!1},backFlowList:function(){this.$router.back(-1)},dropStatus:function(t){0==t&&(this.dropTrigger="")},closeDrop:function(){this.dropTrigger=""},batchDel:function(){if(this.checkStrictly=!1,this.checkedKeys.length<=0)this.$message.warning("请选择一条记录！");else{for(var t="",e=0;e<this.checkedKeys.length;e++)t+=this.checkedKeys[e]+",";var r=this;this.$confirm({title:"确认删除",content:"确定要删除所选中的 "+this.checkedKeys.length+" 条数据，以及子节点数据吗?",onOk:function(){Object(s["a"])(r.url.deleteBatch,{ids:t}).then((function(t){t.success?(r.$message.success(t.message),r.loadTree(),r.onClearSelected()):r.$message.warning(t.message)}))}})}},onSearch:function(t){var e=this;t?Object(s["e"])(e.url.queryTreeList,{name:t}).then((function(t){if(t.success){e.departTree=[];for(var r=0;r<t.result.length;r++){var a=t.result[r];e.departTree.push(a)}}else e.$message.warning(t.message)})):e.loadTree()},nodeModalOk:function(){this.loadTree()},nodeModalClose:function(){},hide:function(){this.visible=!1},onCheck:function(t,e){this.hiding=!1,this.checkStrictly?this.checkedKeys=t.checked:this.checkedKeys=t,this.checkedKeys.length>0?this.queryParam.typeId=this.checkedKeys.join(","):this.queryParam.typeId=void 0,this.loadData(1)},setValuesToForm:function(t){this.form.getFieldDecorator("fax",{initialValue:""}),this.form.setFieldsValue(o()(t,"typeName","typeNum","isShow","orderNum"))},getCurrSelectedTitle:function(){return this.currSelected.title?this.currSelected.title:""},onClearSelect:function(){this.hiding=!0,this.checkedKeys=[],this.currSelected={},this.form.resetFields(),this.selectedKeys=[],this.selectedRowKeys=[]},handleNodeTypeChange:function(t){this.currSelected.nodeType=t},notifyTriggerTypeChange:function(t){this.currSelected.notifyTriggerType=t},receiptTriggerTypeChange:function(t){this.currSelected.receiptTriggerType=t},submitCurrForm:function(){var t=this;0!==this.checkedKeys.length?this.form.validateFields((function(e,r){if(!e){r.checkedKeys=t.checkedKeys,r.isUrl||(r.message=t.message),r.imageId=t.imageId,r.isUrl=t.isUrl,r.isImage=t.isImage;var a=Object.assign(t.model,r);Object(s["i"])(t.url.add,a,"post").then((function(e){e.success?t.$message.success("发布成功!"):t.$message.error(e.message)}))}})):this.$message.error("请至少选择一个栏目！")},emptyCurrForm:function(){this.form.resetFields(),this.message=null},nodeSettingFormSubmit:function(){this.form.validateFields((function(t,e){}))},openSelect:function(){this.$refs.sysDirectiveModal.show()},selectDirectiveOk:function(t){this.nodeSettingForm.setFieldsValue({directiveCode:t.directiveCode}),this.currSelected.sysCode=t.sysCode},getFlowGraphData:function(t){if(this.graphDatasource.nodes.push({id:t.id,text:t.flowNodeName}),t.children.length>0)for(var e=0;e<t.children.length;e++){var r=t.children[e];this.graphDatasource.edges.push({source:t.id,target:r.id}),this.getFlowGraphData(r)}},expandAll:function(){this.iExpandedKeys=this.allTreeKeys},closeAll:function(){this.iExpandedKeys=[]},checkALL:function(){this.checkStriccheckStrictlytly=!1,this.checkedKeys=this.allTreeKeys},cancelCheckALL:function(){this.checkedKeys=[]},switchCheckStrictly:function(t){1==t?this.checkStrictly=!1:2==t&&(this.checkStrictly=!0)},getAllKeys:function(t){if(this.allTreeKeys.push(t.key),t.children&&t.children.length>0)for(var e=0;e<t.children.length;e++)this.getAllKeys(t.children[e])},detailHistory:function(t){this.$refs.ContentPersonList.queryParam.contentId=t.contentId,this.$refs.ContentPersonList.edit(t)},initSysPersonNum:function(){var t=this;this.systemNum=0,Object(s["i"])(this.url.listAll,{pageSize:1},"get").then((function(e){e.success&&(t.systemNum=e.result.total)}))}},created:function(){this.currFlowId=this.$route.params.id,this.currFlowName=this.$route.params.name,this.loadTree(),this.initSysPersonNum()}},y=v,b=(r("39cd"),r("2877")),w=Object(b["a"])(y,a,n,!1,null,"45ebff8b",null);e["default"]=w.exports},d361:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-spin",{attrs:{spinning:t.confirmLoading}},[r("a-form-model",{ref:"form",attrs:{model:t.model,rules:t.validatorRules}},[r("a-row",{staticClass:"houseInfo"},[r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v(" 事项名称")]),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{staticStyle:{width:"100%"},attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,prop:"matterName"}},[r("a-input",{attrs:{placeholder:"请输入事项名称"},model:{value:t.model.matterName,callback:function(e){t.$set(t.model,"matterName",e)},expression:"model.matterName"}})],1)],1),r("a-col",{attrs:{span:4}},[r("span",{staticClass:"requiredText"},[t._v("*")]),t._v(" 事项编码")]),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{staticStyle:{width:"100%"},attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,prop:"matterCode"}},[r("a-input",{attrs:{placeholder:"请输入事项编码"},model:{value:t.model.matterCode,callback:function(e){t.$set(t.model,"matterCode",e)},expression:"model.matterCode"}})],1)],1),r("a-col",{attrs:{span:4}},[t._v(" 数据新增接口地址")]),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{staticStyle:{width:"100%"},attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,prop:"addUrl"}},[r("a-input",{attrs:{placeholder:"请输入数据新增接口地址"},model:{value:t.model.addUrl,callback:function(e){t.$set(t.model,"addUrl",e)},expression:"model.addUrl"}})],1)],1),r("a-col",{attrs:{span:4}},[t._v(" 数据编辑接口地址")]),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{staticStyle:{width:"100%"},attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,prop:"editUrl"}},[r("a-input",{attrs:{placeholder:"请输入数据编辑接口地址"},model:{value:t.model.editUrl,callback:function(e){t.$set(t.model,"editUrl",e)},expression:"model.editUrl"}})],1)],1),r("a-col",{attrs:{span:4}},[t._v(" 主表数据接口地址")]),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{staticStyle:{width:"100%"},attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,prop:"getByIdUrl"}},[r("a-input",{attrs:{placeholder:"请输入通过id获取主表数据接口地址"},model:{value:t.model.getByIdUrl,callback:function(e){t.$set(t.model,"getByIdUrl",e)},expression:"model.getByIdUrl"}})],1)],1),r("a-col",{attrs:{span:4}},[t._v(" 绑定流程")]),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{staticStyle:{width:"100%"},attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,prop:"workflowCode"}},[r("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择绑定流程"},model:{value:t.model.workflowCode,callback:function(e){t.$set(t.model,"workflowCode",e)},expression:"model.workflowCode"}},[r("a-select-option",{key:""},[t._v(" 不使用工作流 ")]),t._l(t.processDefinitionList,(function(e,a){return r("a-select-option",{key:e.key},[t._v("\n              "+t._s(e.name)+"\n            ")])}))],2)],1)],1),r("a-col",{attrs:{span:4}},[t._v(" 流程摘要规则")]),r("a-col",{attrs:{span:20}},[r("a-form-model-item",{staticStyle:{width:"100%"},attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,prop:"workflowCode"}},[r("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入流程摘要规则(可使用实体类字段作为变量 如：@applicationBuss.createBy@的补贴申请)"},model:{value:t.model.summary,callback:function(e){t.$set(t.model,"summary",e)},expression:"model.summary"}})],1)],1)],1)],1),r("a-tabs",{on:{change:t.handleChangeTabs},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-tab-pane",{key:t.refKeys[0],attrs:{tab:"组件配置",forceRender:!0}},[r("j-editable-table",{ref:t.refKeys[0],attrs:{loading:t.comMatterDetailTable.loading,columns:t.comMatterDetailTable.columns,dataSource:t.comMatterDetailTable.dataSource,maxHeight:300,rowNumber:!0,rowSelection:!0,actionButton:!0,dragSort:!0,dragSortKey:"order"},scopedSlots:t._u([{key:"action",fn:function(e){return[r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.handleDelete(e)}}},[r("a-button",{staticStyle:{"margin-left":"2px","padding-top":"2px"},attrs:{type:"dashed"}},[t._v("删除")])],1)]}},{key:"json",fn:function(e){return[r("a-input",{staticStyle:{width:"calc(100% - 67px)"},on:{change:function(r){return t.onJsonInputChange(r,e)}},model:{value:e.value,callback:function(r){t.$set(e,"value",r)},expression:"props.value"}}),r("a-button",{staticStyle:{"margin-left":"2px","padding-top":"2px"},attrs:{type:"dashed"},on:{click:function(r){return t.onJsonClick(e)}}},[t._v("编辑")])]}}])})],1),r("a-tab-pane",{key:t.refKeys[1],attrs:{tab:"附件配置",forceRender:!0}},[r("j-editable-table",{ref:t.refKeys[1],attrs:{loading:t.comMatterFileTable.loading,columns:t.comMatterFileTable.columns,dataSource:t.comMatterFileTable.dataSource,maxHeight:300,rowNumber:!0,rowSelection:!0,actionButton:!0,dragSort:!0,dragSortKey:"order"},scopedSlots:t._u([{key:"action",fn:function(e){return[r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.handleDelete(e)}}},[r("a-button",{staticStyle:{"margin-left":"2px","padding-top":"2px"},attrs:{type:"dashed"}},[t._v("删除")])],1)]}}])})],1)],1),r("a-modal",{attrs:{title:"编辑变量",width:800},on:{ok:t.handleJsonOk},model:{value:t.jsonVisible,callback:function(e){t.jsonVisible=e},expression:"jsonVisible"}},t._l(t.currentData,(function(e,a){return r("div",{staticStyle:{"margin-bottom":"5px"}},[r("div",{staticStyle:{width:"45%",float:"left"}},[r("span",[t._v("变量名：")]),r("a-input",{staticStyle:{width:"calc(100% - 60px)"},model:{value:e.key,callback:function(r){t.$set(e,"key",r)},expression:"item.key"}})],1),r("div",{staticStyle:{width:"45%",float:"left"}},[r("span",[t._v("变量值：")]),r("a-input",{staticStyle:{width:"calc(100% - 60px)"},model:{value:e.value,callback:function(r){t.$set(e,"value",r)},expression:"item.value"}})],1),r("a-button",{attrs:{icon:"plus"},on:{click:t.onJsonAdd}}),a>0?r("a-button",{attrs:{icon:"minus"},on:{click:function(e){return t.onJsonDel(a)}}}):t._e()],1)})),0)],1)},n=[],i=r("e2e0"),o=r("535e"),s=r("0fea");function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function d(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=p(t,"string");return"symbol"==c(e)?e:e+""}function p(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=c(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var h={name:"ComMatterForm",mixins:[o["a"]],data:function(){return{currentProps:{},jsonVisible:!1,currentData:[],processDefinitionList:[],addDefaultRowNum:1,model:{workflowCode:""},validatorRules:{matterName:[{required:!0,message:"请输入事项名称!"}],matterCode:[{required:!0,message:"请输入事项编码!"}]},refKeys:["comMatterDetail","comMatterFile"],activeKey:"comMatterDetail",comMatterDetailTable:{loading:!1,dataSource:[],columns:[{title:"组件",key:"comId",type:i["a"].select,options:[],defaultValue:"",width:"300px",allowInput:!0,placeholder:"请输入${title}"},{title:"组件变量",key:"comVar",type:i["a"].slot,slotName:"json",width:"400px",defaultValue:"",placeholder:"请输入${title}"},{title:"组件位置",key:"comPosition",type:i["a"].select,options:[{title:"第一页",value:"1"},{title:"第二页",value:"2"},{title:"意见框内",value:"0"}],width:"200px",defaultValue:"1",placeholder:"请选择${title}"},{title:"操作",key:"action",width:"80px",type:i["a"].slot,slotName:"action"}],columns2:[{title:"附件分类名称",key:"fileItemName",type:i["a"].input,defaultValue:"",width:"300px",allowInput:!0,placeholder:"请输入${title}"},{title:"是否必填",key:"isRequire",type:i["a"].select,options:[{title:"是",value:"Y"},{title:"否",value:"N"}],width:"600px",defaultValue:"",placeholder:"请选择${title}"},{title:"是否使用高拍仪",key:"isGpy",type:i["a"].select,options:[{title:"是",value:"Y"},{title:"否",value:"N"}],width:"600px",defaultValue:"",placeholder:"请选择${title}"},{title:"是否使用跨屏上传",key:"isUpload",type:i["a"].select,options:[{title:"是",value:"Y"},{title:"否",value:"N"}],width:"600px",defaultValue:"",placeholder:"请输入${title}"},{title:"操作",key:"action",width:"80px",type:i["a"].slot,slotName:"action"}]},comMatterFileTable:{loading:!1,dataSource:[],columns:[{title:"附件分类名称",key:"itemName",type:i["a"].input,defaultValue:"",width:"300px",allowInput:!0,placeholder:"请输入${title}"},{title:"是否必填",key:"isRequire",type:i["a"].select,options:[{title:"是",value:"Y"},{title:"否",value:"N"}],width:"200px",defaultValue:"",placeholder:"请选择${title}"},{title:"是否使用高拍仪",key:"isGpy",type:i["a"].select,options:[{title:"是",value:"Y"},{title:"否",value:"N"}],width:"200px",defaultValue:"",placeholder:"请选择${title}"},{title:"是否使用跨屏上传",key:"isUpload",type:i["a"].select,options:[{title:"是",value:"Y"},{title:"否",value:"N"}],width:"200px",defaultValue:"",placeholder:"请输入${title}"},{title:"操作",key:"action",width:"80px",type:i["a"].slot,slotName:"action"}]},url:{add:"/components/comMatter/add",edit:"/components/comMatter/edit",comMatterDetail:{list:"/components/comMatter/queryComMatterDetailByMainId"},comMatterFile:{list:"/components/comMatter/queryComMatterFileByMainId"},comLibraryList:"/components/comLibrary/list"}}},created:function(){this.getLastVersionList(),this.getComLibraryList()},methods:{getLastVersionList:function(){var t=this;Object(s["e"])("/act/procdef/queryLastVersionList").then((function(e){t.processDefinitionList=e}))},handleJsonOk:function(){for(var t={},e=0;this.currentData&&this.currentData.length>0&&e<this.currentData.length;e++)this.currentData[e].key&&""!==this.currentData[e].key&&this.currentData[e].value&&""!==this.currentData[e].value&&(t[this.currentData[e].key]=this.currentData[e].value);Object.keys(t).length>0?this.currentProps.handleChange(JSON.stringify(t)):this.currentProps.handleChange(""),this.jsonVisible=!1,this.$forceUpdate()},handleDelete:function(t){var e=t.rowId,r=t.target;r.removeRows(e)},onJsonDel:function(t){this.currentData.splice(t,1)},onJsonAdd:function(){this.currentData.push({key:"",value:""})},onJsonInputChange:function(t,e){e.handleChange(t.target.value)},onJsonClick:function(t){this.currentProps=t,this.currentData=[];var e={};t.value&&t.value.length>0&&(e=JSON.parse(t.value));for(var r=Object.keys(e),a=0;r&&r.length>0&&a<r.length;a++){var n={};n.key=r[a],n.value=e[r[a]],this.currentData.push(n)}0===this.currentData.length&&this.currentData.push({key:"",value:""}),this.jsonVisible=!0,this.$forceUpdate()},getComLibraryList:function(){var t=this;Object(s["e"])(this.url.comLibraryList,{pageSize:"9999"}).then((function(e){if(e.success)for(var r=0;e.result&&e.result.records&&e.result.records.length>0&&r<e.result.records.length;r++)t.comMatterDetailTable.columns[0].options.push({title:e.result.records[r].comName,value:e.result.records[r].id})}))},editAfter:function(){if(this.model.id){var t={id:this.model.id};this.requestSubTableData(this.url.comMatterDetail.list,t,this.comMatterDetailTable),this.requestSubTableData(this.url.comMatterFile.list,t,this.comMatterFileTable)}},classifyIntoFormData:function(t){var e=Object.assign(this.model,t.formValue);return u(u({},e),{},{comMatterDetailList:t.tablesValue[0].values,comMatterFileList:t.tablesValue[1].values})}}},m=h,g=(r("cdb0"),r("2877")),v=Object(g["a"])(m,a,n,!1,null,"32aa9bf8",null);e["default"]=v.exports},d758:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[r("a-row",{attrs:{gutter:24}},[r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("a-form-item",[r("a-input",{attrs:{placeholder:"请输入组件名称"},model:{value:t.queryParam.comName,callback:function(e){t.$set(t.queryParam,"comName",e)},expression:"queryParam.comName"}})],1)],1),r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("a-form-item",[r("a-input",{attrs:{placeholder:"请输入组件路径"},model:{value:t.queryParam.comPath,callback:function(e){t.$set(t.queryParam,"comPath",e)},expression:"queryParam.comPath"}})],1)],1),r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("a-form-item",[r("a-select",{staticStyle:{width:"100%"},attrs:{"default-value":"00",placeholder:"请选择组件类型"},model:{value:t.queryParam.comType,callback:function(e){t.$set(t.queryParam,"comType",e)},expression:"queryParam.comType"}},[r("a-select-option",{attrs:{value:"00"}},[t._v(" 业务组件 ")]),r("a-select-option",{attrs:{value:"01"}},[t._v(" 首页组件 ")])],1)],1)],1),r("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[r("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[r("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.searchQuery}},[t._v("查询")]),r("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"redo"},on:{click:t.searchReset}},[t._v("重置")])],1)])],1)],1)],1),r("div",{staticClass:"table-operator"},[r("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleAdd}},[t._v("新增")]),r("a-button",{attrs:{icon:"delete"},on:{click:t.batchDel}},[t._v("批量删除")])],1),r("div",[r("div",{staticClass:"ant-alert ant-alert-info",staticStyle:{"margin-bottom":"16px"}},[r("i",{staticClass:"anticon anticon-info-circle ant-alert-icon"}),t._v(" 已选择\n      "),r("a",{staticStyle:{"font-weight":"600"}},[t._v(t._s(t.selectedRowKeys.length))]),t._v("项\n      "),r("a",{staticStyle:{"margin-left":"24px"},on:{click:t.onClearSelected}},[t._v("清空")])]),r("a-table",{ref:"table",staticClass:"j-table-force-nowrap",attrs:{size:"middle",bordered:"",rowKey:"id",columns:t.columns,dataSource:t.dataSource,pagination:t.ipagination,loading:t.loading,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(e,a){return r("span",{},[r("a",{on:{click:function(e){return t.handleEdit(a)}}},[r("a-icon",{attrs:{type:"edit"}}),t._v(" 编辑")],1),r("a-divider",{attrs:{type:"vertical"}}),r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.handleDelete(a.id)}}},[r("a",[r("a-icon",{attrs:{type:"delete"}}),t._v(" 删除")],1)])],1)}}])})],1),r("comLibrary-modal",{ref:"modalForm",on:{ok:t.modalFormOk}})],1)},n=[],i=(r("6eb7"),r("a700")),o=r("b65a"),s={name:"ComLibraryList",mixins:[o["a"]],components:{ComLibraryModal:i["default"]},data:function(){return{description:"组件库管理页面",columns:[{title:"#",dataIndex:"",key:"rowIndex",width:60,align:"center",customRender:function(t,e,r){return parseInt(r)+1}},{title:"组件名称",align:"center",dataIndex:"comName"},{title:"组件类型",align:"center",dataIndex:"comType",customRender:function(t,e,r){return t&&""!==t&&"00"!==t?"01"===t?"首页组件":t:"业务组件"}},{title:"组件路径",align:"center",dataIndex:"comPath"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],url:{list:"/components/comLibrary/list",delete:"/components/comLibrary/delete",deleteBatch:"/components/comLibrary/deleteBatch",exportXlsUrl:"components/comLibrary/exportXls",importExcelUrl:"components/comLibrary/importExcel"}}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)}},methods:{}},c=s,l=(r("f47c4"),r("2877")),u=Object(l["a"])(c,a,n,!1,null,"398d7c1d",null);e["default"]=u.exports},dbb8:function(t,e,r){},dc29:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-spin",{staticClass:"uploadLoadingCss",attrs:{spinning:t.SpinfileLoading,tip:t.tip}},[r("div",{ref:"modalBox",staticStyle:{position:"relative","z-index":"50"}}),t.previewVisible?r("div",{ref:"previewDiv",staticClass:"outer_box"},[r("previewPicture",{attrs:{isEdit:!t.isDetail,fileList:t.previewFileList,fileNum:t.previewNum},on:{cancel:t.handleCancel,numChange:t.numChange}})],1):t._e(),r("a-collapse",{directives:[{name:"show",rawName:"v-show",value:t.enclosureList&&t.enclosureList.length>0,expression:"enclosureList && enclosureList.length>0"}],model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-collapse-panel",{key:"0",attrs:{header:"附件上传","show-arrow":!1}},[t.refresh?r("a-row",{staticStyle:{padding:"0 10px"},attrs:{type:"flex",gutter:20}},t._l(t.enclosureList,(function(e,a){return r("a-col",{key:a,attrs:{span:12}},[r("a-form-item",{key:a,staticStyle:{width:"100%",display:"flex"},attrs:{labelCol:{style:"width:90px"},wrapperCol:{style:"width:calc(100% - 90px)"}}},[r("div",{staticClass:"enclosure-label",attrs:{slot:"label"},slot:"label"},["Y"===e.isRequire?r("span",{staticStyle:{color:"red"}},[t._v("*")]):t._e(),t._v("\n              "+t._s(e.itemName)+"\n              "),r("div",["Y"!==e.isGpy||t.isDetail?t._e():r("a-tooltip",[r("template",{slot:"title"},[t._v("\n                    高拍仪\n                  ")]),r("a-button",{attrs:{shape:"circle",icon:"camera",type:"link"},on:{click:function(r){return r.stopPropagation(),t.toCamera(e.id)}}})],2),"Y"!==e.isUpload||t.isDetail?t._e():r("a-tooltip",{on:{visibleChange:t.onTipVisibleChange},model:{value:e.tipVis,callback:function(r){t.$set(e,"tipVis",r)},expression:"item.tipVis"}},[r("template",{slot:"title"},[t._v("\n                    跨屏上传\n                  ")]),r("a-popover",{attrs:{trigger:"click",placement:"topRight",title:"跨屏上传"}},[r("template",{staticStyle:{"text-align":"center"},slot:"content"},[r("div",{staticClass:"qr-img",attrs:{id:"qrcode"+e.id}}),r("div",{staticStyle:{"text-align":"center"}},[t._v("使用微信扫一扫")])]),r("a-button",{attrs:{shape:"circle",icon:"qrcode",type:"link"},on:{click:function(r){return r.stopPropagation(),t.getUploadCode(e)}}})],2)],2)],1)]),t.isDetail&&e.showList&&e.showList.length>0||!t.isDetail?r("div",{staticStyle:{"line-height":"1"},on:{click:function(r){return t.getEnclosureId(e.id)}}},[r("a-upload",{class:t.isDetail?"uplodeImgBox":"",staticStyle:{"line-height":"1"},attrs:{customRequest:function(r){return t.uploadFile(r,e,a)},multiple:!0,disabled:t.isDetail,action:t.uploadActionImg,headers:t.headers,listType:"picture-card","file-list":e.showList,"before-upload":t.onBeforeUploadImage,remove:function(r){return t.onRemove(r,e)}},on:{preview:function(r){return t.handlePreview(r,e,a)}}},[t.isDetail?t._e():r("div",[r("a-icon",{attrs:{type:"upload"}}),r("div",{staticClass:"ant-upload-text"},[t._v("\n                    上传\n                  ")])],1)])],1):t._e(),e.showList&&0!==e.showList.length||!t.isDetail?t._e():r("div",{staticClass:"empty_top"},[r("div",{staticClass:"empty_kuang"},[r("a-icon",{style:"fontSize: 30px",attrs:{type:"file-text"}}),"Y"===e.isRequire?r("div",{staticStyle:{"line-height":"18px"}},[t._v("待上传")]):t._e()],1)])])],1)})),1):t._e()],1)],1),r("scanner-modal",{ref:"ScannerModal",on:{onUpload:t.onUpload}})],1)},n=[],i=r("899b"),o=i["a"],s=(r("416e"),r("2877")),c=Object(s["a"])(o,a,n,!1,null,"62f377b1",null);e["default"]=c.exports},dc76:function(t,e,r){},dd45:function(t,e,r){"use strict";r("3cda")},ded1f:function(t,e,r){"use strict";r("2086")},e00e:function(t,e,r){"use strict";r("4856")},e0d9:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-spin",{attrs:{spinning:t.confirmLoading}},[r("j-form-container",{ref:"form",attrs:{model:t.model,disabled:t.formDisabled,formRef:"formOwnRow",border:!1}},[r("div",{attrs:{slot:"edit"},slot:"edit"},["0"===t.parentConfig.pastFlag?r("div",{staticStyle:{margin:"0 0 12px 0"}},[r("a-space",[r("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.addRow}},[t._v("添加一行")]),r("a-button",{attrs:{type:"primary"},on:{click:t.save}},[r("a-icon",{attrs:{type:"save"}}),t._v("保存")],1),r("a-popconfirm",{attrs:{title:"是否删除?","ok-text":"是","cancel-text":"否"},on:{confirm:t.removeRow}},[r("a-button",{attrs:{type:"danger"}},[r("a-icon",{attrs:{type:"delete"}}),t._v("删除")],1)],1)],1)],1):r("div",[r("br"),r("br")]),r("vxe-grid",{ref:"grid",staticStyle:{"flex-grow":"1"},attrs:{"row-id":"id",columns:t.childColumns,"checkbox-config":{showHeader:!0,reserve:!0},"edit-config":{trigger:"click",mode:"cell",autoClear:!1},"edit-rules":t.editRules,height:"400px","valid-config":{autoPos:!0},"keyboard-config":{isArrow:!0,isDel:!0,isTab:!0,isEdit:!0},"mouse-config":{selected:!0},data:t.childList,"show-overflow":"","auto-resize":"",border:""},on:{"valid-error":t.validError},scopedSlots:t._u([{key:"targetName",fn:function(e){e.rowIndex;var a=e.row;e.column;return[r("a-select",{staticStyle:{width:"100%"},attrs:{disabled:"0"!==t.parentConfig.pastFlag},model:{value:a.targetName,callback:function(e){t.$set(a,"targetName",e)},expression:"row.targetName"}},t._l(t.targetNameDict,(function(e){return r("a-select-option",{key:e.value,attrs:{value:e.value,disabled:!!t.childList.find((function(t){return t.targetName===e.value}))}},[t._v("\n              "+t._s(e.text)+"\n            ")])})),1)]}},{key:"weight",fn:function(e){e.rowIndex;var a=e.row;e.column;return[r("amount-input",{attrs:{"addon-after":"%",disabled:"0"!==t.parentConfig.pastFlag},model:{value:a.weight,callback:function(e){t.$set(a,"weight",e)},expression:"row.weight"}})]}},{key:"remark",fn:function(e){e.rowIndex;var a=e.row;e.column;return[r("a-input",{staticStyle:{width:"100%"},attrs:{disabled:"0"!==t.parentConfig.pastFlag},model:{value:a.remark,callback:function(e){t.$set(a,"remark",e)},expression:"row.remark"}})]}}])})],1)])],1)},n=[],i=r("eccd"),o=r("db21"),s=r("d8a5"),c=r("0fea"),l=r("4aae");function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */d=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",m="suspendedYield",g="executing",v="completed",y={};function b(){}function w(){}function _(){}var x={};l(x,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(x=C);var L=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,s){var c=p(t[n],t,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==u(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(d).then((function(t){l.value=t,o(l)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=h;return function(i,o){if(n===g)throw Error("Generator is already running");if(n===v){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===h)throw n=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=g;var l=p(e,r,a);if("normal"===l.type){if(n=a.done?v:m,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=v,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=p(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,l(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),l(D.prototype,s,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(f(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),l(L,c,"Generator"),l(L,o,(function(){return this})),l(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function f(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function p(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){f(i,a,n,o,s,"next",t)}function s(t){f(i,a,n,o,s,"throw",t)}o(void 0)}))}}var h={name:"BComparConfigForm",components:{JDDictSelectTag:i["default"],JDictCountyTreeSelect:o["default"],initDictOptions:s["g"],AmountInput:l["default"]},props:{disabled:{type:Boolean,default:!1,required:!1}},data:function(){return{formDisabled:!1,childList:[],model:{},url:{getChildConfigList:"/compare/bComparConfig/getChildConfigListByParentId",saveChildConfig:"/compare/bComparConfig/saveChildConfig"},parentId:"",parentConfig:{},targetNameDict:[],confirmLoading:!1,childColumns:[{type:"checkbox",width:60,fixed:"left",align:"center"},{title:"指标名称",align:"left",field:"targetName",width:150,slots:{edit:"targetName"},editRender:{type:"visible"}},{title:"权重",align:"left",field:"weight",width:130,slots:{edit:"weight"},editRender:{type:"visible"}},{title:"备注",align:"center",field:"remark",slots:{edit:"remark"},editRender:{type:"visible"}}],editRules:{targetName:[{required:!0,message:"请选择指标名称！"}],weight:[{required:!0,message:"权重不能为空！"},{validator:this.validateWeight}]}}},computed:{},created:function(){this.initData()},methods:{loadData:function(t){var e=this;this.parentConfig=t,Object(c["e"])(this.url.getChildConfigList+"/"+t.id).then((function(t){t.success&&(e.childList=t.result)}))},validError:function(){var t=this;setTimeout((function(){t.$refs.grid.clearValidate()}),2e3)},addRow:function(){null==this.childList?this.childList=[{}]:this.childList.push({})},initData:function(){var t=this;Object(s["g"])("composite_compar").then((function(e){e.success&&(t.targetNameDict=e.result)}))},removeRow:function(){var t=p(d().mark((function t(){var e,r,a,n,i=this;return d().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$refs.grid.getCheckboxRecords(!0),!(e&&e.length>0)){t.next=16;break}if(r=e.map((function(t){return t.id})),a=JSON.parse(JSON.stringify(this.childList)),n=0,a.forEach((function(t){r.includes(t.id)||(n+=t.weight)})),!(n<100)){t.next=10;break}this.$message.warning("剩余权重之和必须为100！"),t.next=14;break;case 10:return t.next=12,e.forEach((function(t){i.childList.forEach((function(e,r){t.id===e.id&&i.childList.splice(r,1)}))}));case 12:return t.next=14,this.save();case 14:t.next=17;break;case 16:this.$message.warning("请选中指标后，再进行删除操作！");case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),save:function(){var t=this;this.checkData().then((function(e){e&&(Object(c["j"])(t.url.saveChildConfig,{configList:t.childList,parentConfig:t.parentConfig}).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})),t.$emit("close-modal"))}))},checkData:function(){var t=this;return new Promise((function(e,r){t.$refs.grid.validate(t.childList,(function(t){if(t)return e(!1),!0;e(!0)}))}))},validateWeight:function(t){var e=t.cellValue,r=(t.rule,t.rules,t.row,t.rowIndex,t.column,t.columnIndex,0);return this.childList.forEach((function(t){null!=t.weight&&t.weight>0&&(r+=Number(t.weight))})),null==e?Promise.reject(new Error("权重不能为空！")):e<=0?Promise.reject(new Error("权重必须>0！")):100!==r?Promise.reject(new Error("权重之和必须为100！")):void 0}}},m=h,g=(r("a718"),r("2877")),v=Object(g["a"])(m,a,n,!1,null,"069a9724",null);e["default"]=v.exports},e1fd:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-modal",{attrs:{visible:t.visable,footer:null},on:{cancel:function(e){return t.hidden()}}},[r("supervise-info",{ref:"supinfo",attrs:{infoList:t.infoList}})],1)},n=[],i=r("46f2"),o=r("0fea"),s={name:"SuperviseInfoModel",components:{SuperviseInfo:i["default"]},props:{},data:function(){return{visable:!1,url:{getSuperviseInfo:"/use/processSupervision/getBpSurByProjId"},infoList:[]}},methods:{hidden:function(){this.visable=!1},show:function(t){var e=this;this.visable=!0,this.$nextTick((function(){Object(o["j"])(e.url.getSuperviseInfo+"/"+t).then((function(t){t.success?(t.result.forEach((function(t){var e=[];for(var r in t.processSupervision)t.processSupervision[r]&&(e=[].concat(t.processSupervision[r]));t.fileList=e.filter((function(e){return"01"==e.processStage&&(!t.aduitTime||e.createTime>t.aduitTime)}))})),e.infoList=t.result[0].fileList):e.$message.error("获取现场勘察记录失败！")}))}))}}},c=s,l=r("2877"),u=Object(l["a"])(c,a,n,!1,null,null,null);e["default"]=u.exports},e333:function(t,e,r){},e580:function(t,e,r){"use strict";r("e333")},e6ca:function(t,e,r){"use strict";r("1416")},e93e:function(t,e,r){},e9f3:function(t,e,r){},ea341:function(t,e,r){"use strict";r("a8a2")},ea8d:function(t,e,r){},f47c4:function(t,e,r){"use strict";r("72b6")},f4f7:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("j-modal",{attrs:{title:t.title,width:t.width,visible:t.visible,footer:null},on:{cancel:t.handleCancel}},[r("div",[t.fileManageList.length>0?[r("img-list",{attrs:{"img-list":t.fileList,"is-filled":!0}})]:r("a-empty",{attrs:{description:"暂无附件信息"}})],2),t.previewVisible?r("div",{staticClass:"outer_box",style:{zIndex:"1001"}},[r("previewPicture",{ref:"previewPicture",attrs:{fileNum:t.previewNum,fileList:t.previewFileList},on:{cancel:function(e){t.previewVisible=!1}}})],1):t._e()])},n=[],i=r("5745"),o=r("4a12"),s={name:"ViewFileMoel",components:{ImgList:o["default"]},mixins:[i["a"]],props:{},data:function(){return{title:"施工方案",visible:!1,fileManageList:[],showList:[],width:250,disableSubmit:!1}},methods:{show:function(){this.fileList=this.fileManageList,this.buildShowList(),this.visible=!0},hidden:function(){this.visible=!1},handleOk:function(){this.hidden()},handleCancel:function(){this.hidden()}}},c=s,l=(r("9b37"),r("2877")),u=Object(l["a"])(c,a,n,!1,null,"6718c59a",null);e["default"]=u.exports},f630:function(t,e,r){},f826:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-page-search-wrapper"},[r("a-form",{attrs:{layout:"inline",colon:!1},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[r("a-row",{staticClass:"queryForm",attrs:{gutter:24}},[r("a-col",{staticClass:"padrigh",attrs:{xl:4,lg:7,md:8,sm:24}},[r("a-form-item",{attrs:{label:"标题"}},[r("a-input",{attrs:{placeholder:"请输入标题"},model:{value:t.queryParam.contentTitle,callback:function(e){t.$set(t.queryParam,"contentTitle",e)},expression:"queryParam.contentTitle"}})],1)],1),r("a-col",{staticClass:"padrigh",attrs:{xl:16,lg:7,md:8,sm:24}}),r("a-col",{attrs:{xl:4,lg:7,md:8,sm:24}},[r("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"right",overflow:"hidden"}},[r("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.searchQuery}},[t._v("查询")]),r("a-button",{staticStyle:{"margin-left":"4px"},attrs:{type:"primary",icon:"reload"},on:{click:t.searchReset}},[t._v("重置")])],1)])],1)],1)],1),r("div",{staticClass:"table-operator"},[r("a-button",{staticStyle:{margin:"8px 4px 0 0"},attrs:{type:"primary",icon:"check"},on:{click:t.handleYes}},[t._v("审核通过")]),r("a-button",{attrs:{type:"primary",icon:"minus"},on:{click:t.handleNo}},[t._v("审核不通过")]),t.selectedRowKeys.length>0?r("span",{staticClass:"ant-alert ant-alert-info",staticStyle:{"margin-bottom":"10px","margin-right":"10px",top:"1px"}},[r("i",{staticClass:"anticon anticon-info-circle ant-alert-icon"}),t._v(" 已选择 "),r("a",{staticStyle:{"font-weight":"600"}},[t._v(t._s(t.selectedRowKeys.length))]),t._v("项\n      "),r("a",{staticStyle:{"margin-left":"24px"},on:{click:t.onClearSelected}},[t._v("清空")])]):t._e()],1),r("div",[r("a-table",{ref:"table",attrs:{size:"middle",bordered:"",rowKey:"id",columns:t.columns,dataSource:t.dataSource,scroll:{x:1e3},pagination:t.ipagination,loading:t.loading,rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange,columnWidth:40}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"action",fn:function(e,a){return r("span",{},[r("a",{on:{click:function(e){return t.handleEdit(a)}}},[t._v("编辑")]),r("a-divider",{attrs:{type:"vertical"}}),r("a",{on:{click:function(e){return t.handleNewDetail(a)}}},[t._v("预览")]),r("a-divider",{attrs:{type:"vertical"}}),r("a",{on:{click:function(e){return t.handleType(a)}}},[t._v("调整栏目")])],1)}},{key:"createTime",fn:function(e,a){return r("span",{staticStyle:{"text-align":"center"}},[r("a-tooltip",[r("template",{slot:"title"},[t._v(t._s(e))]),t._v(t._s(t.getFormatDataYMD(e)))],2)],1)}}])})],1),r("contentBaseType-modal",{ref:"modalForm",on:{ok:t.modalFormOk}}),r("content-detail-modal",{ref:"detailForm",on:{ok:t.modalFormOk}}),r("content-change-type-modal",{ref:"changForm",on:{ok:t.modalFormOk}})],1)},n=[],i=r("cc2b"),o=r("b65a"),s=r("0fea"),c=(r("88bc"),r("8a64")),l=r("5b4f"),u=r("c1df"),d=r.n(u),f=r("d579"),p={name:"ContentBaseTypeList",mixins:[o["a"]],components:{ContentChangeTypeModal:l["default"],ContentDetailModal:c["default"],ContentBaseTypeModal:i["default"],JEllipsis:f["default"]},data:function(){return{titleList:[],selectedRowKeys:[],description:"新闻栏目关系表管理页面",columns:[{title:"标题",align:"left",dataIndex:"contentTitle",ellipsis:!0,scopedSlots:{customRender:"contentTitle"}},{title:"栏目",align:"center",width:280,dataIndex:"typeName"},{title:"发布时间",align:"center",width:120,dataIndex:"createTime",scopedSlots:{customRender:"createTime"},sorter:!0},{title:"发布人",align:"center",dataIndex:"createBy",width:120},{title:"状态",align:"center",width:140,dataIndex:"state_dictText"},{title:"操作",dataIndex:"action",align:"center",width:200,scopedSlots:{customRender:"action"}}],url:{list:"/content/contentBaseType/listContent",delete:"/content/contentBaseType/delete",deleteBatch:"/content/contentBaseType/deleteBatch",exportXlsUrl:"content/contentBaseType/exportXls",importExcelUrl:"content/contentBaseType/importExcel",setState:"/content/contentBaseType/setState",titleSearch:"/content/contentBaseInfo/list"}}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)}},methods:{getFormatDataYMD:function(t){return""!==t&&null!==t&&void 0!==t?d()(t).format("YYYY-MM-DD"):""},Ellipsis:function(t,e,r){return t[e]?t[e].widthSub(r):""},handleExpertSearch:function(t){var e=this;Object(s["e"])(this.url.titleSearch,{title:"*"+t+"*"}).then((function(t){t.success&&(e.titleList=t.result.records)}))},handleNewDetail:function(t){this.$refs.detailForm.title="预览",this.$refs.detailForm.edit(t)},handleType:function(t){this.$refs.changForm.edit(t)},handleYes:function(){for(var t=this,e=this,r="",a=0;a<this.selectedRowKeys.length;a++)"1"===this.dataSource.find((function(t){return t.id===e.selectedRowKeys[a]})).state&&(e.selectedRowKeys.splice(a,1),r="1");this.selectedRowKeys.length>0?Object(s["l"])(this.url.setState,{ids:this.selectedRowKeys,state:"1"}).then((function(e){e.success?t.$message.success(e.message):t.$message.warning(e.message),t.loadData(),t.selectedRowKeys=[],t.selectionRows=[]})):"1"===r?this.$message.warning("无需再次审核！"):this.$message.warning("请至少选中一条可用记录！")},handleNo:function(){for(var t=this,e=this,r="",a=0;a<this.selectedRowKeys.length;a++)"2"===this.dataSource.find((function(t){return t.id===e.selectedRowKeys[a]})).state&&(e.selectedRowKeys.splice(a,1),r="1");this.selectedRowKeys.length>0?Object(s["l"])(this.url.setState,{ids:this.selectedRowKeys,state:"2"}).then((function(e){e.success?t.$message.success(e.message):t.$message.warning(e.message),t.loadData(),t.selectedRowKeys=[],t.selectionRows=[]})):"1"===r?this.$message.warning("无需再次审核！"):this.$message.warning("请至少选中一条可用记录！")},onSelectChange:function(t){this.selectedRowKeys=t}}},h=p,m=(r("66e8"),r("2877")),g=Object(m["a"])(h,a,n,!1,null,"31a3a102",null);e["default"]=g.exports},f85f:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("a-collapse",{attrs:{bordered:!1,expandIconPosition:"right"},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[r("a-collapse-panel",{key:"1",staticStyle:{"background-color":"#fff"},scopedSlots:t._u([{key:"header",fn:function(){return[r("div",{staticClass:"collapseTitle"},[t._v("\n          "+t._s(t.title)+"\n        ")])]},proxy:!0},{key:"extra",fn:function(){return["1"==t.projMainData().hisFlag&&t.isDoing?r("a-button",{staticStyle:{"pointer-events":"auto"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.skipCompete.apply(null,arguments)}}},[t._v("跳过比选")]):t._e()]},proxy:!0}])},[r("j-form-container",{ref:"form",attrs:{disabled:!0,border:!1,model:t.projMainData(),formRef:"formRow"}},[r("a-row",{ref:"formRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{span:4}},[t._v("项目编号")]),r("a-col",{attrs:{span:4}},[r("span",[t._v(" "+t._s(t.projMainData().code)+" ")])]),r("a-col",{attrs:{span:4}},[t._v("项目描述")]),r("a-col",{attrs:{span:12}},[r("span",[t._v(t._s(t.projMainData().describe))])]),r("a-col",{attrs:{span:4}},[t._v("申报小区")]),r("a-col",{attrs:{span:4}},[r("span",[t._v(t._s(t.projMainData().communityName))])]),r("a-col",{attrs:{span:4}},[t._v("联系人")]),r("a-col",{attrs:{span:4}},[r("span",[t._v(" "+t._s(t.projMainData().reqMan)+" ")])]),r("a-col",{attrs:{span:4}},[t._v("打印勘察表")]),r("a-col",[r("a",{on:{click:function(e){return e.stopPropagation(),t.print()}}},[r("a-icon",{attrs:{type:"printer"}}),t._v(" 打印")],1)])],1)],1)],1)],1),r("a-card",{staticClass:"complete",attrs:{bordered:!1}},[r("a-steps",{staticStyle:{width:"100%"},attrs:{current:t.current,size:"small"}},[r("a-step",{class:{ftc:"0"==t.current},attrs:{status:t.step1,title:"施工单位列表"},on:{click:function(e){return e.stopPropagation(),t.changeTab(0)}}}),r("a-step",{class:{ftc:"1"==t.current},attrs:{status:t.step2,title:"发布维修公告"},on:{click:function(e){return e.stopPropagation(),t.changeTab(1)}}}),r("a-step",{class:{ftc:"2"==t.current},attrs:{status:t.step3,title:"报价大厅"},on:{click:function(e){return e.stopPropagation(),t.changeTab(2)}}}),r("a-step",{class:{ftc:"3"==t.current},attrs:{status:t.step4,title:"比选确定施工单位"},on:{click:function(e){return e.stopPropagation(),t.changeTab(3)}}})],1),r("a-divider"),r("div",{staticClass:"stepBody"},[0===t.current?r("supplier-select",{ref:"supplier",attrs:{disabled:"0"==!t.comparProj.comparState,projectId:t.projMainData().id,projectIds:t.projectIds,comparProj:t.comparProj,minCorpNum:t.minCorpNum,scope:t.scope},on:{getCorpCodes:t.getCorpCodes,handleDetail:t.handleDetail,"set-company-sufficient":t.setCompanySufficient}}):t._e(),r("competerule",{directives:[{name:"show",rawName:"v-show",value:1===t.current,expression:"current === 1"}],ref:"compet",attrs:{disabled:"0"==!t.comparProj.comparState,comparProj:t.comparProj,comparTypes:t.comparTypes,projectId:t.projMainData().id,scope:t.scope,projectIds:t.projectIds},on:{getComparProj:t.getComparProj}}),2===t.current?r("bidding-hall",{ref:"bidding",attrs:{minCorpNum:t.minCorpNum,disabled:"1"!=t.comparProj.comparState,projectId:t.projectId,comparProj:t.comparProj,projectMethod:t.projectMethod,projBaseType:this.projMainData().baseType,scope:t.scope},on:{getComparProj:t.getComparProj,re_create_compar:t.reCompar,handleDetail:t.handleDetail}}):t._e(),3===t.current?r("bidding-result-two",{attrs:{projectId:t.projectId,comparProj:t.comparProj,comparTypes:t.comparTypes,scope:t.scope},on:{updateBudgetAmount:t.updateBudgetAmount,getComparProj:t.getComparProj,handleDetail:t.handleDetail}}):t._e()],1),r("print-report-comp",{ref:"print"}),r("corp-info-detail",{ref:"detailForm"}),r("a-modal",{attrs:{width:"400px"},on:{ok:t.skipHandleOk,close:t.closeSkipCompete},model:{value:t.skipVisible,callback:function(e){t.skipVisible=e},expression:"skipVisible"}},[r("a-form-model",{ref:"skipCompeteFormModel",attrs:{model:t.skipCompeteModel,rules:t.skipFormRule,"label-col":{span:0},"wrapper-col":{span:24}}},[r("a-row",{staticClass:"houseInfo"},[r("a-col",{attrs:{span:6}},[r("span",{staticClass:"required"},[t._v("施工单位")])]),r("a-col",{attrs:{span:18}},[r("a-form-model-item",{staticClass:"width100",attrs:{prop:"chargeCorpCode"}},[r("input-search-modal",{attrs:{width:"100%",placeholder:"请选择单位",action:"/base/rCorpInfo/getCorpInfoByBaseType",options:{value:"code",label:"name",search:"name"},"page-fields":{current:"pageNo",size:"pageSize"},columns:t.skipSelectColumn,otherParams:{field:"id,name,address,linkMan",order:"desc",column:"createTime",baseType:"03"},"is-custom-modal":!1},on:{change:t.skipUnitChoose},scopedSlots:t._u([{key:"button",fn:function(){return[r("a-button",[t._v("选择单位")])]},proxy:!0}]),model:{value:t.skipCompeteModel.chargeCorpCode,callback:function(e){t.$set(t.skipCompeteModel,"chargeCorpCode",e)},expression:"skipCompeteModel.chargeCorpCode"}})],1)],1),r("a-col",{attrs:{span:6}},[r("span",{staticClass:"required"},[t._v("施工费用")])]),r("a-col",{attrs:{span:18}},[r("a-form-model-item",{staticClass:"width100",attrs:{prop:"cost"}},[r("amount-input",{model:{value:t.skipCompeteModel.cost,callback:function(e){t.$set(t.skipCompeteModel,"cost",e)},expression:"skipCompeteModel.cost"}})],1)],1)],1)],1)],1)],1)],1)},n=[],i=r("9eab"),o=r("4880"),s=r("b4c9"),c=r("a37d"),l=r("0fea"),u=r("9bed"),d=r("2b0e"),f=r("d8a5"),p=r("779d"),h=r("4aae"),m=r("aa2d");function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function v(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */v=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function u(t,e,r,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new O(a||[]);return n(o,"_invoke",{value:P(t,r,s)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function b(){}function w(){}function _(){}var x={};l(x,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(E([])));C&&C!==r&&a.call(C,o)&&(x=C);var L=_.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function r(n,i,o,s){var c=d(t[n],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==g(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,o,s)}),(function(t){r("throw",t,o,s)})):e.resolve(u).then((function(t){l.value=t,o(l)}),(function(t){return r("throw",t,o,s)}))}s(c.arg)}var i;n(this,"_invoke",{value:function(t,a){function n(){return new e((function(e,n){r(t,a,e,n)}))}return i=i?i.then(n,n):n()}})}function P(e,r,a){var n=f;return function(i,o){if(n===h)throw Error("Generator is already running");if(n===m){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var c=T(s,a);if(c){if(c===y)continue;return c}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===f)throw n=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=h;var l=d(e,r,a);if("normal"===l.type){if(n=a.done?m:p,l.arg===y)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=m,a.method="throw",a.arg=l.arg)}}}function T(e,r){var a=r.method,n=e.iterator[a];if(n===t)return r.delegate=null,"throw"===a&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=d(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(g(e)+" is not iterable")}return w.prototype=_,n(L,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:w,configurable:!0}),w.displayName=l(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,l(t,c,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(D.prototype),l(D.prototype,s,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(u(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(L),l(L,c,"Generator"),l(L,o,(function(){return this})),l(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;j(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:E(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function y(t,e,r,a,n,i,o){try{var s=t[i](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(a,n)}function b(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var i=t.apply(e,r);function o(t){y(i,a,n,o,s,"next",t)}function s(t){y(i,a,n,o,s,"throw",t)}o(void 0)}))}}var w={name:"CompeteTitle",inject:{projMainData:{default:{}},newEditModal:{default:{}}},props:{isDoing:{type:Boolean,default:!1},isDetail:{type:Boolean,default:!1}},components:{InputSearchModal:m["default"],AmountInput:h["default"],CorpInfoDetail:p["default"],SupplierSelect:i["default"],Competerule:o["default"],BiddingHall:c["default"],BiddingResultTwo:s["default"],PrintReportComp:u["default"]},data:function(){return{isPreDeclaration:!1,minCorpNum:1,scope:"",comparTypes:[],companySufficient:!0,activeKey:["1"],title:"项目信息",current:0,projectId:"",projectIds:[],projectMethod:"0",projectStatus:"0",currentStatus:"",comparProj:{},skipVisible:!1,skipCompeteModel:{},skipSelectColumn:[{title:"单位名称",align:"left",field:"name"},{title:"地址",align:"left",field:"address"},{title:"联系人",align:"center",field:"linkMan"}],skipFormRule:{chargeCorpCode:[{required:!0,message:"请选择施工单位！",trigger:["change","blur"]}],cost:[{validator:function(t,e,r){e&&0!==Number(e)?r():r(new Error("请输入施工费用！"))}}]},url:{queryById:"/productpurchase/productPurchase/queryById",getCompar:"/compare/bComparProj/add",costAdd:"/use/serviceCost/add",reCompar:"/compare/bComparProj/reCompar",getComparTypes:"/use/serviceProj/getComparTypes",getScope:"/use/serviceProj/getScope",getBiddingPartList:"/compare/bComparPart/getBiddingPartList",getRightCorpInfo:"/base/rCorpInfo/getRightCorpInfo"}}},computed:{step1:function(){return"0"!=this.comparProj.comparState||this.companySufficient?this.comparProj.comparState>="0"&&this.companySufficient?"finish":"wait":"process"},step2:function(){return"0"==this.comparProj.comparState&&this.companySufficient?"process":"0"!=this.comparProj.comparState||this.companySufficient?"finish":"wait"},step3:function(){return"1"===this.comparProj.comparState||"X"===this.comparProj.comparState||"2"===this.comparProj.comparState&&this.comparProj.comparCorpCount<this.minCorpNum?"process":this.comparProj.comparState>="2"&&this.comparProj.comparCorpCount>=this.minCorpNum?"finish":"wait"},step4:function(){return"2"==this.comparProj.comparState&&this.comparProj.comparCorpCount>=this.minCorpNum?"process":"3"==this.comparProj.comparState&&this.comparProj.comparCorpCount>=this.minCorpNum?"finish":"wait"}},created:function(){this.getMinCorpNum(),this.getPreDeclaration(),this.isDoing&&"8"!==this.projMainData().state||this.initData()},methods:{getPreDeclaration:function(){var t=this;Object(f["e"])("pre_declaration").then((function(e){t.isPreDeclaration="1"==e}))},skipCompete:function(){this.skipCompeteModel=this.projMainData()["construction"],this.skipVisible=!0},skipUnitChoose:function(t,e){this.skipCompeteModel.chargeCorpMan=e?e.linkMan:"",this.skipCompeteModel.chargeCorpPhone=e?e.phone:""},skipHandleOk:function(){var t=this;this.$refs.skipCompeteFormModel.validate((function(e){e&&(t.projMainData()["budgetCost"]=t.skipCompeteModel.cost,t.projMainData()["construction"].chargeCorpCode=t.skipCompeteModel.chargeCorpCode,t.projMainData()["construction"].chargeCorpMan=t.skipCompeteModel.chargeCorpMan,t.projMainData()["construction"].chargeCorpPhone=t.skipCompeteModel.chargeCorpPhone,t.projMainData()["construction"].cost=t.skipCompeteModel.cost,t.newEditModal().handleOk(t.isPreDeclaration),t.closeSkipCompete())}))},closeSkipCompete:function(){this.skipVisible=!1,this.skipCompeteModel={}},handleDetail:function(t){var e=this;Object(l["e"])(this.url.getRightCorpInfo,{id:t}).then((function(t){t.success&&t.result.records.length>0&&(e.$refs.detailForm.show(t.result.records[0]),e.$refs.detailForm.title=t.result.records[0].name+" ("+t.result.records[0].baseType_dictText+") ")}))},getMinCorpNum:function(){var t=this;"01"===this.projMainData().baseType&&Object(f["e"])("proj_compare_minCorpNum").then((function(e){t.minCorpNum=e?parseInt(e):0})),"02"===this.projMainData().baseType&&Object(f["e"])("emergency_compare_minCorpNum").then((function(e){t.minCorpNum=e?parseInt(e):0}))},initData:function(){var t=b(v().mark((function t(){var e=this;return v().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.projectIds=[],this.projMainData().children&&this.projMainData().children.length>0?this.projMainData().children.forEach((function(t){e.projectIds.push(t.id)})):this.projectIds.push(this.projMainData().id),this.$store.commit("SET_PAGE_LOAD_STATE",{state:!0}),t.next=5,this.initIds();case 5:return t.next=7,this.createComparProj(this.projMainData().id);case 7:this.currentStatus=1,this.changeTab(),this.userInfo=d["default"].ls.get("Login_Userinfo"),this.$store.commit("SET_PAGE_LOAD_STATE",{state:!1});case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),print:function(){var t=this.projectIds;this.$refs.print.type="print";var e=this.userInfo.orgCodeTxt;"3"===this.scope?this.$refs.print.print("fire_device_explore_report",{projId:t,orgCodeTxt:e}):"4"===this.scope||"5"===this.scope?this.$refs.print.print("lift_device_explore_report",{projId:t,orgCodeTxt:e}):"2"===this.scope?this.$refs.print.print("waterproof_device_explore_report",{projId:t,orgCodeTxt:e}):this.$refs.print.print("public_device_explore_report2",{projId:t,orgCodeTxt:e})},setProjBudgetCost:function(){var t=this;return new Promise((function(e){Object(l["e"])(t.url.getBiddingPartList,{projectId:t.comparProj.projectId,corpCode:t.comparProj.corpCode,comparState:t.comparProj.comparState}).then((function(r){r.success&&(r.result.partList.forEach((function(e){t.projMainData().id==e.projectId&&(t.projMainData().budgetCost=e.corpPrice,t.projMainData().construction.chargeCorpCode=e.corpCode,t.projMainData().construction.cost=e.corpPrice,(t.projMainData().children||0==t.projMainData().children.length)&&t.projMainData().costLists.forEach((function(e){r.result.materialList.forEach((function(r){r.cprojId==t.projMainData().id&&r.costListId==e.id&&(e.totalPrice=r.priceTotal)}))})))})),t.projMainData().children&&t.projMainData().children.length>0&&t.projMainData().children.forEach((function(t){r.result.partList.forEach((function(e){t.id==e.projectId&&(t.budgetCost=e.corpPrice,t.construction.chargeCorpCode=e.corpCode,t.construction.cost=e.corpPrice)})),t.costLists.forEach((function(e){r.result.materialList.forEach((function(r){r.cprojId==t.id&&r.costListId==e.id&&(e.totalPrice=r.priceTotal)}))}))})),t.projMainData().costs&&t.projMainData().costs.forEach((function(t){r.result.partList.forEach((function(e){e.projectId==t.projId&&(t.cost=e.corpPrice,t.chargeCorpCode=e.corpCode)}))}))),e()})).catch((function(){e()}))}))},getComparTypes:function(t){var e=this;return new Promise((function(r){t?Object(l["e"])(e.url.getComparTypes,{projectIds:t.toString()}).then((function(t){e.comparTypes=t.result,r()})).catch((function(){r()})):r()}))},getScope:function(t){var e=this;return new Promise((function(r){Object(l["e"])(e.url.getScope,{projectIds:t.toString()}).then((function(t){t.success&&(e.scope=t.result),r()})).catch((function(){r()}))}))},initIds:function(){var t=this;return new Promise((function(e){t.$nextTick(b(v().mark((function r(){return v().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.getComparTypes(t.projectIds);case 2:return r.next=4,t.getScope(t.projectIds);case 4:e();case 5:case"end":return r.stop()}}),r)}))))}))},setCompanySufficient:function(t){this.companySufficient=t,this.companySufficient||this.$message.warning("单位数量不足"+this.minCorpNum+"家，不能进行比选！")},updateBudgetAmount:function(t){this.projMainData().construction.cost=t.corpPrice,this.projMainData().construction.chargeCorpCode=t.corpCode,this.projMainData().construction.id=null,this.projMainData().construction.stage="02",Object(l["j"])(this.url.costAdd,this.projMainData().construction).then((function(t){}))},getComparProj:function(){var t=this;this.$store.commit("SET_PAGE_LOAD_STATE",{state:!0}),Object(l["e"])("/compare/bComparProj/queryById?id="+this.comparProj.id).then(function(){var e=b(v().mark((function e(r){return v().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.comparProj=r.result,t.$emit("compar-footer",t.comparProj.comparState),null==t.comparProj.configId&&(t.comparProj.configId=void 0),!t.comparProj||"3"!=t.comparProj.comparState){e.next=6;break}return e.next=6,t.setProjBudgetCost();case 6:t.$store.commit("SET_PAGE_LOAD_STATE",{state:!1});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){t.$store.commit("SET_PAGE_LOAD_STATE",{state:!1})}))},createComparProj:function(t){var e=this;return new Promise((function(r){Object(l["e"])(e.url.getCompar,{projectId:t}).then(function(){var t=b(v().mark((function t(a){return v().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.comparProj=a.result,e.$emit("compar-footer",e.comparProj.comparState),null==e.comparProj.configId&&(e.comparProj.configId=void 0),!e.comparProj||"3"!=e.comparProj.comparState){t.next=7;break}return t.next=7,e.setProjBudgetCost();case 7:r();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){r()}))}))},reCompar:function(){var t=b(v().mark((function t(){var e,r=this;return v().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,t.next=3,Object(l["j"])(this.url.reCompar,this.comparProj).then((function(t){t.success?(e.createComparProj(r.projMainData().id),r.$message.info("已经重新发起比选"),e.current="null",e.current=0):r.$message.warning("发生错误!")}));case 3:this.changeTab(1);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeTab:function(t){this.isDoing||"3"===this.comparProj.comparState?this.companySufficient&&(t<2&&(this.current=t),2===t&&("1"!==this.comparProj.comparState&&"2"!==this.comparProj.comparState&&"3"!==this.comparProj.comparState&&"X"!==this.comparProj.comparState||(this.current=t)),3===t&&("2"===this.comparProj.comparState||"3"===this.comparProj.comparState)&&this.comparProj.comparCorpCount>=this.minCorpNum&&(this.current=t)):this.$message.warning("施工单位比选节点已过,无法操作!")},getCorpCodes:function(t){var e=this;this.$nextTick((function(){e.$refs.compet.getCorpCodes(t)}))}}},_=w,x=(r("ded1f"),r("0dac"),r("2877")),k=Object(x["a"])(_,a,n,!1,null,"254e92f8",null);e["default"]=k.exports},f89d:function(t,e,r){},f986:function(t,e,r){},fc72:function(t,e,r){"use strict";r("fd000")},fd000:function(t,e,r){},fd02:function(t,e,r){"use strict";r("50fe")},fd65:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-row",[r("a-col",{staticStyle:{"margin-left":"0%"}},[r("a-tooltip",{attrs:{placement:"topLeft"}},[r("template",{slot:"title"},[r("span",[t._v("点击右侧“选择用户”按钮添加谁可以看")])]),r("a-select",{staticStyle:{width:"calc(100% - 115px)"},attrs:{maxTagCount:10,mode:"multiple",allowClear:"",open:!1,disabled:t.disabled},on:{deselect:t.onDel,change:t.changeUser},model:{value:t.receptionList0,callback:function(e){t.receptionList0=e},expression:"receptionList0"}})],2),t.isDisabled?r("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.onSearchDepUser}},[t._v("选择用户")]):t._e()],1),r("j-select-user-by-dep-modal-new",{ref:"selectModal",attrs:{"modal-width":1e3,multi:!0,userIds:t.personids},on:{ok:t.selectOK}})],1)},n=[],i=r("a505"),o=r("0f9d");function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}var u={name:"JSelectUserByDep",components:{JSelectUserByDepModal:i["default"],JSelectMultiUser:o["default"],JSelectUserByDepModalNew:i["default"]},created:function(){},props:{modalWidth:{type:Number,default:1250,required:!1},value:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},multi:{type:Boolean,default:!0,required:!1}},data:function(){return{isDisabled:!0,personids:"",persons:"",userIds:"",userId:[],user:[],ids:"",rows:{},userNames:"",isShow:!1,receptionList0:[],labelCol:{xs:{span:4},sm:{span:8}},wrapperCol:{xs:{span:20},sm:{span:16}},labelCol1:{xs:{span:7},sm:{span:8}},wrapperCol1:{xs:{span:17},sm:{span:16}}}},mounted:function(){$("input").attr("readonly","readonly"),this.userIds=this.value},watch:{value:function(t){this.userIds=t},paramIndex:function(t){this.param=t}},model:{prop:"value",event:"change"},methods:{changeUser:function(t){0==t.length&&(this.personids="")},onDel:function(t){for(var e=0;e<this.rows.length;e++)if(t==this.rows[e].realname||t==this.rows[e].name){this.rows.splice(e,1);break}for(var r=[],a=0;a<this.rows.length;a++)r.push(this.rows[a].id);this.personids=r.join(",")},initPerson:function(t){var e=this;this.rows=t;for(var r="",a=0;a<this.rows.length;a++)this.rows[a].id=this.rows[a].userId,r+=","+this.rows[a].id;this.ids=r.substring(1),t.forEach((function(t){e.receptionList0.push(t.name),e.userId.push(t.userId)}))},initComp:function(t){this.userNames=t},onSearchDepUser:function(){if(this.$refs.selectModal.showModal(),this.rows.length>0)for(var t=0;t<this.receptionList0.length;t++)for(var e=0;e<this.rows.length;e++)this.rows[e].realname?this.receptionList0[t]==this.rows[e].realname&&(this.$refs.selectModal.selectedRowKeys.push(this.rows[e].id),this.$refs.selectModal.selectUserRows.push(this.rows[e])):this.receptionList0[t]==this.rows[e].name&&(this.$refs.selectModal.selectedRowKeys.push(this.rows[e].id),this.$refs.selectModal.selectUserRows.push(this.rows[e]))},selectOK:function(t,e){if(this.receptionList0=[],this.rows=t,t){var r,a="",n="",i=s(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;void 0!=o.realname?this.receptionList0.push(o.realname):this.receptionList0.push(o.name),n+=","+o.id}}catch(c){i.e(c)}finally{i.f()}this.persons=a.substring(1),this.personids=n.substring(1),this.ids=this.personids}else this.persons="",this.personids=""}}},d=u,f=(r("a62d"),r("2877")),p=Object(f["a"])(d,a,n,!1,null,"7990d25f",null);e["default"]=p.exports}}]);