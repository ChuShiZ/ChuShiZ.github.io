(window["webpackJsonp_joinsoft-v9"]=window["webpackJsonp_joinsoft-v9"]||[]).push([["app~6c7f64d0"],{"0a06":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-card",{staticClass:"mainCard",attrs:{bordered:!1}},[i("div",{staticClass:"listQuery"},[i("m-e-s-super-query",{ref:"mesSuperQuery",staticClass:"mesSuperQuery",attrs:{isExpand:!0,fieldList:e.queryObj,saveCode:e.fileName,type:e.showType,"is-full-query":!0},on:{ok:e.handleSuperQuery},scopedSlots:e._u([{key:"busiDataStart",fn:function(t){var r=t.row;return[i("a-date-picker",{attrs:{value:e.minDate,disabledDate:e.startDisabledDate},on:{change:function(t){return e.startChange(t,r)}}})]}},{key:"busiDataEnd",fn:function(t){var r=t.row;return[i("a-date-picker",{attrs:{value:e.maxDate,disabledDate:e.endDisabledDate},on:{change:function(t){return e.endChange(t,r)}}})]}}])}),i("cover-info-comp",{staticClass:"coverInfoComp",on:{isLogin:function(t){return e.$refs.mesSuperQuery.manuallyQuery()},ok:e.modalFormOk}})],1),i("div",{staticClass:"listTable"},[i("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,"if-init-query":!1,checkbox:!0,selectChangeEvent:e.selectChangeEvent,"select-all-event":e.selectAllEvent,expand:!1,data:e.loadData,"table-height":"auto",tableColumn:e.columns},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("div",{staticClass:"vxetable-operator"},[i("a-button",{attrs:{icon:"plus",type:"primary"},on:{click:e.handleAdd}},[e._v("新建")]),i("a-dropdown",[i("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[i("a-menu-item",{key:"1",on:{click:e.printVoucher}},[i("a-icon",{attrs:{type:"printer"}}),e._v("打印")],1),i("a-menu-item",{key:"2",on:{click:e.checkDeleteBatch}},[i("a-icon",{attrs:{type:"delete"}}),e._v("删除")],1)],1),i("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),i("a-icon",{attrs:{type:"down"}})],1)],1)],1)]},proxy:!0},{key:"busiNo",fn:function(t){var r=t.text,n=t.row;return[i("a",{on:{click:function(t){return e.gotoDetail(n)}}},[e._v(e._s(r))])]}},{key:"action",fn:function(t){t.text;var r=t.row;return["01"!==r.vouAttr&&"0"===r.isVoucol?i("span",[i("a",{on:{click:function(t){return e.handleEdit(r)}}},[i("a-icon",{attrs:{type:"edit"}}),e._v(" 编辑")],1),i("a-divider",{attrs:{type:"vertical"}}),i("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return e.handleDelete(r.id)}}},[i("a",[i("a-icon",{attrs:{type:"delete"}}),e._v(" 删除")],1)]),i("a-divider",{attrs:{type:"vertical"}})],1):e._e(),"01"===r.vouAttr?i("span",[i("a",{on:{click:function(t){return e.handleInfo(r)}}},[i("a-icon",{attrs:{type:"edit"}}),e._v(" 附件维护")],1),i("a-divider",{attrs:{type:"vertical"}})],1):e._e(),i("span",[i("a",{on:{click:function(t){return e.handleDetail(r)}}},[i("a-icon",{attrs:{type:"snippets"}}),e._v(" 查看详情")],1)])]}},{key:"isVoucol",fn:function(t){var r=t.text;t.row;return["0"===r?i("span",[e._v("未汇总")]):e._e(),"1"===r?i("span",[e._v("已汇总")]):e._e()]}}])})],1),i("voucher-modal",{ref:"modalForm",on:{ok:e.modalFormOk}}),i("print-voucher-modal",{ref:"printVoucher"}),i("j-modal",{attrs:{switchFullscreen:!0,title:e.houseTitle,top:8,"body-style":{padding:0},visible:e.houseVisible,width:"1160px"},on:{cancel:e.handleCancel}},[i("template",{slot:"footer"},[i("div",{staticStyle:{"text-align":"center"}},[i("a-button",{on:{click:e.handleCancel}},[i("a-icon",{attrs:{type:"close-circle"}}),e._v("\n          取消\n        ")],1)],1)]),i("deposit-business-details",{ref:"tradIngRecord"})],2),i("com-acc-info-modal",{ref:"detail",attrs:{"dict-code":e.dictCode,"busi-type-detail":e.busiTypeDetail}}),e.pageName?i(r("4b3b")("./"+e.pageName).default,{ref:"refund",tag:"component",attrs:{"req-id":e.reqId}}):e._e(),i("allot-list-modal",{ref:"allotModal"}),i("income-modal",{ref:"incomeModal"}),i("j-modal",{attrs:{switchFullscreen:!0,title:"归属变更详情",top:8,"body-style":{padding:0},visible:e.attrChangeVisible,width:"1160px"},on:{cancel:e.handleCancel}},[i("template",{slot:"footer"},[i("div",{staticStyle:{"text-align":"center"}},[i("a-button",{on:{click:e.handleCancel}},[i("a-icon",{attrs:{type:"close-circle"}}),e._v("\n          取消\n        ")],1)],1)]),i("batch-change-record-comp",{ref:"batchChangeRecordComp"})],2),i("j-modal",{attrs:{switchFullscreen:!0,title:"资金转账详情",top:8,"body-style":{padding:0},visible:e.transferVisible,width:"1160px"},on:{cancel:e.handleCancel}},[i("template",{slot:"footer"},[i("div",{staticStyle:{"text-align":"center"}},[i("a-button",{on:{click:e.handleCancel}},[i("a-icon",{attrs:{type:"close-circle"}}),e._v("\n          取消\n        ")],1)],1)]),i("acc-transfer-audit-comp",{ref:"accTransferAuditComp"})],2),i("no-account-modal",{ref:"NoAccountModal",attrs:{"dict-code":e.dictCode,"busi-type-detail":e.busiTypeDetail}})],1)},n=[],a=(r("6eb7"),r("0fea")),o=r("ac0d"),s=r("0a5e"),l=r("6fa9"),c=r("93d8"),u=r("c1df"),d=r.n(u),f=r("4ec3"),h=r("3ed7"),m=r("30e0"),v=r("ca00"),p=r("d9c6"),b=r("8399"),y=r("2ca0"),g={name:"VoucherList",mixins:[s["a"],o["b"],b["VoucherJump"]],components:{VoucherModal:c["default"],MESSuperQuery:l["default"],CoverInfoComp:m["default"],PrintVoucherModal:p["default"],IncomeModal:y["default"]},data:function(){var e=this;return{showType:"queryList",fileName:"VoucherList",houseTitle:"",description:"凭证管理管理页面",queryObj:[{type:"select",value:"busiTypeDetail",label:"业务类型",options:[]},{type:"input",value:"amount",label:"业务金额",queryType:"like"},{label:"填制日期始",value:"busiDateStart",type:"slot",queryType:"ge",val:Object(v["h"])(),slotName:"busiDataStart"},{label:"填制日期至",value:"busiDateEnd",type:"slot",queryType:"le",val:Object(v["i"])(),slotName:"busiDataEnd"},{type:"select",value:"vouAttr",label:"凭证属性",options:[]},{type:"input",value:"oldVouchsn",label:"原始凭证号",queryType:"like"},{type:"input",value:"oldVoucolsn",label:"汇总凭证号",queryType:"like"},{type:"select",value:"isVoucol",label:"汇总状态",options:[{label:"未汇总",value:"0"},{label:"已汇总",value:"1"}]},{type:"input",value:"createBy",label:"凭证制单人",queryType:"like"}],columns:[{title:"业务类型",field:"busiTypeName",align:"left",headerAlign:"left"},{title:"凭证号",field:"vouchNo",align:"center",headerAlign:"center",width:100},{title:"业务编号",field:"busiNo",align:"center",headerAlign:"center",width:150,slot:!0},{title:"业务金额 (元)",align:"right",headerAlign:"right",field:"amount",width:150,formatter:function(e){var t=e.cellValue;return Object(h["g"])(t)}},{title:"填制日期",align:"center",field:"makeDate",formatter:function(e){var t=e.cellValue;return t?d()(t).format("YYYY-MM-DD"):""},width:140},{title:"附件数 (张)",align:"right",headerAlign:"right",field:"acceNum",width:120},{title:"凭证属性",align:"left",headerAlign:"left",field:"vouAttr_dictText",width:120},{title:"汇总状态",align:"left",headerAlign:"left",field:"isVoucol",slot:!0,width:150},{title:"凭证制单人",align:"left",headerAlign:"left",field:"makeOper",width:150},{title:"操作",field:"action",align:"center",fixed:"right",width:260,slot:!0}],childColumns:[{title:"顺序号",align:"center",dataIndex:"orderNum",width:60},{title:"摘要",align:"left",dataIndex:"brief",width:280},{title:"科目名称",align:"center",dataIndex:"itemName",width:250},{title:"借方金额 (元)",align:"right",dataIndex:"debitAmount",width:150,customRender:function(e){return Object(h["g"])(e)}},{title:"贷方金额 (元)",align:"right",dataIndex:"creditAmount",width:150,customRender:function(e){return Object(h["g"])(e)}}],loadData:function(t){return Object(a["e"])(e.url.list,Object.assign(t,e.queryParam)).then((function(t){return t&&!t.success?e.$message.error("请登录账套！"):t.result}))},url:{list:"/voucher/list",delete:"/voucher/delete",deleteBatch:"/voucher/deleteBatch",url_data:"/sys/category/loadTreeData"},BusinessType:"/sys/category/loadTreeData",dictOptions:{},minDate:Object(v["h"])(),maxDate:Object(v["i"])()}},created:function(){this.loadRoot(),this.initBidType()},methods:{initBidType:function(){this.queryObj.map((function(e){"vouAttr"===e.value&&Object(f["i"])("voucher_properties",null).then((function(t){t.success&&(e.options=t.result.map((function(e){return{label:e.title,value:e.value}})))}))}))},loadRoot:function(){var e=this;this.queryObj.map((function(t){"busiTypeDetail"===t.value&&Object(a["e"])(e.BusinessType,{pcode:"90"}).then((function(r){r.success&&(t.options=e.convert(r.result))}))}))},convert:function(e,t){for(var r=e,i=[],n=0;n<r.length;n++){var a={};a.value=t?r[n].value:r[n].code,a.label=r[n].title,i.push(a)}return i},checkDeleteBatch:function(){this.checkDel()&&this.batchDel()},printVoucher:function(){if(this.selectedRowKeys.length<1)return this.$message.warning("请选择一条记录！");this.$refs.printVoucher.init(this.selectedRowKeys,"voucher_detail")},handleInfo:function(e){this.$refs.modalForm.edit(e,!0),this.$refs.modalForm.title="附件维护",this.$refs.modalForm.disableSubmit=!1},handleDetail:function(e){this.$refs.modalForm.handleDetail(e),this.$refs.modalForm.title="查看详情",this.$refs.modalForm.disableSubmit=!1},startDisabledDate:function(e){return d()(e).isAfter(this.maxDate)},endDisabledDate:function(e){return d()(e).isBefore(this.minDate)},startChange:function(e,t){e?(this.minDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.minDate)):this.minDate=""},endChange:function(e,t){e?(this.maxDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.maxDate)):this.maxDate=""},checkDel:function(){var e=!0;if(this.selectedRowKeys.length<=0)return this.$message.warning("请选择一条记录！"),e=!1,e;if(this.selectedRows)for(var t=0;t<this.selectedRows.length;t++){var r=this.selectedRows[t];if("01"===r.vouAttr)return this.$message.warning("所选凭证中,含有属性为自动的凭证,不可删除！"),e=!1,e;if("1"===r.isVoucol)return this.$message.warning("所选凭证中,含有已汇总的凭证,不可删除！"),e=!1,e}return e}}},w=g,x=(r("8fd7"),r("2877")),D=Object(x["a"])(w,i,n,!1,null,"570561cd",null);t["default"]=D.exports},"1e27":function(e,t,r){"use strict";r("9fc6")},"31bd":function(e,t,r){},"3e68":function(e,t,r){"use strict";r("f730")},"4ef7":function(e,t,r){},"513b":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-card",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"ant-modal-cust-warp mainCard",attrs:{bordered:!1}},[i("m-e-s-super-query",{ref:"mesSuperQuery",attrs:{fieldList:e.queryObj,saveCode:e.fileName,isResetDefault:!1,type:"queryList","is-init-query":!0,"default-query":!1},on:{ok:e.handleSuperQuery},scopedSlots:e._u([{key:"busiTypeDetail",fn:function(t){var r=t.row;return[i("a-tree-select",{staticStyle:{width:"100%"},attrs:{"show-search":!0,filterTreeNode:e.filter,dropdownStyle:{maxHeight:"400px",overflow:"auto"},treeData:e.busiTypeDetailList,placeholder:"请选择业务类型"},model:{value:r.val,callback:function(t){e.$set(r,"val",t)},expression:"row.val"}})]}}])}),i("div",{staticClass:"tableDiv"},[i("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,checkbox:!0,selectChangeEvent:e.selectChangeEvent,"select-all-event":e.selectAllEvent,"table-height":"auto",expand:!1,data:e.loadData,tableColumn:e.columns,ifInitQuery:!1,footerMethod:e.footerMethod},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("div",{staticClass:"vxetable-operator"},[i("a-button",{attrs:{icon:"redo",disabled:e.isSelectedVoucol,type:"primary"},on:{click:e.summary}},[e._v("凭证汇总")]),i("a-button",{attrs:{icon:"printer",type:"primary"},on:{click:e.print}},[e._v("打印")])],1)]},proxy:!0},{key:"busiNo",fn:function(t){var r=t.text,n=t.row;return[i("a",{on:{click:function(t){return e.gotoDetail(n)}}},[e._v(e._s(r))])]}},{key:"actionExpand",fn:function(t){t.text;var r=t.row;return[i("a-table",{attrs:{size:"middle",bordered:"",columns:e.childColumns,dataSource:r.vouList,pagination:!1}})]}}])})],1),i("j-modal",{attrs:{switchFullscreen:!0,title:"房屋交易明细",top:8,"body-style":{padding:0},visible:e.houseVisible,width:"1160px"},on:{cancel:e.handleCancel}},[i("template",{slot:"footer"},[i("div",{staticStyle:{"text-align":"center"}},[i("a-button",{on:{click:e.handleCancel}},[i("a-icon",{attrs:{type:"close-circle"}}),e._v("\n          取消\n        ")],1)],1)]),i("deposit-business-details",{ref:"tradIngRecord"})],2),i("com-acc-info-modal",{ref:"detail",attrs:{"dict-code":e.dictCode,"busi-type-detail":e.busiTypeDetail}}),e.pageName?i(r("4b3b")("./"+e.pageName).default,{ref:"refund",tag:"component",attrs:{"req-id":e.reqId}}):e._e(),i("allot-list-modal",{ref:"allotModal"}),i("income-modal",{ref:"incomeModal"}),i("j-modal",{attrs:{switchFullscreen:!0,title:"归属变更详情",top:8,"body-style":{padding:0},visible:e.attrChangeVisible,width:"1160px"},on:{cancel:e.handleCancel}},[i("template",{slot:"footer"},[i("div",{staticStyle:{"text-align":"center"}},[i("a-button",{on:{click:e.handleCancel}},[i("a-icon",{attrs:{type:"close-circle"}}),e._v("\n          取消\n        ")],1)],1)]),i("batch-change-record-comp",{ref:"batchChangeRecordComp"})],2),i("j-modal",{attrs:{switchFullscreen:!0,title:"资金转账详情",top:8,"body-style":{padding:0},visible:e.transferVisible,width:"1160px"},on:{cancel:e.handleCancel}},[i("template",{slot:"footer"},[i("div",{staticStyle:{"text-align":"center"}},[i("a-button",{on:{click:e.handleCancel}},[i("a-icon",{attrs:{type:"close-circle"}}),e._v("\n          取消\n        ")],1)],1)]),i("acc-transfer-audit-comp",{ref:"accTransferAuditComp"})],2),i("no-account-modal",{ref:"NoAccountModal",attrs:{"dict-code":e.dictCode,"busi-type-detail":e.busiTypeDetail}}),i("print-report-comp",{ref:"print"})],1)},n=[],a=(r("6eb7"),r("0fea")),o=r("ac0d"),s=r("0a5e"),l=r("6fa9"),c=r("ca00"),u=r("c1df"),d=r.n(u),f=r("3ed7"),h=r("2b0e"),m=r("9fb0"),v=r("8399"),p=r("2ca0"),b=r("9bed"),y=r("c695"),g=r.n(y),w=r("5c96");function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=D(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function D(e,t){if(e){if("string"==typeof e)return k(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var C={name:"VoucherColListSummary",mixins:[s["a"],o["b"],v["VoucherJump"]],components:{MESSuperQuery:l["default"],IncomeModal:p["default"],PrintReportComp:b["default"]},watch:{selectedRows:function(e){this.isSelectedVoucol=e.some((function(e){return"1"==e.isVoucol}))}},data:function(){var e=this;return{minDate:Object(c["h"])(),maxDate:Object(c["i"])(),fileName:"VoucherColList",description:"凭证汇总页面",queryObj:[{type:"slot",queryType:"like",slotName:"busiTypeDetail",value:"busiTypeDetail",label:"业务类型"},{label:"填制日期始",value:"busiDateStart",queryType:"ge",type:"date",maxDate:"busiDateEnd"},{label:"填制日期止",value:"busiDateEnd",queryType:"le",type:"date",minDate:"busiDateStart"},{type:"select",value:"coverYear",label:"年份",options:[],val:""},{type:"select",value:"month",label:"月份",options:[],val:Object(c["k"])()},{type:"select",value:"isVoucol",label:"是否汇总",options:[{value:"0",label:"未汇总"},{value:"1",label:"已汇总"}]}],isLoading:!1,columns:[{title:"业务类型",align:"left",headerAlign:"left",field:"busiTypeName"},{title:"凭证号",align:"left",headerAlign:"left",field:"vouchNo",width:90},{title:"业务编号",field:"busiNo",align:"center",headerAlign:"center",width:150,slot:!0},{title:"业务金额 (元)",align:"right",headerAlign:"right",field:"amount",formatter:"amount",width:150},{title:"月份",align:"left",headerAlign:"left",field:"month",width:80},{title:"填制日期",align:"center",field:"makeDate",formatter:function(e){var t=e.cellValue;return d()(t).format("YYYY-MM-DD")},width:150},{title:"摘要",align:"left",field:"brief"},{title:"属性",align:"left",headerAlign:"left",field:"vouAttr_dictText",width:80},{title:"汇总状态",align:"left",headerAlign:"left",field:"isVoucol",width:90,formatter:function(e){var t=e.cellValue;return"1"==t?"已汇总":"未汇总"}},{title:"制单人",align:"left",headerAlign:"left",field:"createBy_dictText",width:150},{title:"明细",align:"left",headerAlign:"left",field:"action",width:"80px",type:"expand",slot:!0}],childColumns:[{title:"顺序号",align:"center",dataIndex:"orderNum",width:60},{title:"科目编号",align:"center",dataIndex:"itemNo",width:300},{title:"科目名称",dataIndex:"itemName",align:"left",width:300},{title:"摘要",align:"left",dataIndex:"brief"},{title:"借方发生额(元)",align:"right",dataIndex:"debitAmount",width:200,customRender:function(e){return Object(f["g"])(e)}},{title:"贷方发生额(元)",align:"right",dataIndex:"creditAmount",width:200,customRender:function(e){return Object(f["g"])(e)}}],isSelectedVoucol:!1,url:{list:"/voucher/list",listTotalInfo:"/voucher/listTotalInfo",url_data:"/sys/category/loadTreeRoot",summary:"/voucherCol/summary"},loadData:function(t){return e.selectedRowKeys=[],e.selectedRows=[],e.getTotalInfo(),Object(a["e"])(e.url.list,Object.assign(t,e.getQueryParams())).then((function(t){return t.success?t.result:e.$message.error("请登录账套！")}))},busiTypeDetailList:[],amountTotal:0}},created:function(){this.initQuery()},methods:{filter:function(e,t){return t.data.props.title.includes(e)},checkboxConfig:function(e){var t=e.row;return"0"==t.isVoucol},initQuery:function(){var e=this;Object(a["e"])(this.url.url_data,{pcode:"business_type",async:!1}).then((function(t){t.success&&(e.busiTypeDetailList=t.result)})),this.queryObj.map((function(e){if("month"===e.value){for(var t=[],r=1;r<13;r++){var i={};i.value=r<10?"0"+r:r,i.label=r<10?"0"+r:r,t.push(i)}e.options=t}if("coverYear"===e.value){var n=new Date,a=n.getFullYear(),o=h["default"].ls.get(m["f"]);if(o){var s=[],l="";l="1"==o.isStartNew?Number(o.newStartMonth.substring(0,4)):Number(o.startMonth.substring(0,4));var c={};if(c.value=l,c.label=l,s.push(c),Number(l)!=a&&a-l>0)for(var u=0;u<a-Number(l);u++){var d={};d.value=Number(l)+1+u,d.label=Number(l)+1+u,s.push(d)}e.options=s,e.val=a}}}))},summary:function(){var e,t=this,r=this.$createElement,i=x(this.selectedRows);try{for(i.s();!(e=i.n()).done;){var n=e.value;if("1"==n.isVoucol)return this.$message.warning("只能选择未汇总的凭证！")}}catch(s){i.e(s)}finally{i.f()}var o="";o=this.selectedRowKeys.length<1?"当前未选择数据，所有未汇总凭证都将汇总，是否继续？":"确认汇总？",this.$confirm({title:"注意",content:o,okText:"确认",cancelText:"取消",icon:function(){return r("a-icon",{attrs:{type:"exclamation-circle"},style:"color: #FF4D4F"})},onOk:function(){t.isLoading=!0,Object(a["j"])(t.url.summary,t.selectedRowKeys).then((function(e){e.success?(t.$message.success("操作成功"),t.onClearSelected(),t.$refs.mesSuperQuery.manuallyQuery()):t.$message.warning(e.message)})).finally((function(){t.isLoading=!1}))}})},print:function(){if(0==this.selectedRows.length)return this.$message.warning("请选择一条记录！");for(var e=h["default"].ls.get(m["f"]),t=[],r=0;r<this.selectedRows.length;r++)t.push(this.selectedRows[r].id);this.$refs.print.print("finance_voucol",{coverno:e.coverNo,id:t})},radioChange:function(){this.$refs.mesSuperQuery.manuallyQuery()},getQueryParams:function(){var e=Object.assign({},this.queryParam);return Object(c["f"])(e)},convert:function(e,t){var r,i=e,n=[],a=x(i);try{for(a.s();!(r=a.n()).done;){var o=r.value,s={};s.value=t?o.value:o.code,s.label=o.title,n.push(s)}}catch(l){a.e(l)}finally{a.f()}return n},startDisabledDate:function(e){return d()(e).isAfter(this.maxDate)},endDisabledDate:function(e){return d()(e).isBefore(this.minDate)},startChange:function(e,t){e?(this.minDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.minDate)):this.minDate=""},endChange:function(e,t){e?(this.maxDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.maxDate)):this.maxDate=""},footerMethod:function(e){var t=this,r=e.columns,i=e.data,n=[r.map((function(e,t){return"busiNo"===e.property?"合计：":["amount"].includes(e.property)?Object(f["g"])(g.a.sum(i,e.property)):null})),r.map((function(e,r){return"busiNo"===e.property?"总合计：":["amount"].includes(e.property)?Object(f["g"])(t.amountTotal):null}))];return n},getTotalInfo:function(){var e,t,r=this;this.$refs.table&&(t=this.$refs.table.$el.querySelector(".vxe-table--footer-wrapper.body--wrapper"),e=w["Loading"].service({target:t,customClass:"tableFooterLoading"})),Object(a["e"])(this.url.listTotalInfo,Object.assign({current:1,size:-1},this.getQueryParams())).then((function(e){try{r.amountTotal=e.result.amountTotal||0}catch(t){r.amountTotal=0}r.$refs.table.updateFooter()})).finally((function(){t&&e&&e.close()}))}}},_=C,$=(r("82fe"),r("2877")),O=Object($["a"])(_,i,n,!1,null,"47bfb928",null);t["default"]=O.exports},"570af":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("j-modal",{attrs:{title:"月结信息",width:900,visible:e.visible,switchFullscreen:"","modal-height":"40vh"},on:{cancel:e.handleCancel}},[r("template",{slot:"footer"},[r("div",["add"==e.type?r("a-button",{attrs:{type:"primary",icon:"check-circle"},on:{click:e.monthOk}},[e._v("确认月结")]):e._e(),"revoke"==e.type?r("a-button",{attrs:{type:"primary",icon:"close-circle"},on:{click:e.monthRevoke}},[e._v("撤销月结")]):e._e(),"detail"==e.type&&"0"==e.model.state?r("span",{staticStyle:{color:"red"}},[e._v("不可撤销，请按顺序撤销")]):e._e(),"detail"==e.type&&"2"==e.model.state?r("span",{staticStyle:{color:"red"}},[e._v("不可月结，请确认收支结转以及凭证状态")]):e._e()],1)]),r("a-table",{ref:"table",attrs:{rowKey:"id",size:"middle",bordered:"",columns:e.columns,loading:e.confirmLoading,dataSource:e.dataSource,pagination:!1}})],2)},n=[],a=r("0fea"),o=r("3ed7"),s={name:"TransferModal",data:function(){return{visible:!1,confirmLoading:!1,dataSource:[],columns:[{title:"科目类别",align:"center",dataIndex:"itemType",customRender:function(e){return"1"==e?e+"_资产":"2"==e?e+"_负债":"3"==e?e+"_净资产":"4"==e?e+"_收入":"5"==e?e+"_支出":void 0}},{title:"期初余额 (元)",align:"right",dataIndex:"sumBeginBalance",customRender:function(e){return Object(o["g"])(e)}},{title:"本期借方发生额 (元)",align:"right",dataIndex:"sumDebitAmount",customRender:function(e){return Object(o["g"])(e)}},{title:"本期贷方发生额 (元)",align:"right",dataIndex:"sumCreditAmount",customRender:function(e){return Object(o["g"])(e)}},{title:"期末余额 (元)",align:"right",dataIndex:"sumEndBalance",customRender:function(e){return Object(o["g"])(e)}}],url:{list:"/transfer/monthTransList",transferMonth:"/transfer/transferMonth",revokeMonth:"/transfer/revokeMonth"},model:{},type:""}},created:function(){},methods:{add:function(e){this.type="add",this.loadData(e)},revoke:function(e){this.type="revoke",this.loadData(e)},detail:function(e){this.type="detail",this.loadData(e)},loadData:function(e){var t=this;this.model=Object.assign({},e),this.visible=!0,this.confirmLoading=!0,Object(a["e"])(this.url.list,{month:this.model.month,year:this.model.coverYear}).then((function(e){e.success?t.dataSource=e.result:t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1}))},handleCancel:function(){this.model={},this.type="",this.confirmLoading=!1,this.visible=!1},monthOk:function(){var e=this,t=this;this.$confirm({content:"确定进行月末结转吗？",onOk:function(){Object(a["e"])(t.url.transferMonth,{month:e.model.month,year:e.model.coverYear}).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.handleCancel()):t.$message.warning(e.message)}))}})},monthRevoke:function(){var e=this,t=this;this.$confirm({content:"确定撤销月结吗？",onOk:function(){Object(a["e"])(t.url.revokeMonth,{month:e.model.month,year:e.model.coverYear}).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.handleCancel()):t.$message.warning(e.message)}))}})}}},l=s,c=(r("5dd0"),r("2877")),u=Object(c["a"])(l,i,n,!1,null,"3cde3ea1",null);t["default"]=u.exports},"58d4":function(e,t,r){"use strict";r("7339")},59240:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{staticClass:"ant-modal-cust-warp mainCard",attrs:{bordered:!1}},[r("div",{staticStyle:{width:"100%"}},[r("m-e-s-super-query",{ref:"mesSuperQuery",attrs:{fieldList:e.queryObj,saveCode:e.fileName,type:"queryList","is-reset-default":!1,"is-init-query":!0,"default-query":!1},on:{ok:e.handleSuperQuery},scopedSlots:e._u([{key:"extra",fn:function(){return[r("cover-info-comp",{staticClass:"coverInfoComp",attrs:{"show-icon":!1},on:{isLogin:function(t){return e.$refs.mesSuperQuery.manuallyQuery()},ok:e.modalFormOk}})]},proxy:!0}])})],1),r("a-tabs",{staticClass:" ",on:{change:e.radioChange},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[r("a-tab-pane",{key:"0",attrs:{tab:"未审核","force-render":""}}),r("a-tab-pane",{key:"1",attrs:{tab:"已审核","force-render":""}})],1),r("div",{staticClass:"tableDiv"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,checkbox:!0,selectChangeEvent:e.selectChangeEvent,"select-all-event":e.selectAllEvent,expand:!1,"table-height":"auto",data:e.loadData,tableColumn:e.columns,ifInitQuery:!1},scopedSlots:e._u([{key:"vouchNo",fn:function(t){var i=t.text,n=t.row;return[r("a",{on:{click:function(t){return e.handleInfo(n)}}},[e._v(e._s(i))])]}},{key:"buttons",fn:function(){return[0==e.activeKey?r("div",{staticClass:"vxetable-operator"},[r("a-button",{attrs:{icon:"redo",type:"primary"},on:{click:e.summaryApproval}},[e._v("审核")])],1):e._e(),1==e.activeKey?r("div",{staticClass:"vxetable-operator"},[r("a-button",{attrs:{icon:"undo",type:"primary"},on:{click:e.revokeApproval}},[e._v("撤销审核")]),r("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"printer",type:"primary"},on:{click:e.printVoucher}},[e._v("凭证打印")])],1):e._e()]},proxy:!0},{key:"actionExpand",fn:function(t){t.text;var i=t.row;return[r("a-table",{attrs:{size:"middle",bordered:"",columns:e.childColumns,dataSource:i.voulistColList,pagination:!1}})]}}])})],1),r("voucher-col-modal",{ref:"voucherColModal"}),r("print-voucher-modal",{ref:"printColVoucher"})],1)},n=[],a=(r("6eb7"),r("0fea")),o=r("ac0d"),s=r("0a5e"),l=r("6fa9"),c=r("ca00"),u=r("c1df"),d=r.n(u),f=r("3ed7"),h=r("905a"),m=r("30e0"),v=r("d9c6"),p=r("2b0e"),b=r("9fb0"),y={name:"VoucherColCheckList",mixins:[s["a"],o["b"]],components:{MESSuperQuery:l["default"],VoucherColModal:h["default"],CoverInfoComp:m["default"],PrintVoucherModal:v["default"]},watch:{},data:function(){var e=this;return{minDate:Object(c["h"])(),maxDate:Object(c["i"])(),fileName:"VoucherColCheckList",description:"凭证汇总页面",queryObj:[{label:"填制日期始",value:"busiDateStart",type:"date",queryType:"ge",maxDate:"busiDateEnd"},{label:"填制日期止",value:"busiDateEnd",type:"date",queryType:"le",minDate:"busiDateStart"},{type:"select",value:"isRecord",label:"是否记账",options:[{label:"是",value:"1"},{label:"否",value:"0"}]},{type:"select",value:"coverYear",label:"年份",options:[],val:""},{type:"select",value:"month",label:"月份",options:[],val:Object(c["k"])()}],columns:[{title:"凭证号",align:"left",headerAlign:"left",field:"vouchNo",slot:!0},{title:"月份",align:"left",headerAlign:"left",field:"month",width:150},{title:"属性",align:"left",headerAlign:"left",field:"vouAttr_dictText",width:180},{title:"制单日期",align:"center",field:"makeDate",formatter:function(e){var t=e.cellValue;return d()(t).format("YYYY-MM-DD")},width:180},{title:"制单人",align:"left",headerAlign:"left",field:"makeOper_dictText",width:180},{title:"汇总日期",align:"center",field:"createTime",formatter:function(e){var t=e.cellValue;return d()(t).format("YYYY-MM-DD")},width:180},{title:"是否记账",align:"left",headerAlign:"left",field:"isRecord",formatter:function(e){var t=e.cellValue;return 0==t?"否":"是"},width:180},{title:"明细",align:"left",headerAlign:"left",field:"action",width:"100px",type:"expand",slot:!0}],childColumns:[{title:"顺序号",align:"center",dataIndex:"orderNum",width:60},{title:"科目编号",align:"center",dataIndex:"itemNo",width:300},{title:"科目名称",align:"left",dataIndex:"itemName",width:300},{title:"摘要",align:"left",dataIndex:"brief"},{title:"借方发生额(元)",align:"right",dataIndex:"debitAmount",width:200,customRender:function(e){return Object(f["g"])(e)}},{title:"贷方发生额(元)",align:"right",dataIndex:"creditAmount",width:200,customRender:function(e){return Object(f["g"])(e)}}],url:{list:"/voucherCol/list",url_data:"/sys/category/loadTreeData",summaryApproval:"/voucherCol/summaryApproval",revokeApproval:"/voucherCol/revokeApproval"},activeKey:"0",loadData:function(t){return Object(a["e"])(e.url.list,Object.assign(t,e.getQueryParams())).then((function(t){return t.success?t.result:e.$message.error("请登录账套！")}))}}},created:function(){this.initQuery()},methods:{handleInfo:function(e){var t=this;this.$nextTick((function(){t.$refs.voucherColModal.visible=!0,t.$refs.voucherColModal.edit(e)}))},initQuery:function(){var e=this;this.queryObj.map((function(t){if("busiType"===t.value&&Object(a["e"])(e.url.url_data,{pcode:"90"}).then((function(r){r.success&&(t.options=e.convert(r.result))})),"month"===t.value){for(var r=[],i=1;i<13;i++){var n={};n.value=i<10?"0"+i:i,n.label=i<10?"0"+i:i,r.push(n)}t.options=r}if("coverYear"===t.value){var o=new Date,s=o.getFullYear(),l=p["default"].ls.get(b["f"]);if(l){var c=[],u="";u="1"==l.isStartNew?Number(l.newStartMonth.substring(0,4)):Number(l.startMonth.substring(0,4));var d={};if(d.value=u,d.label=u,c.push(d),Number(u)!=s&&s-u>0)for(var f=0;f<s-Number(u);f++){var h={};h.value=Number(u)+1+f,h.label=Number(u)+1+f,c.push(h)}t.options=c,t.val=s}}}))},summaryApproval:function(){var e=this,t=this.$createElement,r="";r=this.selectedRowKeys.length<1?"当前未选择数据，所有未审核凭证都将审核，是否继续？":"确认审核？",this.$confirm({title:"注意",content:r,okText:"确认",cancelText:"取消",icon:function(){return t("a-icon",{attrs:{type:"exclamation-circle"},style:"color: #FF4D4F"})},onOk:function(){Object(a["j"])(e.url.summaryApproval,e.selectedRowKeys).then((function(t){t.success?(e.$message.success("操作成功"),e.onClearSelected(),e.$refs.mesSuperQuery.manuallyQuery()):e.$message.warning(t.message)}))},onCancel:function(){}})},printVoucher:function(){if(this.selectedRowKeys.length<1)return this.$message.warning("请选择一条记录！");this.$refs.printColVoucher.init(this.selectedRowKeys,"finance_voucher")},revokeApproval:function(){var e=this,t=this.$createElement,r="选中";this.selectedRows.length<=0&&(r="全部未记账的"),this.$confirm({title:"注意",content:"是否对"+r+"数据撤销审核？",okText:"确认",cancelText:"取消",icon:function(){return t("a-icon",{attrs:{type:"exclamation-circle"},style:"color: #FF4D4F"})},onOk:function(){Object(a["j"])(e.url.revokeApproval,e.selectedRowKeys).then((function(t){t.success?(e.$message.success("操作成功"),e.onClearSelected(),e.$refs.mesSuperQuery.manuallyQuery()):e.$message.warning(t.message)}))},onCancel:function(){}})},radioChange:function(e){this.$refs.mesSuperQuery.manuallyQuery()},getQueryParams:function(){var e=Object.assign({},this.queryParam);return e.isCheck=this.activeKey,Object(c["f"])(e)},convert:function(e,t){for(var r=e,i=[],n=0;n<r.length;n++){var a={};a.value=t?r[n].value:r[n].code,a.label=r[n].title,i.push(a)}return i},startDisabledDate:function(e){return d()(e).isAfter(this.maxDate)},endDisabledDate:function(e){return d()(e).isBefore(this.minDate)},startChange:function(e,t){e?(this.minDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.minDate)):this.minDate=""},endChange:function(e,t){e?(this.maxDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.maxDate)):this.maxDate=""}}},g=y,w=(r("58d4"),r("2877")),x=Object(w["a"])(g,i,n,!1,null,"cce7e9b6",null);t["default"]=x.exports},"5dd0":function(e,t,r){"use strict";r("4ef7")},6617:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{staticClass:"ant-modal-cust-warp mainCard",attrs:{bordered:!1}},[r("m-e-s-super-query",{ref:"mesSuperQuery",attrs:{fieldList:e.queryObj,saveCode:e.fileName,type:"queryList","is-reset-default":!1,"is-init-query":!0,"default-query":!1},on:{ok:e.handleSuperQuery},scopedSlots:e._u([{key:"busiDataStart",fn:function(t){var i=t.row;return[r("a-date-picker",{attrs:{value:e.minDate,disabledDate:e.startDisabledDate},on:{change:function(t){return e.startChange(t,i)}}})]}},{key:"busiDataEnd",fn:function(t){var i=t.row;return[r("a-date-picker",{attrs:{value:e.maxDate,disabledDate:e.endDisabledDate},on:{change:function(t){return e.endChange(t,i)}}})]}},{key:"extra",fn:function(){return[r("cover-info-comp",{staticClass:"coverInfoComp",attrs:{"show-icon":!1},on:{isLogin:function(t){return e.$refs.mesSuperQuery.manuallyQuery()},ok:e.modalFormOk}})]},proxy:!0}])}),r("a-tabs",{on:{change:e.radioChange},model:{value:e.isRecord,callback:function(t){e.isRecord=t},expression:"isRecord"}},[r("a-tab-pane",{key:"0",attrs:{tab:"未记账","force-render":""}}),r("a-tab-pane",{key:"1",attrs:{tab:"已记账","force-render":""}})],1),r("a-spin",{staticClass:"spinDiv",attrs:{spinning:e.loading}},[r("div",{staticClass:"tableDiv"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",ifInitQuery:!1,checkbox:!0,stripe:!0,selectChangeEvent:e.selectChangeEvent,"select-all-event":e.selectAllEvent,"table-height":"auto",expand:!1,data:e.loadData,tableColumn:e.columns,childTableHeight:e.tableHeight,expandConfig:{},detailList:"vouListCol"},scopedSlots:e._u([{key:"vouchNo",fn:function(t){var i=t.text,n=t.row;return[r("a",{on:{click:function(t){return e.handleInfo(n)}}},[e._v(e._s(i))])]}},{key:"buttons",fn:function(){return["0"===e.isRecord?r("div",{staticClass:"vxetable-operator"},[r("a-button",{attrs:{icon:"plus",type:"primary"},on:{click:e.voucherAcc}},[e._v("记账")])],1):e._e(),"1"===e.isRecord?r("div",{staticClass:"vxetable-operator"},[r("a-button",{attrs:{icon:"rollback",type:"primary"},on:{click:e.voucherExam}},[e._v("撤销")])],1):e._e()]},proxy:!0},{key:"actionExpand",fn:function(t){t.text;var i=t.row;return[r("a-table",{attrs:{size:"middle",bordered:"",columns:e.childColumns,dataSource:i.voulistColList,pagination:!1}})]}}])})],1)]),r("voucher-col-modal",{ref:"voucherColModal"})],1)},n=[],a=r("0fea"),o=(r("6eb7"),r("ac0d")),s=r("0a5e"),l=r("c1df"),c=r.n(l),u=r("6fa9"),d=r("905a"),f=r("ca00"),h=r("30e0"),m=r("3ed7"),v=r("2b0e"),p=r("9fb0"),b={mixins:[s["a"],o["b"]],components:{MESSuperQuery:u["default"],VoucherColModal:d["default"],CoverInfoComp:h["default"]},data:function(){var e=this;return{tableHeight:"120",loading:!1,isRecord:"0",fileName:"RegisterList",description:"登记账簿页面",minDate:Object(f["h"])(),maxDate:Object(f["i"])(),queryObj:[{label:"制单日期始",value:"busiDateStart",type:"date",queryType:"ge",maxDate:"busiDateEnd"},{label:"制单日期止",value:"busiDateEnd",type:"date",queryType:"le",minDate:"busiDateStart"},{type:"select",value:"coverYear",label:"年份",options:[],val:""},{type:"select",value:"month",label:"月份",options:[],val:Object(f["k"])()}],columns:[{title:"凭证号",align:"left",headerAlign:"left",field:"vouchNo",slot:!0},{title:"月份",align:"left",headerAlign:"left",field:"month",width:150},{title:"属性",align:"left",headerAlign:"left",field:"vouAttr_dictText",width:180},{title:"制单日期",align:"center",field:"makeDate",formatter:function(e){var t=e.cellValue;return c()(t).format("YYYY-MM-DD")},width:180},{title:"制单人",align:"left",headerAlign:"left",field:"makeOper_dictText",width:180},{title:"汇总日期",align:"center",field:"createTime",formatter:function(e){var t=e.cellValue;return c()(t).format("YYYY-MM-DD")},width:180},{title:"审核日期",align:"center",field:"checkTime",formatter:function(e){var t=e.cellValue;return c()(t).format("YYYY-MM-DD")},width:180},{title:"明细",align:"left",headerAlign:"left",field:"action",width:"100px",type:"expand",slot:!0}],childColumns:[{title:"顺序号",align:"center",dataIndex:"orderNum",width:60},{title:"科目编号",align:"center",dataIndex:"itemNo",width:200},{title:"科目名称",align:"center",dataIndex:"itemName",width:300},{title:"摘要",align:"left",dataIndex:"brief"},{title:"借方发生额 (元)",align:"right",dataIndex:"debitAmount",width:250,customRender:function(e){return Object(m["g"])(e)}},{title:"贷方发生额 (元)",align:"right",dataIndex:"creditAmount",width:250,customRender:function(e){return Object(m["g"])(e)}}],loadData:function(t){return Object(a["e"])(e.url.list,Object.assign(t,e.getQueryParams())).then((function(t){return t.success?t.result:e.$message.error("请登录账套！")}))},url:{list:"/voucherCol/list",voucherAcc:"/register/voucherAcc",voucherExam:"/register/voucherExam",url_data:"/sys/category/loadTreeData",checkTransferLastMonth:"/transfer/checkTransferLastMonth",checkTransfer:"/transfer/checkTransfer"},dictOptions:{}}},name:"RegisterList",created:function(){this.initQuery()},methods:{getQueryParams:function(){var e=Object.assign({},this.queryParam);return e.isRecord=this.isRecord,e.isCheck="1",Object(f["f"])(e)},handleInfo:function(e){var t=this;this.$nextTick((function(){t.$refs.voucherColModal.visible=!0,t.$refs.voucherColModal.edit(e)}))},initQuery:function(){var e=this;this.queryObj.map((function(t){if("busiType"===t.value&&Object(a["e"])(e.url.url_data,{pcode:"90"}).then((function(r){r.success&&(t.options=e.convert(r.result))})),"month"===t.value){for(var r=[],i=1;i<13;i++){var n={};n.value=i<10?"0"+i:i,n.label=i<10?"0"+i:i,r.push(n)}t.options=r}if("coverYear"===t.value){var o=new Date,s=o.getFullYear(),l=v["default"].ls.get(p["f"]);if(l){var c=[],u="";u="1"==l.isStartNew?Number(l.newStartMonth.substring(0,4)):Number(l.startMonth.substring(0,4));var d={};if(d.value=u,d.label=u,c.push(d),Number(u)!=s&&s-u>0)for(var f=0;f<s-Number(u);f++){var h={};h.value=Number(u)+1+f,h.label=Number(u)+1+f,c.push(h)}t.options=c,t.val=s}}}))},radioChange:function(){this.$refs.mesSuperQuery.manuallyQuery()},voucherAcc:function(){var e=this,t={voucherColList:this.selectedRows,coverYear:this.$refs.mesSuperQuery.$refs.listQuery.formList[2].val,month:this.$refs.mesSuperQuery.$refs.listQuery.formList[3].val};Object(a["j"])(this.url.checkTransferLastMonth,t).then((function(t){t.success?e.voucherAccSure():e.$message.warning(t.message)}))},voucherAccSure:function(){var e="选中";this.selectedRows.length<=0&&(e="全部");var t={voucherColList:this.selectedRows,coverYear:this.$refs.mesSuperQuery.$refs.listQuery.formList[2].val,month:this.$refs.mesSuperQuery.$refs.listQuery.formList[3].val},r=this;this.$confirm({title:"记账",content:"确定记账"+e+"数据?",onOk:function(){r.loading=!0,Object(a["j"])(r.url.voucherAcc,t).then((function(e){e.success?(r.$message.success(e.message),r.$refs.mesSuperQuery.manuallyQuery()):r.$message.warning(e.message)})).finally((function(){r.loading=!1}))},onCancel:function(){r.close()}})},voucherExam:function(){var e=this,t={voucherColList:this.selectedRows,coverYear:this.$refs.mesSuperQuery.$refs.listQuery.formList[2].val,month:this.$refs.mesSuperQuery.$refs.listQuery.formList[3].val};Object(a["j"])(this.url.checkTransfer,t).then((function(t){t.success?e.voucherExamSure():e.$message.warning(t.message)}))},voucherExamSure:function(){var e="选中";this.selectedRows.length<=0&&(e="全部");var t={voucherColList:this.selectedRows,coverYear:this.$refs.mesSuperQuery.$refs.listQuery.formList[2].val,month:this.$refs.mesSuperQuery.$refs.listQuery.formList[3].val},r=this;this.$confirm({title:"撤销",content:"确定撤销"+e+"数据?",onOk:function(){r.loading=!0,Object(a["j"])(r.url.voucherExam,t).then((function(e){e.success?(r.$message.success(e.message),r.$refs.mesSuperQuery.manuallyQuery()):r.$message.warning(e.message)})).finally((function(){r.loading=!1}))},onCancel:function(){r.close()}})},close:function(){this.loading=!1},checkData:function(){var e=!0;return this.selectedRows.length<=0?(this.$message.warning("请选择一条记录！"),e=!1,e):e},startDisabledDate:function(e){return c()(e).isAfter(this.maxDate)},endDisabledDate:function(e){return c()(e).isBefore(this.minDate)},startChange:function(e,t){e?(this.minDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.minDate)):this.minDate=""},endChange:function(e,t){e?(this.maxDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.maxDate)):this.maxDate=""}}},y=b,g=(r("8867"),r("2877")),w=Object(g["a"])(y,i,n,!1,null,"5f968f1a",null);t["default"]=w.exports},"71d5":function(e,t,r){},7275:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-spin",{ref:"spinRef",attrs:{spinning:e.confirmLoading}},[r("j-form-container",{ref:"form",attrs:{rules:e.validatorRules,model:e.model,disabled:e.formDisabled,formRef:"formOwnRow",border:!1}},[r("a-row",{ref:"formOwnRow",staticClass:"houseInfo",attrs:{slot:"detail",type:"flex"},slot:"detail"},[r("a-col",{attrs:{span:4}},[e.disableEdit?e._e():r("span",{staticClass:"requiredText"},[e._v("*")]),e._v("\n        填制日期:\n      ")]),r("a-col",{attrs:{span:4,"data-prop":"makeDate"}},[r("a-date-picker",{attrs:{disabled:e.disableEdit,format:e.monthFormat},model:{value:e.model.makeDate,callback:function(t){e.$set(e.model,"makeDate",t)},expression:"model.makeDate"}},[e.disableEdit?r("span",{attrs:{slot:"suffixIcon"},slot:"suffixIcon"}):e._e()])],1),r("a-col",{attrs:{span:4}},[e.disableEdit?e._e():r("span",{staticClass:"requiredText"},[e._v("*")]),e._v("\n        业务类型:\n      ")]),r("a-col",{attrs:{span:4,"data-prop":"busiTypeId"}},[r("j-category-select",{attrs:{disabled:e.disableEdit,pcode:"90"},model:{value:e.model.busiTypeId,callback:function(t){e.$set(e.model,"busiTypeId",t)},expression:"model.busiTypeId"}})],1)],1)],1),r("vxe-grid",{ref:"voucherRef",attrs:{columns:e.columns,"checkbox-config":{showHeader:!1},"edit-config":{trigger:"click",mode:"row",showIcon:!e.disableEdit},"valid-config":{autoPos:!0},toolbar:{zoom:!0},"keyboard-config":{isArrow:!0,isDel:!0,isTab:!0,isEdit:!0},"mouse-config":{selected:!0},"show-overflow":"","auto-resize":"",border:"","show-footer":"","footer-span-method":e.footerSpanMethod,data:e.voucherList,"footer-method":e.footerMethod,"edit-rules":e.disableEdit?{}:e.editRules},scopedSlots:e._u([{key:"brief",fn:function(t){var i=t.row;t.rowIndex;return[e.disableEdit?r("span",[e._v(" "+e._s(i.brief))]):r("a-auto-complete",{staticStyle:{width:"200px"},attrs:{"data-source":e.dataSource,disabled:e.disableEdit,placeholder:"请输入摘要内容","filter-option":e.filterOption},model:{value:i.brief,callback:function(t){e.$set(i,"brief",t)},expression:"row.brief"}})]}},{key:"itemName",fn:function(t){var i=t.row,n=(t.rowIndex,t.column);return[r("a-tooltip",[i.itemNo?r("template",{slot:"title"},[e._v(" "+e._s(i.itemNo)+"_"+e._s(i.itemName)+" ")]):e._e(),e.disableEdit?r("span",[e._v(" "+e._s(i.itemNo)+"_"+e._s(i.itemName)+" ")]):e._e()],2),r("a-tooltip",[i.itemNo?r("template",{slot:"title"},[e._v(" "+e._s(i.itemNo)+"_"+e._s(i.itemName)+" ")]):e._e(),e.disableEdit?e._e():r("span",[r("a-input-search",{attrs:{readOnly:"",placeholder:"请选择科目"},on:{search:function(t,r){return e.onSelectInModel(i,r,n)}},model:{value:i.itemNameSplit,callback:function(t){e.$set(i,"itemNameSplit",t)},expression:"row.itemNameSplit"}},[r("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[e._v("选择科目")])],1)],1)],2)]}},{key:"debitAmount",fn:function(t){var i=t.row;t.rowIndex;return[e.disableEdit?r("span",[e._v(" "+e._s(e._f("getAmount")(i.debitAmount)))]):r("a-input-number",{staticClass:"width-100",attrs:{max:9999999999,disabled:e.disableEdit,step:.1,precision:2},on:{blur:e.AmountChange},model:{value:i.debitAmount,callback:function(t){e.$set(i,"debitAmount",t)},expression:"row.debitAmount"}})]}},{key:"creditAmount",fn:function(t){var i=t.row;t.rowIndex;return[e.disableEdit?r("span",[e._v(" "+e._s(e._f("getAmount")(i.creditAmount)))]):r("a-input-number",{ref:"numberInput",staticClass:"width-100",attrs:{max:9999999999,step:.1,disabled:e.disableEdit,precision:2},on:{change:function(t){return e.restrict(i,t)},blur:e.AmountChange},model:{value:i.creditAmount,callback:function(t){e.$set(i,"creditAmount",t)},expression:"row.creditAmount"}})]}},{key:"checkboxHeader",fn:function(t,i){var n=t.column,a=t.columnIndex,o=t.$columnIndex,s=t._columnIndex,l=t.$rowIndex;return[r("a-space",[r("a-checkbox",{on:{change:e.chooseAll}}),r("i",{staticClass:"vxe-icon--plus",on:{click:function(t){!e.disableEdit&&e.addVoucherInfo({column:n,columnIndex:a,$columnIndex:o,_columnIndex:s,$rowIndex:l})}}}),r("i",{staticClass:"vxe-icon--minus",on:{click:function(t){!e.disableEdit&&e.removeVoucherInfo()}}})],1)]}},{key:"seqFooter",fn:function(t){var i=t.$rowIndex;return[0===i?[e._v("附单据: "),e.disableEdit&&e.disableDetail?r("span",[e._v(e._s(e.model.acceNum))]):r("a-input-number",{staticClass:"zdyinput",attrs:{precision:0,max:999999,disabled:e.disableDetail,min:0},model:{value:e.model.acceNum,callback:function(t){e.$set(e.model,"acceNum",t)},expression:"model.acceNum"}}),e._v(" 张\n      ")]:e._e(),1===i?[e._v(" 合计(大写): ")]:e._e()]}},{key:"itemNameFooter",fn:function(t){var i=t.$rowIndex;return[0===i?[e._v("制单:"),r("span",[e._v(e._s(e.model.makeOper))])]:e._e(),1===i?[e._v("借方金额: "),r("span",[e._v(e._s(e.convertCurrency(e.model.amount)))])]:e._e()]}},{key:"debitAmountFooter",fn:function(t){var i=t.$rowIndex;return[0===i?[e._v("合计:"),r("span",[e._v(e._s(e.formatterAmount(e.model.amount)))])]:e._e(),1===i?void 0:e._e()]}},{key:"creditAmountFooter",fn:function(t){var i=t.$rowIndex;return[0===i?[e._v("合计:"),r("span",[e._v(e._s(e.formatterAmount(e.model.creditAmountSum)))])]:e._e(),1===i?[e._v("贷方金额: "),r("span",[e._v(e._s(e.convertCurrency(e.model.creditAmountSum)))])]:e._e()]}}])}),r("type-attachment-upload",{ref:"fileupload",attrs:{busiType:"30",isDetail:e.disableDetail,busiTypeDetail:"3031",busiNo:e.model.id},on:{change:e.getFileList}}),r("j-select-item-modal",{ref:"selectOutModal",attrs:{isChoosechild:!0},on:{ok:e.selectOutOK}})],1)},n=[],a=r("6c18"),o=r("0fea"),s=r("2b0e"),l=r("9fb0"),c=r("49a8"),u=r("c1df"),d=r.n(u),f=r("9fbd"),h=r("3ed7"),m={name:"VoucherForm",components:{JSelectItemModal:a["default"],JCategorySelect:c["default"],TypeAttachmentUpload:f["default"]},filters:{getAmount:function(e){return e&&""!==e&&"undefined"!==e?String(Number(e).toFixed(2)).replace(/\B(?=(\d{3})+(?!\d))/g,","):"0.00"}},props:{disabled:{type:Boolean,default:!1,required:!1},disableEdit:{type:Boolean,default:!1,required:!1},disableDetail:{type:Boolean,default:!1}},data:function(){var e=function(e){var t=e.cellValue;return new Promise((function(e,r){return t?e():r(new Error("请选择科目！"))}))};function t(e){return""===e||void 0===e||null===e||"0"==e}var r=function(e){e.cellValue;var r=e.row;e.rowIndex;return new Promise((function(e,i){return t(r.creditAmount)||t(r.debitAmount)?t(r.creditAmount)&&t(r.debitAmount)?i(new Error("借方金额和贷方金额全为0,请确认！")):e():i(new Error("借方金额或贷方金额必须有一方为0"))}))},i=function(e){e.cellValue,e.row,e.rowIndex;return new Promise((function(e,t){return e()}))};return{rowid:null,formatterAmount:h["g"],convertCurrency:h["a"],fileIdList:[],dataSource:[],monthFormat:"YYYY-MM-DD",voucherList:[{},{}],model:{acceNum:0,amount:"0.00",creditAmountSum:"0.00",makeDate:""},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,validatorRules:{makeDate:[{required:!0,message:"请选择填制日期"}],busiTypeId:[{required:!0,message:"请选择业务类型"}]},url:{add:"/voucher/add",edit:"/voucher/edit",queryById:"/voucher/queryById",getSummary:"summary/getSummary",cateQueryById:"/sys/category/queryById",leafFlagItemList:"/item/leafFlagItemList"},itemList:[],editRules:{itemName:[{required:!0,validator:e,trigger:"change"}],debitAmount:[{required:!0,validator:r}],creditAmount:[{required:!1,validator:i}]},columns:[{title:"序号",dataIndex:"",width:60,align:"center",type:"seq",slots:{footer:"seqFooter"}},{title:"摘要",field:"brief",align:"left",editRender:{type:"visible"},slots:{edit:"brief"}},{title:"科目名称",field:"itemName",width:350,align:"left",editRender:{type:"visible"},slots:{edit:"itemName",footer:"itemNameFooter"}},{title:"借方金额 (元)",field:"debitAmount",align:"right",editRender:{type:"visible"},slots:{edit:"debitAmount",footer:"debitAmountFooter"}},{title:"贷方金额 (元)",field:"creditAmount",align:"right",editRender:{type:"visible"},slots:{edit:"creditAmount",footer:"creditAmountFooter"}},{width:100,fixed:"right",field:"action",align:"center",type:"checkbox",slots:{header:"checkboxHeader"}}]}},watch:{"model.busiTypeId":"busiTypeWatch",disableEdit:{immediate:!0,handler:function(e){var t=this,r=this;this.$nextTick((function(){var i=t.$refs.voucherRef.getColumnByField("action");e?r.$refs.voucherRef.hideColumn(i):r.$refs.voucherRef.showColumn(i),r.$forceUpdate()}))}}},computed:{formDisabled:function(){return this.disabled}},created:function(){this.model.makeOper=s["default"].ls.get(l["J"]).realname,this.model.makeDate=d()(new Date).format("YYYY-MM-DD"),this.modelDefault=JSON.parse(JSON.stringify(this.model)),this.getSummary()},methods:{restrict:function(e,t){},selectOutOK:function(e){this.selectOutItem=e,Object.assign(this.rowid,{itemNo:this.selectOutItem.itemNo}),this.$set(this.rowid,"itemName",this.selectOutItem.itemName),this.$set(this.rowid,"itemNameSplit",this.selectOutItem.itemNo+"_"+this.selectOutItem.itemName)},onSelectInModel:function(e){var t=this;this.rowid=e,this.$refs.selectOutModal.showModal(this.model.inItemNo),setTimeout((function(){t.$refs.voucherRef.clearValidate()}),100)},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},valida:function(){var e=!0,t=this.$refs.form.validaRowMsg(this.$refs.formOwnRow);if(t.valida){for(var r=0;r<this.voucherList.length;r++){var i=this.voucherList[r];if(Object.is(Number(i.debitAmount),NaN)&&(i.debitAmount=0),Object.is(Number(i.creditAmount),NaN)&&(i.creditAmount=0),0!==Number(i.debitAmount)&&0!==Number(i.creditAmount))return this.$message.warning("在第"+(r+1)+"条中,借方金额或贷方金额必须有一方为0"),void(e=!1);if(0===Number(i.debitAmount)&&0===Number(i.creditAmount))return this.$message.warning("在第"+(r+1)+"条中,借方金额和贷方金额全为0,请确认！"),void(e=!1)}return this.model.amount!==this.model.creditAmountSum?(this.$message.warning("借方合计金额必须与贷方合计金额一致"),void(e=!1)):e}e=!1},AmountChange:function(){var e=0,t=0,r=this.voucherList;r.forEach((function(r){r.debitAmount&&(e=Object(h["c"])(Number(r.debitAmount),e)),r.creditAmount&&(t=Object(h["c"])(Number(r.creditAmount),t))})),this.model.amount=e.toFixed(2),this.model.creditAmountSum=t.toFixed(2),this.$forceUpdate()},getSummary:function(){var e=this;Object(o["e"])(this.url.leafFlagItemList).then((function(t){t.success&&t.result&&(e.itemList=t.result)})),Object(o["e"])(this.url.getSummary).then((function(t){t.success&&t.result?e.dataSource=t.result.map((function(e){return e.briefName})):(e.$message.info(t.message),e.dataSource=[])}))},chooseAll:function(e){this.$refs.voucherRef.setAllCheckboxRow(e.target.checked)},removeVoucherInfo:function(){var e=this.$refs.voucherRef.getCheckboxRecords();if(!(this.voucherList.length-e.length<2)){if(e&&e.length<=0)return this.$message.warning("请选择要删除的数据");var t=[],r=this;e.forEach((function(e){t.push(e._XID)})),this.$confirm({title:"是否确认删除选中数据？",okText:"确认",okCancel:"取消",onOk:function(){t.forEach((function(e){r.voucherList.forEach((function(t,i){t._XID===e&&r.voucherList.splice(i,1)}))})),r.$message.success("删除成功"),r.$forceUpdate()},onCancel:function(){return!1}})}},addVoucherInfo:function(e){e._columnIndex,e.$rowIndex;this.voucherList.push({})},edit:function(e){var t=this;if(e.vouList){this.voucherList=[];for(var r=0;r<e.vouList.length;r++){var i={},n=e.vouList[r];i.id=n.id,i.brief=n.brief,i.itemNo=n.itemNo,i.itemName=n.itemName,i.debitAmount=n.debitAmount?n.debitAmount:0,i.creditAmount=n.creditAmount?n.creditAmount:0,i.vouAttr=n.vouAttr,i.itemNameSplit=n.itemNo+"_"+n.itemName,this.voucherList.push(i)}}this.model=Object.assign({},e),this.model.amount=Number(e.amount).toFixed(2),this.model.creditAmountSum=Number(e.amount).toFixed(2),this.$nextTick((function(){t.$refs.fileupload.initData()}))},submitForm:function(){var e=this,t=e.$refs.form.validaRowMsg(e.$refs.formOwnRow);t.valida&&e.$refs.voucherRef.validate(e.voucherList,(function(t){if(!t){if(e.model.amount!==e.model.creditAmountSum)return void e.$message.warning("借方合计金额必须与贷方合计金额一致");e.model.makeDate=d()(e.model.makeDate).format("YYYY-MM-DD"),e.confirmLoading=!0;var r=Object.assign({},e.model);r.makeOper=s["default"].ls.get(l["J"]).username,e.voucherList.forEach((function(e){return delete e.itemNameSplit})),r.vouList=JSON.parse(JSON.stringify(e.voucherList)),r.vouList.forEach((function(e){e.debitAmount||(e.debitAmount="0"),e.creditAmount||(e.creditAmount="0")})),r.fileIdList=e.fileIdList;var i="",n="";e.model.id?(i+=e.url.edit,n="put"):(i+=e.url.add,n="post"),Object(o["i"])(i,r,n).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok")):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},footerMethod:function(e){var t=e.columns;return[t.map((function(e,t){return""})),t.map((function(e,t){return""}))]},footerSpanMethod:function(e){e._rowIndex;var t=e._columnIndex,r=e.$rowIndex;if(0===r){if(0===t)return{colspan:2};if(1===t)return{colspan:0};if(2===t)return{colspan:1};if(3===t)return{colspan:1};if(4===t)return{colspan:1};if(5===t)return{colspan:1}}if(1===r){if(0===t)return{colspan:2};if(1===t)return{colspan:0};if(2===t)return{colspan:2};if(3===t)return{colspan:0};if(4===t)return{colspan:2};if(5===t)return{colspan:0}}},busiTypeWatch:function(e){var t=this;Object(o["e"])(this.url.cateQueryById,{id:e}).then((function(e){e.result&&e.success&&(t.model.busiTypeDetail=e.result.code)}))},getFileList:function(e){if(this.fileIdList=[],e){var t=this;e.forEach((function(e){t.fileIdList.push(e.id)}))}this.model.acceNum=this.fileIdList.length},itemChange:function(e,t,r){var i=t.data;this.$set(e,"itemName",i.attrs.data.itemName),this.$refs.voucherRef.updateStatus({row:e,column:r})}}},v=m,p=(r("b097"),r("2877")),b=Object(p["a"])(v,i,n,!1,null,"a741df46",null);t["default"]=b.exports},7339:function(e,t,r){},7889:function(e,t,r){},"828e":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"ant-modal-cust-warp mainCard",attrs:{bordered:!1}},[r("m-e-s-super-query",{ref:"mesSuperQuery",attrs:{fieldList:e.queryObj,saveCode:e.fileName,type:"queryList","is-reset-default":!1,"is-init-query":!0,"default-query":!0},on:{ok:e.handleSuperQuery},scopedSlots:e._u([{key:"busiDataStart",fn:function(t){var i=t.row;return[r("a-date-picker",{attrs:{value:e.minDate,disabledDate:e.startDisabledDate},on:{change:function(t){return e.startChange(t,i)}}})]}},{key:"busiDataEnd",fn:function(t){var i=t.row;return[r("a-date-picker",{attrs:{value:e.maxDate,disabledDate:e.endDisabledDate},on:{change:function(t){return e.endChange(t,i)}}})]}}])}),r("div",{staticClass:"tableDiv"},[r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,checkbox:!0,"checkbox-config":e.checkboxConfig,"table-height":"auto",selectChangeEvent:e.selectChangeEvent,"select-all-event":e.selectAllEvent,expand:!1,data:e.loadData,tableColumn:e.columns,ifInitQuery:!1},scopedSlots:e._u([{key:"vouchNo",fn:function(t){var i=t.text,n=t.row;return[r("a",{on:{click:function(t){return e.handleInfo(n)}}},[e._v(e._s(i))])]}},{key:"buttons",fn:function(){return[r("div",{staticClass:"vxetable-operator"},[r("a-button",{attrs:{icon:"undo",type:"primary"},on:{click:e.undoSummary}},[e._v("撤销汇总")]),r("a-button",{attrs:{icon:"printer",type:"primary"},on:{click:e.print}},[e._v("打印")])],1)]},proxy:!0},{key:"actionExpand",fn:function(t){t.text;var i=t.row;return[r("vxe-grid",{attrs:{"auto-resize":"",border:"",size:"mini",data:i.voulistColList,columns:e.childColumns}})]}}])})],1),r("voucher-col-modal",{ref:"voucherColModal"}),r("print-report-comp",{ref:"print"})],1)},n=[],a=(r("6eb7"),r("0fea")),o=r("ac0d"),s=r("0a5e"),l=r("6fa9"),c=r("ca00"),u=r("c1df"),d=r.n(u),f=r("3ed7"),h=r("905a"),m=r("2b0e"),v=r("9fb0"),p=r("9bed");function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=y(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function y(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}var w={name:"VoucherColCheckList",mixins:[s["a"],o["b"]],components:{MESSuperQuery:l["default"],VoucherColModal:h["default"],PrintReportComp:p["default"]},watch:{},data:function(){var e=this;return{minDate:Object(c["h"])(),maxDate:Object(c["i"])(),fileName:"VoucherColCheckList",description:"凭证汇总页面",queryObj:[{label:"填制日期始",value:"busiDateStart",type:"date",queryType:"ge",maxDate:"busiDateEnd"},{label:"填制日期止",value:"busiDateEnd",type:"date",queryType:"le",minDate:"busiDateStart"},{type:"select",value:"coverYear",label:"年份",options:[],val:""},{type:"select",value:"month",label:"月份",options:[],val:Object(c["k"])()},{type:"select",value:"isCheck",label:"是否审核",options:[{value:"0",label:"未审核"},{value:"1",label:"已审核"}]},{type:"select",value:"isRecord",label:"是否记账",options:[{label:"已记账",value:"1"},{label:"未记账",value:"0"}]}],isLoading:!1,columns:[{title:"凭证号",align:"left",headerAlign:"left",minWidth:80,field:"vouchNo",slot:!0},{title:"月份",align:"left",headerAlign:"left",field:"month",width:150},{title:"属性",align:"left",headerAlign:"left",field:"vouAttr_dictText",width:150},{title:"制单日期",align:"center",field:"makeDate",formatter:function(e){var t=e.cellValue;return d()(t).format("YYYY-MM-DD")},width:150},{title:"制单人",align:"left",headerAlign:"left",field:"makeOper_dictText",width:150},{title:"汇总日期",align:"center",field:"createTime",formatter:function(e){var t=e.cellValue;return d()(t).format("YYYY-MM-DD")},width:150},{title:"是否审核",align:"left",headerAlign:"left",field:"isCheck",width:120,formatter:function(e){var t=e.cellValue;return"1"==t?"已审核":"未审核"}},{title:"是否记账",align:"left",headerAlign:"left",field:"isRecord",formatter:function(e){var t=e.cellValue;return 0==t?"未记账":"已记账"},width:120},{title:"明细",align:"center",headerAlign:"center",field:"action",width:"60px",type:"expand",slot:!0}],childColumns:[{title:"顺序号",align:"center",field:"orderNum",width:60},{title:"科目编号",align:"center",field:"itemNo",width:220},{title:"科目名称",field:"itemName",align:"left",width:280},{title:"摘要",align:"left",field:"brief"},{title:"借方发生额(元)",align:"right",field:"debitAmount",width:160,formatter:function(e){var t=e.cellValue;return Object(f["g"])(t)}},{title:"贷方发生额(元)",align:"right",field:"creditAmount",width:160,formatter:function(e){var t=e.cellValue;return Object(f["g"])(t)}}],url:{list:"/voucherCol/list",url_data:"/sys/category/loadTreeData",undoSummary:"/voucherCol/undoSummary"},loadData:function(t){return Object(a["e"])(e.url.list,Object.assign(t,e.getQueryParams())).then((function(t){return t.success?t.result:e.$message.error("请登录账套！")}))}}},created:function(){this.initQuery()},methods:{print:function(){if(0==this.selectedRows.length)return this.$message.warning("请选择一条记录！");for(var e=m["default"].ls.get(v["f"]),t=[],r=0;r<this.selectedRows.length;r++)t.push(this.selectedRows[r].id);this.$refs.print.print("finance_voucol",{coverno:e.coverNo,id:t})},checkboxConfig:function(e){var t=e.row;return"0"==t.isRecord},handleInfo:function(e){var t=this;this.$nextTick((function(){t.$refs.voucherColModal.visible=!0,t.$refs.voucherColModal.edit(e)}))},initQuery:function(){var e=this;this.queryObj.map((function(t){if("busiType"===t.value&&Object(a["e"])(e.url.url_data,{pcode:"90"}).then((function(r){r.success&&(t.options=e.convert(r.result))})),"month"===t.value){for(var r=[],i=1;i<13;i++){var n={};n.value=i<10?"0"+i:i,n.label=i<10?"0"+i:i,r.push(n)}t.options=r}if("coverYear"===t.value){var o=new Date,s=o.getFullYear(),l=m["default"].ls.get(v["f"]);if(l){var c=[],u="";u="1"==l.isStartNew?Number(l.newStartMonth.substring(0,4)):Number(l.startMonth.substring(0,4));var d={};if(d.value=u,d.label=u,c.push(d),Number(u)!=s&&s-u>0)for(var f=0;f<s-Number(u);f++){var h={};h.value=Number(u)+1+f,h.label=Number(u)+1+f,c.push(h)}t.options=c,t.val=s}}}))},undoSummary:function(){var e=this,t=this.$createElement,r="选中";this.selectedRows.length<=0&&(r="全部未审核的");var i,n=b(this.selectedRows);try{for(n.s();!(i=n.n()).done;){var o=i.value;if("1"==o.isCheck)return this.$message.warning("只能选择未审核的凭证！")}}catch(s){n.e(s)}finally{n.f()}this.$confirm({title:"注意",content:"是否对"+r+"数据撤销汇总？",okText:"确认",cancelText:"取消",icon:function(){return t("a-icon",{attrs:{type:"exclamation-circle"},style:"color: #FF4D4F"})},onOk:function(){e.isLoading=!0,Object(a["j"])(e.url.undoSummary,e.selectedRowKeys).then((function(t){t.success?(e.$message.success("操作成功"),e.onClearSelected(),e.$refs.mesSuperQuery.manuallyQuery()):e.$message.warning(t.message)})).finally((function(){e.isLoading=!1}))}})},getQueryParams:function(){var e=Object.assign({},this.queryParam);return Object(c["f"])(e)},convert:function(e,t){var r,i=e,n=[],a=b(i);try{for(a.s();!(r=a.n()).done;){var o=r.value,s={};s.value=t?o.value:o.code,s.label=o.title,n.push(s)}}catch(l){a.e(l)}finally{a.f()}return n},startDisabledDate:function(e){return d()(e).isAfter(this.maxDate)},endDisabledDate:function(e){return d()(e).isBefore(this.minDate)},startChange:function(e,t){e?(this.minDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.minDate)):this.minDate=""},endChange:function(e,t){e?(this.maxDate=e.format("YYYY-MM-DD"),this.$set(t,"val",this.maxDate)):this.maxDate=""}}},x=w,D=(r("b1b0"),r("2877")),k=Object(D["a"])(x,i,n,!1,null,"1ec0fa76",null);t["default"]=k.exports},"82fe":function(e,t,r){"use strict";r("8844")},8399:function(e,t,r){"use strict";r.r(t),r.d(t,"VoucherJump",(function(){return v}));var i=r("6858"),n=r("4130"),a=r("0fea"),o=r("02ac"),s=r("1265"),l=r("8e5d"),c=r("b63c"),u=r("7f8f");function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */f=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),s=new j(i||[]);return n(o,"_invoke",{value:S(e,r,s)}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var m="suspendedStart",v="suspendedYield",p="executing",b="completed",y={};function g(){}function w(){}function x(){}var D={};c(D,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(L([])));C&&C!==r&&i.call(C,o)&&(D=C);var _=x.prototype=g.prototype=Object.create(D);function $(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(n,a,o,s){var l=h(e[n],e,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==d(u)&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}var a;n(this,"_invoke",{value:function(e,i){function n(){return new t((function(t,n){r(e,i,t,n)}))}return a=a?a.then(n,n):n()}})}function S(t,r,i){var n=m;return function(a,o){if(n===p)throw Error("Generator is already running");if(n===b){if("throw"===a)throw o;return{value:e,done:!0}}for(i.method=a,i.arg=o;;){var s=i.delegate;if(s){var l=A(s,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===m)throw n=b,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=p;var c=h(t,r,i);if("normal"===c.type){if(n=i.done?b:v,c.arg===y)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=b,i.method="throw",i.arg=c.arg)}}}function A(t,r){var i=r.method,n=t.iterator[i];if(n===e)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var a=h(n,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,y;var o=a.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function r(){for(;++n<t.length;)if(i.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(d(t)+" is not iterable")}return w.prototype=x,n(_,"constructor",{value:x,configurable:!0}),n(x,"constructor",{value:w,configurable:!0}),w.displayName=c(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,c(e,l,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},$(O.prototype),c(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,i,n,a){void 0===a&&(a=Promise);var o=new O(u(e,r,i,n),a);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},$(_),c(_,l,"Generator"),c(_,o,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(i,n){return s.type="throw",s.arg=t,r.next=i,n&&(r.method="next",r.arg=e),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,r,i){return this.delegate={iterator:L(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=e),y}},t}function h(e,t,r,i,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(i,n)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var a=e.apply(t,r);function o(e){h(a,i,n,o,s,"next",e)}function s(e){h(a,i,n,o,s,"throw",e)}o(void 0)}))}}var v={components:{ComAccInfoModal:i["default"],DepositBusinessDetails:n["default"],AllotListModal:o["default"],InvestInfoModal:s["default"],BatchChangeRecordComp:l["default"],NoAccountModal:c["default"],AccTransferAuditComp:u["default"]},data:function(){return{houseVisible:!1,attrChangeVisible:!1,transferVisible:!1,busiTypeDetail:"",dictCode:"",reqId:"",pageName:"",loading:"",url:{getUrlByFlowId:"/deposit/firstDeposit/getUrlByFlowId",getDrawByBusiNo:"/deposit/firstDeposit/getDrawByBusiNo",getIncomeList:"/income/income/list",getBusiReqList:"/common/bBusiReq/list",getChangeList:"/act/taskinst/done",getOtherList:"/otherAccount/otherAccountList"}}},methods:{gotoDetail:function(){var e=m(f().mark((function e(t){var r=this;return f().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("0001"!==t.busiTypeDetail&&"0002"!==t.busiTypeDetail&&"0003"!==t.busiTypeDetail){e.next=5;break}this.houseVisible=!0,this.$nextTick((function(){r.houseTitle="业务交易明细 （业务编号："+t.busiNo+"）",r.$refs.tradIngRecord.showByBusiNo(t.busiNo)})),e.next=61;break;case 5:if("0004"!==t.busiTypeDetail&&"0007"!==t.busiTypeDetail&&"0008"!==t.busiTypeDetail){e.next=11;break}this.busiTypeDetail=t.busiTypeDetail,"0007"===t.busiTypeDetail?this.dictCode="fund_type":"0008"===t.busiTypeDetail?this.dictCode="shared_facilities_disposal":this.dictCode="",this.$nextTick((function(){r.$refs.detail.disabled=!0,r.$refs.detail.isChoose=!0,r.$refs.detail.initComDepositData(t.busiNo)})),e.next=61;break;case 11:if("1012"!==t.busiTypeDetail&&"1013"!==t.busiTypeDetail&&"1014"!==t.busiTypeDetail&&"4042"!==t.busiTypeDetail){e.next=24;break}return e.next=14,Object(a["e"])(this.url.getDrawByBusiNo,{busiNo:t.busiNo}).then((function(e){e.success&&e.result&&(t=e.result.records[0])}));case 14:if(!t||!t.flowId){e.next=17;break}return e.next=17,Object(a["e"])(this.url.getUrlByFlowId,{flowId:t.flowId}).then((function(e){e.success&&e.result&&(r.pageName=e.result)}));case 17:this.$refs.refund.visible=!0,this.$refs.refund.isProcess=!0,this.$refs.refund.disableSubmit=!0,this.$refs.refund.title="退款申请",this.$nextTick((function(){r.reqId=t.id,r.$refs.refund.rreqId=t.reqNo,r.$refs.refund.rreqNo=t.reqNo,r.$refs.refund.refundType=t.busiTypeDetail,r.$refs.refund.initData(t.houseId,t)})),e.next=61;break;case 24:if("2022"!==t.busiTypeDetail&&"202F"!==t.busiTypeDetail){e.next=30;break}this.reqNo=t.busiNo,this.$refs.allotModal.title=t.reqDescribe?t.reqDescribe:"业务编号"+t.busiNo+" 拨款分摊清册",this.$refs.allotModal.initData(t),e.next=61;break;case 30:if("4041"!==t.busiTypeDetail){e.next=39;break}return e.next=33,Object(a["e"])(this.url.getIncomeList,{busiNo:t.busiNo}).then((function(e){e.success&&e.result&&(t=e.result.records[0])}));case 33:this.$refs.incomeModal.title="详情",this.$refs.incomeModal.disableSubmit=!0,this.$refs.incomeModal.disabled=!0,this.$refs.incomeModal.edit(t),e.next=61;break;case 39:if("5055"!==t.busiTypeDetail&&"5056"!==t.busiTypeDetail&&"5057"!==t.busiTypeDetail&&"505F"!==t.busiTypeDetail&&"505H"!==t.busiTypeDetail){e.next=46;break}return e.next=42,Object(a["e"])(this.url.getBusiReqList,{reqNo:t.busiNo}).then((function(e){e.success&&e.result&&(t=e.result.records[0])}));case 42:this.attrChangeVisible=!0,this.$nextTick((function(){r.$refs.batchChangeRecordComp.initData(t.id)})),e.next=61;break;case 46:if("60"!==t.busiType){e.next=53;break}return e.next=49,Object(a["e"])(this.url.getBusiReqList,{reqNo:t.busiNo}).then((function(e){e.success&&e.result&&(t=e.result.records[0])}));case 49:this.transferVisible=!0,this.$nextTick((function(){r.$refs.accTransferAuditComp.initData(null,{tableId:t.id})})),e.next=61;break;case 53:if("90"!==t.busiType){e.next=60;break}return e.next=56,Object(a["e"])(this.url.getOtherList,{busiNo:t.busiNo}).then((function(e){e.success&&e.result&&(t=e.result.records[0])}));case 56:this.$refs.NoAccountModal.disabled=!0,this.$refs.NoAccountModal.handleEdit(t),e.next=61;break;case 60:this.$message.error("该业务类型无法查看详情信息");case 61:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleCancel:function(){this.houseVisible=!1,this.attrChangeVisible=!1,this.transferVisible=!1}}}},"870e":function(e,t,r){"use strict";r("31bd")},8844:function(e,t,r){},8867:function(e,t,r){"use strict";r("98b7")},"8fd7":function(e,t,r){"use strict";r("7889")},"93d8":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("j-modal",{attrs:{title:e.title,width:e.width,visible:e.visible,switchFullscreen:"",okButtonProps:{class:{"jee-hidden":e.disableSubmit}},cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel},scopedSlots:e._u([{key:"footer",fn:function(){return[r("a-button",{attrs:{icon:"close"},on:{click:e.close}},[e._v("取 消\n    ")]),e.disableDetail?e._e():r("a-button",{attrs:{type:"primary",icon:"check"},on:{click:e.handleOk}},[e._v("确 定\n    ")])]},proxy:!0}])},[r("voucher-form",{ref:"realForm",attrs:{disableDetail:e.disableDetail,disableEdit:e.disableEdit,disabled:e.disableSubmit},on:{ok:e.submitCallback}})],1)},n=[],a=r("7275"),o={name:"VoucherModal",components:{VoucherForm:a["default"]},data:function(){return{title:"",width:1400,visible:!1,disableSubmit:!1,disableEdit:!1,disableDetail:!1}},methods:{add:function(){var e=this;this.visible=!0,this.$nextTick((function(){e.disableEdit=!1,e.disableDetail=!1}))},edit:function(e,t){var r=this;this.visible=!0,this.$nextTick((function(){r.disableEdit=!1,r.disableDetail=!1,t&&(r.disableEdit=!0,r.disableDetail=!1),r.$refs.realForm.edit(e)}))},handleDetail:function(e){var t=this;this.edit(e,!0),this.$nextTick((function(){t.disableDetail=!0})),this.$forceUpdate()},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){this.$refs.realForm.submitForm()},submitCallback:function(){this.$emit("ok"),this.visible=!1},handleCancel:function(){this.close()}}},s=o,l=r("2877"),c=Object(l["a"])(s,i,n,!1,null,null,null);t["default"]=c.exports},"98b7":function(e,t,r){},"9fc6":function(e,t,r){},b097:function(e,t,r){"use strict";r("71d5")},b1b0:function(e,t,r){"use strict";r("c280")},b437:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{staticClass:"ant-modal-cust-warp mainCard",attrs:{bordered:!1}},[r("cover-info-comp",{staticClass:"coverInfoComp",on:{isLogin:function(t){return e.$refs.voucherColListSummary.$refs.mesSuperQuery.manuallyQuery()},ok:e.modalFormOk}}),r("a-tabs",{staticClass:"voucherTabs",on:{change:e.handleChange},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},[r("a-tab-pane",{key:"0",attrs:{tab:"凭证汇总","force-render":""}},[r("voucher-col-list-summary",{ref:"voucherColListSummary"})],1),r("a-tab-pane",{key:"1",attrs:{tab:"汇总撤销","force-render":""}},[r("voucher-col-list-revoke",{ref:"voucherColListRevoke"})],1)],1)],1)},n=[],a=(r("6eb7"),r("30e0")),o=r("513b"),s=r("828e"),l={name:"VoucherColList",components:{CoverInfoComp:a["default"],VoucherColListSummary:o["default"],VoucherColListRevoke:s["default"]},data:function(){return{fileName:"VoucherColList",description:"凭证汇总页面",activeKey:"0"}},methods:{handleChange:function(){var e=this;"0"==this.activeKey?this.$nextTick((function(){e.$refs.voucherColListSummary.modalFormOk()})):this.$nextTick((function(){e.$refs.voucherColListRevoke.modalFormOk()}))},modalFormOk:function(){var e=this;"0"==this.activeKey?this.$nextTick((function(){e.$refs.voucherColListSummary.modalFormOk()})):this.$nextTick((function(){e.$refs.voucherColListRevoke.modalFormOk()}))}}},c=l,u=(r("3e68"),r("2877")),d=Object(u["a"])(c,i,n,!1,null,"57a7699d",null);t["default"]=d.exports},c280:function(e,t,r){},d9c6:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("j-modal",{attrs:{title:"凭证打印",width:1500,visible:e.visible,switchFullscreen:"",footer:null,"modal-height":"70vh"},on:{cancel:e.handleCancel}},[e.isUrl?r("iframe",{staticStyle:{border:"0",width:"100%",height:"600px"},attrs:{src:e.formUrl}}):e._e()])},n=[],a=r("2b0e"),o=r("9fb0"),s=r("0fea"),l={name:"PrintColVouchenModel",data:function(){return{visible:!1,selectedIds:[],isUrl:!1,formUrl:"",url:{queryReport:"/ureport2/ureport2Config/queryReport"},formType:""}},created:function(){},methods:{init:function(e,t){this.selectedIds=e,this.visible=!0,this.formType=t,this.loadData()},handleCancel:function(){this.selectedIds=[],this.visible=!1},loadData:function(){var e=this;this.formUrl="",this.isUrl=!1;var t=a["default"].ls.get(o["f"]);Object(s["e"])(this.url.queryReport,{formType:this.formType}).then((function(r){if(r.success&&r.result&&r.result.formTypeName){var i=r.result.formTypeName,n=a["default"].ls.get("SOURCE_NAME");n&&""!==n||(n="master");var o=_baseConfig["production"].VUE_APP_API_BASE_URL+"/ureport/preview?_u="+n+"db:"+i+"&_t="+r.result.reportHeaderButton+"&_n=凭证打印&coverNo="+t.coverNo+"&voucherIds="+e.selectedIds;e.formUrl=o,e.isUrl=!0}}))}}},c=l,u=(r("1e27"),r("2877")),d=Object(u["a"])(c,i,n,!1,null,"4f80d9a8",null);t["default"]=d.exports},e34e:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",{staticClass:"ant-modal-cust-warp mainCard",attrs:{bordered:!1}},[r("cover-info-comp",{staticClass:"coverInfoComp",staticStyle:{width:"400px"},on:{isLogin:function(t){return e.queryPage()},ok:e.modalFormOk}}),r("v-table",{ref:"table",attrs:{"row-config":{height:120},toolbar:!0,bordered:"",stripe:!0,checkbox:!1,"if-init-query":!1,expand:!1,data:e.loadData,tableColumn:e.columns},scopedSlots:e._u([{key:"coverYear",fn:function(t){var i=t.text;t.row;return[r("span",[e._v(e._s(i)+" 年度")])]}},{key:"month",fn:function(t){var i=t.text;t.row;return[r("span",[e._v(e._s(i)+" 月")])]}},{key:"state",fn:function(t){var i=t.text;t.row;return["0"==i?r("span",[e._v("已月结（不可撤销）")]):e._e(),"1"==i?r("span",[e._v("已月结（可撤销）")]):e._e(),"2"==i?r("span",[e._v("未月结（不可月结）")]):e._e(),"3"==i?r("span",[e._v("未月结（可月结）")]):e._e()]}},{key:"action",fn:function(t){t.text;var i=t.row;return[1==i.needTransSz?r("a",{on:{click:function(t){return e.transferSz(i)}}},[r("a-icon",{attrs:{type:"retweet"}}),e._v(" 收支结转")],1):e._e(),1==i.needTransSz?r("a-divider",{attrs:{type:"vertical"}}):e._e(),0==i.state||2==i.state||1==i.state?r("a",{on:{click:function(t){return e.detail(i)}}},[r("a-icon",{attrs:{type:"eye"}}),e._v(" 详情")],1):e._e(),3==i.state?r("a",{on:{click:function(t){return e.add(i)}}},[r("a-icon",{attrs:{type:"check-circle"}}),e._v(" 月结")],1):e._e(),1==i.state?r("a-divider",{attrs:{type:"vertical"}}):e._e(),1==i.state?r("a",{on:{click:function(t){return e.revoke(i)}}},[r("a-icon",{attrs:{type:"close-circle"}}),e._v(" 撤销月结")],1):e._e()]}}])}),r("transfer-modal",{ref:"transferModal",on:{ok:e.queryPage}})],1)},n=[],a=(r("6eb7"),r("0fea")),o=r("0a5e"),s=r("570af"),l=r("30e0"),c={name:"TransferList",mixins:[o["a"]],components:{TransferModal:s["default"],CoverInfoComp:l["default"]},data:function(){var e=this;return{fileName:"TransferList",description:"数据结转页面",columns:[{title:"年度",align:"left",headerAlign:"left",field:"coverYear",slot:!0},{title:"月份",align:"left",headerAlign:"left",field:"month",slot:!0},{title:"结转状态",align:"left",headerAlign:"left",field:"state",slot:!0},{title:"操作",align:"center",field:"action",slot:!0}],url:{list:"/transfer/transList",transferSz:"/transfer/transferSz",isRevocable:"/transfer/isRevocable"},loadData:function(t){return Object(a["e"])(e.url.list,Object.assign(t,e.queryParam)).then((function(t){return t.success?t.result:e.$message.error("请登录账套！")}))}}},methods:{transferSz:function(e){var t=this;this.$confirm({content:"确定进行收支结转吗？",onOk:function(){Object(a["j"])(t.url.transferSz,e).then((function(e){e.success?(t.$message.success(e.message),t.queryPage()):t.$message.warning(e.message)}))}})},add:function(e){this.$refs.transferModal.add(e)},revoke:function(e){var t=this;Object(a["e"])(this.url.isRevocable,{coverYear:e.coverYear,month:e.month}).then((function(r){r.success?t.$refs.transferModal.revoke(e):t.$message.error(r.message)}))},detail:function(e){this.$refs.transferModal.detail(e)}}},u=c,d=(r("870e"),r("2877")),f=Object(d["a"])(u,i,n,!1,null,"3fbdf759",null);t["default"]=f.exports},f730:function(e,t,r){}}]);