(window["webpackJsonp_joinsoft-v9"]=window["webpackJsonp_joinsoft-v9"]||[]).push([["chunk-libs~35f50c21"],{"030f":function(n,t,e){(function(n){(function(t){"use strict";var e=function(){},o=function(n){return function(){return n()}},r=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n(t.apply(null,e))}},i=function(n){return function(){return n}},u=function(n){return n};function a(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.concat(e);return n.apply(null,r)}}var c=function(n){return function(t){return!n(t)}},s=function(n){return function(){throw new Error(n)}},f=i(!1),l=i(!0),d=tinymce.util.Tools.resolve("tinymce.ThemeManager"),m=function(){return m=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var r in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},m.apply(this,arguments)};function g(n,t){var e={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(e[o[r]]=n[o[r]])}return e}function p(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var o=Array(n),r=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var v,h=function(){return b},b=function(){var n=function(n){return n.isNone()},t=function(n){return n()},o=function(n){return n},r={fold:function(n,t){return n()},is:f,isSome:f,isNone:l,getOr:o,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:o,orThunk:t,map:h,each:e,bind:h,exists:f,forall:l,filter:h,equals:n,equals_:n,toArray:function(){return[]},toString:i("none()")};return r}(),y=function(n){var t=i(n),e=function(){return r},o=function(t){return t(n)},r={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:l,isNone:f,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return y(t(n))},each:function(t){t(n)},bind:o,exists:o,forall:o,filter:function(t){return t(n)?r:b},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(f,(function(t){return e(n,t)}))}};return r},x=function(n){return null===n||void 0===n?b:y(n)},w={some:y,none:h,from:x},S=function(n){var t=function(t){return n===t},e=function(t){return S(n)},o=function(t){return S(n)},r=function(t){return S(t(n))},u=function(t){return S(n)},a=function(t){t(n)},c=function(t){return t(n)},s=function(t,e){return e(n)},d=function(t){return t(n)},m=function(t){return t(n)},g=function(){return w.some(n)};return{is:t,isValue:l,isError:f,getOr:i(n),getOrThunk:i(n),getOrDie:i(n),or:e,orThunk:o,fold:s,map:r,mapError:u,each:a,bind:c,exists:d,forall:m,toOption:g}},k=function(n){var t=function(n){return n()},o=function(){return s(String(n))()},r=function(n){return n},i=function(n){return n()},a=function(t){return k(n)},c=function(t){return k(t(n))},d=function(t){return k(n)},m=function(t,e){return t(n)};return{is:f,isValue:f,isError:l,getOr:u,getOrThunk:t,getOrDie:o,or:r,orThunk:i,fold:m,map:a,mapError:c,each:e,bind:d,exists:f,forall:l,toOption:w.none}},C=function(n,t){return n.fold((function(){return k(t)}),S)},O={value:S,error:k,fromOption:C},_=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},T=function(n){return function(t){return _(t)===n}},E=function(n){return function(t){return typeof t===n}},B=function(n){return function(t){return n===t}},D=T("string"),A=T("object"),M=T("array"),F=E("boolean"),I=B(void 0),R=E("function"),V=E("number"),H=function(n,t){if(M(n)){for(var e=0,o=n.length;e<o;++e)if(!t(n[e]))return!1;return!0}return!1},P=Array.prototype.slice,z=Array.prototype.indexOf,N=Array.prototype.push,L=function(n,t){return z.call(n,t)},j=function(n,t){var e=L(n,t);return-1===e?w.none():w.some(e)},U=function(n,t){return L(n,t)>-1},W=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];if(t(r,e))return!0}return!1},G=function(n,t){for(var e=[],o=0;o<n;o++)e.push(t(o));return e},X=function(n,t){for(var e=[],o=0;o<n.length;o+=t){var r=P.call(n,o,o+t);e.push(r)}return e},Y=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;r++){var i=n[r];o[r]=t(i,r)}return o},q=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];t(r,e)}},K=function(n,t){for(var e=n.length-1;e>=0;e--){var o=n[e];t(o,e)}},J=function(n,t){for(var e=[],o=[],r=0,i=n.length;r<i;r++){var u=n[r],a=t(u,r)?e:o;a.push(u)}return{pass:e,fail:o}},$=function(n,t){for(var e=[],o=0,r=n.length;o<r;o++){var i=n[o];t(i,o)&&e.push(i)}return e},Q=function(n,t,e){return K(n,(function(n){e=t(e,n)})),e},Z=function(n,t,e){return q(n,(function(n){e=t(e,n)})),e},nn=function(n,t,e){for(var o=0,r=n.length;o<r;o++){var i=n[o];if(t(i,o))return w.some(i);if(e(i,o))break}return w.none()},tn=function(n,t){return nn(n,t,f)},en=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];if(t(r,e))return w.some(e)}return w.none()},on=function(n){for(var t=[],e=0,o=n.length;e<o;++e){if(!M(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);N.apply(t,n[e])}return t},rn=function(n,t){return on(Y(n,t))},un=function(n,t){for(var e=0,o=n.length;e<o;++e){var r=n[e];if(!0!==t(r,e))return!1}return!0},an=function(n){var t=P.call(n,0);return t.reverse(),t},cn=function(n,t){return $(n,(function(n){return!U(t,n)}))},sn=function(n,t){for(var e={},o=0,r=n.length;o<r;o++){var i=n[o];e[String(i)]=t(i,o)}return e},fn=function(n){return[n]},ln=function(n,t){var e=P.call(n,0);return e.sort(t),e},dn=function(n){return 0===n.length?w.none():w.some(n[0])},mn=function(n){return 0===n.length?w.none():w.some(n[n.length-1])},gn=R(Array.from)?Array.from:function(n){return P.call(n)},pn=function(n,t){for(var e=0;e<n.length;e++){var o=t(n[e],e);if(o.isSome())return o}return w.none()},vn=Object.keys,hn=Object.hasOwnProperty,bn=function(n,t){for(var e=vn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i];t(u,i)}},yn=function(n,t){return xn(n,(function(n,e){return{k:e,v:t(n,e)}}))},xn=function(n,t){var e={};return bn(n,(function(n,o){var r=t(n,o);e[r.k]=r.v})),e},wn=function(n){return function(t,e){n[e]=t}},Sn=function(n,t,e,o){var r={};return bn(n,(function(n,r){(t(n,r)?e:o)(n,r)})),r},kn=function(n,t){var o={};return Sn(n,t,wn(o),e),o},Cn=function(n,t){var e=[];return bn(n,(function(n,o){e.push(t(n,o))})),e},On=function(n,t){for(var e=vn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i];if(t(u,i,n))return w.some(u)}return w.none()},_n=function(n){return Cn(n,(function(n){return n}))},Tn=function(n,t){return En(n,t)?w.from(n[t]):w.none()},En=function(n,t){return hn.call(n,t)},Bn=function(n,t){return En(n,t)&&void 0!==n[t]&&null!==n[t]},Dn=function(n){if(!M(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],o={};return q(n,(function(r,i){var u=vn(r);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=r[a];if(void 0!==o[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!M(c))throw new Error("case arguments must be an array");e.push(a),o[a]=function(){var o=arguments.length;if(o!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+o);for(var r=new Array(o),u=0;u<r.length;u++)r[u]=arguments[u];var s=function(n){var t=vn(n);if(e.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+t.join(","));var o=un(e,(function(n){return U(t,n)}));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+e.join(", "));return n[a].apply(null,r)};return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);var t=arguments[i];return t.apply(null,r)},match:s,log:function(n){t.console.log(n,{constructors:e,constructor:a,params:r})}}}})),o},An={generate:Dn},Mn=Object.prototype.hasOwnProperty,Fn=function(n,t){return t},In=function(n,t){var e=A(n)&&A(t);return e?Vn(n,t):t},Rn=function(n){return function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<t.length;r++){var i=t[r];for(var u in i)Mn.call(i,u)&&(o[u]=n(o[u],i[u]))}return o}},Vn=Rn(In),Hn=Rn(Fn),Pn=function(n){var t,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,t=n.apply(null,o)),t}};(function(n){n[n["Error"]=0]="Error",n[n["Value"]=1]="Value"})(v||(v={}));var zn=function(n,t,e){return n.stype===v.Error?t(n.serror):e(n.svalue)},Nn=function(n){var t=[],e=[];return q(n,(function(n){zn(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},Ln=function(n,t){return n.stype===v.Error?{stype:v.Error,serror:t(n.serror)}:n},jn=function(n,t){return n.stype===v.Value?{stype:v.Value,svalue:t(n.svalue)}:n},Un=function(n,t){return n.stype===v.Value?t(n.svalue):n},Wn=function(n,t){return n.stype===v.Error?t(n.serror):n},Gn=function(n){return{stype:v.Value,svalue:n}},Xn=function(n){return{stype:v.Error,serror:n}},Yn=function(n){return zn(n,O.error,O.value)},qn=function(n){return n.fold(Xn,Gn)},Kn={fromResult:qn,toResult:Yn,svalue:Gn,partition:Nn,serror:Xn,bind:Un,bindError:Wn,map:jn,mapError:Ln,fold:zn},Jn=An.generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),$n=function(n){return Jn.defaultedThunk(i(n))},Qn=function(n){return Jn.mergeWithThunk(i(n))},Zn=Jn.strict,nt=Jn.asOption,tt=Jn.defaultedThunk,et=(Jn.asDefaultedOptionThunk,Jn.mergeWithThunk),ot=function(n,t){var e={};return bn(n,(function(n,o){U(t,o)||(e[o]=n)})),e},rt=function(n,t){var e;return e={},e[n]=t,e},it=function(n){var t={};return q(n,(function(n){t[n.key]=n.value})),t},ut=(An.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){var t=[],e=[];return q(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}),at=function(n,t){return ot(n,t)},ct=function(n,t){return rt(n,t)},st=function(n){return it(n)},ft=function(n,t){return 0===n.length?O.value(t):O.value(Vn(t,Hn.apply(void 0,n)))},lt=function(n){return O.error(on(n))},dt=function(n,t){var e=ut(n);return e.errors.length>0?lt(e.errors):ft(e.values,t)},mt=function(n,t){return n.length>0?Kn.svalue(Vn(t,Hn.apply(void 0,n))):Kn.svalue(t)},gt=function(n){return r(Kn.serror,on)(n)},pt=function(n,t){var e=Kn.partition(n);return e.errors.length>0?gt(e.errors):mt(e.values,t)},vt=function(n){var t=Kn.partition(n);return t.errors.length>0?gt(t.errors):Kn.svalue(t.values)},ht={consolidateObj:pt,consolidateArr:vt},bt=function(n){return A(n)&&vn(n).length>100?" removed due to size":JSON.stringify(n,null,2)},yt=function(n){var t=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return Y(t,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))},xt=function(n,t){return Kn.serror([{path:n,getErrorInfo:t}])},wt=function(n,t,e){return xt(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+bt(e)}))},St=function(n,t){return xt(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))},kt=function(n,t,e){return xt(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+bt(t)}))},Ct=function(n,t){return xt(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))},Ot=function(n,t){return xt(n,(function(){return t}))},_t=An.generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Tt=function(n,t,e){return Tn(t,e).fold((function(){return wt(n,e,t)}),Kn.svalue)},Et=function(n,t,e){var o=Tn(n,t).fold((function(){return e(n)}),u);return Kn.svalue(o)},Bt=function(n,t){return Kn.svalue(Tn(n,t))},Dt=function(n,t,e){var o=Tn(n,t).map((function(t){return!0===t?e(n):t}));return Kn.svalue(o)},At=function(n,t,e,o){return e.fold((function(e,r,u,a){var c=function(t){var i=a.extract(n.concat([e]),o,t);return Kn.map(i,(function(n){return rt(r,o(n))}))},s=function(t){return t.fold((function(){var n=rt(r,o(w.none()));return Kn.svalue(n)}),(function(t){var i=a.extract(n.concat([e]),o,t);return Kn.map(i,(function(n){return rt(r,o(w.some(n)))}))}))};return function(){return u.fold((function(){return Kn.bind(Tt(n,t,e),c)}),(function(n){return Kn.bind(Et(t,e,n),c)}),(function(){return Kn.bind(Bt(t,e),s)}),(function(n){return Kn.bind(Dt(t,e,n),s)}),(function(n){var o=n(t),r=Kn.map(Et(t,e,i({})),(function(n){return Vn(o,n)}));return Kn.bind(r,c)}))}()}),(function(n,e){var r=e(t);return Kn.svalue(rt(n,o(r)))}))},Mt=function(n,t,e,o){var r=Y(e,(function(e){return At(n,t,e,o)}));return ht.consolidateObj(r,{})},Ft=function(n){var t=function(t,e,o){return n().extract(t,e,o)},e=function(){return n().toString()};return{extract:t,toString:e}},It=function(n){var t=function(t,e,o){return Kn.bindError(n(o,e),(function(n){return Ot(t,n)}))},e=function(){return"val"};return{extract:t,toString:e}},Rt=function(n){return vn(kn(n,(function(n){return void 0!==n&&null!==n})))},Vt=function(n){var t=Ht(n),e=Q(n,(function(n,t){return t.fold((function(t){return Vn(n,ct(t,!0))}),i(n))}),{}),o=function(n,o,r){var i=F(r)?[]:Rt(r),u=$(i,(function(n){return!Bn(e,n)}));return 0===u.length?t.extract(n,o,r):Ct(n,u)};return{extract:o,toString:t.toString}},Ht=function(n){var t=function(t,e,o){return Mt(t,o,n,e)},e=function(){var t=Y(n,(function(n){return n.fold((function(n,t,e,o){return n+" -> "+o.toString()}),(function(n,t){return"state("+n+")"}))}));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:e}},Pt=function(n){var t=function(t,e,o){var r=Y(o,(function(o,r){return n.extract(t.concat(["["+r+"]"]),e,o)}));return ht.consolidateArr(r)},e=function(){return"array("+n.toString()+")"};return{extract:t,toString:e}},zt=function(n){var t=function(t,e,o){for(var r=[],i=0,u=n;i<u.length;i++){var a=u[i],c=a.extract(t,e,o);if(c.stype===v.Value)return c;r.push(c)}return ht.consolidateArr(r)},e=function(){return"oneOf("+Y(n,(function(n){return n.toString()})).join(", ")+")"};return{extract:t,toString:e}},Nt=function(n,t){var e=function(t,e){return Pt(It(n)).extract(t,u,e)},o=function(n,o,r){var i=vn(r),u=e(n,i);return Kn.bind(u,(function(e){var i=Y(e,(function(n){return _t.field(n,n,Zn(),t)}));return Ht(i).extract(n,o,r)}))},r=function(){return"setOf("+t.toString()+")"};return{extract:o,toString:r}},Lt=i(It(Kn.svalue)),jt=r(Pt,Ht),Ut=_t.state,Wt=_t.field,Gt=function(n,t,e,o,r){var i=Tn(o,r);return i.fold((function(){return kt(n,o,r)}),(function(o){return o.extract(n.concat(["branch: "+r]),t,e)}))},Xt=function(n,t){var e=function(e,o,r){var i=Tn(r,n);return i.fold((function(){return St(e,n)}),(function(n){return Gt(e,o,r,t,n)}))},o=function(){return"chooseOn("+n+"). Possible values: "+vn(t)};return{extract:e,toString:o}},Yt=It(Kn.svalue),qt=function(n){return jt(n)},Kt=function(){return Pt(Yt)},Jt=Ft,$t=function(n){return It((function(t){return n(t).fold(Kn.serror,Kn.svalue)}))},Qt=function(n,t){return Nt((function(t){return Kn.fromResult(n(t))}),t)},Zt=function(n,t,e,o){var r=t.extract([n],e,o);return Kn.mapError(r,(function(n){return{input:o,errors:n}}))},ne=function(n,t,e){return Kn.toResult(Zt(n,t,u,e))},te=function(n){return n.fold((function(n){throw new Error(oe(n))}),u)},ee=function(n,t,e){return te(ne(n,t,e))},oe=function(n){return"Errors: \n"+yt(n.errors).join("\n")+"\n\nInput object: "+bt(n.input)},re=function(n,t){return Xt(n,t)},ie=function(n,t){return Xt(n,yn(t,Ht))},ue=i(Yt),ae=function(n,t){return It((function(e){var o=typeof e;return n(e)?Kn.svalue(e):Kn.serror("Expected type: "+t+" but got: "+o)}))},ce=ae(V,"number"),se=ae(D,"string"),fe=ae(F,"boolean"),le=ae(R,"function"),de=function(n){var t=function(n,t){var e=n.next();while(!e.done){if(!t(e.value))return!1;e=n.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every((function(t){return de(n[t])}));case"Map":return t(n.keys(),de)&&t(n.values(),de);case"Set":return t(n.keys(),de);default:return!1}},me=It((function(n){return de(n)?Kn.svalue(n):Kn.serror("Expected value to be acceptable for sending via postMessage")})),ge=function(n){return $t((function(t){return U(n,t)?O.value(t):O.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')}))},pe=function(n){return Wt(n,n,Zn(),Lt())},ve=function(n,t){return Wt(n,n,Zn(),t)},he=function(n){return ve(n,ce)},be=function(n){return ve(n,se)},ye=function(n,t){return Wt(n,n,Zn(),ge(t))},xe=function(n){return ve(n,fe)},we=function(n){return ve(n,le)},Se=function(n,t){return Wt(n,n,nt(),It((function(e){return Kn.serror("The field: "+n+" is forbidden. "+t)})))},ke=function(n,t){return Wt(n,n,Zn(),Ht(t))},Ce=function(n,t){return Wt(n,n,Zn(),jt(t))},Oe=function(n,t){return Wt(n,n,Zn(),Pt(t))},_e=function(n){return Wt(n,n,nt(),Lt())},Te=function(n,t){return Wt(n,n,nt(),t)},Ee=function(n){return Te(n,ce)},Be=function(n){return Te(n,se)},De=function(n){return Te(n,le)},Ae=function(n,t){return Te(n,Pt(t))},Me=function(n,t){return Te(n,Ht(t))},Fe=function(n,t){return Te(n,Vt(t))},Ie=function(n,t){return Wt(n,n,$n(t),Lt())},Re=function(n,t,e){return Wt(n,n,$n(t),e)},Ve=function(n,t){return Re(n,t,ce)},He=function(n,t){return Re(n,t,se)},Pe=function(n,t,e){return Re(n,t,ge(e))},ze=function(n,t){return Re(n,t,fe)},Ne=function(n,t){return Re(n,t,le)},Le=function(n,t){return Re(n,t,me)},je=function(n,t,e){return Re(n,t,Pt(e))},Ue=function(n,t,e){return Re(n,t,Ht(e))},We=function(n,t){return Ut(n,t)},Ge=function(n){var t=n,e=function(){return t},o=function(n){t=n};return{get:e,set:o}},Xe=function(n,e){var o=e||t.document,r=o.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Ke(r.childNodes[0])},Ye=function(n,e){var o=e||t.document,r=o.createElement(n);return Ke(r)},qe=function(n,e){var o=e||t.document,r=o.createTextNode(n);return Ke(r)},Ke=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:i(n)}},Je=function(n,t,e){var o=n.dom();return w.from(o.elementFromPoint(t,e)).map(Ke)},$e={fromHtml:Xe,fromTag:Ye,fromText:qe,fromDom:Ke,fromPoint:Je},Qe=function(n,t,e){return 0!==(n.compareDocumentPosition(t)&e)},Ze=function(n,e){return Qe(n,e,t.Node.DOCUMENT_POSITION_CONTAINED_BY)},no=function(n,t){for(var e=0;e<n.length;e++){var o=n[e];if(o.test(t))return o}},to=function(n,t){var e=no(n,t);if(!e)return{major:0,minor:0};var o=function(n){return Number(t.replace(e,"$"+n))};return ro(o(1),o(2))},eo=function(n,t){var e=String(t).toLowerCase();return 0===n.length?oo():to(n,e)},oo=function(){return ro(0,0)},ro=function(n,t){return{major:n,minor:t}},io={nu:ro,detect:eo,unknown:oo},uo="Edge",ao="Chrome",co="IE",so="Opera",fo="Firefox",lo="Safari",mo=function(){return go({current:void 0,version:io.unknown()})},go=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:o(uo),isChrome:o(ao),isIE:o(co),isOpera:o(so),isFirefox:o(fo),isSafari:o(lo)}},po={unknown:mo,nu:go,edge:i(uo),chrome:i(ao),ie:i(co),opera:i(so),firefox:i(fo),safari:i(lo)},vo="Windows",ho="iOS",bo="Android",yo="Linux",xo="OSX",wo="Solaris",So="FreeBSD",ko="ChromeOS",Co=function(){return Oo({current:void 0,version:io.unknown()})},Oo=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:o(vo),isiOS:o(ho),isAndroid:o(bo),isOSX:o(xo),isLinux:o(yo),isSolaris:o(wo),isFreeBSD:o(So),isChromeOS:o(ko)}},_o={unknown:Co,nu:Oo,windows:i(vo),ios:i(ho),android:i(bo),linux:i(yo),osx:i(xo),solaris:i(wo),freebsd:i(So),chromeos:i(ko)},To=function(n,t,e,o){var r=n.isiOS()&&!0===/ipad/i.test(e),u=n.isiOS()&&!r,a=n.isiOS()||n.isAndroid(),c=a||o("(pointer:coarse)"),s=r||!u&&a&&o("(min-device-width:768px)"),f=u||a&&!s,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!f&&!s&&!l;return{isiPad:i(r),isiPhone:i(u),isTablet:i(s),isPhone:i(f),isTouch:i(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:i(l),isDesktop:i(d)}},Eo=function(n,t){var e=String(t).toLowerCase();return tn(n,(function(n){return n.search(e)}))},Bo=function(n,t){return Eo(n,t).map((function(n){var e=io.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},Do=function(n,t){return Eo(n,t).map((function(n){var e=io.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},Ao={detectBrowser:Bo,detectOs:Do},Mo=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},Fo=function(n,t){return-1!==n.indexOf(t)},Io=function(n,t){return Mo(n,t,n.length-t.length)},Ro=function(n){return function(t){return t.replace(n,"")}},Vo=Ro(/^\s+|\s+$/g),Ho=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Po=function(n){return function(t){return Fo(t,n)}},zo=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Fo(n,"edge/")&&Fo(n,"chrome")&&Fo(n,"safari")&&Fo(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ho],search:function(n){return Fo(n,"chrome")&&!Fo(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Fo(n,"msie")||Fo(n,"trident")}},{name:"Opera",versionRegexes:[Ho,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Po("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Po("firefox")},{name:"Safari",versionRegexes:[Ho,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Fo(n,"safari")||Fo(n,"mobile/"))&&Fo(n,"applewebkit")}}],No=[{name:"Windows",search:Po("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Fo(n,"iphone")||Fo(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Po("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Po("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Po("linux"),versionRegexes:[]},{name:"Solaris",search:Po("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Po("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Po("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Lo={browsers:i(zo),oses:i(No)},jo=function(n,t){var e=Lo.browsers(),o=Lo.oses(),r=Ao.detectBrowser(e,n).fold(po.unknown,po.nu),i=Ao.detectOs(o,n).fold(_o.unknown,_o.nu),u=To(i,r,n,t);return{browser:r,os:i,deviceType:u}},Uo={detect:jo},Wo=function(n){return t.window.matchMedia(n).matches},Go=Pn((function(){return Uo.detect(t.navigator.userAgent,Wo)})),Xo=function(){return Go()},Yo=9,qo=1,Ko=3,Jo=qo,$o=Yo,Qo=function(n,t){var e=n.dom();if(e.nodeType!==Jo)return!1;var o=e;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Zo=function(n){return n.nodeType!==Jo&&n.nodeType!==$o||0===n.childElementCount},nr=function(n,e){var o=void 0===e?t.document:e.dom();return Zo(o)?[]:Y(o.querySelectorAll(n),$e.fromDom)},tr=function(n,e){var o=void 0===e?t.document:e.dom();return Zo(o)?w.none():w.from(o.querySelector(n)).map($e.fromDom)},er=function(n,t){return n.dom()===t.dom()},or=function(n,t){var e=n.dom(),o=t.dom();return e!==o&&e.contains(o)},rr=function(n,t){return Ze(n.dom(),t.dom())},ir=function(n,t){return Xo().browser.isIE()?rr(n,t):or(n,t)},ur=function(n){return R(n)?n:i(!1)},ar=function(n,t,e){var o=n.dom(),r=ur(e);while(o.parentNode){o=o.parentNode;var i=$e.fromDom(o),u=t(i);if(u.isSome())return u;if(r(i))break}return w.none()},cr=function(n,t,e){var o=t(n),r=ur(e);return o.orThunk((function(){return r(n)?w.none():ar(n,t,r)}))},sr=function(n,t){return er(n.element(),t.event().target())},fr=function(n){if(!Bn(n,"can")&&!Bn(n,"abort")&&!Bn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return ee("Extracting event.handler",Vt([Ie("can",i(!0)),Ie("abort",i(!1)),Ie("run",e)]),n)},lr=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return Z(n,(function(n,o){return n&&t(o).apply(void 0,e)}),!0)}},dr=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return Z(n,(function(n,o){return n||t(o).apply(void 0,e)}),!1)}},mr=function(n){return R(n)?{can:i(!0),abort:i(!1),run:n}:n},gr=function(n){var t=lr(n,(function(n){return n.can})),e=dr(n,(function(n){return n.abort})),o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];q(n,(function(n){n.run.apply(void 0,t)}))};return fr({can:t,abort:e,run:o})},pr=i("touchstart"),vr=i("touchmove"),hr=i("touchend"),br=i("touchcancel"),yr=i("mousedown"),xr=i("mousemove"),wr=i("mouseout"),Sr=i("mouseup"),kr=i("mouseover"),Cr=i("focusin"),Or=i("focusout"),_r=i("keydown"),Tr=i("keyup"),Er=i("input"),Br=i("change"),Dr=i("click"),Ar=i("transitionend"),Mr=i("selectstart"),Fr={tap:i("alloy.tap")},Ir=i("alloy.focus"),Rr=i("alloy.blur.post"),Vr=i("alloy.paste.post"),Hr=i("alloy.receive"),Pr=i("alloy.execute"),zr=i("alloy.focus.item"),Nr=Fr.tap,Lr=i("alloy.longpress"),jr=i("alloy.sandbox.close"),Ur=i("alloy.typeahead.cancel"),Wr=i("alloy.system.init"),Gr=i("alloy.system.touchmove"),Xr=i("alloy.system.touchend"),Yr=i("alloy.system.scroll"),qr=i("alloy.system.resize"),Kr=i("alloy.system.attached"),Jr=i("alloy.system.detached"),$r=i("alloy.system.dismissRequested"),Qr=i("alloy.system.repositionRequested"),Zr=i("alloy.focusmanager.shifted"),ni=i("alloy.slotcontainer.visibility"),ti=i("alloy.change.tab"),ei=i("alloy.dismiss.tab"),oi=i("alloy.highlight"),ri=i("alloy.dehighlight"),ii=function(n,t){si(n,n.element(),t,{})},ui=function(n,t,e){si(n,n.element(),t,e)},ai=function(n){ii(n,Pr())},ci=function(n,t,e){si(n,t,e,{})},si=function(n,t,e,o){var r=m({target:t},o);n.getSystem().triggerEvent(e,t,yn(r,i))},fi=function(n,t,e,o){n.getSystem().triggerEvent(e,t,o.event())},li=function(n){return st(n)},di=function(n,t){return{key:n,value:fr({abort:t})}},mi=function(n,t){return{key:n,value:fr({can:t})}},gi=function(n){return{key:n,value:fr({run:function(n,t){t.event().prevent()}})}},pi=function(n,t){return{key:n,value:fr({run:t})}},vi=function(n,t,e){return{key:n,value:fr({run:function(n,o){t.apply(void 0,[n,o].concat(e))}})}},hi=function(n){return function(t){return pi(n,t)}},bi=function(n){return function(t){return{key:n,value:fr({run:function(n,e){sr(n,e)&&t(n,e)}})}}},yi=function(n,t){return pi(n,(function(e,o){e.getSystem().getByUid(t).each((function(t){fi(t,t.element(),n,o)}))}))},xi=function(n,t,e){var o=t.partUids[e];return yi(n,o)},wi=function(n,t){return pi(n,(function(n,e){var o=e.event(),r=n.getSystem().getByDom(o.target()).fold((function(){var t=cr(o.target(),(function(t){return n.getSystem().getByDom(t).toOption()}),i(!1));return t.getOr(n)}),(function(n){return n}));t(n,r,e)}))},Si=function(n){return pi(n,(function(n,t){t.cut()}))},ki=function(n){return pi(n,(function(n,t){t.stop()}))},Ci=function(n,t){return bi(n)(t)},Oi=bi(Kr()),_i=bi(Jr()),Ti=bi(Wr()),Ei=hi(Pr()),Bi=function(n){return $e.fromDom(n.dom().ownerDocument)},Di=function(n){return $e.fromDom(n.dom().ownerDocument.documentElement)},Ai=function(n){return $e.fromDom(n.dom().ownerDocument.defaultView)},Mi=function(n){return w.from(n.dom().parentNode).map($e.fromDom)},Fi=function(n){return w.from(n.dom().offsetParent).map($e.fromDom)},Ii=function(n){return w.from(n.dom().nextSibling).map($e.fromDom)},Ri=function(n){return Y(n.dom().childNodes,$e.fromDom)},Vi=function(n,t){var e=n.dom().childNodes;return w.from(e[t]).map($e.fromDom)},Hi=function(n){return Vi(n,0)},Pi=function(n,t){var e=Mi(n);e.each((function(e){e.dom().insertBefore(t.dom(),n.dom())}))},zi=function(n,t){var e=Ii(n);e.fold((function(){var e=Mi(n);e.each((function(n){Li(n,t)}))}),(function(n){Pi(n,t)}))},Ni=function(n,t){var e=Hi(n);e.fold((function(){Li(n,t)}),(function(e){n.dom().insertBefore(t.dom(),e.dom())}))},Li=function(n,t){n.dom().appendChild(t.dom())},ji=function(n,t,e){Vi(n,e).fold((function(){Li(n,t)}),(function(n){Pi(n,t)}))},Ui=function(n,t){q(t,(function(t){Pi(n,t)}))},Wi=function(n,t){q(t,(function(t){Li(n,t)}))},Gi=function(n){n.dom().textContent="",q(Ri(n),(function(n){Xi(n)}))},Xi=function(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Yi=function(n){var t=Ri(n);t.length>0&&Ui(n,t),Xi(n)},qi=function(n,e){var o=e||t.document,r=o.createElement("div");return r.innerHTML=n,Ri($e.fromDom(r))},Ki=function(n){return n.dom().innerHTML},Ji=function(n,t){var e=Bi(n),o=e.dom(),r=$e.fromDom(o.createDocumentFragment()),i=qi(t,o);Wi(r,i),Gi(n),Li(n,r)},$i=function(n){var t=$e.fromTag("div"),e=$e.fromDom(n.dom().cloneNode(!0));return Li(t,e),Ki(t)},Qi=("undefined"!==typeof t.window?t.window:Function("return this;")(),function(n){var t=n.dom().nodeName;return t.toLowerCase()}),Zi=function(n){return n.dom().nodeType},nu=function(n){return function(t){return Zi(t)===n}},tu=nu(qo),eu=nu(Ko),ou=function(n,e,o){if(!(D(o)||F(o)||V(o)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",o,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,o+"")},ru=function(n,t,e){ou(n.dom(),t,e)},iu=function(n,t){var e=n.dom();bn(t,(function(n,t){ou(e,t,n)}))},uu=function(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e},au=function(n,t){return w.from(uu(n,t))},cu=function(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},su=function(n,t){n.dom().removeAttribute(t)},fu=function(n,t){return $e.fromDom(n.dom().cloneNode(t))},lu=function(n){return fu(n,!1)},du=function(n){var t=lu(n);return $i(t)},mu=function(n){return du(n)},gu=function(n,t,e){return er(t,n.element())&&!er(t,e)},pu=li([mi(Ir(),(function(n,e){var o=e.event().originator(),r=e.event().target();return!gu(n,o,r)||(t.console.warn(Ir()+" did not get interpreted by the desired target. \nOriginator: "+mu(o)+"\nTarget: "+mu(r)+"\nCheck the "+Ir()+" event handlers"),!1)}))]),vu=Object.freeze({__proto__:null,events:pu}),hu=0,bu=function(n){var t=new Date,e=t.getTime(),o=Math.floor(1e9*Math.random());return hu++,n+"_"+o+hu+String(e)},yu=i("alloy-id-"),xu=i("data-alloy-id"),wu=yu(),Su=xu(),ku=function(n,t){var e=bu(wu+n);return Cu(t,e),e},Cu=function(n,t){Object.defineProperty(n.dom(),Su,{value:t,writable:!0})},Ou=function(n){var t=tu(n)?n.dom()[Su]:null;return w.from(t)},_u=function(n){return bu(n)},Tu=u,Eu=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+mu(n().element())+" is not in context.":""))}};return{debugInfo:i("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:i(!1)}},Bu=Eu(),Du=function(n,t,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Au(u.slice(0,1).concat(u.slice(3)))}},n},Au=function(n){return Y(n,(function(n){return Io(n,"/*")?n.substring(0,n.length-"/*".length):n}))},Mu=function(n,t){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Au(i)}},n},Fu=function(n,t){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Au(i.slice(1))}},n},Iu=bu("alloy-premade"),Ru=function(n){return ct(Iu,n)},Vu=function(n){return Tn(n,Iu)},Hu=function(n){return Fu((function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return n.apply(void 0,p([t.getApis(),t],e))}),n)},Pu={init:function(){return zu({readState:function(){return"No State required"}})}},zu=function(n){return n},Nu=function(n,t){var e=Y(t,(function(n){return Me(n.name(),[pe("config"),Ie("state",Pu)])})),o=ne("component.behaviours",Ht(e),n.behaviours).fold((function(t){throw new Error(oe(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}));return{list:t,data:yn(o,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return t}}))}},Lu=function(n){return n.list},ju=function(n){return n.data},Uu=function(n,t){var e={};return bn(n,(function(n,o){bn(n,(function(n,r){var i=Tn(e,r).getOr([]);e[r]=i.concat([t(o,n)])}))})),e},Wu=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},Gu=function(n,t){return m(m({},n),{attributes:m(m({},n.attributes),t.attributes),styles:m(m({},n.styles),t.styles),classes:n.classes.concat(t.classes)})},Xu=function(n,t,e,o){var r=m({},t);q(e,(function(t){r[t.name()]=t.exhibit(n,o)}));var i=Uu(r,(function(n,t){return{name:n,modification:t}})),u=function(n){return Q(n,(function(n,t){return m(m({},t.modification),n)}),{})},a=Q(i.classes,(function(n,t){return t.modification.concat(n)}),[]),c=u(i.attributes),s=u(i.styles);return Wu({classes:a,attributes:c,styles:s})},Yu=function(n,t,e,o){try{var r=ln(e,(function(e,r){var i=e[t](),u=r[t](),a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return O.value(r)}catch(i){return O.error([i])}},qu=function(n,t){return{handler:n,purpose:i(t)}},Ku=function(n,t){return{cHandler:n,purpose:i(t)}},Ju=function(n,t){return Ku(a.apply(void 0,[n.handler].concat(t)),n.purpose())},$u=function(n){return n.cHandler},Qu=function(n,t){return{name:i(n),handler:i(t)}},Zu=function(n,t){var e={};return q(n,(function(n){e[n.name()]=n.handlers(t)})),e},na=function(n,t,e){var o=m(m({},e),Zu(t,n));return Uu(o,Qu)},ta=function(n,t,e,o){var r=na(n,e,o);return ia(r,t)},ea=function(n){var t=mr(n);return function(n,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[n,e].concat(o);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},oa=function(n,t){return O.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(Y(t,(function(n){return n.name()})),null,2)])},ra=function(n,t,e){var o=t[e];return o?Yu("Event: "+e,"name",n,o).map((function(n){var t=Y(n,(function(n){return n.handler()}));return gr(t)})):oa(e,n)},ia=function(n,t){var e=Cn(n,(function(n,e){var o=1===n.length?O.value(n[0].handler()):ra(n,t,e);return o.map((function(o){var r=ea(o),i=n.length>1?$(t[e],(function(t){return W(n,(function(n){return n.name()===t}))})).join(" > "):n[0].name();return ct(e,qu(r,i))}))}));return dt(e,{})},ua=function(n){return ne("custom.definition",Ht([Wt("dom","dom",Zn(),Ht([pe("tag"),Ie("styles",{}),Ie("classes",[]),Ie("attributes",{}),_e("value"),_e("innerHtml")])),pe("components"),pe("uid"),Ie("events",{}),Ie("apis",{}),Wt("eventOrder","eventOrder",Qn({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"],"alloy.receive":["receiving","reflecting","tooltipping"]}),ue()),_e("domModification")]),n)},aa=function(n){return m(m({},n.dom),{uid:n.uid,domChildren:Y(n.components,(function(n){return n.element()}))})},ca=function(n){return n.domModification.fold((function(){return Wu({})}),Wu)},sa=function(n){return n.events},fa=function(n,t){var e=uu(n,t);return void 0===e||""===e?[]:e.split(" ")},la=function(n,t,e){var o=fa(n,t),r=o.concat([e]);return ru(n,t,r.join(" ")),!0},da=function(n,t,e){var o=$(fa(n,t),(function(n){return n!==e}));return o.length>0?ru(n,t,o.join(" ")):su(n,t),!1},ma=function(n){return void 0!==n.dom().classList},ga=function(n){return fa(n,"class")},pa=function(n,t){return la(n,"class",t)},va=function(n,t){return da(n,"class",t)},ha=function(n,t){ma(n)?n.dom().classList.add(t):pa(n,t)},ba=function(n){var t=ma(n)?n.dom().classList:ga(n);0===t.length&&su(n,"class")},ya=function(n,t){if(ma(n)){var e=n.dom().classList;e.remove(t)}else va(n,t);ba(n)},xa=function(n,t){return ma(n)&&n.dom().classList.contains(t)},wa=function(n,t){q(t,(function(t){ha(n,t)}))},Sa=function(n,t){q(t,(function(t){ya(n,t)}))},ka=function(n){return void 0!==n.style&&R(n.style.getPropertyValue)},Ca=function(n){var t=eu(n)?n.dom().parentNode:n.dom();return void 0!==t&&null!==t&&t.ownerDocument.body.contains(t)},Oa=function(){return _a($e.fromDom(t.document))},_a=function(n){var t=n.dom().body;if(null===t||void 0===t)throw new Error("Body is not available yet");return $e.fromDom(t)},Ta=function(n,e,o){if(!D(o))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",o,":: Element ",n),new Error("CSS value must be a string: "+o);ka(n)&&n.style.setProperty(e,o)},Ea=function(n,t){ka(n)&&n.style.removeProperty(t)},Ba=function(n,t,e){var o=n.dom();Ta(o,t,e)},Da=function(n,t){var e=n.dom();bn(t,(function(n,t){Ta(e,t,n)}))},Aa=function(n,t){var e=n.dom();bn(t,(function(n,t){n.fold((function(){Ea(e,t)}),(function(n){Ta(e,t,n)}))}))},Ma=function(n,e){var o=n.dom(),r=t.window.getComputedStyle(o),i=r.getPropertyValue(e);return""!==i||Ca(n)?i:Fa(o,e)},Fa=function(n,t){return ka(n)?n.style.getPropertyValue(t):""},Ia=function(n,t){var e=n.dom(),o=Fa(e,t);return w.from(o).filter((function(n){return n.length>0}))},Ra=function(n){var t={},e=n.dom();if(ka(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);t[r]=e.style[r]}return t},Va=function(n,t,e){var o=$e.fromTag(n);Ba(o,t,e);var r=Ia(o,t);return r.isSome()},Ha=function(n,t){var e=n.dom();Ea(e,t),au(n,"style").map(Vo).is("")&&su(n,"style")},Pa=function(n){return n.dom().offsetWidth},za=function(n){return n.dom().value},Na=function(n,t){if(void 0===t)throw new Error("Value.set was undefined");n.dom().value=t},La=function(n){var t=$e.fromTag(n.tag);iu(t,n.attributes),wa(t,n.classes),Da(t,n.styles),n.innerHtml.each((function(n){return Ji(t,n)}));var e=n.domChildren;return Wi(t,e),n.value.each((function(n){Na(t,n)})),n.uid,Cu(t,n.uid),t},ja=function(n){var t=Tn(n,"behaviours").getOr({}),e=$(vn(t),(function(n){return void 0!==t[n]}));return Y(e,(function(n){return t[n].me}))},Ua=function(n,t){return Nu(n,t)},Wa=function(n){var t=ja(n);return Ua(n,t)},Ga=function(n,t,e){var o=aa(n),r=ca(n),i={"alloy.base.modification":r},u=t.length>0?Xu(e,i,t,o):r;return Gu(o,u)},Xa=function(n,t,e){var o={"alloy.base.behaviour":sa(n)};return ta(e,n.eventOrder,t,o).getOrDie()},Ya=function(n){var t=function(){return y},e=Ge(Bu),o=te(ua(n)),r=Wa(n),u=Lu(r),a=ju(r),c=Ga(o,u,a),s=La(c),f=Xa(o,u,a),l=Ge(o.components),d=function(n){e.set(n)},m=function(){e.set(Eu(t))},g=function(){var n=Ri(s),t=rn(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));l.set(t)},p=function(t){var e=a,o=R(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))};return o()},v=function(n){return R(a[n.name()])},h=function(){return o.apis},b=function(n){return a[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},y={getSystem:e.get,config:p,hasConfigured:v,spec:i(n),readState:b,getApis:h,connect:d,disconnect:m,element:i(s),syncComponents:g,components:l.get,events:i(f)};return y},qa=function(n){var t=Tn(n,"components").getOr([]);return Y(t,Za)},Ka=function(n){var t=Tu(n),e=t.events,o=g(t,["events"]),r=qa(o),i=m(m({},o),{events:m(m({},vu),e),components:r});return O.value(Ya(i))},Ja=function(n){var t=$e.fromText(n);return $a({element:t})},$a=function(n){var t=ee("external.component",Vt([pe("element"),_e("uid")]),n),o=Ge(Eu()),r=function(n){o.set(n)},u=function(){o.set(Eu((function(){return a})))};t.uid.each((function(n){Cu(t.element,n)}));var a={getSystem:o.get,config:w.none,hasConfigured:i(!1),connect:r,disconnect:u,getApis:function(){return{}},element:i(t.element),spec:i(n),readState:i("No state"),syncComponents:e,components:i([]),events:i({})};return Ru(a)},Qa=_u,Za=function(n){return Vu(n).fold((function(){var t=n.hasOwnProperty("uid")?n:m({uid:Qa("")},n);return Ka(t).getOrDie()}),(function(n){return n}))},nc=Ru;function tc(n,t){var e=function(t,e){if(!V(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var o=t.dom();ka(o)&&(o.style[n]=e+"px")},o=function(e){var o=t(e);if(o<=0||null===o){var r=Ma(e,n);return parseFloat(r)||0}return o},r=o,i=function(n,t){return Z(t,(function(t,e){var o=Ma(n,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?t:t+r}),0)},u=function(n,t,e){var o=i(n,e),r=t>o?t-o:0;return r};return{set:e,get:o,getOuter:r,aggregate:i,max:u}}var ec=tc("height",(function(n){var t=n.dom();return Ca(n)?t.getBoundingClientRect().height:t.offsetHeight})),oc=function(n){return ec.get(n)},rc=function(n){return ec.getOuter(n)},ic=function(n,t){var e=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],o=ec.max(n,t,e);Ba(n,"max-height",o+"px")},uc=function(n,t){var e=function(e,o){return uc(n+e,t+o)};return{left:i(n),top:i(t),translate:e}},ac=uc,cc=function(n){var t=n.getBoundingClientRect();return ac(t.left,t.top)},sc=function(n,t){return void 0!==n?n:void 0!==t?t:0},fc=function(n){var t=n.dom().ownerDocument,e=t.body,o=t.defaultView,r=t.documentElement;if(e===n.dom())return ac(e.offsetLeft,e.offsetTop);var i=sc(o.pageYOffset,r.scrollTop),u=sc(o.pageXOffset,r.scrollLeft),a=sc(r.clientTop,e.clientTop),c=sc(r.clientLeft,e.clientLeft);return lc(n).translate(u-c,i-a)},lc=function(n){var t=n.dom(),e=t.ownerDocument,o=e.body;return o===t?ac(o.offsetLeft,o.offsetTop):Ca(n)?cc(t):ac(0,0)},dc=tc("width",(function(n){return n.dom().offsetWidth})),mc=function(n,t){return dc.set(n,t)},gc=function(n){return dc.get(n)},pc=function(n){return dc.getOuter(n)},vc=function(n,t){var e=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],o=dc.max(n,t,e);Ba(n,"max-width",o+"px")},hc=function(n,t,e,o,r,u,a){return{target:i(n),x:i(t),y:i(e),stop:o,prevent:r,kill:u,raw:i(a)}},bc=function(n){var t=$e.fromDom(n.target),e=function(){return n.stopPropagation()},o=function(){return n.preventDefault()},i=r(o,e);return hc(t,n.clientX,n.clientY,e,o,i,n)},yc=function(n,t){return function(e){n(e)&&t(bc(e))}},xc=function(n,t,e,o,r){var i=yc(e,o);return n.dom().addEventListener(t,i,r),{unbind:a(kc,n,t,i,r)}},wc=function(n,t,e,o){return xc(n,t,e,o,!1)},Sc=function(n,t,e,o){return xc(n,t,e,o,!0)},kc=function(n,t,e,o){n.dom().removeEventListener(t,e,o)},Cc=function(n){var e=void 0!==n?n.dom():t.document,o=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return ac(o,r)},Oc=function(n,e,o){var r=void 0!==o?o.dom():t.document,i=r.defaultView;i.scrollTo(n,e)},_c=function(n){var e=void 0===n?t.window:n;return w.from(e["visualViewport"])},Tc=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},Ec=function(n){var e=void 0===n?t.window:n,o=e.document,r=Cc($e.fromDom(o));return _c(e).fold((function(){var n=e.document.documentElement,t=n.clientWidth,o=n.clientHeight;return Tc(r.left(),r.top(),t,o)}),(function(n){return Tc(Math.max(n.pageLeft,r.left()),Math.max(n.pageTop,r.top()),n.width,n.height)}))},Bc=function(n,t){var e=n.view(t);return e.fold(i([]),(function(t){var e=n.owner(t),o=Bc(n,e);return[t].concat(o)}))},Dc=function(n,t){var e=t.owner(n),o=Bc(t,e);return w.some(o)},Ac=function(n){var e=n.dom()===t.document?w.none():w.from(n.dom().defaultView.frameElement);return e.map($e.fromDom)},Mc=function(n){return Bi(n)},Fc=Object.freeze({__proto__:null,view:Ac,owner:Mc}),Ic=function(n){var e=$e.fromDom(t.document),o=Cc(e),r=Dc(n,Fc);return r.fold(a(fc,n),(function(t){var e=lc(n),r=Q(t,(function(n,t){var e=lc(t);return{left:n.left+e.left(),top:n.top+e.top()}}),{left:0,top:0});return ac(r.left+e.left()+o.left(),r.top+e.top()+o.top())}))},Rc=function(n,t,e){return{point:n,width:t,height:e}},Vc=function(n,t,e,o){return{x:n,y:t,width:e,height:o}},Hc=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},Pc=function(n){var t=fc(n),e=pc(n),o=rc(n);return Hc(t.left(),t.top(),e,o)},zc=function(n){var t=Ic(n),e=pc(n),o=rc(n);return Hc(t.left(),t.top(),e,o)},Nc=function(){return Ec(t.window)};function Lc(n,t,e,o,r){return n(e,o)?w.some(e):R(r)&&r(e)?w.none():t(e,o,r)}var jc,Uc=function(n,t,e){var o=n.dom(),r=R(e)?e:i(!1);while(o.parentNode){o=o.parentNode;var u=$e.fromDom(o);if(t(u))return w.some(u);if(r(u))break}return w.none()},Wc=function(n,t,e){var o=function(n,t){return t(n)};return Lc(o,Uc,n,t,e)},Gc=function(n,t){var e=function(n){for(var o=0;o<n.childNodes.length;o++){var r=$e.fromDom(n.childNodes[o]);if(t(r))return w.some(r);var i=e(n.childNodes[o]);if(i.isSome())return i}return w.none()};return e(n.dom())},Xc=function(n,t,e){return Wc(n,t,e).isSome()},Yc=function(n,t,e){return Uc(n,(function(n){return Qo(n,t)}),e)},qc=function(n,t){return tr(t,n)},Kc=function(n,t,e){var o=function(n,t){return Qo(n,t)};return Lc(o,Yc,n,t,e)},Jc=function(n){var t=Wc(n,(function(n){if(!tu(n))return!1;var t=uu(n,"id");return void 0!==t&&t.indexOf("aria-owns")>-1}));return t.bind((function(n){var t=uu(n,"id"),e=Bi(n);return qc(e,'[aria-owns="'+t+'"]')}))},$c=function(){var n=bu("aria-owns"),t=function(t){ru(t,"aria-owns",n)},e=function(n){su(n,"aria-owns")};return{id:n,link:t,unlink:e}},Qc=function(n,t){return Jc(t).exists((function(t){return Zc(n,t)}))},Zc=function(n,t){return Xc(t,(function(t){return er(t,n.element())}),i(!1))||Qc(n,t)},ns="unknown";(function(n){n[n["STOP"]=0]="STOP",n[n["NORMAL"]=1]="NORMAL",n[n["LOGGING"]=2]="LOGGING"})(jc||(jc={}));var ts,es=Ge({}),os=function(n,e){var o=[],r=(new Date).getTime();return{logEventCut:function(n,t,e){o.push({outcome:"cut",target:t,purpose:e})},logEventStopped:function(n,t,e){o.push({outcome:"stopped",target:t,purpose:e})},logNoParent:function(n,t,e){o.push({outcome:"no-parent",target:t,purpose:e})},logEventNoHandlers:function(n,t){o.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,e){o.push({outcome:"response",purpose:e,target:t})},write:function(){var i=(new Date).getTime();U(["mousemove","mouseover","mouseout",Wr()],n)||t.console.log(n,{event:n,time:i-r,target:e.dom(),sequence:Y(o,(function(n){return U(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+mu(n.target)+")":n.outcome}))})}}},rs=function(n,t,e){var o=Tn(es.get(),n).orThunk((function(){var t=vn(es.get());return pn(t,(function(t){return n.indexOf(t)>-1?w.some(es.get()[t]):w.none()}))})).getOr(jc.NORMAL);switch(o){case jc.NORMAL:return e(ss());case jc.LOGGING:var r=os(n,t),i=e(r);return r.write(),i;case jc.STOP:return!0}},is=["alloy/data/Fields","alloy/debugging/Debugging"],us=function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");return tn(t,(function(n){return n.indexOf("alloy")>0&&!W(is,(function(t){return n.indexOf(t)>-1}))})).getOr(ns)}return ns},as={logEventCut:e,logEventStopped:e,logNoParent:e,logEventNoHandlers:e,logEventResponse:e,write:e},cs=function(n,t,e){return rs(n,t,e)},ss=i(as),fs=i([pe("menu"),pe("selectedMenu")]),ls=i([pe("item"),pe("selectedItem")]),ds=(i(Ht(ls().concat(fs()))),i(Ht(ls()))),ms=ke("initSize",[pe("numColumns"),pe("numRows")]),gs=function(){return ve("markers",ds())},ps=function(){return ke("markers",[pe("backgroundMenu")].concat(fs()).concat(ls()))},vs=function(n){return ke("markers",Y(n,pe))},hs=function(n,t,e){us();return Wt(t,t,e,$t((function(n){return O.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)}))})))},bs=function(n){return hs("onHandler",n,$n(e))},ys=function(n){return hs("onKeyboardHandler",n,$n(w.none))},xs=function(n){return hs("onHandler",n,Zn())},ws=function(n){return hs("onKeyboardHandler",n,Zn())},Ss=function(n,t){return We(n,i(t))},ks=function(n){return We(n,u)},Cs=i(ms),Os=function(n,t,e,o,r,u){return{x:i(n),y:i(t),bubble:i(e),direction:i(o),boundsRestriction:i(r),label:i(u)}},_s=An.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ts=function(n,t,e,o,r,i,u,a,c){return n.fold(t,e,o,r,i,u,a,c)},Es=function(n,t,e,o){return n.fold(t,t,o,o,t,o,e,e)},Bs=function(n,t,e,o){return n.fold(t,o,t,o,e,e,t,o)},Ds=_s.southeast,As=_s.southwest,Ms=_s.northeast,Fs=_s.northwest,Is=_s.south,Rs=_s.north,Vs=_s.east,Hs=_s.west,Ps=function(n,t){switch(t){case 1:return n.x;case 0:return n.x+n.width;case 2:return n.y;case 3:return n.y+n.height}},zs=function(n,t){return sn(["left","right","top","bottom"],(function(e){return Tn(t,e).map((function(t){return Ps(n,t)}))}))},Ns=function(n,t,e){var o=function(n,o){var r="top"===n||"bottom"===n?e.top():e.left();return Tn(t,n).bind(u).bind((function(t){return"left"===n||"top"===n?t>=o?w.some(t):w.none():t<=o?w.some(t):w.none()})).map((function(n){return n+r})).getOr(o)},r=o("left",n.x),i=o("top",n.y),a=o("right",n.right),c=o("bottom",n.bottom);return Hc(r,i,a-r,c-i)},Ls=function(n){return n.x},js=function(n,t){return n.x+n.width/2-t.width/2},Us=function(n,t){return n.x+n.width-t.width},Ws=function(n,t){return n.y-t.height},Gs=function(n){return n.y+n.height},Xs=function(n,t){return n.y+n.height/2-t.height/2},Ys=function(n){return n.x+n.width},qs=function(n,t){return n.x-t.width},Ks=function(n,t,e){return Os(Ls(n),Gs(n),e.southeast(),Ds(),zs(n,{left:1,top:3}),"layout-se")},Js=function(n,t,e){return Os(Us(n,t),Gs(n),e.southwest(),As(),zs(n,{right:0,top:3}),"layout-sw")},$s=function(n,t,e){return Os(Ls(n),Ws(n,t),e.northeast(),Ms(),zs(n,{left:1,bottom:2}),"layout-ne")},Qs=function(n,t,e){return Os(Us(n,t),Ws(n,t),e.northwest(),Fs(),zs(n,{right:0,bottom:2}),"layout-nw")},Zs=function(n,t,e){return Os(js(n,t),Ws(n,t),e.north(),Rs(),zs(n,{bottom:2}),"layout-n")},nf=function(n,t,e){return Os(js(n,t),Gs(n),e.south(),Is(),zs(n,{top:3}),"layout-s")},tf=function(n,t,e){return Os(Ys(n),Xs(n,t),e.east(),Vs(),zs(n,{left:0}),"layout-e")},ef=function(n,t,e){return Os(qs(n,t),Xs(n,t),e.west(),Hs(),zs(n,{right:1}),"layout-w")},of=function(){return[Ks,Js,$s,Qs,nf,Zs,tf,ef]},rf=function(){return[Js,Ks,Qs,$s,nf,Zs,tf,ef]},uf=function(){return[$s,Qs,Ks,Js,Zs,nf]},af=function(){return[Qs,$s,Js,Ks,Zs,nf]},cf=function(){return[Ks,Js,$s,Qs,nf,Zs]},sf=function(){return[Js,Ks,Qs,$s,nf,Zs]},ff=function(n,t,e){return Ei((function(o){e(o,n,t)}))},lf=function(n,t,e){return Ti((function(o,r){e(o,n,t)}))},df=function(n,t,e,o,r,i){var u=Vt(n),a=Me(t,[Fe("config",n)]);return vf(u,a,t,e,o,r,i)},mf=function(n,t,e,o,r,i){var u=n,a=Me(t,[Te("config",n)]);return vf(u,a,t,e,o,r,i)},gf=function(n,t,e){var o=function(o){for(var r=[],u=1;u<arguments.length;u++)r[u-1]=arguments[u];var a=[o].concat(r);return o.config({name:i(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(a,1);return t.apply(void 0,[o,n.config,n.state].concat(e))}))};return Du(o,e,t)},pf=function(n){return{key:n,value:void 0}},vf=function(n,t,e,o,r,i,u){var c=function(n){return Bn(n,e)?n[e]():w.none()},s=yn(r,(function(n,t){return gf(e,n,t)})),f=yn(i,(function(n,t){return Mu(n,t)})),l=m(m(m({},f),s),{revoke:a(pf,e),config:function(t){var o=ee(e+"-config",n,t);return{key:e,value:{config:o,me:l,configAsRaw:Pn((function(){return ee(e+"-config",n,t)})),initialConfig:t,state:u}}},schema:function(){return t},exhibit:function(n,t){return c(n).bind((function(n){return Tn(o,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(Wu({}))},name:function(){return e},handlers:function(n){return c(n).map((function(n){var t=Tn(o,"events").getOr((function(){return{}}));return t(n.config,n.state)})).getOr({})}});return l},hf=function(n){return st(n)},bf=Vt([pe("fields"),pe("name"),Ie("active",{}),Ie("apis",{}),Ie("state",Pu),Ie("extra",{})]),yf=function(n){var t=ee("Creating behaviour: "+n.name,bf,n);return df(t.fields,t.name,t.active,t.apis,t.extra,t.state)},xf=Vt([pe("branchKey"),pe("branches"),pe("name"),Ie("active",{}),Ie("apis",{}),Ie("state",Pu),Ie("extra",{})]),wf=function(n){var t=ee("Creating behaviour: "+n.name,xf,n);return mf(ie(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},Sf=i(void 0),kf=function(n,t){return t.universal()?n:$(n,(function(n){return U(t.channels(),n)}))},Cf=function(n){return li([pi(Hr(),(function(t,e){var o=n.channels,r=vn(o),i=e,u=kf(r,i);q(u,(function(n){var e=o[n],r=e.schema,u=ee("channel["+n+"] data\nReceiver: "+mu(t.element()),r,i.data());e.onReceive(t,u)}))}))])},Of=Object.freeze({__proto__:null,events:Cf}),_f=[ve("channels",Qt(O.value,Vt([xs("onReceive"),Ie("schema",ue())])))],Tf=yf({fields:_f,name:"receiving",active:Of}),Ef=function(n,t){return Wu({classes:[],styles:t.useFixed()?{}:{position:"relative"}})},Bf=Object.freeze({__proto__:null,exhibit:Ef}),Df=function(n){return n.dom().focus()},Af=function(n){return n.dom().blur()},Mf=function(n){var t=Bi(n).dom();return n.dom()===t.activeElement},Ff=function(n){var e=void 0!==n?n.dom():t.document;return w.from(e.activeElement).map($e.fromDom)},If=function(n){return Ff(Bi(n)).filter((function(t){return n.dom().contains(t.dom())}))},Rf=function(n,t){var o=Bi(t),r=Ff(o).bind((function(n){var e=function(t){return er(n,t)};return e(t)?w.some(t):Gc(t,e)})),i=n(t);return r.each((function(n){Ff(o).filter((function(t){return er(t,n)})).fold((function(){Df(n)}),e)})),i},Vf=function(n,t,e,o,r){return{position:i(n),left:i(t),top:i(e),right:i(o),bottom:i(r)}},Hf=function(n,t){var e=function(n){return n+"px"};Aa(n,{position:w.some(t.position()),left:t.left().map(e),top:t.top().map(e),right:t.right().map(e),bottom:t.bottom().map(e)})},Pf=An.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),zf=function(n,t,e,o,r,i){var u=t.x-e,a=t.y-o,c=t.width,s=t.height,f=r-(u+c),l=i-(a+s),d=w.some(u),m=w.some(a),g=w.some(f),p=w.some(l),v=w.none();return Ts(t.direction,(function(){return Vf(n,d,m,v,v)}),(function(){return Vf(n,v,m,g,v)}),(function(){return Vf(n,d,v,v,p)}),(function(){return Vf(n,v,v,g,p)}),(function(){return Vf(n,d,m,v,v)}),(function(){return Vf(n,d,v,v,p)}),(function(){return Vf(n,d,m,v,v)}),(function(){return Vf(n,v,m,g,v)}))},Nf=function(n,t){return n.fold((function(){return Vf("absolute",w.some(t.x),w.some(t.y),w.none(),w.none())}),(function(n,e,o,r){return zf("absolute",t,n,e,o,r)}),(function(n,e,o,r){return zf("fixed",t,n,e,o,r)}))},Lf=function(n,t){var e=a(Ic,t),o=n.fold(e,e,(function(){var n=Cc();return Ic(t).translate(-n.left(),-n.top())})),r=pc(t),i=rc(t);return Hc(o.left(),o.top(),r,i)},jf=function(n,t){return t.fold((function(){return n.fold(Nc,Nc,Hc)}),(function(t){return n.fold(t,t,(function(){var e=t(),o=Uf(n,e.x,e.y);return Hc(o.left(),o.top(),e.width,e.height)}))}))},Uf=function(n,t,e){var o=ac(t,e),r=function(){var n=Cc();return o.translate(-n.left(),-n.top())};return n.fold(i(o),i(o),r)},Wf=function(n,t,e,o){return n.fold(t,e,o)},Gf=(Pf.none,Pf.relative),Xf=Pf.fixed,Yf=function(n,t){return{anchorBox:i(n),origin:i(t)}},qf=function(n,t){return Yf(n,t)},Kf=function(n,t,e,o){var r=n+t;return r>o?e:r<e?o:r},Jf=function(n,t,e){return Math.min(Math.max(n,t),e)},$f=An.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Qf=function(n,t,e,o,r){var i=r.x,u=r.y,a=r.width,c=r.height,s=n>=i,f=t>=u,l=s&&f,d=n+e<=i+a,m=t+o<=u+c,g=d&&m,p=Math.abs(Math.min(e,s?i+a-n:i-(n+e))),v=Math.abs(Math.min(o,f?u+c-t:u-(t+o))),h=Math.max(r.x,r.right-e),b=Math.max(r.y,r.bottom-o),y=Jf(n,r.x,h),x=Jf(t,r.y,b);return{originInBounds:l,sizeInBounds:g,limitX:y,limitY:x,deltaW:p,deltaH:v}},Zf=function(n,t,e,o){var r=n.x(),u=n.y(),a=n.bubble().offset(),c=a.left(),s=a.top(),f=Ns(o,n.boundsRestriction(),a),l=f.y,d=f.bottom,m=f.x,g=f.right,p=r+c,v=u+s,h=Qf(p,v,t,e,f),b=h.originInBounds,y=h.sizeInBounds,x=h.limitX,w=h.limitY,S=h.deltaW,k=h.deltaH,C=i(w+k-l),O=i(d-w),_=Es(n.direction(),O,O,C),T=i(x+S-m),E=i(g-x),B=Bs(n.direction(),E,E,T),D={x:x,y:w,width:S,height:k,maxHeight:_,maxWidth:B,direction:n.direction(),classes:{on:n.bubble().classesOn(),off:n.bubble().classesOff()},label:n.label(),candidateYforTest:v};return b&&y?$f.fit(D):$f.nofit(D,S,k)},nl=function(n,t,e,o,r){var i=e.width,c=e.height,s=function(n,u,a,s){var f=n(t,e,o),l=Zf(f,i,c,r);return l.fold($f.fit,(function(n,t,e){var o=e>s||t>a;return o?$f.nofit(n,t,e):$f.nofit(u,a,s)}))},f=Z(n,(function(n,t){var e=a(s,t);return n.fold($f.fit,e)}),$f.nofit({x:t.x,y:t.y,width:e.width,height:e.height,maxHeight:e.height,maxWidth:e.width,direction:Ds(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y},-1,-1));return f.fold(u,u)},tl=function(n){return{width:pc(n),height:rc(n)}},el=function(n,t,e,o){Ha(t,"max-height"),Ha(t,"max-width");var r=tl(t);return nl(o.preference,n,r,e,o.bounds)},ol=function(n,t){var e=t.classes;Sa(n,e.off),wa(n,e.on)},rl=function(n,t,e){var o=e.maxHeightFunction;o(n,t.maxHeight)},il=function(n,t,e){var o=e.maxWidthFunction;o(n,t.maxWidth)},ul=function(n,t,e){Hf(n,Nf(e.origin,t))},al=function(n,t){ic(n,Math.floor(t))},cl=i((function(n,t){al(n,t),Da(n,{"overflow-x":"hidden","overflow-y":"auto"})})),sl=i((function(n,t){al(n,t)})),fl=function(n,t,e){return void 0===n[t]?e:n[t]},ll=function(n,t,o,r,i,u){var a=fl(u,"maxHeightFunction",cl()),c=fl(u,"maxWidthFunction",e),s=n.anchorBox(),f=n.origin(),l={bounds:jf(f,i),origin:f,preference:r,maxHeightFunction:a,maxWidthFunction:c};dl(s,t,o,l)},dl=function(n,t,e,o){var r=el(n,t,e,o);ul(t,r,o),ol(t,r),rl(t,r,o),il(t,r,o)},ml=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],gl=function(n,t,e){var o=function(n){return Tn(e,n).getOr([])},r=function(n,t,e){var r=cn(ml,e);return{offset:function(){return ac(n,t)},classesOn:function(){return rn(e,o)},classesOff:function(){return rn(r,o)}}};return{southeast:function(){return r(-n,t,["top","alignLeft"])},southwest:function(){return r(n,t,["top","alignRight"])},south:function(){return r(-n/2,t,["top","alignCentre"])},northeast:function(){return r(-n,-t,["bottom","alignLeft"])},northwest:function(){return r(n,-t,["bottom","alignRight"])},north:function(){return r(-n/2,-t,["bottom","alignCentre"])},east:function(){return r(n,-t/2,["valignCentre","left"])},west:function(){return r(-n,-t/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,t,["top","alignRight"])},innerNortheast:function(){return r(n,t,["top","alignLeft"])},innerNorth:function(){return r(-n/2,t,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-t,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-t,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-t,["bottom","alignCentre"])},innerWest:function(){return r(n,-t/2,["valignCentre","right"])},innerEast:function(){return r(-n,-t/2,["valignCentre","left"])}}},pl=function(){return gl(0,0,{})},vl=function(n){return n},hl=function(n,t){return function(e){return"rtl"===bl(e)?t:n}},bl=function(n){return"rtl"===Ma(n,"direction")?"rtl":"ltr"};(function(n){n["TopToBottom"]="toptobottom",n["BottomToTop"]="bottomtotop"})(ts||(ts={}));var yl="data-alloy-vertical-dir",xl=function(n){return Xc(n,(function(n){return tu(n)&&uu(n,yl)===ts.BottomToTop}))},wl=function(){return Me("layouts",[pe("onLtr"),pe("onRtl"),_e("onBottomLtr"),_e("onBottomRtl")])},Sl=function(n,t,e,o,r,i,u){var a=u.map(xl).getOr(!1),c=t.layouts.map((function(t){return t.onLtr(n)})),s=t.layouts.map((function(t){return t.onRtl(n)})),f=a?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(n)}))})).or(c).getOr(r):c.getOr(e),l=a?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(n)}))})).or(s).getOr(i):s.getOr(o),d=hl(f,l);return d(n)},kl=function(n,t,e){var o=t.hotspot,r=Lf(e,o.element()),i=Sl(n.element(),t,cf(),sf(),uf(),af(),w.some(t.hotspot.element()));return w.some(vl({anchorBox:r,bubble:t.bubble.getOr(pl()),overrides:t.overrides,layouts:i,placer:w.none()}))},Cl=[pe("hotspot"),_e("bubble"),Ie("overrides",{}),wl(),Ss("placement",kl)],Ol=function(n,t,e){var o=Uf(e,t.x,t.y),r=Hc(o.left(),o.top(),t.width,t.height),i=Sl(n.element(),t,of(),rf(),of(),rf(),w.none());return w.some(vl({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:i,placer:w.none()}))},_l=[pe("x"),pe("y"),Ie("height",0),Ie("width",0),Ie("bubble",pl()),Ie("overrides",{}),wl(),Ss("placement",Ol)],Tl="\ufeff",El="",Bl=function(n,t,e,o){return{start:i(n),soffset:i(t),finish:i(e),foffset:i(o)}},Dl={create:Bl},Al=An.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ml=function(n,t,e,o){return n.fold(t,e,o)},Fl=function(n){return n.fold(u,u,u)},Il=Al.before,Rl=Al.on,Vl=Al.after,Hl={before:Il,on:Rl,after:Vl,cata:Ml,getStart:Fl},Pl=An.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),zl=function(n){return Pl.exact(n.start(),n.soffset(),n.finish(),n.foffset())},Nl=function(n){return n.match({domRange:function(n){return $e.fromDom(n.startContainer)},relative:function(n,t){return Hl.getStart(n)},exact:function(n,t,e,o){return n}})},Ll=Pl.domRange,jl=Pl.relative,Ul=Pl.exact,Wl=function(n){var t=Nl(n);return Ai(t)},Gl=Dl.create,Xl={domRange:Ll,relative:jl,exact:Ul,exactFromRange:zl,getWin:Wl,range:Gl},Yl=function(n,t){t.fold((function(t){n.setStartBefore(t.dom())}),(function(t,e){n.setStart(t.dom(),e)}),(function(t){n.setStartAfter(t.dom())}))},ql=function(n,t){t.fold((function(t){n.setEndBefore(t.dom())}),(function(t,e){n.setEnd(t.dom(),e)}),(function(t){n.setEndAfter(t.dom())}))},Kl=function(n,t,e){var o=n.document.createRange();return Yl(o,t),ql(o,e),o},Jl=function(n,t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(o.dom(),r),i},$l=function(n){return{left:i(n.left),top:i(n.top),right:i(n.right),bottom:i(n.bottom),width:i(n.width),height:i(n.height)}},Ql=function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?w.some(e).map($l):w.none()},Zl=An.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),nd=function(n,t,e){return t($e.fromDom(e.startContainer),e.startOffset,$e.fromDom(e.endContainer),e.endOffset)},td=function(n,t){return t.match({domRange:function(n){return{ltr:i(n),rtl:w.none}},relative:function(t,e){return{ltr:Pn((function(){return Kl(n,t,e)})),rtl:Pn((function(){return w.some(Kl(n,e,t))}))}},exact:function(t,e,o,r){return{ltr:Pn((function(){return Jl(n,t,e,o,r)})),rtl:Pn((function(){return w.some(Jl(n,o,r,t,e))}))}}})},ed=function(n,t){var e=t.ltr();if(e.collapsed){var o=t.rtl().filter((function(n){return!1===n.collapsed}));return o.map((function(n){return Zl.rtl($e.fromDom(n.endContainer),n.endOffset,$e.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return nd(n,Zl.ltr,e)}))}return nd(n,Zl.ltr,e)},od=function(n,t){var e=td(n,t);return ed(n,e)},rd=function(n,t){var e=od(n,t);return e.match({ltr:function(t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(o.dom(),r),i},rtl:function(t,e,o,r){var i=n.document.createRange();return i.setStart(o.dom(),r),i.setEnd(t.dom(),e),i}})};Zl.ltr,Zl.rtl;function id(n,t){var e=function(e){if(!n(e))throw new Error("Can only get "+t+" value of a "+t+" node");return o(e).getOr("")},o=function(t){return n(t)?w.from(t.dom().nodeValue):w.none()},r=function(e,o){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom().nodeValue=o};return{get:e,getOption:o,set:r}}var ud=id(eu,"text"),ad=function(n){return ud.get(n)},cd=function(n){return ud.getOption(n)},sd=function(n){return"img"===Qi(n)?1:cd(n).fold((function(){return Ri(n).length}),(function(n){return n.length}))},fd=function(n){return cd(n).filter((function(n){return 0!==n.trim().length||n.indexOf(El)>-1})).isSome()},ld=["img","br"],dd=function(n){var t=fd(n);return t||U(ld,Qi(n))},md=function(n){return gd(n,dd)},gd=function(n,t){var e=function(n){for(var o=Ri(n),r=o.length-1;r>=0;r--){var i=o[r];if(t(i))return w.some(i);var u=e(i);if(u.isSome())return u}return w.none()};return e(n)},pd=function(n,t){return nr(t,n)},vd=function(n,t,e,o){var r=Bi(n),i=r.dom().createRange();return i.setStart(n.dom(),t),i.setEnd(e.dom(),o),i},hd=function(n,t,e,o){var r=vd(n,t,e,o),i=er(n,e)&&t===o;return r.collapsed&&!i},bd=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return w.some(Dl.create($e.fromDom(t.startContainer),t.startOffset,$e.fromDom(e.endContainer),e.endOffset))}return w.none()},yd=function(n){var t=$e.fromDom(n.anchorNode),e=$e.fromDom(n.focusNode);return hd(t,n.anchorOffset,e,n.focusOffset)?w.some(Dl.create(t,n.anchorOffset,e,n.focusOffset)):bd(n)},xd=function(n){return w.from(n.getSelection()).filter((function(n){return n.rangeCount>0})).bind(yd)},wd=function(n,t){var e=rd(n,t);return Ql(e)},Sd=function(n,t){return{element:n,offset:t}},kd=function(n,t){var e=Ri(n);if(0===e.length)return Sd(n,t);if(t<e.length)return Sd(e[t],0);var o=e[e.length-1],r=eu(o)?ad(o).length:Ri(o).length;return Sd(o,r)},Cd=An.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Od=function(n){return n.fold(u,(function(n,t,e){return n.translate(-t,-e)}))},_d=function(n){return n.fold(u,u)},Td=function(n){return Z(n,(function(n,t){return n.translate(t.left(),t.top())}),ac(0,0))},Ed=function(n){var t=Y(n,Od);return Td(t)},Bd=function(n){var t=Y(n,_d);return Td(t)},Dd=Cd.screen,Ad=Cd.absolute,Md=function(n,t,e){var o=Ai(e.root).dom(),r=function(t){var e=Bi(t),o=Bi(n.element());return er(e,o)};return w.from(o.frameElement).map($e.fromDom).filter(r).map(fc)},Fd=function(n,t,e){var o=Bi(n.element()),r=Cc(o),i=Md(n,t,e).getOr(r);return Ad(i,r.left(),r.top())},Id=function(n,t,e,o){var r=n,i=t,u=e,a=o;n<0&&(r=0,u=e+n),t<0&&(i=0,a=o+t);var c=Dd(ac(r,i));return w.some(Rc(c,u,a))},Rd=function(n,t,e,o,r){return n.map((function(n){var i=[t,n.point],u=Wf(o,(function(){return Bd(i)}),(function(){return Bd(i)}),(function(){return Ed(i)})),a=Vc(u.left(),u.top(),n.width,n.height),c=e.showAbove?uf():cf(),s=(e.showAbove,sf()),f=Sl(r,e,c,s,c,s,w.none());return vl({anchorBox:a,bubble:e.bubble.getOr(pl()),overrides:e.overrides,layouts:f,placer:w.none()})}))},Vd=function(n,t){return{element:n,offset:t}},Hd=function(n,t){return eu(n)?Vd(n,t):kd(n,t)},Pd=function(n,t){var e=t.getSelection.getOrThunk((function(){return function(){return xd(n)}}));return e().map((function(n){var t=Hd(n.start(),n.soffset()),e=Hd(n.finish(),n.foffset());return Xl.range(t.element,t.offset,e.element,e.offset)}))},zd=function(n,t,e){var o=Ai(t.root).dom(),r=Fd(n,e,t),i=Pd(o,t).bind((function(n){var t=wd(o,Xl.exactFromRange(n)).orThunk((function(){var t=$e.fromText(Tl);return Pi(n.start(),t),wd(o,Xl.exact(t,0,t,1)).map((function(n){return Xi(t),n}))}));return t.bind((function(n){return Id(n.left(),n.top(),n.width(),n.height())}))})),u=Pd(o,t).bind((function(n){return tu(n.start())?w.some(n.start()):Mi(n.start())})),a=u.getOr(n.element());return Rd(i,r,t,e,a)},Nd=[_e("getSelection"),pe("root"),_e("bubble"),wl(),Ie("overrides",{}),Ie("showAbove",!1),Ss("placement",zd)],Ld=function(n,t,e){var o=Fd(n,e,t);return t.node.bind((function(r){var i=r.dom().getBoundingClientRect(),u=Id(i.left,i.top,i.width,i.height),a=t.node.getOr(n.element());return Rd(u,o,t,e,a)}))},jd=[pe("node"),pe("root"),_e("bubble"),wl(),Ie("overrides",{}),Ie("showAbove",!1),Ss("placement",Ld)],Ud=function(n){return n.x+n.width},Wd=function(n,t){return n.x-t.width},Gd=function(n,t){return n.y-t.height+n.height},Xd=function(n){return n.y},Yd=function(n,t,e){return Os(Ud(n),Xd(n),e.southeast(),Ds(),zs(n,{left:0,top:2}),"link-layout-se")},qd=function(n,t,e){return Os(Wd(n,t),Xd(n),e.southwest(),As(),zs(n,{right:1,top:2}),"link-layout-sw")},Kd=function(n,t,e){return Os(Ud(n),Gd(n,t),e.northeast(),Ms(),zs(n,{left:0,bottom:3}),"link-layout-ne")},Jd=function(n,t,e){return Os(Wd(n,t),Gd(n,t),e.northwest(),Fs(),zs(n,{right:1,bottom:3}),"link-layout-nw")},$d=function(){return[Yd,qd,Kd,Jd]},Qd=function(){return[qd,Yd,Jd,Kd]},Zd=function(n,t,e){var o=Lf(e,t.item.element()),r=Sl(n.element(),t,$d(),Qd(),$d(),Qd(),w.none());return w.some(vl({anchorBox:o,bubble:pl(),overrides:t.overrides,layouts:r,placer:w.none()}))},nm=[pe("item"),wl(),Ie("overrides",{}),Ss("placement",Zd)],tm=ie("anchor",{selection:Nd,node:jd,hotspot:Cl,submenu:nm,makeshift:_l}),em=function(){var n=t.document.documentElement;return Xf(0,0,n.clientWidth,n.clientHeight)},om=function(n){var t=fc(n.element()),e=n.element().dom().getBoundingClientRect();return Gf(t.left(),t.top(),e.width,e.height)},rm=function(n,t,e,o,r){var i=qf(e.anchorBox,t);ll(i,r.element(),e.bubble,e.layouts,o,e.overrides)},im=function(n,t,e,o,r){um(n,t,e,o,r,w.none())},um=function(n,t,e,o,r,i){var u=i.map(Pc);return am(n,t,e,o,r,u)},am=function(n,t,e,o,r,u){var a=ee("positioning anchor.info",tm,o);Rf((function(){Ba(r.element(),"position","fixed");var e=Ia(r.element(),"visibility");Ba(r.element(),"visibility","hidden");var o=t.useFixed()?em():om(n),c=a.placement,s=u.map(i).or(t.getBounds);c(n,a,o).each((function(t){var e=t.placer.getOr(rm);e(n,o,t,s,r)})),e.fold((function(){Ha(r.element(),"visibility")}),(function(n){Ba(r.element(),"visibility",n)})),Ia(r.element(),"left").isNone()&&Ia(r.element(),"top").isNone()&&Ia(r.element(),"right").isNone()&&Ia(r.element(),"bottom").isNone()&&Ia(r.element(),"position").is("fixed")&&Ha(r.element(),"position")}),r.element())},cm=function(n,t,e){return t.useFixed()?"fixed":"absolute"},sm=Object.freeze({__proto__:null,position:im,positionWithin:um,positionWithinBounds:am,getMode:cm}),fm=[Ie("useFixed",f),_e("getBounds")],lm=yf({fields:fm,name:"positioning",active:Bf,apis:sm}),dm=function(n){ii(n,Jr());var t=n.components();q(t,dm)},mm=function(n){var t=n.components();q(t,mm),ii(n,Kr())},gm=function(n,t){Li(n.element(),t.element())},pm=function(n){q(n.components(),(function(n){return Xi(n.element())})),Gi(n.element()),n.syncComponents()},vm=function(n,t){var e=n.components();pm(n);var o=cn(e,t);q(o,(function(t){dm(t),n.getSystem().removeFromWorld(t)})),q(t,(function(t){t.getSystem().isConnected()?gm(n,t):(n.getSystem().addToWorld(t),gm(n,t),Ca(n.element())&&mm(t)),n.syncComponents()}))},hm=function(n,t){bm(n,t,Li)},bm=function(n,t,e){n.getSystem().addToWorld(t),e(n.element(),t.element()),Ca(n.element())&&mm(t),n.syncComponents()},ym=function(n){dm(n),Xi(n.element()),n.getSystem().removeFromWorld(n)},xm=function(n){var t=Mi(n.element()).bind((function(t){return n.getSystem().getByDom(t).toOption()}));ym(n),t.each((function(n){n.syncComponents()}))},wm=function(n){var t=n.components();q(t,ym),Gi(n.element()),n.syncComponents()},Sm=function(n,t){Cm(n,t,Li)},km=function(n,t){Cm(n,t,zi)},Cm=function(n,t,e){e(n,t.element());var o=Ri(t.element());q(o,(function(n){t.getByDom(n).each(mm)}))},Om=function(n){var t=Ri(n.element());q(t,(function(t){n.getByDom(t).each(dm)})),Xi(n.element())},_m=function(n,t,e,o){e.get().each((function(t){wm(n)}));var r=t.getAttachPoint(n);hm(r,n);var i=n.getSystem().build(o);return hm(n,i),e.set(i),i},Tm=function(n,t,e,o){var r=_m(n,t,e,o);return t.onOpen(n,r),r},Em=function(n,t,e,o){return e.get().map((function(){return _m(n,t,e,o)}))},Bm=function(n,t,e,o,r){Vm(n,t),Tm(n,t,e,o),r(),Pm(n,t)},Dm=function(n,t,e){e.get().each((function(o){wm(n),xm(n),t.onClose(n,o),e.clear()}))},Am=function(n,t,e){return e.isOpen()},Mm=function(n,t,e,o){return Am(n,t,e)&&e.get().exists((function(e){return t.isPartOf(n,e,o)}))},Fm=function(n,t,e){return e.get()},Im=function(n,t,e,o){Ia(n.element(),t).fold((function(){su(n.element(),e)}),(function(t){ru(n.element(),e,t)})),Ba(n.element(),t,o)},Rm=function(n,t,e){au(n.element(),e).fold((function(){return Ha(n.element(),t)}),(function(e){return Ba(n.element(),t,e)}))},Vm=function(n,t,e){var o=t.getAttachPoint(n);Ba(n.element(),"position",lm.getMode(o)),Im(n,"visibility",t.cloakVisibilityAttr,"hidden")},Hm=function(n){return W(["top","left","right","bottom"],(function(t){return Ia(n,t).isSome()}))},Pm=function(n,t,e){Hm(n.element())||Ha(n.element(),"position"),Rm(n,"visibility",t.cloakVisibilityAttr)},zm=Object.freeze({__proto__:null,cloak:Vm,decloak:Pm,open:Tm,openWhileCloaked:Bm,close:Dm,isOpen:Am,isPartOf:Mm,getState:Fm,setContent:Em}),Nm=function(n,t){return li([pi(jr(),(function(e,o){Dm(e,n,t)}))])},Lm=Object.freeze({__proto__:null,events:Nm}),jm=[bs("onOpen"),bs("onClose"),pe("isPartOf"),pe("getAttachPoint"),Ie("cloakVisibilityAttr","data-precloak-visibility")],Um=function(){var n=Ge(w.none()),t=i("not-implemented"),e=function(){return n.get().isSome()},o=function(t){n.set(w.some(t))},r=function(){return n.get()},u=function(){n.set(w.none())};return zu({readState:t,isOpen:e,clear:u,set:o,get:r})},Wm=Object.freeze({__proto__:null,init:Um}),Gm=yf({fields:jm,name:"sandboxing",active:Lm,apis:zm,state:Wm}),Xm=i("dismiss.popups"),Ym=i("reposition.popups"),qm=i("mouse.released"),Km=Vt([Ie("isExtraPart",i(!1)),Me("fireEventInstead",[Ie("event",$r())])]),Jm=function(n){var t,e=ee("Dismissal",Km,n);return t={},t[Xm()]={schema:Vt([pe("target")]),onReceive:function(n,t){if(Gm.isOpen(n)){var o=Gm.isPartOf(n,t.target)||e.isExtraPart(n,t.target);o||e.fireEventInstead.fold((function(){return Gm.close(n)}),(function(t){return ii(n,t.event)}))}}},t},$m=Vt([Me("fireEventInstead",[Ie("event",Qr())]),we("doReposition")]),Qm=function(n){var t,e=ee("Reposition",$m,n);return t={},t[Ym()]={onReceive:function(n){Gm.isOpen(n)&&e.fireEventInstead.fold((function(){return e.doReposition(n)}),(function(t){return ii(n,t.event)}))}},t},Zm=function(n,t,e){t.store.manager.onLoad(n,t,e)},ng=function(n,t,e){t.store.manager.onUnload(n,t,e)},tg=function(n,t,e,o){t.store.manager.setValue(n,t,e,o)},eg=function(n,t,e){return t.store.manager.getValue(n,t,e)},og=function(n,t,e){return e},rg=Object.freeze({__proto__:null,onLoad:Zm,onUnload:ng,setValue:tg,getValue:eg,getState:og}),ig=function(n,t){var e=n.resetOnDom?[Oi((function(e,o){Zm(e,n,t)})),_i((function(e,o){ng(e,n,t)}))]:[lf(n,t,Zm)];return li(e)},ug=Object.freeze({__proto__:null,events:ig}),ag=function(){var n=Ge(null),t=function(){return{mode:"memory",value:n.get()}},e=function(){return null===n.get()},o=function(){n.set(null)};return zu({set:n.set,get:n.get,isNotSet:e,clear:o,readState:t})},cg=function(){var n=function(){};return zu({readState:n})},sg=function(){var n=Ge({}),t=Ge({}),e=function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},o=function(){n.set({}),t.set({})},r=function(e){return Tn(n.get(),e).orThunk((function(){return Tn(t.get(),e)}))},i=function(e){var o=n.get(),r=t.get(),i={},u={};q(e,(function(n){i[n.value]=n,Tn(n,"meta").each((function(t){Tn(t,"text").each((function(t){u[t]=n}))}))})),n.set(m(m({},o),i)),t.set(m(m({},r),u))};return zu({readState:e,lookup:r,update:i,clear:o})},fg=function(n){return n.store.manager.state(n)},lg=Object.freeze({__proto__:null,memory:ag,dataset:sg,manual:cg,init:fg}),dg=function(n,t,e,o){var r=t.store;e.update([o]),r.setValue(n,o),t.onSetValue(n,o)},mg=function(n,t,e){var o=t.store,r=o.getDataKey(n);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(n){return n}))},gg=function(n,t,e){var o=t.store;o.initialValue.each((function(o){dg(n,t,e,o)}))},pg=function(n,t,e){e.clear()},vg=[_e("initialValue"),pe("getFallbackEntry"),pe("getDataKey"),pe("setValue"),Ss("manager",{setValue:dg,getValue:mg,onLoad:gg,onUnload:pg,state:sg})],hg=function(n,t,e){return t.store.getValue(n)},bg=function(n,t,e,o){t.store.setValue(n,o),t.onSetValue(n,o)},yg=function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},xg=[pe("getValue"),Ie("setValue",e),_e("initialValue"),Ss("manager",{setValue:bg,getValue:hg,onLoad:yg,onUnload:e,state:Pu.init})],wg=function(n,t,e,o){e.set(o),t.onSetValue(n,o)},Sg=function(n,t,e){return e.get()},kg=function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},Cg=function(n,t,e){e.clear()},Og=[_e("initialValue"),Ss("manager",{setValue:wg,getValue:Sg,onLoad:kg,onUnload:Cg,state:ag})],_g=[Re("store",{mode:"memory"},ie("mode",{memory:Og,manual:xg,dataset:vg})),bs("onSetValue"),Ie("resetOnDom",!1)],Tg=yf({fields:_g,name:"representing",active:ug,apis:rg,extra:{setValueFrom:function(n,t){var e=Tg.getValue(t);Tg.setValue(n,e)}},state:lg}),Eg=function(n,t){return Ue(n,{},Y(t,(function(t){return Se(t.name(),"Cannot configure "+t.name()+" for "+n)})).concat([We("dump",u)]))},Bg=function(n){return n.dump},Dg=function(n,t){return m(m({},n.dump),hf(t))},Ag={field:Eg,augment:Dg,get:Bg},Mg="placeholder",Fg=An.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Ig=function(n){return En(n,"uiType")},Rg=function(n,t,e,o){return n.exists((function(n){return n!==e.owner}))?Fg.single(!0,i(e)):Tn(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+vn(o)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))},Vg=function(n,t,e,o){return Ig(e)&&e.uiType===Mg?Rg(n,t,e,o):Fg.single(!1,i(e))},Hg=function(n,t,e,o){var r=Vg(n,t,e,o);return r.fold((function(r,i){var u=Ig(e)?i(t,e.config,e.validated):i(t),a=Tn(u,"components").getOr([]),c=rn(a,(function(e){return Hg(n,t,e,o)}));return[m(m({},u),{components:c})]}),(function(n,o){if(Ig(e)){var r=o(t,e.config,e.validated),i=e.validated.preprocess.getOr(u);return i(r)}return o(t)}))},Pg=function(n,t,e,o){return rn(e,(function(e){return Hg(n,t,e,o)}))},zg=function(n,t){var e=!1,o=function(){return e},r=function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,t},u=function(){return t.fold((function(n,t){return n}),(function(n,t){return n}))};return{name:i(n),required:u,used:o,replace:r}},Ng=function(n,t,e,o){var r=yn(o,(function(n,t){return zg(t,n)})),i=Pg(n,t,e,r);return bn(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),i},Lg=Fg.single,jg=Fg.multiple,Ug=i(Mg),Wg=An.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Gg=Ie("factory",{sketch:u}),Xg=Ie("schema",[]),Yg=pe("name"),qg=Wt("pname","pname",tt((function(n){return"<alloy."+bu(n.name)+">"})),ue()),Kg=We("schema",(function(){return[_e("preprocess")]})),Jg=Ie("defaults",i({})),$g=Ie("overrides",i({})),Qg=Ht([Gg,Xg,Yg,qg,Jg,$g]),Zg=Ht([Gg,Xg,Yg,Jg,$g]),np=Ht([Gg,Xg,Yg,qg,Jg,$g]),tp=Ht([Gg,Kg,Yg,pe("unit"),qg,Jg,$g]),ep=function(n){return n.fold(w.some,w.none,w.some,w.some)},op=function(n){var t=function(n){return n.name};return n.fold(t,t,t,t)},rp=function(n){return n.fold(u,u,u,u)},ip=function(n,t){return function(e){var o=ee("Converting part type",t,e);return n(o)}},up=ip(Wg.required,Qg),ap=ip(Wg.external,Zg),cp=ip(Wg.optional,np),sp=ip(Wg.group,tp),fp=i("entirety"),lp=Object.freeze({__proto__:null,required:up,external:ap,optional:cp,group:sp,asNamedPart:ep,name:op,asCommon:rp,original:fp}),dp=function(n,t,e,o){return Vn(t.defaults(n,e,o),e,{uid:n.partUids[t.name]},t.overrides(n,e,o))},mp=function(n,t,e){var o={},r={};return q(e,(function(n){n.fold((function(n){o[n.pname]=Lg(!0,(function(t,e,o){return n.factory.sketch(dp(t,n,e,o))}))}),(function(n){var e=t.parts[n.name];r[n.name]=i(n.factory.sketch(dp(t,n,e[fp()]),e))}),(function(n){o[n.pname]=Lg(!1,(function(t,e,o){return n.factory.sketch(dp(t,n,e,o))}))}),(function(n){o[n.pname]=jg(!0,(function(t,e,o){var r=t[n.name];return Y(r,(function(e){return n.factory.sketch(Vn(n.defaults(t,e,o),e,n.overrides(t,e)))}))}))}))})),{internals:i(o),externals:i(r)}},gp=function(n,t){var e={};return q(t,(function(t){ep(t).each((function(t){var o=pp(n,t.pname);e[t.name]=function(e){var r=ee("Part: "+t.name+" in "+n,Ht(t.schema),e);return m(m({},o),{config:e,validated:r})}}))})),e},pp=function(n,t){return{uiType:Ug(),owner:n,name:t}},vp=function(n,t,e){return{uiType:Ug(),owner:n,name:t,config:e,validated:{}}},hp=function(n){return rn(n,(function(n){return n.fold(w.none,w.some,w.none,w.none).map((function(n){return ke(n.name,n.schema.concat([ks(fp())]))})).toArray()}))},bp=function(n){return Y(n,op)},yp=function(n,t,e){return mp(n,t,e)},xp=function(n,t,e){return Ng(w.some(n),t,t.components,e)},wp=function(n,t,e){var o=t.partUids[e];return n.getSystem().getByUid(o).toOption()},Sp=function(n,t,e){return wp(n,t,e).getOrDie("Could not find part: "+e)},kp=function(n,t,e){var o={},r=t.partUids,u=n.getSystem();return q(e,(function(n){o[n]=i(u.getByUid(r[n]))})),o},Cp=function(n,t){var e=n.getSystem();return yn(t.partUids,(function(n,t){return i(e.getByUid(n))}))},Op=function(n){return vn(n.partUids)},_p=function(n,t,e){var o={},r=t.partUids,u=n.getSystem();return q(e,(function(n){o[n]=i(u.getByUid(r[n]).getOrDie())})),o},Tp=function(n,t){var e=bp(t);return st(Y(e,(function(t){return{key:t,value:n+"-"+t}})))},Ep=function(n){return Wt("partUids","partUids",et((function(t){return Tp(t.uid,n)})),ue())},Bp=Object.freeze({__proto__:null,generate:gp,generateOne:vp,schemas:hp,names:bp,substitutes:yp,components:xp,defaultUids:Tp,defaultUidsSchema:Ep,getAllParts:Cp,getAllPartNames:Op,getPart:wp,getPartOrDie:Sp,getParts:kp,getPartsOrDie:_p}),Dp=function(n,t){var e=n.length>0?[ke("parts",n)]:[];return e.concat([pe("uid"),Ie("dom",{}),Ie("components",[]),ks("originalSpec"),Ie("debug.sketcher",{})]).concat(t)},Ap=function(n,t,e,o,r){var i=Dp(o,r);return ee(n+" [SpecSchema]",Vt(i.concat(t)),e)},Mp=function(n,t,e,o){var r=Rp(o),i=Ap(n,t,r,[],[]);return e(i,r)},Fp=function(n,t,e,o,r){var i=Rp(r),u=hp(e),a=Ep(e),c=Ap(n,t,i,u,[a]),s=yp(n,c,e),f=xp(n,c,s.internals());return o(c,f,i,s.externals())},Ip=function(n){return En(n,"uid")},Rp=function(n){return Ip(n)?n:m(m({},n),{uid:_u("uid")})};function Vp(n){return void 0!==n.uid}var Hp,Pp=Vt([pe("name"),pe("factory"),pe("configFields"),Ie("apis",{}),Ie("extraApis",{})]),zp=Vt([pe("name"),pe("factory"),pe("configFields"),pe("partFields"),Ie("apis",{}),Ie("extraApis",{})]),Np=function(n){var t=ee("Sketcher for "+n.name,Pp,n),e=function(n){return Mp(t.name,t.configFields,t.factory,n)},o=yn(t.apis,Hu),r=yn(t.extraApis,(function(n,t){return Mu(n,t)}));return m(m({name:i(t.name),configFields:i(t.configFields),sketch:e},o),r)},Lp=function(n){var t=ee("Sketcher for "+n.name,zp,n),e=function(n){return Fp(t.name,t.configFields,t.partFields,t.factory,n)},o=gp(t.name,t.partFields),r=yn(t.apis,Hu),u=yn(t.extraApis,(function(n,t){return Mu(n,t)}));return m(m({name:i(t.name),partFields:i(t.partFields),configFields:i(t.configFields),sketch:e,parts:i(o)},r),u)},jp=function(n){for(var t=[],e=function(n){t.push(n)},o=0;o<n.length;o++)n[o].each(e);return t},Up=function(n){for(var t=[],e=0;e<n.length;e++){var o=n[e];if(!o.isSome())return w.none();t.push(o.getOrDie())}return w.some(t)},Wp=function(n,t,e){return n.isSome()&&t.isSome()?w.some(e(n.getOrDie(),t.getOrDie())):w.none()},Gp=function(n,t,e,o){return n.isSome()&&t.isSome()&&e.isSome()?w.some(o(n.getOrDie(),t.getOrDie(),e.getOrDie())):w.none()},Xp=function(n){return"input"===Qi(n)&&"radio"!==uu(n,"type")||"textarea"===Qi(n)},Yp=function(n,t,e){return t.find(n)},qp=Object.freeze({__proto__:null,getCurrent:Yp}),Kp=[pe("find")],Jp=yf({fields:Kp,name:"composing",apis:qp}),$p=function(n,t,e,o){var r=pd(n.element(),"."+t.highlightClass);q(r,(function(e){W(o,(function(n){return n.element()===e}))||(ya(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),ii(e,ri())})))}))},Qp=function(n,t,e){return $p(n,t,e,[])},Zp=function(n,t,e,o){iv(n,t,e,o)&&(ya(o.element(),t.highlightClass),t.onDehighlight(n,o),ii(o,ri()))},nv=function(n,t,e,o){$p(n,t,e,[o]),iv(n,t,e,o)||(ha(o.element(),t.highlightClass),t.onHighlight(n,o),ii(o,oi()))},tv=function(n,t,e){cv(n,t).each((function(o){nv(n,t,e,o)}))},ev=function(n,t,e){sv(n,t).each((function(o){nv(n,t,e,o)}))},ov=function(n,t,e,o){av(n,t,e,o).fold((function(n){throw new Error(n)}),(function(o){nv(n,t,e,o)}))},rv=function(n,t,e,o){var r=mv(n,t),i=tn(r,o);i.each((function(o){nv(n,t,e,o)}))},iv=function(n,t,e,o){return xa(o.element(),t.highlightClass)},uv=function(n,t,e){return qc(n.element(),"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOption()}))},av=function(n,t,e,o){var r=pd(n.element(),"."+t.itemClass);return w.from(r[o]).fold((function(){return O.error("No element found with index "+o)}),n.getSystem().getByDom)},cv=function(n,t,e){return qc(n.element(),"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOption()}))},sv=function(n,t,e){var o=pd(n.element(),"."+t.itemClass),r=o.length>0?w.some(o[o.length-1]):w.none();return r.bind((function(t){return n.getSystem().getByDom(t).toOption()}))},fv=function(n,t,e,o){var r=pd(n.element(),"."+t.itemClass),i=en(r,(function(n){return xa(n,t.highlightClass)}));return i.bind((function(t){var e=Kf(t,o,0,r.length-1);return n.getSystem().getByDom(r[e]).toOption()}))},lv=function(n,t,e){return fv(n,t,e,-1)},dv=function(n,t,e){return fv(n,t,e,1)},mv=function(n,t,e){var o=pd(n.element(),"."+t.itemClass);return jp(Y(o,(function(t){return n.getSystem().getByDom(t).toOption()})))},gv=Object.freeze({__proto__:null,dehighlightAll:Qp,dehighlight:Zp,highlight:nv,highlightFirst:tv,highlightLast:ev,highlightAt:ov,highlightBy:rv,isHighlighted:iv,getHighlighted:uv,getFirst:cv,getLast:sv,getPrevious:lv,getNext:dv,getCandidates:mv}),pv=[pe("highlightClass"),pe("itemClass"),bs("onHighlight"),bs("onDehighlight")],vv=yf({fields:pv,name:"highlighting",apis:gv}),hv=function(){return[8]},bv=function(){return[9]},yv=function(){return[13]},xv=function(){return[27]},wv=function(){return[32]},Sv=function(){return[37]},kv=function(){return[38]},Cv=function(){return[39]},Ov=function(){return[40]},_v=function(n,t,e){var o=an(n.slice(0,t)),r=an(n.slice(t+1));return tn(o.concat(r),e)},Tv=function(n,t,e){var o=an(n.slice(0,t));return tn(o,e)},Ev=function(n,t,e){var o=n.slice(0,t),r=n.slice(t+1);return tn(r.concat(o),e)},Bv=function(n,t,e){var o=n.slice(t+1);return tn(o,e)},Dv=function(n){return function(t){var e=t.raw();return U(n,e.which)}},Av=function(n){return function(t){return un(n,(function(n){return n(t)}))}},Mv=function(n){var t=n.raw();return!0===t.shiftKey},Fv=function(n){var t=n.raw();return!0===t.ctrlKey},Iv=c(Mv),Rv=function(n,t){return{matches:n,classification:t}},Vv=function(n,t){var e=tn(n,(function(n){return n.matches(t)}));return e.map((function(n){return n.classification}))},Hv=function(n,t,e){var o=t.exists((function(n){return e.exists((function(t){return er(t,n)}))}));o||ui(n,Zr(),{prevFocus:t,newFocus:e})},Pv=function(){var n=function(n){return If(n.element())},t=function(t,e){var o=n(t);t.getSystem().triggerFocus(e,t.element());var r=n(t);Hv(t,o,r)};return{get:n,set:t}},zv=function(){var n=function(n){return vv.getHighlighted(n).map((function(n){return n.element()}))},t=function(t,o){var r=n(t);t.getSystem().getByDom(o).fold(e,(function(n){vv.highlight(t,n)}));var i=n(t);Hv(t,r,i)};return{get:n,set:t}};(function(n){n["OnFocusMode"]="onFocus",n["OnEnterOrSpaceMode"]="onEnterOrSpace",n["OnApiMode"]="onApi"})(Hp||(Hp={}));var Nv=function(n,t,e,o,r){var i=function(){return n.concat([Ie("focusManager",Pv()),Re("focusInside","onFocus",$t((function(n){return U(["onFocus","onEnterOrSpace","onApi"],n)?O.value(n):O.error("Invalid value for focusInside")}))),Ss("handler",c),Ss("state",t),Ss("sendFocusIn",r)])},u=function(n,t,e,o,r){var i=e(n,t,o,r);return Vv(i,t.event()).bind((function(e){return e(n,t,o,r)}))},a=function(n,t){var i=n.focusInside!==Hp.OnFocusMode?w.none():r(n).map((function(e){return pi(Ir(),(function(o,r){e(o,n,t),r.stop()}))})),a=function(e,o){var i=Dv(wv().concat(yv()))(o.event());n.focusInside===Hp.OnEnterOrSpaceMode&&i&&sr(e,o)&&r(n).each((function(r){r(e,n,t),o.stop()}))},c=[pi(_r(),(function(o,r){u(o,r,e,n,t).fold((function(){a(o,r)}),(function(n){r.stop()}))})),pi(Tr(),(function(e,r){u(e,r,o,n,t).each((function(n){r.stop()}))}))];return li(i.toArray().concat(c))},c={schema:i,processKey:u,toEvents:a};return c},Lv=function(n){var t=[_e("onEscape"),_e("onEnter"),Ie("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ie("firstTabstop",0),Ie("useTabstopAt",i(!0)),_e("visibilitySelector")].concat([n]),e=function(n,t){var e=n.visibilitySelector.bind((function(n){return Kc(t,n)})).getOr(t);return oc(e)>0},o=function(n,t){var o=pd(n.element(),t.selector),r=$(o,(function(n){return e(t,n)}));return w.from(r[t.firstTabstop])},r=function(n,t){return t.focusManager.get(n).bind((function(n){return Kc(n,t.selector)}))},u=function(n,t){return e(n,t)&&n.useTabstopAt(t)},c=function(n,t,e){o(n,t).each((function(e){t.focusManager.set(n,e)}))},s=function(n,t,e,o,r){return r(t,e,(function(n){return u(o,n)})).fold((function(){return o.cyclic?w.some(!0):w.none()}),(function(t){return o.focusManager.set(n,t),w.some(!0)}))},f=function(n,t,e,o){var i=pd(n.element(),e.selector);return r(n,e).bind((function(t){var r=en(i,a(er,t));return r.bind((function(t){return s(n,i,t,e,o)}))}))},l=function(n,t,e){var o=e.cyclic?_v:Tv;return f(n,t,e,o)},d=function(n,t,e){var o=e.cyclic?Ev:Bv;return f(n,t,e,o)},m=function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))},g=function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))},p=i([Rv(Av([Mv,Dv(bv())]),l),Rv(Dv(bv()),d),Rv(Dv(xv()),g),Rv(Av([Iv,Dv(yv())]),m)]),v=i([]);return Nv(t,Pu.init,p,v,(function(){return w.some(c)}))},jv=Lv(We("cyclic",i(!1))),Uv=Lv(We("cyclic",i(!0))),Wv=function(n,t,e){return ci(n,e,Pr()),w.some(!0)},Gv=function(n,t,e){var o=Xp(e)&&Dv(wv())(t.event());return o?w.none():Wv(n,t,e)},Xv=function(n,t){return w.some(!0)},Yv=[Ie("execute",Gv),Ie("useSpace",!1),Ie("useEnter",!0),Ie("useControlEnter",!1),Ie("useDown",!1)],qv=function(n,t,e){return e.execute(n,t,n.element())},Kv=function(n,t,e,o){var r=e.useSpace&&!Xp(n.element())?wv():[],i=e.useEnter?yv():[],u=e.useDown?Ov():[],a=r.concat(i).concat(u);return[Rv(Dv(a),qv)].concat(e.useControlEnter?[Rv(Av([Fv,Dv(yv())]),qv)]:[])},Jv=function(n,t,e,o){return e.useSpace&&!Xp(n.element())?[Rv(Dv(wv()),Xv)]:[]},$v=Nv(Yv,Pu.init,Kv,Jv,(function(){return w.none()})),Qv=function(){var n=Ge(w.none()),t=function(t,e){n.set(w.some({numRows:t,numColumns:e}))},e=function(){return n.get().map((function(n){return n.numRows}))},o=function(){return n.get().map((function(n){return n.numColumns}))};return zu({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:t,getNumRows:e,getNumColumns:o})},Zv=function(n){return n.state(n)},nh=Object.freeze({__proto__:null,flatgrid:Qv,init:Zv}),th=function(n){return function(t,e,o,r){var i=n(t.element());return ih(i,t,e,o,r)}},eh=function(n,t){var e=hl(n,t);return th(e)},oh=function(n,t){var e=hl(t,n);return th(e)},rh=function(n){return function(t,e,o,r){return ih(n,t,e,o,r)}},ih=function(n,t,e,o,r){var i=o.focusManager.get(t).bind((function(e){return n(t.element(),e,o,r)}));return i.map((function(n){return o.focusManager.set(t,n),!0}))},uh=rh,ah=rh,ch=rh,sh=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0},fh=function(n){return!sh(n.dom())},lh=function(n,t){return en(n,t).map((function(t){return{index:i(t),candidates:i(n)}}))},dh=function(n,t,e){var o=function(n){return er(n,t)},r=pd(n,e),i=$(r,fh);return lh(i,o)},mh=function(n,t){return en(n,(function(n){return er(t,n)}))},gh=function(n,t,e,o){var r=Math.floor(t/e),i=t%e;return o(r,i).bind((function(t){var o=t.row()*e+t.column();return o>=0&&o<n.length?w.some(n[o]):w.none()}))},ph=function(n,t,e,o,r){return gh(n,t,o,(function(t,u){var a=t===e-1,c=a?n.length-t*o:o,s=Kf(u,r,0,c-1);return w.some({row:i(t),column:i(s)})}))},vh=function(n,t,e,o,r){return gh(n,t,o,(function(t,u){var a=Kf(t,r,0,e-1),c=a===e-1,s=c?n.length-a*o:o,f=Jf(u,0,s-1);return w.some({row:i(a),column:i(f)})}))},hh=function(n,t,e,o){return ph(n,t,e,o,1)},bh=function(n,t,e,o){return ph(n,t,e,o,-1)},yh=function(n,t,e,o){return vh(n,t,e,o,-1)},xh=function(n,t,e,o){return vh(n,t,e,o,1)},wh=[pe("selector"),Ie("execute",Gv),ys("onEscape"),Ie("captureTab",!1),Cs()],Sh=function(n,t,e){qc(n.element(),t.selector).each((function(e){t.focusManager.set(n,e)}))},kh=function(n,t){return t.focusManager.get(n).bind((function(n){return Kc(n,t.selector)}))},Ch=function(n,t,e,o){return kh(n,e).bind((function(o){return e.execute(n,t,o)}))},Oh=function(n){return function(t,e,o,r){return dh(t,e,o.selector).bind((function(t){return n(t.candidates(),t.index(),r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},_h=function(n,t,e){return e.captureTab?w.some(!0):w.none()},Th=function(n,t,e){return e.onEscape(n,t)},Eh=Oh(bh),Bh=Oh(hh),Dh=Oh(yh),Ah=Oh(xh),Mh=i([Rv(Dv(Sv()),eh(Eh,Bh)),Rv(Dv(Cv()),oh(Eh,Bh)),Rv(Dv(kv()),uh(Dh)),Rv(Dv(Ov()),ah(Ah)),Rv(Av([Mv,Dv(bv())]),_h),Rv(Av([Iv,Dv(bv())]),_h),Rv(Dv(xv()),Th),Rv(Dv(wv().concat(yv())),Ch)]),Fh=i([Rv(Dv(wv()),Xv)]),Ih=Nv(wh,Qv,Mh,Fh,(function(){return w.some(Sh)})),Rh=function(n,t,e,o){var r=function(n){return"button"===Qi(n)&&"disabled"===uu(n,"disabled")},i=function(n,t,e){var u=Kf(t,o,0,e.length-1);return u===n?w.none():r(e[u])?i(n,u,e):w.from(e[u])};return dh(n,e,t).bind((function(n){var t=n.index(),e=n.candidates();return i(t,t,e)}))},Vh=[pe("selector"),Ie("getInitial",w.none),Ie("execute",Gv),ys("onEscape"),Ie("executeOnMove",!1),Ie("allowVertical",!0)],Hh=function(n,t){return t.focusManager.get(n).bind((function(n){return Kc(n,t.selector)}))},Ph=function(n,t,e){return Hh(n,e).bind((function(o){return e.execute(n,t,o)}))},zh=function(n,t,e){t.getInitial(n).orThunk((function(){return qc(n.element(),t.selector)})).each((function(e){t.focusManager.set(n,e)}))},Nh=function(n,t,e){return Rh(n,e.selector,t,-1)},Lh=function(n,t,e){return Rh(n,e.selector,t,1)},jh=function(n){return function(t,e,o,r){return n(t,e,o,r).bind((function(){return o.executeOnMove?Ph(t,e,o):w.some(!0)}))}},Uh=function(n,t,e){return e.onEscape(n,t)},Wh=function(n,t,e,o){var r=Sv().concat(e.allowVertical?kv():[]),i=Cv().concat(e.allowVertical?Ov():[]);return[Rv(Dv(r),jh(eh(Nh,Lh))),Rv(Dv(i),jh(oh(Nh,Lh))),Rv(Dv(yv()),Ph),Rv(Dv(wv()),Ph),Rv(Dv(xv()),Uh)]},Gh=i([Rv(Dv(wv()),Xv)]),Xh=Nv(Vh,Pu.init,Wh,Gh,(function(){return w.some(zh)})),Yh=function(n,t,e){return w.from(n[t]).bind((function(n){return w.from(n[e]).map((function(n){return{rowIndex:t,columnIndex:e,cell:n}}))}))},qh=function(n,t,e,o){var r=n[t],i=r.length,u=Kf(e,o,0,i-1);return Yh(n,t,u)},Kh=function(n,t,e,o){var r=Kf(e,o,0,n.length-1),i=n[r].length,u=Jf(t,0,i-1);return Yh(n,r,u)},Jh=function(n,t,e,o){var r=n[t],i=r.length,u=Jf(e+o,0,i-1);return Yh(n,t,u)},$h=function(n,t,e,o){var r=Jf(e+o,0,n.length-1),i=n[r].length,u=Jf(t,0,i-1);return Yh(n,r,u)},Qh=function(n,t,e){return qh(n,t,e,1)},Zh=function(n,t,e){return qh(n,t,e,-1)},nb=function(n,t,e){return Kh(n,e,t,-1)},tb=function(n,t,e){return Kh(n,e,t,1)},eb=function(n,t,e){return Jh(n,t,e,-1)},ob=function(n,t,e){return Jh(n,t,e,1)},rb=function(n,t,e){return $h(n,e,t,-1)},ib=function(n,t,e){return $h(n,e,t,1)},ub=[ke("selectors",[pe("row"),pe("cell")]),Ie("cycles",!0),Ie("previousSelector",w.none),Ie("execute",Gv)],ab=function(n,t,e){var o=t.previousSelector(n).orThunk((function(){var e=t.selectors;return qc(n.element(),e.cell)}));o.each((function(e){t.focusManager.set(n,e)}))},cb=function(n,t,e){return If(n.element()).bind((function(o){return e.execute(n,t,o)}))},sb=function(n,t){return Y(n,(function(n){return pd(n,t.selectors.cell)}))},fb=function(n,t){return function(e,o,r){var i=r.cycles?n:t;return Kc(o,r.selectors.row).bind((function(n){var t=pd(n,r.selectors.cell);return mh(t,o).bind((function(t){var o=pd(e,r.selectors.row);return mh(o,n).bind((function(n){var e=sb(o,r);return i(e,n,t).map((function(n){return n.cell}))}))}))}))}},lb=fb(Zh,eb),db=fb(Qh,ob),mb=fb(nb,rb),gb=fb(tb,ib),pb=i([Rv(Dv(Sv()),eh(lb,db)),Rv(Dv(Cv()),oh(lb,db)),Rv(Dv(kv()),uh(mb)),Rv(Dv(Ov()),ah(gb)),Rv(Dv(wv().concat(yv())),cb)]),vb=i([Rv(Dv(wv()),Xv)]),hb=Nv(ub,Pu.init,pb,vb,(function(){return w.some(ab)})),bb=[pe("selector"),Ie("execute",Gv),Ie("moveOnTab",!1)],yb=function(n,t,e){return e.focusManager.get(n).bind((function(o){return e.execute(n,t,o)}))},xb=function(n,t,e){qc(n.element(),t.selector).each((function(e){t.focusManager.set(n,e)}))},wb=function(n,t,e){return Rh(n,e.selector,t,-1)},Sb=function(n,t,e){return Rh(n,e.selector,t,1)},kb=function(n,t,e,o){return e.moveOnTab?ch(wb)(n,t,e,o):w.none()},Cb=function(n,t,e,o){return e.moveOnTab?ch(Sb)(n,t,e,o):w.none()},Ob=i([Rv(Dv(kv()),ch(wb)),Rv(Dv(Ov()),ch(Sb)),Rv(Av([Mv,Dv(bv())]),kb),Rv(Av([Iv,Dv(bv())]),Cb),Rv(Dv(yv()),yb),Rv(Dv(wv()),yb)]),_b=i([Rv(Dv(wv()),Xv)]),Tb=Nv(bb,Pu.init,Ob,_b,(function(){return w.some(xb)})),Eb=[ys("onSpace"),ys("onEnter"),ys("onShiftEnter"),ys("onLeft"),ys("onRight"),ys("onTab"),ys("onShiftTab"),ys("onUp"),ys("onDown"),ys("onEscape"),Ie("stopSpaceKeyup",!1),_e("focusIn")],Bb=function(n,t,e){return[Rv(Dv(wv()),e.onSpace),Rv(Av([Iv,Dv(yv())]),e.onEnter),Rv(Av([Mv,Dv(yv())]),e.onShiftEnter),Rv(Av([Mv,Dv(bv())]),e.onShiftTab),Rv(Av([Iv,Dv(bv())]),e.onTab),Rv(Dv(kv()),e.onUp),Rv(Dv(Ov()),e.onDown),Rv(Dv(Sv()),e.onLeft),Rv(Dv(Cv()),e.onRight),Rv(Dv(wv()),e.onSpace),Rv(Dv(xv()),e.onEscape)]},Db=function(n,t,e){return e.stopSpaceKeyup?[Rv(Dv(wv()),Xv)]:[]},Ab=Nv(Eb,Pu.init,Bb,Db,(function(n){return n.focusIn})),Mb=jv.schema(),Fb=Uv.schema(),Ib=Xh.schema(),Rb=Ih.schema(),Vb=hb.schema(),Hb=$v.schema(),Pb=Tb.schema(),zb=Ab.schema(),Nb=Object.freeze({__proto__:null,acyclic:Mb,cyclic:Fb,flow:Ib,flatgrid:Rb,matrix:Vb,execution:Hb,menu:Pb,special:zb}),Lb=function(n){return Bn(n,"setGridSize")},jb=wf({branchKey:"mode",branches:Nb,name:"keying",active:{events:function(n,t){var e=n.handler;return e.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element(),n.element())}),(function(o){o(n,t,e)}))},setGridSize:function(n,e,o,r,i){Lb(o)?o.setGridSize(r,i):t.console.error("Layout does not support setGridSize")}},state:nh}),Ub=function(n,t,e,o){Rf((function(){var t=Y(o,n.getSystem().build);vm(n,t)}),n.element())},Wb=function(n,t,e,o){var r=n.getSystem().build(o);bm(n,r,e)},Gb=function(n,t,e,o){Wb(n,t,Li,o)},Xb=function(n,t,e,o){Wb(n,t,Ni,o)},Yb=function(n,t,e,o){var r=qb(n),i=tn(r,(function(n){return er(o.element(),n.element())}));i.each(xm)},qb=function(n,t){return n.components()},Kb=function(n,t,e,o,r){var i=qb(n);return w.from(i[o]).map((function(i){return Yb(n,t,e,i),r.each((function(e){Wb(n,t,(function(n,t){ji(n,t,o)}),e)})),i}))},Jb=function(n,t,e,o,r){var i=qb(n);return en(i,o).bind((function(o){return Kb(n,t,e,o,r)}))},$b=Object.freeze({__proto__:null,append:Gb,prepend:Xb,remove:Yb,replaceAt:Kb,replaceBy:Jb,set:Ub,contents:qb}),Qb=yf({fields:[],name:"replacing",apis:$b}),Zb=function(n,t){var e=li(t);return yf({fields:[pe("enabled")],name:n,active:{events:i(e)}})},ny=function(n,t){var e=Zb(n,t);return{key:n,value:{config:{},me:e,configAsRaw:i({}),initialConfig:{},state:Pu}}},ty=function(n,t){t.ignore||(Df(n.element()),t.onFocus(n))},ey=function(n,t){t.ignore||Af(n.element())},oy=function(n){return Mf(n.element())},ry=Object.freeze({__proto__:null,focus:ty,blur:ey,isFocused:oy}),iy=function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return Wu(e)},uy=function(n){return li([pi(Ir(),(function(t,e){ty(t,n),e.stop()}))].concat(n.stopMousedown?[pi(yr(),(function(n,t){t.event().prevent()}))]:[]))},ay=Object.freeze({__proto__:null,exhibit:iy,events:uy}),cy=[bs("onFocus"),Ie("stopMousedown",!1),Ie("ignore",!1)],sy=yf({fields:cy,name:"focusing",active:ay,apis:ry}),fy=function(n,t,e){var o=t.aria;o.update(n,o,e.get())},ly=function(n,t,e){t.toggleClass.each((function(t){e.get()?ha(n.element(),t):ya(n.element(),t)}))},dy=function(n,t,e){py(n,t,e,!e.get())},my=function(n,t,e){e.set(!0),ly(n,t,e),fy(n,t,e)},gy=function(n,t,e){e.set(!1),ly(n,t,e),fy(n,t,e)},py=function(n,t,e,o){var r=o?my:gy;r(n,t,e)},vy=function(n,t,e){return e.get()},hy=function(n,t,e){py(n,t,e,t.selected)},by=Object.freeze({__proto__:null,onLoad:hy,toggle:dy,isOn:vy,on:my,off:gy,set:py}),yy=function(){return Wu({})},xy=function(n,t){var e=ff(n,t,dy),o=lf(n,t,hy);return li(on([n.toggleOnExecute?[e]:[],[o]]))},wy=Object.freeze({__proto__:null,exhibit:yy,events:xy}),Sy=function(n){var t=function(){var t=Ge(n),e=function(){return t.get()},o=function(n){return t.set(n)},r=function(){return t.set(n)},i=function(){return t.get()};return{get:e,set:o,clear:r,readState:i}};return{init:t}},ky=function(n,t,e){ru(n.element(),"aria-pressed",e),t.syncWithExpanded&&_y(n,t,e)},Cy=function(n,t,e){ru(n.element(),"aria-selected",e)},Oy=function(n,t,e){ru(n.element(),"aria-checked",e)},_y=function(n,t,e){ru(n.element(),"aria-expanded",e)},Ty=[Ie("selected",!1),_e("toggleClass"),Ie("toggleOnExecute",!0),Re("aria",{mode:"none"},ie("mode",{pressed:[Ie("syncWithExpanded",!1),Ss("update",ky)],checked:[Ss("update",Oy)],expanded:[Ss("update",_y)],selected:[Ss("update",Cy)],none:[Ss("update",e)]}))],Ey=yf({fields:Ty,name:"toggling",active:wy,apis:by,state:Sy(!1)}),By=function(){var n=function(n,t){t.stop(),ai(n)};return[pi(Dr(),n),pi(Nr(),n),Si(pr()),Si(yr())]},Dy=function(n){var t=function(n){return Ei((function(t,e){n(t),e.stop()}))};return li(on([n.map(t).toArray(),By()]))},Ay="alloy.item-hover",My="alloy.item-focus",Fy=function(n){(If(n.element()).isNone()||sy.isFocused(n))&&(sy.isFocused(n)||sy.focus(n),ui(n,Ay,{item:n}))},Iy=function(n){ui(n,My,{item:n})},Ry=i(Ay),Vy=i(My),Hy=function(n){return{dom:n.dom,domModification:m(m({},n.domModification),{attributes:m(m(m({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Ag.augment(n.itemBehaviours,[n.toggling.fold(Ey.revoke,(function(n){return Ey.config(m({aria:{mode:"checked"}},n))})),sy.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Iy(n)}}),jb.config({mode:"execution"}),Tg.config({store:{mode:"memory",initialValue:n.data}}),ny("item-type-events",p(By(),[pi(kr(),Fy),pi(zr(),sy.focus)]))]),components:n.components,eventOrder:n.eventOrder}},Py=[pe("data"),pe("components"),pe("dom"),Ie("hasSubmenu",!1),_e("toggling"),Ag.field("itemBehaviours",[Ey,sy,jb,Tg]),Ie("ignoreFocus",!1),Ie("domModification",{}),Ss("builder",Hy),Ie("eventOrder",{})],zy=function(n){return{dom:n.dom,components:n.components,events:li([ki(zr())])}},Ny=[pe("dom"),pe("components"),Ss("builder",zy)],Ly=function(){return"item-widget"},jy=i([up({name:"widget",overrides:function(n){return{behaviours:hf([Tg.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),Uy=function(n){var t=yp(Ly(),n,jy()),e=xp(Ly(),n,t.internals()),o=function(t){return wp(t,n,"widget").map((function(n){return jb.focusIn(n),n}))},r=function(t,e){return Xp(e.event().target())?w.none():function(){return n.autofocus?(e.setSource(t.element()),w.none()):w.none()}()};return{dom:n.dom,components:e,domModification:n.domModification,events:li([Ei((function(n,t){o(n).each((function(n){t.stop()}))})),pi(kr(),Fy),pi(zr(),(function(t,e){n.autofocus?o(t):sy.focus(t)}))]),behaviours:Ag.augment(n.widgetBehaviours,[Tg.config({store:{mode:"memory",initialValue:n.data}}),sy.config({ignore:n.ignoreFocus,onFocus:function(n){Iy(n)}}),jb.config({mode:"special",focusIn:n.autofocus?function(n){o(n)}:Sf(),onLeft:r,onRight:r,onEscape:function(t,e){return sy.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element()),w.none()):w.none():(sy.focus(t),w.some(!0))}})])}},Wy=[pe("uid"),pe("data"),pe("components"),pe("dom"),Ie("autofocus",!1),Ie("ignoreFocus",!1),Ag.field("widgetBehaviours",[Tg,sy,jb]),Ie("domModification",{}),Ep(jy()),Ss("builder",Uy)],Gy=ie("type",{widget:Wy,item:Py,separator:Ny}),Xy=function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}},Yy=function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}},qy=function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}},Ky=i([sp({factory:{sketch:function(n){var t=ee("menu.spec item",Gy,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:m(m({},t),{uid:_u("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Jy=i([pe("value"),pe("items"),pe("dom"),pe("components"),Ie("eventOrder",{}),Eg("menuBehaviours",[vv,Tg,Jp,jb]),Re("movement",{mode:"menu",moveOnTab:!0},ie("mode",{grid:[Cs(),Ss("config",Xy)],matrix:[Ss("config",Yy),pe("rowSelector")],menu:[Ie("moveOnTab",!0),Ss("config",qy)]})),gs(),Ie("fakeFocus",!1),Ie("focusManager",Pv()),bs("onHighlight")]),$y=i("alloy.menu-focus"),Qy=function(n,t,e,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Dg(n.menuBehaviours,[vv.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Tg.config({store:{mode:"memory",initialValue:n.value}}),Jp.config({find:w.some}),jb.config(n.movement.config(n,n.movement))]),events:li([pi(Vy(),(function(n,t){var e=t.event();n.getSystem().getByDom(e.target()).each((function(e){vv.highlight(n,e),t.stop(),ui(n,$y(),{menu:n,item:e})}))})),pi(Ry(),(function(n,t){var e=t.event().item();vv.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}},Zy=Lp({name:"Menu",configFields:Jy(),partFields:Ky(),factory:Qy}),nx=function(n){return xn(n,(function(n,t){return{k:n,v:t}}))},tx=function(n,t,e,o){return Tn(e,o).bind((function(o){return Tn(n,o).bind((function(o){var r=tx(n,t,e,o);return w.some([o].concat(r))}))})).getOr([])},ex=function(n,t){var e={};bn(n,(function(n,t){q(n,(function(n){e[n]=t}))}));var o=t,r=nx(t),i=yn(r,(function(n,t){return[t].concat(tx(e,o,r,t))}));return yn(e,(function(n){return Tn(i,n).getOr([n])}))},ox=function(){var n=Ge({}),t=Ge({}),e=Ge({}),o=Ge(w.none()),r=Ge({}),i=function(){n.set({}),t.set({}),e.set({}),o.set(w.none())},u=function(){return o.get().isNone()},a=function(n,e){var o;t.set(m(m({},t.get()),(o={},o[n]={type:"prepared",menu:e},o)))},c=function(i,u,a,c){o.set(w.some(i)),n.set(a),t.set(u),r.set(c);var s=ex(c,a);e.set(s)},s=function(t){return On(n.get(),(function(n,e){return n===t}))},f=function(n,t,e){return v(n).bind((function(o){return s(n).bind((function(n){return t(n).map((function(n){return{triggeredMenu:o,triggeringItem:n,triggeringPath:e}}))}))}))},l=function(n,t){var r=$(b(n).toArray(),(function(n){return v(n).isSome()}));return Tn(e.get(),n).bind((function(n){var e=an(r.concat(n)),i=rn(e,(function(n,r){return f(n,t,e.slice(0,r+1)).fold((function(){return o.get().is(n)?[]:[w.none()]}),(function(n){return[w.some(n)]}))}));return Up(i)}))},d=function(t){return Tn(n.get(),t).map((function(n){var o=Tn(e.get(),t).getOr([]);return[n].concat(o)}))},g=function(n){return Tn(e.get(),n).bind((function(n){return n.length>1?w.some(n.slice(1)):w.none()}))},p=function(n){return Tn(e.get(),n)},v=function(n){return h(n).bind(rx)},h=function(n){return Tn(t.get(),n)},b=function(t){return Tn(n.get(),t)},y=function(n){var t=r.get();return cn(vn(t),n)},x=function(){return o.get().bind(v)},S=function(){return t.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:p,collapse:g,lookupMenu:h,lookupItem:b,otherMenus:y,getPrimary:x,getMenus:S,clear:i,isClear:u,getTriggeringPath:l}},rx=function(n){return"prepared"===n.type?w.some(n.menu):w.none()},ix={init:ox,extractPreparedMenu:rx},ux=function(n,t){var e,o=Ge(w.none()),r=function(t,e,o){return yn(o,(function(o,r){var i=function(){return Zy.sketch(m(m({dom:o.dom},o),{value:r,items:o.items,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?zv():Pv()}))};return r===e?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))},i=ix.init(),u=function(t){var e=r(t,n.data.primary,n.data.menus),o=s();return i.setContents(n.data.primary,e,n.data.expansions,o),i.getPrimary()},a=function(n){return Tg.getValue(n).value},c=function(n,t,e){return pn(t,(function(n){if(!n.getSystem().isConnected())return w.none();var t=vv.getCandidates(n);return tn(t,(function(n){return a(n)===e}))}))},s=function(t){return yn(n.data.menus,(function(n,t){return rn(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},f=function(n,t){vv.highlight(n,t),vv.getHighlighted(t).orThunk((function(){return vv.getFirst(t)})).each((function(t){ci(n,t.element(),zr())}))},l=function(n,t){return jp(Y(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?w.some(n.menu):w.none()}))})))},d=function(t,e,o){var r=l(e,e.otherMenus(o));q(r,(function(e){Sa(e.element(),[n.markers.backgroundMenu]),n.stayInDom||Qb.remove(t,e)}))},g=function(t){return o.get().getOrThunk((function(){var e={},r=pd(t.element(),"."+n.markers.item),i=$(r,(function(n){return"true"===uu(n,"aria-haspopup")}));return q(i,(function(n){t.getSystem().getByDom(n).each((function(n){var t=a(n);e[t]=n}))})),o.set(w.some(e)),e}))},p=function(n,t){var e=g(n);bn(e,(function(n,e){var o=U(t,e);ru(n.element(),"aria-expanded",o)}))},v=function(t,e,o){return w.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return w.none();var i=r.menu,u=l(e,o.slice(1));return q(u,(function(t){ha(t.element(),n.markers.backgroundMenu)})),Ca(i.element())||Qb.append(t,nc(i)),Sa(i.element(),[n.markers.backgroundMenu]),f(t,i),d(t,e,o),w.some(i)}))}))};(function(n){n[n["HighlightSubmenu"]=0]="HighlightSubmenu",n[n["HighlightParent"]=1]="HighlightParent"})(e||(e={}));var h=function(n,t,e){if("notbuilt"===e.type){var o=n.getSystem().build(e.nbMenu());return i.setMenuBuilt(t,o),o}return e.menu},b=function(t,o,r){void 0===r&&(r=e.HighlightSubmenu);var u=a(o);return i.expand(u).bind((function(u){return p(t,u),w.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=h(t,a,c);return Ca(s.element())||Qb.append(t,nc(s)),n.onOpenSubmenu(t,o,s,an(u)),r===e.HighlightSubmenu?(vv.highlightFirst(s),v(t,i,u)):(vv.dehighlightAll(s),w.some(o))}))}))}))},y=function(t,e){var o=a(e);return i.collapse(o).bind((function(o){return p(t,o),v(t,i,o).map((function(o){return n.onCollapseMenu(t,e,o),o}))}))},x=function(n,t){var e=a(t);return i.refresh(e).bind((function(t){return p(n,t),v(n,i,t)}))},S=function(n,t){return Xp(t.element())?w.none():b(n,t,e.HighlightSubmenu)},k=function(n,t){return Xp(t.element())?w.none():y(n,t)},C=function(t,e){return y(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))},O=function(t){return function(e,o){return Kc(o.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOption().bind((function(n){return t(e,n).map((function(){return!0}))}))}))}},_=li([pi($y(),(function(n,t){var e=t.event().item();i.lookupItem(a(e)).each((function(){var e=t.event().menu();vv.highlight(n,e);var o=a(t.event().item());i.refresh(o).each((function(t){return d(n,i,t)}))}))})),Ei((function(t,o){var r=o.event().target();t.getSystem().getByDom(r).each((function(o){var r=a(o);0===r.indexOf("collapse-item")&&y(t,o),b(t,o,e.HighlightSubmenu).fold((function(){n.onExecute(t,o)}),(function(){}))}))})),Oi((function(t,e){u(t).each((function(e){Qb.append(t,nc(e)),n.onOpenMenu(t,e),n.highlightImmediately&&f(t,e)}))}))].concat(n.navigateOnHover?[pi(Ry(),(function(t,o){var r=o.event().item();x(t,r),b(t,r,e.HighlightParent),n.onHover(t,r)}))]:[])),T=function(n){return vv.getHighlighted(n).bind(vv.getHighlighted)},E=function(n){T(n).each((function(t){y(n,t)}))},B=function(n){i.getPrimary().each((function(t){f(n,t)}))},D=function(n){return w.from(n.components()[0]).filter((function(n){return"menu"===uu(n.element(),"role")}))},A=function(t){var e=i.getPrimary().bind((function(n){return T(t).bind((function(n){var e=a(n),o=_n(i.getMenus()),r=jp(Y(o,ix.extractPreparedMenu));return i.getTriggeringPath(e,(function(n){return c(t,r,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))}));e.fold((function(){D(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;n.onRepositionMenu(t,o,r)}))},M={collapseMenu:E,highlightPrimary:B,repositionMenus:A};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Dg(n.tmenuBehaviours,[jb.config({mode:"special",onRight:O(S),onLeft:O(k),onEscape:O(C),focusIn:function(n,t){i.getPrimary().each((function(t){ci(n,t.element(),zr())}))}}),vv.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),Jp.config({find:function(n){return vv.getHighlighted(n)}}),Qb.config({})]),eventOrder:n.eventOrder,apis:M,events:_}},ax=i("collapse-item"),cx=function(n,t,e){return{primary:n,menus:t,expansions:e}},sx=function(n,t){return{primary:n,menus:ct(n,t),expansions:{}}},fx=function(n){return{value:bu(ax()),meta:{text:n}}},lx=Np({name:"TieredMenu",configFields:[ws("onExecute"),ws("onEscape"),xs("onOpenMenu"),xs("onOpenSubmenu"),bs("onRepositionMenu"),bs("onCollapseMenu"),Ie("highlightImmediately",!0),ke("data",[pe("primary"),pe("menus"),pe("expansions")]),Ie("fakeFocus",!1),bs("onHighlight"),bs("onHover"),ps(),pe("dom"),Ie("navigateOnHover",!0),Ie("stayInDom",!1),Eg("tmenuBehaviours",[jb,vv,Jp,Qb]),Ie("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:ux,extraApis:{tieredData:cx,singleData:sx,collapseItem:fx}}),dx=function(n,t,e,o,r){var i=function(){return n.lazySink(t)},u="horizontal"===o.type?{layouts:{onLtr:function(){return cf()},onRtl:function(){return sf()}}}:{},a=function(n){return 2===n.length},c=function(n){return a(n)?u:{}};return lx.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return Gm.close(t),n.onEscape.map((function(n){return n(t)})),w.some(!0)},onExecute:function(){return w.some(!0)},onOpenMenu:function(n,t){lm.positionWithinBounds(i().getOrDie(),e,t,r())},onOpenSubmenu:function(n,t,e,o){var r=i().getOrDie();lm.position(r,m({anchor:"submenu",item:t},c(o)),e)},onRepositionMenu:function(n,t,o){var u=i().getOrDie();lm.positionWithinBounds(u,e,t,r()),q(o,(function(n){var t=c(n.triggeringPath);lm.position(u,m({anchor:"submenu",item:n.triggeringItem},t),n.triggeredMenu)}))}})},mx=function(n,t){var e=function(t,e){var o=n.getRelated(t);return o.exists((function(n){return Zc(n,e)}))},o=function(n,t){Gm.setContent(n,t)},r=function(n,t,e){i(n,t,e,w.none())},i=function(n,t,e,o){u(n,t,e,(function(){return o.map((function(n){return Pc(n)}))}))},u=function(t,e,o,r){var i=n.lazySink(t).getOrDie();Gm.openWhileCloaked(t,o,(function(){return lm.positionWithinBounds(i,e,t,r())})),Tg.setValue(t,w.some({mode:"position",anchor:e,getBounds:r}))},a=function(n,t,e){c(n,t,e,(function(){return w.none()}))},c=function(t,e,o,r){var i=dx(n,t,e,o,r);Gm.open(t,i),Tg.setValue(t,w.some({mode:"menu",menu:i}))},s=function(n){Gm.isOpen(n)&&(Tg.setValue(n,w.none()),Gm.close(n))},f=function(n){return Gm.getState(n)},l=function(t){Gm.isOpen(t)&&Tg.getValue(t).each((function(e){switch(e.mode){case"menu":Gm.getState(t).each((function(n){lx.repositionMenus(n)}));break;case"position":var o=n.lazySink(t).getOrDie();lm.positionWithinBounds(o,e.anchor,t,e.getBounds());break}}))},d={setContent:o,showAt:r,showWithin:i,showWithinBounds:u,showMenuAt:a,showMenuWithinBounds:c,hide:s,getContent:f,reposition:l,isOpen:Gm.isOpen};return{uid:n.uid,dom:n.dom,behaviours:Dg(n.inlineBehaviours,[Gm.config({isPartOf:function(n,t,o){return Zc(t,o)||e(n,o)},getAttachPoint:function(t){return n.lazySink(t).getOrDie()},onOpen:function(t){n.onShow(t)},onClose:function(t){n.onHide(t)}}),Tg.config({store:{mode:"memory",initialValue:w.none()}}),Tf.config({channels:m(m({},Jm(m({isExtraPart:t.isExtraPart},n.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),Qm(m(m({},n.fireRepositionEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})),{doReposition:l})))})]),eventOrder:n.eventOrder,apis:d}},gx=Np({name:"InlineView",configFields:[pe("lazySink"),bs("onShow"),bs("onHide"),De("onEscape"),Eg("inlineBehaviours",[Gm,Tg,Tf]),Me("fireDismissalEventInstead",[Ie("event",$r())]),Me("fireRepositionEventInstead",[Ie("event",Qr())]),Ie("getRelated",w.none),Ie("isExtraPart",f),Ie("eventOrder",w.none)],factory:mx,apis:{showAt:function(n,t,e,o){n.showAt(t,e,o)},showWithin:function(n,t,e,o,r){n.showWithin(t,e,o,r)},showWithinBounds:function(n,t,e,o,r){n.showWithinBounds(t,e,o,r)},showMenuAt:function(n,t,e,o){n.showMenuAt(t,e,o)},showMenuWithinBounds:function(n,t,e,o,r){n.showMenuWithinBounds(t,e,o,r)},hide:function(n,t){n.hide(t)},isOpen:function(n,t){return n.isOpen(t)},getContent:function(n,t){return n.getContent(t)},setContent:function(n,t,e){n.setContent(t,e)},reposition:function(n,t){n.reposition(t)}}}),px=function(n){return n.x},vx=function(n,t){return n.x+n.width/2-t.width/2},hx=function(n,t){return n.x+n.width-t.width},bx=function(n){return n.y},yx=function(n,t){return n.y+n.height-t.height},xx=function(n,t,e){return Os(hx(n,t),yx(n,t),e.innerSoutheast(),Fs(),zs(n,{right:0,bottom:3}),"layout-inner-se")},wx=function(n,t,e){return Os(px(n),yx(n,t),e.innerSouthwest(),Ms(),zs(n,{left:1,bottom:3}),"layout-inner-sw")},Sx=function(n,t,e){return Os(hx(n,t),bx(n),e.innerNortheast(),As(),zs(n,{right:0,top:2}),"layout-inner-ne")},kx=function(n,t,e){return Os(px(n),bx(n),e.innerNorthwest(),Ds(),zs(n,{left:1,top:2}),"layout-inner-nw")},Cx=function(n,t,e){return Os(vx(n,t),bx(n),e.innerNorth(),Is(),zs(n,{top:2}),"layout-inner-n")},Ox=function(n,t,e){return Os(vx(n,t),yx(n,t),e.innerSouth(),Rs(),zs(n,{bottom:3}),"layout-inner-s")},_x=tinymce.util.Tools.resolve("tinymce.util.Delay"),Tx=function(n){var t=Dy(n.action),e=n.dom.tag,o=function(t){return Tn(n.dom,"attributes").bind((function(n){return Tn(n,t)}))},r=function(){if("button"===e){var n=o("type").getOr("button"),t=o("role").map((function(n){return{role:n}})).getOr({});return m({type:n},t)}var r=o("role").getOr("button");return{role:r}};return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Ag.augment(n.buttonBehaviours,[sy.config({}),jb.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:r()},eventOrder:n.eventOrder}},Ex=Np({name:"Button",factory:Tx,configFields:[Ie("uid",void 0),pe("dom"),Ie("components",[]),Ag.field("buttonBehaviours",[sy,jb]),_e("action"),_e("role"),Ie("eventOrder",{})]}),Bx=function(n){var t=Vp(n)&&Bn(n,"uid")?n.uid:_u("memento"),e=function(n){return n.getSystem().getByUid(t).getOrDie()},o=function(n){return n.getSystem().getByUid(t).toOption()},r=function(){return m(m({},n),{uid:t})};return{get:e,getOpt:o,asSpec:r}},Dx=function(n){return w.from(n()["temporary-placeholder"]).getOr("!not found!")},Ax=function(n,t){return w.from(t()[n]).getOrThunk((function(){return Dx(t)}))},Mx=function(n,t,e){return w.from(t()[n]).or(e).getOrThunk((function(){return Dx(t)}))},Fx=function(n,t){return pn(n,(function(n){return w.from(t()[n])})).getOrThunk((function(){return Dx(t)}))},Ix={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Rx=function(n){var t=Bx({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:hf([Qb.config({})])}),e=function(n){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+n+"%"}}}},o=function(n){return{dom:{tag:"div",classes:["tox-text"],innerHtml:n+"%"}}},r=Bx({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:hf([Qb.config({})])}),i=function(n,t){n.getSystem().isConnected()&&r.getOpt(n).each((function(n){Qb.set(n,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(t)]},o(t)])}))},u=function(n,e){if(n.getSystem().isConnected()){var o=t.get(n);Qb.set(o,[Ja(e)])}},a={updateProgress:i,updateText:u},c=on([n.icon.toArray(),n.level.toArray(),n.level.bind((function(n){return w.from(Ix[n])})).toArray()]);return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map((function(n){return["tox-notification","tox-notification--in","tox-notification--"+n]})).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:Fx(c,n.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:hf([Qb.config({})])}].concat(n.progress?[r.asSpec()]:[]).concat(n.closeButton?[Ex.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Ax("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})]:[]),apis:a}},Vx=Np({name:"Notification",factory:Rx,configFields:[_e("level"),pe("progress"),pe("icon"),pe("onAction"),pe("text"),pe("iconProvider"),pe("translationProvider"),ze("closeButton",!0)],apis:{updateProgress:function(n,t,e){n.updateProgress(t,e)},updateText:function(n,t,e){n.updateText(t,e)}}});function Hx(n,t,e){var o=t.backstage,r=function(n){switch(n){case"bc-bc":return Ox;case"tc-tc":return Cx;case"tc-bc":return Zs;case"bc-tc":default:return nf}},i=function(n){q(n,(function(n){return n.moveTo(0,0)}))},u=function(n){n.length>0&&(dn(n).each((function(n){return n.moveRel(null,"banner")})),q(n,(function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},a=function(n){i(n),u(n)},c=function(n,i){var u=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),a=function(){i(),gx.hide(s)},c=Za(Vx.sketch({text:n.text,level:U(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:w.from(n.icon),closeButton:!u,onAction:a,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),s=Za(gx.sketch(m({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(s),n.timeout>0&&_x.setTimeout((function(){a()}),n.timeout),{close:a,moveTo:function(n,t){gx.showAt(s,{anchor:"makeshift",x:n,y:t},nc(c))},moveRel:function(n,e){if("banner"!==e){var o=r(e),i={anchor:"node",root:Oa(),node:w.some($e.fromDom(n)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}};gx.showAt(s,i,nc(c))}else gx.showAt(s,t.backstage.shared.anchors.banner(),nc(c))},text:function(n){Vx.updateText(c,n)},settings:n,getEl:function(){return c.element().dom()},progressBar:{value:function(n){Vx.updateProgress(c,n)}}}},s=function(n){n.close()},f=function(n){return n.settings};return{open:c,close:s,reposition:a,getArgs:f}}var Px,zx=function(n,e){var o=null,r=function(){null!==o&&(t.clearTimeout(o),o=null)},i=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null===o&&(o=t.setTimeout((function(){n.apply(null,r),o=null}),e))};return{cancel:r,throttle:i}},Nx=function(n,e){var o=null,r=function(){null!==o&&(t.clearTimeout(o),o=null)},i=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null!==o&&t.clearTimeout(o),o=t.setTimeout((function(){n.apply(null,r),o=null}),e)};return{cancel:r,throttle:i}},Lx=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),jx=function(n,t){return n.isBlock(t)||U(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t)},Ux=function(n,t,e,o,r){var i=Lx(n,(function(t){return jx(n,t)}));return w.from(i.backwards(t,e,o,r))},Wx="[data-mce-autocompleter]",Gx=function(n,t){return Xx($e.fromDom(n.selection.getNode())).getOrThunk((function(){var e=$e.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return Li(e,$e.fromDom(t.extractContents())),t.insertNode(e.dom()),Mi(e).each((function(n){return n.dom().normalize()})),md(e).map((function(t){n.selection.setCursorLocation(t.dom(),sd(t))})),e}))},Xx=function(n){return Kc(n,Wx)},Yx=function(n){return n.collapsed&&3===n.startContainer.nodeType},qx=function(n){return n.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Kx=function(n){return""!==n&&-1!==" \f\n\r\t\v".indexOf(n)},Jx=function(n,t){return n.substring(t.length)},$x=function(n,t,e){var o;for(o=t-1;o>=0;o--){var r=n.charAt(o);if(Kx(r))return w.none();if(r===e)break}return w.some(o)},Qx=function(n,t,e,o){if(void 0===o&&(o=0),!Yx(t))return w.none();var r=function(n,t,o){return $x(o,t,e).getOr(t)},i=n.getParent(t.startContainer,n.isBlock)||n.getRoot();return Ux(n,t.startContainer,t.startOffset,r,i).bind((function(n){var r=t.cloneRange();if(r.setStart(n.container,n.offset),r.setEnd(t.endContainer,t.endOffset),r.collapsed)return w.none();var i=qx(r),u=i.lastIndexOf(e);return 0!==u||Jx(i,e).length<o?w.none():w.some({text:Jx(i,e),range:r,triggerChar:e})}))},Zx=function(n,t,e,o){return void 0===o&&(o=0),Xx($e.fromDom(t.startContainer)).fold((function(){return Qx(n,t,e,o)}),(function(t){var o=n.createRng();o.selectNode(t.dom());var r=qx(o);return w.some({range:o,text:Jx(r,e),triggerChar:e})}))},nw=function(n,t){t.on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel);var e=function(n,t){ui(n,_r(),{raw:t})};t.on("keydown",(function(t){var o=function(){return n.getView().bind(vv.getHighlighted)};8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(o().each(ai),t.preventDefault()):40===t.which?(o().fold((function(){n.getView().each(vv.highlightFirst)}),(function(n){e(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||o().each((function(n){e(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())})),t.on("NodeChange",(function(t){n.isActive()&&!n.isProcessingAction()&&Xx($e.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))},tw={setup:nw},ew=tinymce.util.Tools.resolve("tinymce.util.Promise"),ow=function(n,t){return{container:n,offset:t}},rw=function(n){return n.nodeType===t.Node.TEXT_NODE},iw=function(n){return n.nodeType===t.Node.ELEMENT_NODE},uw=function(n){if(rw(n))return ow(n,n.data.length);var t=n.childNodes;return t.length>0?uw(t[t.length-1]):ow(n,t.length)},aw=function(n,t){var e=n.childNodes;return e.length>0&&t<e.length?aw(e[t],0):e.length>0&&iw(n)&&e.length===t?uw(e[e.length-1]):ow(n,t)},cw=function(n,t){return Ux(n,t.container,t.offset,(function(n,t){return 0===t?-1:t}),n.getRoot()).filter((function(n){var t=n.container.data.charAt(n.offset-1);return!Kx(t)})).isSome()},sw=function(n){return function(t){var e=aw(t.startContainer,t.startOffset);return!cw(n,e)}},fw=function(n,t,e){return pn(e.triggerChars,(function(e){return Zx(n,t,e)}))},lw=function(n,t){var e=t(),o=n.selection.getRng();return fw(n.dom,o,e).bind((function(e){return dw(n,t,e)}))},dw=function(n,t,e,o){void 0===o&&(o={});var r=t(),i=n.selection.getRng(),u=i.startContainer.nodeValue,a=$(r.lookupByChar(e.triggerChar),(function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk((function(){return sw(n.dom)}))(e.range,u,e.text)}));if(0===a.length)return w.none();var c=ew.all(Y(a,(function(n){var t=n.fetch(e.text,n.maxResults,o);return t.then((function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction}}))})));return w.some({lookupData:c,context:e})},mw=Ht([be("type"),Be("text")]),gw=function(n){return ne("separatormenuitem",mw,n)},pw=Ht([We("type",(function(){return"autocompleteitem"})),We("active",(function(){return!1})),We("disabled",(function(){return!1})),Ie("meta",{}),be("value"),Be("text"),Be("icon")]),vw=Ht([be("type"),be("ch"),Ve("minChars",1),Ie("columns",1),Ve("maxResults",10),De("matches"),we("fetch"),we("onAction")]),hw=function(n){return ne("Autocompleter.Separator",mw,n)},bw=function(n){return ne("Autocompleter.Item",pw,n)},yw=function(n){return ne("Autocompleter",vw,n)},xw=function(n){var t={};return q(n,(function(n){t[n]={}})),vn(t)},ww=function(n){var t=n.ui.registry.getAll().popups,e=yn(t,(function(n){return yw(n).fold((function(n){throw new Error(oe(n))}),(function(n){return n}))})),o=xw(Cn(e,(function(n){return n.ch}))),r=_n(e),i=function(n){return $(r,(function(t){return t.ch===n}))};return{dataset:e,triggerChars:o,lookupByChar:i}},Sw=[ze("disabled",!1),Be("text"),Be("shortcut"),Wt("value","value",tt((function(){return bu("menuitem-value")})),ue()),Ie("meta",{})],kw=Ht([be("type"),Ne("onSetup",(function(){return e})),Ne("onAction",e),Be("icon")].concat(Sw)),Cw=function(n){return ne("menuitem",kw,n)},Ow=Ht([be("type"),we("getSubmenuItems"),Ne("onSetup",(function(){return e})),Be("icon")].concat(Sw)),_w=function(n){return ne("nestedmenuitem",Ow,n)},Tw=Ht([be("type"),Be("icon"),ze("active",!1),Ne("onSetup",(function(){return e})),we("onAction")].concat(Sw)),Ew=function(n){return ne("togglemenuitem",Tw,n)},Bw=Ht([be("type"),ze("active",!1),Be("icon")].concat(Sw)),Dw=function(n){return ne("choicemenuitem",Bw,n)},Aw=["inserttable","colorswatch"],Mw=Ht([be("type"),ye("fancytype",Aw),Ne("onAction",e)]),Fw=function(n){return ne("fancymenuitem",Mw,n)},Iw=function(n,t,e){var o=pd(n.element(),"."+e);if(o.length>0){var r=en(o,(function(n){var e=n.dom().getBoundingClientRect().top,r=o[0].dom().getBoundingClientRect().top;return Math.abs(e-r)>t})).getOr(o.length);return w.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return w.none()},Rw=function(n,t){return hf([ny(n,t)])},Vw=function(n){return Rw(bu("unnamed-events"),n)},Hw={namedEvents:Rw,unnamedEvents:Vw},Pw=[pe("lazySink"),pe("tooltipDom"),Ie("exclusive",!0),Ie("tooltipComponents",[]),Ie("delay",300),Pe("mode","normal",["normal","follow-highlight"]),Ie("anchor",(function(n){return{anchor:"hotspot",hotspot:n,layouts:{onLtr:i([nf,Zs,Ks,$s,Js,Qs]),onRtl:i([nf,Zs,Ks,$s,Js,Qs])}}})),bs("onHide"),bs("onShow")],zw=function(){var n=Ge(w.none()),e=Ge(w.none()),o=function(){return e.get()},r=function(n){e.set(w.some(n))},u=function(){e.set(w.none())},a=function(){n.get().each((function(n){t.clearTimeout(n)}))},c=function(e,o){a(),n.set(w.some(t.setTimeout((function(){e()}),o)))},s=function(){return e.get().isSome()},f=i("not-implemented");return zu({getTooltip:o,isShowing:s,setTooltip:r,clearTooltip:u,clearTimer:a,resetTimer:c,readState:f})},Nw=Object.freeze({__proto__:null,init:zw}),Lw=bu("tooltip.exclusive"),jw=bu("tooltip.show"),Uw=bu("tooltip.hide"),Ww=function(n,t,e){n.getSystem().broadcastOn([Lw],{})},Gw=function(n,t,e,o){e.getTooltip().each((function(n){n.getSystem().isConnected()&&Qb.set(n,o)}))},Xw=Object.freeze({__proto__:null,hideAllExclusive:Ww,setComponents:Gw}),Yw=function(n,t){var e=function(e){t.getTooltip().each((function(o){xm(o),n.onHide(e,o),t.clearTooltip()})),t.clearTimer()},o=function(e){if(!t.isShowing()){Ww(e);var o=n.lazySink(e).getOrDie(),r=e.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:li("normal"===n.mode?[pi(kr(),(function(n){ii(e,jw)})),pi(wr(),(function(n){ii(e,Uw)}))]:[]),behaviours:hf([Qb.config({})])});t.setTooltip(r),hm(o,r),n.onShow(e,r),lm.position(o,n.anchor(e),r)}};return li(on([[pi(jw,(function(e){t.resetTimer((function(){o(e)}),n.delay)})),pi(Uw,(function(o){t.resetTimer((function(){e(o)}),n.delay)})),pi(Hr(),(function(n,t){var o=t;U(o.channels(),Lw)&&e(n)})),_i((function(n){e(n)}))],"normal"===n.mode?[pi(Cr(),(function(n){ii(n,jw)})),pi(Rr(),(function(n){ii(n,Uw)})),pi(kr(),(function(n){ii(n,jw)})),pi(wr(),(function(n){ii(n,Uw)}))]:[pi(oi(),(function(n,t){ii(n,jw)})),pi(ri(),(function(n){ii(n,Uw)}))]]))},qw=Object.freeze({__proto__:null,events:Yw}),Kw=yf({fields:Pw,name:"tooltipping",active:qw,state:Nw,apis:Xw}),Jw=tinymce.util.Tools.resolve("tinymce.util.I18n"),$w="tox-menu-nav__js",Qw="tox-collection__item",Zw="tox-swatch",nS={normal:$w,color:Zw},tS="tox-collection__item--enabled",eS="tox-collection__group-heading",oS="tox-collection__item-icon",rS="tox-collection__item-label",iS="tox-collection__item-accessory",uS="tox-collection__item-caret",aS="tox-collection__item-checkmark",cS="tox-collection__item--active",sS="tox-collection__item-icon-rtl",fS=function(n){return Tn(nS,n).getOr($w)},lS=tinymce.util.Tools.resolve("tinymce.Env"),dS=function(n){var t={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},e={meta:"Ctrl",access:"Shift+Alt"},o=lS.mac?t:e,r=n.split("+"),i=Y(r,(function(n){var t=n.toLowerCase().trim();return En(o,t)?o[t]:n}));return lS.mac?i.join(""):i.join("+")},mS=function(n){return{dom:{tag:"div",classes:[oS],innerHtml:n}}},gS=function(n){return{dom:{tag:"div",classes:[rS]},components:[Ja(Jw.translate(n))]}},pS=function(n){return{dom:{tag:"div",classes:[rS],innerHtml:n}}},vS=function(n,t){return{dom:{tag:"div",classes:[rS]},components:[{dom:{tag:n.tag,styles:n.styles},components:[Ja(Jw.translate(t))]}]}},hS=function(n){return{dom:{tag:"div",classes:[iS],innerHtml:dS(n)}}},bS=function(n){return{dom:{tag:"div",classes:[aS],innerHtml:Ax("checkmark",n)}}},yS=function(n){return{dom:{tag:"div",classes:[uS],innerHtml:Ax("chevron-right",n)}}},xS=function(n){return{dom:{tag:"div",classes:[uS],innerHtml:Ax("chevron-down",n)}}},wS=function(n,t,e,o){var r="custom",i="remove",u=function(){var u=Zw,a=e.getOr(""),c=n.map((function(n){return{title:o.translate(n)}})).getOr({}),s={tag:"div",attributes:c,classes:[u]};return m(m({},s),t===r?{tag:"button",classes:p(s.classes,["tox-swatches__picker-btn"]),innerHtml:a}:t===i?{classes:p(s.classes,["tox-swatch--remove"]),innerHtml:a}:{attributes:m(m({},s.attributes),{"data-mce-color":t}),styles:{"background-color":t}})};return{dom:u(),optComponents:[]}},SS=function(n,t,e,o,r){var i=e?t.or(w.some("")).map(mS):w.none(),u=n.checkMark,a=n.ariaLabel.map((function(n){return{attributes:{title:Jw.translate(n)}}})).getOr({}),c=m({tag:"div",classes:[$w,Qw].concat(r?[sS]:[])},a),s=n.htmlContent.fold((function(){return n.textContent.map(o)}),(function(n){return w.some(pS(n))})),f={dom:c,optComponents:[i,s,n.shortcutContent.map(hS),u,n.caret]};return f},kS=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],CS=["list-bull-circle","list-bull-default","list-bull-square"],OS=function(n,t,e,o){void 0===o&&(o=w.none());var r=function(n){return n.map((function(n){return Jw.isRtl()&&U(kS,n)?n+"-rtl":n}))},i=Jw.isRtl()&&n.iconContent.exists((function(n){return U(CS,n)})),u=r(n.iconContent).map((function(n){return Mx(n,t.icons,o)})),c=w.from(n.meta).fold((function(){return gS}),(function(n){return En(n,"style")?a(vS,n.style):gS}));return"color"===n.presets?wS(n.ariaLabel,n.value,u,t):SS(n,u,e,c,i)},_S=["input","button","textarea","select"],TS=function(n,t,e){var o=t.disabled()?RS:VS;o(n,t,e)},ES=function(n,t){return!0===t.useNative&&U(_S,Qi(n.element()))},BS=function(n){return cu(n.element(),"disabled")},DS=function(n){ru(n.element(),"disabled","disabled")},AS=function(n){su(n.element(),"disabled")},MS=function(n){return"true"===uu(n.element(),"aria-disabled")},FS=function(n){ru(n.element(),"aria-disabled","true")},IS=function(n){ru(n.element(),"aria-disabled","false")},RS=function(n,t,e){t.disableClass.each((function(t){ha(n.element(),t)}));var o=ES(n,t)?DS:FS;o(n),t.onDisabled(n)},VS=function(n,t,e){t.disableClass.each((function(t){ya(n.element(),t)}));var o=ES(n,t)?AS:IS;o(n),t.onEnabled(n)},HS=function(n,t){return ES(n,t)?BS(n):MS(n)},PS=function(n,t,e,o){var r=o?RS:VS;r(n,t,e)},zS=Object.freeze({__proto__:null,enable:VS,disable:RS,isDisabled:HS,onLoad:TS,set:PS}),NS=function(n,t){return Wu({classes:t.disabled?t.disableClass.map(fn).getOr([]):[]})},LS=function(n,t){return li([di(Pr(),(function(t,e){return HS(t,n)})),lf(n,t,TS)])},jS=Object.freeze({__proto__:null,exhibit:NS,events:LS}),US=[Ne("disabled",f),Ie("useNative",!0),_e("disableClass"),bs("onDisabled"),bs("onEnabled")],WS=yf({fields:US,name:"disabling",active:jS,apis:zS}),GS=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),XS=tinymce.util.Tools.resolve("tinymce.EditorManager"),YS=function(n){var t=n.settings,e=t.skin,o=t.skin_url;if(!1!==e){var r=e||"oxide";o=o?n.documentBaseURI.toAbsolute(o):XS.baseURL+"/skins/ui/"+r}return o},qS=function(n){return n.getParam("readonly",!1,"boolean")},KS=function(n){return!1===n.getParam("skin")},JS=function(n){return n.getParam("height",Math.max(n.getElement().offsetHeight,200))},$S=function(n){return n.getParam("width",GS.DOM.getStyle(n.getElement(),"width"))},QS=function(n){return w.from(n.settings.min_width).filter(V)},ZS=function(n){return w.from(n.settings.min_height).filter(V)},nk=function(n){return w.from(n.getParam("max_width")).filter(V)},tk=function(n){return w.from(n.getParam("max_height")).filter(V)},ek=function(n){return w.from(n.getParam("style_formats")).filter(M)},ok=function(n){return n.getParam("style_formats_merge",!1,"boolean")},rk=function(n){return n.getParam("removed_menuitems","")},ik=function(n){return!1!==n.getParam("menubar",!0,"boolean")},uk=function(n){var t=n.getParam("toolbar",!0),e=!0===t,o=D(t),r=M(t)&&t.length>0;return!ck(n)&&(r||o||e)},ak=function(n){var t=vn(n.settings),e=$(t,(function(n){return/^toolbar([1-9])$/.test(n)})),o=Y(e,(function(t){return n.getParam(t,!1,"string")})),r=$(o,(function(n){return"string"===typeof n}));return r.length>0?w.some(r):w.none()},ck=function(n){return ak(n).fold((function(){var t=n.getParam("toolbar",[],"string[]");return t.length>0}),(function(){return!0}))};(function(n){n["default"]="wrap",n["floating"]="floating",n["sliding"]="sliding",n["scrolling"]="scrolling"})(Px||(Px={}));var sk,fk=function(n){return n.getParam("toolbar_mode","","string")};(function(n){n["auto"]="auto",n["top"]="top",n["bottom"]="bottom"})(sk||(sk={}));var lk,dk=function(n){return n.getParam("toolbar_groups",{},"object")},mk=function(n){return n.getParam("toolbar_location",sk.auto,"string")},gk=function(n){return mk(n)===sk.bottom},pk=function(n){return n.getParam("fixed_toolbar_container","","string")},vk=function(n){var t=pk(n);return t.length>0&&n.inline?qc(Oa(),t):w.none()},hk=function(n){return n.inline&&vk(n).isSome()},bk=function(n){var t=vk(n);return t.getOr(Oa())},yk=function(n){return n.inline&&!ik(n)&&!uk(n)&&!ck(n)},xk=function(n){var t=n.getParam("toolbar_sticky",!1,"boolean");return(t||n.inline)&&!hk(n)&&!yk(n)},wk=function(n){return n.getParam("draggable_modal",!1,"boolean")},Sk="silver.readonly",kk=Ht([xe("readonly")]),Ck=function(n,t){var e=n.outerContainer,o=e.element();t&&(n.mothership.broadcastOn([Xm()],{target:o}),n.uiMothership.broadcastOn([Xm()],{target:o})),n.mothership.broadcastOn([Sk],{readonly:t}),n.uiMothership.broadcastOn([Sk],{readonly:t})},Ok=function(n,t){n.on("init",(function(){n.mode.isReadOnly()&&Ck(t,!0)})),n.on("SwitchMode",(function(){return Ck(t,n.mode.isReadOnly())})),qS(n)&&n.setMode("readonly")},_k=function(){var n;return Tf.config({channels:(n={},n[Sk]={schema:kk,onReceive:function(n,t){WS.set(n,t.readonly)}},n)})},Tk=function(n){return WS.config({disabled:n,disableClass:"tox-collection__item--state-disabled"})},Ek=function(n){return WS.config({disabled:n})},Bk=function(n){return WS.config({disabled:n,disableClass:"tox-tbtn--disabled"})},Dk=function(n){return WS.config({disabled:n,disableClass:"tox-tbtn--disabled",useNative:!1})},Ak={item:Tk,button:Ek,splitButton:Bk,toolbarButton:Dk},Mk=function(n,t){var e=n.getApi(t);return function(n){n(e)}},Fk=function(n,t){return Oi((function(e){var o=Mk(n,e);o((function(e){var o=n.onSetup(e);null!==o&&void 0!==o&&t.set(o)}))}))},Ik=function(n,t){return _i((function(e){return Mk(n,e)(t.get())}))};(function(n){n[n["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",n[n["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(lk||(lk={}));var Rk=lk,Vk=function(n,t){return Ei((function(e,o){Mk(n,e)(n.onAction),n.triggersSubmenu||t!==Rk.CLOSE_ON_EXECUTE||(ii(e,jr()),o.stop())}))},Hk={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},Pk=function(n){return rn(n,(function(n){return n.toArray()}))},zk=function(n,t,o,r){var i=Ge(e);return{type:"item",dom:t.dom,components:Pk(t.optComponents),data:n.data,eventOrder:Hk,hasSubmenu:n.triggersSubmenu,itemBehaviours:hf([ny("item-events",[Vk(n,o),Fk(n,i),Ik(n,i)]),Ak.item((function(){return n.disabled||r.isReadOnly()})),_k(),Qb.config({})].concat(n.itemBehaviours))}},Nk=function(n){return{value:n.value,meta:m({text:n.text.getOr("")},n.meta)}},Lk=function(n,t){return Tn(n,"tooltipWorker").map((function(n){return[Kw.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(n){return{anchor:"submenu",item:n,overrides:{maxHeightFunction:sl}}},mode:"follow-highlight",onShow:function(t,e){n((function(n){Kw.setComponents(t,[$a({element:$e.fromDom(n)})])}))}})]})).getOr([])},jk=function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},Uk=function(n){return GS.DOM.encode(n)},Wk=function(n,t){var e=Jw.translate(n),o=Uk(e);if(t.length>0){var r=new RegExp(jk(t),"gi");return o.replace(r,(function(n){return'<span class="tox-autocompleter-highlight">'+n+"</span>"}))}return o},Gk=function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);var c=OS({presets:o,textContent:w.none(),htmlContent:e?n.text.map((function(n){return Wk(n,t)})):w.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:w.none(),checkMark:w.none(),caret:w.none(),value:n.value},u.providers,a,n.icon);return zk({data:Nk(n),disabled:n.disabled,getApi:function(){return{}},onAction:function(t){return r(n.value,n.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:Lk(n.meta,u)},c,i,u.providers)},Xk=function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);var c=function(n){return{setActive:function(t){Ey.set(n,t)},isActive:function(){return Ey.isOn(n)},isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)}}},s=OS({presets:e,textContent:t?n.text:w.none(),htmlContent:w.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:w.none(),checkMark:t?w.some(bS(u.icons)):w.none(),caret:w.none(),value:n.value},u,a);return Vn(zk({data:Nk(n),disabled:n.disabled,getApi:c,onAction:function(t){return o(n.value)},onSetup:function(n){return n.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},s,i,u),{toggling:{toggleClass:tS,toggleOnExecute:!1,selected:n.active}})},Yk=i(gp(Ly(),jy())),qk=bu("cell-over"),Kk=bu("cell-execute"),Jk=function(n,t,e){var o,r=function(e){return ui(e,qk,{row:n,col:t})},i=function(e){return ui(e,Kk,{row:n,col:t})},u=function(n,t){t.stop(),i(n)};return Za({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:hf([ny("insert-table-picker-cell",[pi(kr(),sy.focus),pi(Pr(),i),pi(Dr(),u),pi(Nr(),u)]),Ey.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),sy.config({onFocus:r})])})},$k=function(n,t,e){for(var o=[],r=0;r<t;r++){for(var i=[],u=0;u<e;u++)i.push(Jk(r,u,n));o.push(i)}return o},Qk=function(n,t,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Ey.set(n[i][u],i<=t&&u<=e)},Zk=function(n){return rn(n,(function(n){return Y(n,nc)}))},nC=function(n,t){return Ja(t+1+"x"+(n+1))},tC=function(n){var t=10,e=10,o=bu("size-label"),r=$k(o,t,e),i=Bx({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:o}},components:[Ja("0x0")],behaviours:hf([Qb.config({})])});return{type:"widget",data:{value:bu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Yk().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Zk(r).concat(i.asSpec()),behaviours:hf([ny("insert-table-picker",[wi(qk,(function(n,o,u){var a=u.event().row(),c=u.event().col();Qk(r,a,c,t,e),Qb.set(i.get(n),[nC(a,c)])})),wi(Kk,(function(t,e,o){n.onAction({numRows:o.event().row()+1,numColumns:o.event().col()+1}),ii(t,jr())}))]),jb.config({initSize:{numRows:t,numColumns:e},mode:"flatgrid",selector:'[role="button"]'})])})]}},eC=function(n){return{value:n}},oC=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,rC=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,iC=function(n){return oC.test(n)||rC.test(n)},uC=function(n){var t=n.value.replace(oC,(function(n,t,e,o){return t+t+e+e+o+o}));return{value:t}},aC=function(n){var t=uC(n),e=rC.exec(t.value);return null===e?["FFFFFF","FF","FF","FF"]:e},cC=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},sC=function(n){var t=cC(n.red)+cC(n.green)+cC(n.blue);return eC(t)},fC=Math.min,lC=Math.max,dC=Math.round,mC=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,gC=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,pC=function(n,t,e,o){return{red:n,green:t,blue:e,alpha:o}},vC=function(n){var t=parseInt(n,10);return t.toString()===n&&t>=0&&t<=255},hC=function(n){var t,e,o,r=(n.hue||0)%360,i=n.saturation/100,u=n.value/100;if(i=lC(0,fC(i,1)),u=lC(0,fC(u,1)),0===i)return t=e=o=dC(255*u),pC(t,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:t=c,e=s,o=0;break;case 1:t=s,e=c,o=0;break;case 2:t=0,e=c,o=s;break;case 3:t=0,e=s,o=c;break;case 4:t=s,e=0,o=c;break;case 5:t=c,e=0,o=s;break;default:t=e=o=0}return t=dC(255*(t+f)),e=dC(255*(e+f)),o=dC(255*(o+f)),pC(t,e,o,1)},bC=function(n){var t=aC(n),e=parseInt(t[1],16),o=parseInt(t[2],16),r=parseInt(t[3],16);return pC(e,o,r,1)},yC=function(n,t,e,o){var r=parseInt(n,10),i=parseInt(t,10),u=parseInt(e,10),a=parseFloat(o);return pC(r,i,u,a)},xC=function(n){if("transparent"===n)return w.some(pC(0,0,0,0));var t=mC.exec(n);if(null!==t)return w.some(yC(t[1],t[2],t[3],"1"));var e=gC.exec(n);return null!==e?w.some(yC(e[1],e[2],e[3],e[4])):w.none()},wC=function(n){return"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")"},SC=pC(255,0,0,1),kC=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),CC="tinymce-custom-colors";function OC(n){void 0===n&&(n=10);var t=kC.getItem(CC),e=D(t)?JSON.parse(t):[],o=function(t){var e=n-t.length;return e<0?t.slice(0,n):t},r=o(e),i=function(t){j(r,t).each(u),r.unshift(t),r.length>n&&r.pop(),kC.setItem(CC,JSON.stringify(r))},u=function(n){r.splice(n,1)},a=function(){return r.slice(0)};return{add:i,state:a}}var _C="choiceitem",TC=[{type:_C,text:"Light Green",value:"#BFEDD2"},{type:_C,text:"Light Yellow",value:"#FBEEB8"},{type:_C,text:"Light Red",value:"#F8CAC6"},{type:_C,text:"Light Purple",value:"#ECCAFA"},{type:_C,text:"Light Blue",value:"#C2E0F4"},{type:_C,text:"Green",value:"#2DC26B"},{type:_C,text:"Yellow",value:"#F1C40F"},{type:_C,text:"Red",value:"#E03E2D"},{type:_C,text:"Purple",value:"#B96AD9"},{type:_C,text:"Blue",value:"#3598DB"},{type:_C,text:"Dark Turquoise",value:"#169179"},{type:_C,text:"Orange",value:"#E67E23"},{type:_C,text:"Dark Red",value:"#BA372A"},{type:_C,text:"Dark Purple",value:"#843FA1"},{type:_C,text:"Dark Blue",value:"#236FA1"},{type:_C,text:"Light Gray",value:"#ECF0F1"},{type:_C,text:"Medium Gray",value:"#CED4D9"},{type:_C,text:"Gray",value:"#95A5A6"},{type:_C,text:"Dark Gray",value:"#7E8C8D"},{type:_C,text:"Navy Blue",value:"#34495E"},{type:_C,text:"Black",value:"#000000"},{type:_C,text:"White",value:"#ffffff"}],EC=OC(10),BC=function(n){var e=[],o=t.document.createElement("canvas");o.height=1,o.width=1;for(var r=o.getContext("2d"),i=function(n,t){var e=255,o=t/255,r=Math.round(n*o+e*(1-o));return("0"+r.toString(16)).slice(-2).toUpperCase()},u=function(n){if(/^[0-9A-Fa-f]{6}$/.test(n))return"#"+n.toUpperCase();r.clearRect(0,0,o.width,o.height),r.fillStyle="#FFFFFF",r.fillStyle=n,r.fillRect(0,0,1,1);var t=r.getImageData(0,0,1,1).data,e=t[0],u=t[1],a=t[2],c=t[3];return"#"+i(e,c)+i(u,c)+i(a,c)},a=0;a<n.length;a+=2)e.push({text:n[a+1],value:u(n[a]),type:"choiceitem"});return e},DC=function(n,t){return n.getParam("color_cols",t,"number")},AC=function(n){return!1!==n.getParam("custom_colors")},MC=function(n){return n.getParam("color_map")},FC=function(n){var t=MC(n);return void 0!==t?BC(t):TC},IC=function(){return Y(EC.state(),(function(n){return{type:_C,text:n,value:n}}))},RC=function(n){EC.add(n)},VC=function(n){return n.fire("SkinLoaded")},HC=function(n,t){return n.fire("SkinLoadError",t)},PC=function(n){return n.fire("ResizeEditor")},zC=function(n,t){return n.fire("ResizeContent",t)},NC=function(n,t){return n.fire("ScrollContent",t)},LC=function(n,t){return n.fire("TextColorChange",t)},jC=function(n,t){var e;return n.dom.getParents(n.selection.getStart(),(function(n){var o;(o=n.style["forecolor"===t?"color":"background-color"])&&(e=e||o)})),e},UC=function(n,t,e){n.undoManager.transact((function(){n.focus(),n.formatter.apply(t,{value:e}),n.nodeChanged()}))},WC=function(n,t){n.undoManager.transact((function(){n.focus(),n.formatter.remove(t,{value:null},null,!0),n.nodeChanged()}))},GC=function(n){n.addCommand("mceApplyTextcolor",(function(t,e){UC(n,t,e)})),n.addCommand("mceRemoveTextcolor",(function(t){WC(n,t)}))},XC=function(n){return Math.max(5,Math.ceil(Math.sqrt(n)))},YC=function(n){var t=FC(n),e=XC(t.length);return DC(n,e)},qC=function(n){var t="choiceitem",e={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},o={type:t,text:"Custom color",icon:"color-picker",value:"custom"};return n?[e,o]:[e]},KC=function(n,t,e,o){if("custom"===e){var r=tO(n);r((function(e){e.each((function(e){RC(e),n.execCommand("mceApplyTextcolor",t,e),o(e)}))}),"#000000")}else"remove"===e?(o(""),n.execCommand("mceRemoveTextcolor",t)):(o(e),n.execCommand("mceApplyTextcolor",t,e))},JC=function(n,t){return n.concat(IC().concat(qC(t)))},$C=function(n,t){return function(e){e(JC(n,t))}},QC=function(n,t,e){var o=function(t,e){n.setIconFill(t,e),n.setIconStroke(t,e)},r="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";o(r,e)},ZC=function(n,t,e,o,r){n.ui.registry.addSplitButton(t,{tooltip:o,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){var o=w.from(jC(n,e));return o.bind((function(n){return xC(n).map((function(n){var e=sC(n).value;return Fo(t.toLowerCase(),e)}))})).getOr(!1)},columns:YC(n),fetch:$C(FC(n),AC(n)),onAction:function(t){null!==r.get()&&KC(n,e,r.get(),(function(){}))},onItemAction:function(o,i){KC(n,e,i,(function(e){r.set(e),LC(n,{name:t,color:e})}))},onSetup:function(e){null!==r.get()&&QC(e,t,r.get());var o=function(n){n.name===t&&QC(e,n.name,n.color)};return n.on("TextColorChange",o),function(){n.off("TextColorChange",o)}}})},nO=function(n,t,o,r){n.ui.registry.addNestedMenuItem(t,{text:r,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){KC(n,o,t.value,e)}}]}})},tO=function(n){return function(t,e){var o=function(n){return function(t){var e=t.getData();n(w.from(e.colorpicker)),t.close()}},r=function(n,t){"hex-valid"===t.name&&(t.value?n.enable("ok"):n.disable("ok"))},i={colorpicker:e},u=o(t);n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onAction:r,onSubmit:u,onClose:function(){},onCancel:function(){t(w.none())}})}},eO=function(n){GC(n);var t=Ge(null),e=Ge(null);ZC(n,"forecolor","forecolor","Text color",t),ZC(n,"backcolor","hilitecolor","Background color",e),nO(n,"forecolor","forecolor","Text color"),nO(n,"backcolor","hilitecolor","Background color")},oO=function(n){return"color"===n?"tox-swatches":"tox-menu"},rO=function(n){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:oO(n),tieredMenu:"tox-tiered-menu"}},iO=function(n){var t=rO(n);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:fS(n)}},uO=function(n,t,e){var o=rO(e);return{tag:"div",classes:on([[o.menu,"tox-menu-"+t+"-column"],n?[o.hasIcons]:[]])}},aO=[Zy.parts().items({})],cO=function(n,t,e){var o=rO(e),r={tag:"div",classes:on([[o.tieredMenu]])};return{dom:r,markers:iO(e)}},sO=function(n,t){return function(e){var o=X(e,t);return Y(o,(function(t){return{dom:n,components:t}}))}},fO=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Zy.parts().items({preprocess:"auto"!==n?sO({tag:"div",classes:["tox-swatches__row"]},n):u})]}]}},lO=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Zy.parts().items({preprocess:sO({tag:"div",classes:["tox-collection__group"]},n)})]}},dO=function(n,t){var e=[],o=[];return q(n,(function(n,r){t(n,r)?(o.length>0&&e.push(o),o=[],En(n.dom,"innerHtml")&&o.push(n)):o.push(n)})),o.length>0&&e.push(o),Y(e,(function(n){return{dom:{tag:"div",classes:["tox-collection__group"]},components:n}}))},mO=function(n,t,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Zy.parts().items({preprocess:function(e){return"auto"!==n&&n>1?sO({tag:"div",classes:["tox-collection__group"]},n)(e):dO(e,(function(n,e){return"separator"===t[e].type}))}})]}},gO=function(n,t){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Zy.parts().items({preprocess:function(t){return dO(t,(function(t,e){return"separator"===n[e].type}))}})]}},pO=function(n){return W(n,(function(n){return"icon"in n&&void 0!==n.icon}))},vO=function(n){return t.console.error(oe(n)),t.console.log(n),w.none()},hO=function(n,t,e,o,r){var i=gO(e);return{value:n,dom:i.dom,components:i.components,items:e}},bO=function(n,t,e,o,r){if("color"===r){var i=fO(o);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r&&"auto"===o){i=mO(o,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r&&1===o){i=mO(1,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r){i=mO(o,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("listpreview"===r&&"auto"!==o){i=lO(o);return{value:n,dom:i.dom,components:i.components,items:e}}return{value:n,dom:uO(t,o,r),components:aO,items:e}},yO=function(n,t,e,o,r,i,u,a){var c=pO(t),s="color"!==r?"normal":"color",f=xO(t,e,o,s,i,u,a);return bO(n,c,f,o,r)},xO=function(n,t,e,o,r,i,u){return jp(Y(n,(function(a){return"choiceitem"===a.type?Dw(a).fold(vO,(function(c){return w.some(Xk(c,1===e,o,t,i(a.value),r,u,pO(n)))})):w.none()})))},wO=function(n,t){var e=iO(t);if(1===n)return{mode:"menu",moveOnTab:!0};if("auto"===n)return{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}};var o="color"===t?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+o}},SO=function(n,t){return 1===n?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===n?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?"."+Zw:"."+Qw}}};function kO(n,t){var e=JC(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),r="color",i=yO(bu("menu-value"),e,(function(t){n.onAction({value:t})}),o,r,Rk.CLOSE_ON_EXECUTE,(function(){return!1}),t.shared.providers),u=m(m({},i),{markers:iO(r),movement:wO(o,r)});return{type:"widget",data:{value:bu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Yk().widget(Zy.sketch(u))]}}var CO,OO={inserttable:tC,colorswatch:kO},_O=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)?w.some(n[t]):w.none()},TO=function(n,t){return _O(OO,n.fancytype).map((function(e){return e(n,t)}))},EO=function(n,t,e,o){void 0===o&&(o=!0);var r=function(n){return{isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)}}},i=OS({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,caret:w.none(),checkMark:w.none(),shortcutContent:n.shortcut},e,o);return zk({data:Nk(n),getApi:r,disabled:n.disabled,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,e)},BO=function(n,t,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var u=i?xS(o.icons):yS(o.icons),a=function(n){return{isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)}}},c=OS({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,caret:w.some(u),checkMark:w.none(),shortcutContent:n.shortcut},o,r);return zk({data:Nk(n),getApi:a,disabled:n.disabled,onAction:e,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,t,o)},DO=function(n){var t=n.text.fold((function(){return{}}),(function(n){return{innerHtml:n}}));return{type:"separator",dom:m({tag:"div",classes:[Qw,eS]},t),components:[]}},AO=function(n,t,e,o){void 0===o&&(o=!0);var r=function(n){return{setActive:function(t){Ey.set(n,t)},isActive:function(){return Ey.isOn(n)},isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)}}},i=OS({iconContent:n.icon,textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,checkMark:w.some(bS(e.icons)),caret:w.none(),shortcutContent:n.shortcut,presets:"normal",meta:n.meta},e,o);return Vn(zk({data:Nk(n),disabled:n.disabled,getApi:r,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,e),{toggling:{toggleClass:tS,toggleOnExecute:!1,selected:n.active}})},MO=Gk,FO=DO,IO=EO,RO=BO,VO=AO,HO=TO;(function(n){n[n["ContentFocus"]=0]="ContentFocus",n[n["UiFocus"]=1]="UiFocus"})(CO||(CO={}));var PO=function(n,e,o,r,i){var u=o.shared.providers,a=function(n){return i?m(m({},n),{shortcut:w.none(),icon:n.text.isSome()?w.none():n.icon}):n};switch(n.type){case"menuitem":return Cw(n).fold(vO,(function(n){return w.some(IO(a(n),e,u,r))}));case"nestedmenuitem":return _w(n).fold(vO,(function(n){return w.some(RO(a(n),e,u,r,i))}));case"togglemenuitem":return Ew(n).fold(vO,(function(n){return w.some(VO(a(n),e,u,r))}));case"separator":return gw(n).fold(vO,(function(n){return w.some(FO(n))}));case"fancymenuitem":return Fw(n).fold(vO,(function(n){return HO(a(n),o)}));default:return t.console.error("Unknown item in general menu",n),w.none()}},zO=function(n,t,e,o,r,i){var u=1===o,a=!u||pO(n);return jp(Y(n,(function(n){return"separator"===n.type?hw(n).fold(vO,(function(n){return w.some(FO(n))})):bw(n).fold(vO,(function(n){return w.some(MO(n,t,u,"normal",e,r,i,a))}))})))},NO=function(n,t,e,o,r){var i=pO(t),u=jp(Y(t,(function(n){var t=function(n){return r?!n.hasOwnProperty("text"):i},u=function(n){return PO(n,e,o,t(n),r)};return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?u(m(m({},n),{disabled:!0})):u(n)}))),a=r?hO:bO;return a(n,i,u,1,"normal")},LO=function(n){return lx.singleData(n.value,n)},jO=function(n,t,e,o){var r=e===CO.ContentFocus?zv():Pv(),i=wO(t,o),u=iO(o);return{dom:n.dom,components:n.components,items:n.items,value:n.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===CO.ContentFocus,focusManager:r,menuBehaviours:Hw.unnamedEvents("auto"!==t?[]:[Oi((function(n,t){Iw(n,4,u.item).each((function(t){var e=t.numColumns,o=t.numRows;jb.setGridSize(n,o,e)}))}))])}},UO=function(n,e){var o=Ge(w.none()),r=Ge(!1),i=Za(gx.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:hf([ny("dismissAutocompleter",[pi($r(),(function(){return s()}))])]),lazySink:e.getSink})),u=function(){return gx.isOpen(i)},a=function(){return o.get().isSome()},c=function(){a()&&gx.hide(i)},s=function(){if(a()){var t=o.get().map((function(n){return n.element}));Xx(t.getOr($e.fromDom(n.selection.getNode()))).each(Yi),c(),o.set(w.none()),r.set(!1)}},f=Pn((function(){return ww(n)})),l=function(o,i){var u=pn(i,(function(n){return w.from(n.columns)})).getOr(1);return rn(i,(function(i){var a=i.items;return zO(a,i.matchText,(function(e,u){var a=n.selection.getRng();Zx(n.dom,a,o).fold((function(){return t.console.error("Lost context. Cursor probably moved")}),(function(n){var t=n.range,o={hide:function(){s()},reload:function(n){c(),p(n)}};r.set(!0),i.onAction(o,t,e,u),r.set(!1)}))}),u,Rk.BUBBLE_TO_SANDBOX,e)}))},d=function(t){if(!a()){var e=Gx(n,t.range);o.set(w.some({triggerChar:t.triggerChar,element:e,matchLength:t.text.length})),r.set(!1)}},m=function(t,e,o,r){t.matchLength=e.text.length;var u=pn(o,(function(n){return w.from(n.columns)})).getOr(1);gx.showAt(i,{anchor:"node",root:$e.fromDom(n.getBody()),node:w.from(t.element)},Zy.sketch(jO(bO("autocompleter-value",!0,r,u,"normal"),u,CO.ContentFocus,"normal"))),gx.getContent(i).each(vv.highlightFirst)},g=function(t){return o.get().map((function(e){return Zx(n.dom,n.selection.getRng(),e.triggerChar).bind((function(e){return dw(n,f,e,t)}))})).getOrThunk((function(){return lw(n,f)}))},p=function(n){g(n).fold(s,(function(n){d(n.context),n.lookupData.then((function(t){o.get().map((function(e){var o=n.context;if(e.triggerChar===o.triggerChar){var r=l(o.triggerChar,t);r.length>0?m(e,o,t,r):o.text.length-e.matchLength>=10?s():c()}}))}))}))},v=Nx((function(n){27!==n.which&&p()}),50),h={onKeypress:v,cancelIfNecessary:s,isMenuOpen:u,isActive:a,isProcessingAction:r.get,getView:function(){return gx.getContent(i)}};tw.setup(h,n)},WO={register:UO},GO=i(!0),XO=function(n,t,e){return wc(n,t,GO,e)},YO=function(n,t,e){return Sc(n,t,GO,e)},qO=bc,KO=function(n,t,e){return Kc(n,t,e).isSome()};function JO(n,e){var o=null,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o=t.setTimeout((function(){n.apply(null,r),o=null}),e)},i=function(){null!==o&&(t.clearTimeout(o),o=null)};return{cancel:i,schedule:r}}var $O=5,QO=400,ZO=function(n){var t=n.raw();return void 0===t.touches||1!==t.touches.length?w.none():w.some(t.touches[0])},n_=function(n,t){var e=Math.abs(n.clientX-t.x),o=Math.abs(n.clientY-t.y);return e>$O||o>$O},t_=function(n){var t=Ge(w.none()),e=Ge(!1),o=JO((function(t){n.triggerEvent(Lr(),t),e.set(!0)}),QO),r=function(n){return ZO(n).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:n.target()};o.schedule(n),e.set(!1),t.set(w.some(i))})),w.none()},i=function(n){return o.cancel(),ZO(n).each((function(n){t.get().each((function(e){n_(n,e)&&t.set(w.none())}))})),w.none()},u=function(r){o.cancel();var i=function(n){return er(n.target,r.target())};return t.get().filter(i).map((function(t){return e.get()?(r.prevent(),!1):n.triggerEvent(Nr(),r)}))},a=st([{key:pr(),value:r},{key:vr(),value:i},{key:hr(),value:u}]),c=function(n,t){return Tn(a,t).bind((function(t){return t(n)}))};return{fireIfReady:c}},e_=function(n){var t=n.raw();return t.which===hv()[0]&&!U(["input","textarea"],Qi(n.target()))&&!KO(n.target(),'[contenteditable="true"]')},o_=function(){return Xo().browser.isFirefox()},r_=Vt([we("triggerEvent"),Ie("stopBackspace",!0)]),i_=function(n,t){return o_()?YO(n,"focus",t):XO(n,"focusin",t)},u_=function(n,t){return o_()?YO(n,"blur",t):XO(n,"focusout",t)},a_=function(n,e){var o=ee("Getting GUI events settings",r_,e),r=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],i=t_(o),u=Y(r.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return XO(n,t,(function(n){i.fireIfReady(n,t).each((function(t){t&&n.kill()}));var e=o.triggerEvent(t,n);e&&n.kill()}))})),a=Ge(w.none()),c=XO(n,"paste",(function(n){i.fireIfReady(n,"paste").each((function(t){t&&n.kill()}));var e=o.triggerEvent("paste",n);e&&n.kill(),a.set(w.some(t.setTimeout((function(){o.triggerEvent(Vr(),n)}),0)))})),s=XO(n,"keydown",(function(n){var t=o.triggerEvent("keydown",n);t?n.kill():!0===o.stopBackspace&&e_(n)&&n.prevent()})),f=i_(n,(function(n){var t=o.triggerEvent("focusin",n);t&&n.kill()})),l=Ge(w.none()),d=u_(n,(function(n){var e=o.triggerEvent("focusout",n);e&&n.kill(),l.set(w.some(t.setTimeout((function(){o.triggerEvent(Rr(),n)}),0)))})),m=function(){q(u,(function(n){n.unbind()})),s.unbind(),f.unbind(),d.unbind(),c.unbind(),a.get().each(t.clearTimeout),l.get().each(t.clearTimeout)};return{unbind:m}},c_=function(n,t){var e=Tn(n,"target").map((function(n){return n()})).getOr(t);return Ge(e)},s_=function(n,t){var e=Ge(!1),o=Ge(!1),r=function(){e.set(!0)},u=function(){o.set(!0)};return{stop:r,cut:u,isStopped:e.get,isCut:o.get,event:i(n),setSource:t.set,getSource:t.get}},f_=function(n){var t=Ge(!1),o=function(){t.set(!0)};return{stop:o,cut:e,isStopped:t.get,isCut:i(!1),event:i(n),setSource:s("Cannot set source of a broadcasted event"),getSource:s("Cannot get source of a broadcasted event")}},l_=An.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),d_=function(n,t,e,o,r,i){var u=n(t,o),a=s_(e,r);return u.fold((function(){return i.logEventNoHandlers(t,o),l_.complete()}),(function(n){var e=n.descHandler,o=$u(e);return o(a),a.isStopped()?(i.logEventStopped(t,n.element,e.purpose()),l_.stopped()):a.isCut()?(i.logEventCut(t,n.element,e.purpose()),l_.complete()):Mi(n.element).fold((function(){return i.logNoParent(t,n.element,e.purpose()),l_.complete()}),(function(o){return i.logEventResponse(t,n.element,e.purpose()),l_.resume(o)}))}))},m_=function(n,t,e,o,r,i){return d_(n,t,e,o,r,i).fold((function(){return!0}),(function(o){return m_(n,t,e,o,r,i)}),(function(){return!1}))},g_=function(n,t,e,o,r){var i=c_(e,o);return d_(n,t,e,o,i,r)},p_=function(n,t,e){var o=f_(t);return q(n,(function(n){var t=n.descHandler(),e=$u(t);e(o)})),o.isStopped()},v_=function(n,t,e,o){var r=e.target();return h_(n,t,e,r,o)},h_=function(n,t,e,o,r){var i=c_(e,o);return m_(n,t,e,o,i,r)},b_=function(n,t){return{element:n,descHandler:t}},y_=function(n,t){return{id:i(n),descHandler:i(t)}};function x_(){var n={},t=function(t,e,o){bn(o,(function(o,r){var i=void 0!==n[r]?n[r]:{};i[e]=Ju(o,t),n[r]=i}))},e=function(n,t){return Ou(t).fold((function(){return w.none()}),(function(e){return n.bind((function(n){return Tn(n,e)})).map((function(n){return b_(t,n)}))}))},o=function(t){return Tn(n,t).map((function(n){return Cn(n,(function(n,t){return y_(t,n)}))})).getOr([])},r=function(t,o,r){var i=Tn(n,o);return cr(r,(function(n){return e(i,n)}),t)},i=function(t){bn(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))};return{registerId:t,unregisterId:i,filterByType:o,find:r}}function w_(){var n=x_(),t={},e=function(n){var t=n.element();return Ou(t).fold((function(){return ku("uid-",n.element())}),(function(n){return n}))},o=function(n,e){var o=t[e];if(o!==n)throw new Error('The tagId "'+e+'" is already used by: '+mu(o.element())+"\nCannot use it for: "+mu(n.element())+"\nThe conflicting element is"+(Ca(o.element())?" ":" not ")+"already in the DOM");i(n)},r=function(r){var i=e(r);Bn(t,i)&&o(r,i);var u=[r];n.registerId(u,i,r.events()),t[i]=r},i=function(e){Ou(e.element()).each((function(e){delete t[e],n.unregisterId(e)}))},u=function(t){return n.filterByType(t)},a=function(t,e,o){return n.find(t,e,o)},c=function(n){return Tn(t,n)};return{find:a,filter:u,register:r,unregister:i,getById:c}}var S_=function(n){var t=n.dom,e=t.attributes,o=g(t,["attributes"]);return{uid:n.uid,dom:m({tag:"div",attributes:m({role:"presentation"},e)},o),components:n.components,behaviours:Bg(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},k_=Np({name:"Container",factory:S_,configFields:[Ie("components",[]),Eg("containerBehaviours",[]),Ie("events",{}),Ie("domModification",{}),Ie("eventOrder",{})]}),C_=function(n){var t=function(t){return Mi(n.element()).fold((function(){return!0}),(function(n){return er(t,n)}))},o=w_(),r=function(n,e){return o.find(t,n,e)},u=a_(n.element(),{triggerEvent:function(n,t){return cs(n,t.target(),(function(e){return v_(r,n,t,e)}))}}),a={debugInfo:i("real"),triggerEvent:function(n,t,e){cs(n,t,(function(o){return h_(r,n,e,t,o)}))},triggerFocus:function(n,t){Ou(n).fold((function(){Df(n)}),(function(o){cs(Ir(),n,(function(o){return g_(r,Ir(),{originator:i(t),kill:e,prevent:e,target:i(n)},n,o),!1}))}))},triggerEscape:function(n,t){a.triggerEvent("keydown",n.element(),t.event())},getByUid:function(n){return h(n)},getByDom:function(n){return b(n)},build:Za,addToGui:function(n){f(n)},removeFromGui:function(n){l(n)},addToWorld:function(n){c(n)},removeFromWorld:function(n){s(n)},broadcast:function(n){g(n)},broadcastOn:function(n,t){p(n,t)},broadcastEvent:function(n,t){v(n,t)},isConnected:i(!0)},c=function(n){n.connect(a),eu(n.element())||(o.register(n),q(n.components(),c),a.triggerEvent(Wr(),n.element(),{target:i(n.element())}))},s=function(n){eu(n.element())||(q(n.components(),s),o.unregister(n)),n.disconnect()},f=function(t){hm(n,t)},l=function(n){xm(n)},d=function(){u.unbind(),Xi(n.element())},m=function(n){var t=o.filter(Hr());q(t,(function(t){var e=t.descHandler(),o=$u(e);o(n)}))},g=function(n){m({universal:i(!0),data:i(n)})},p=function(n,t){m({universal:i(!1),channels:i(n),data:i(t)})},v=function(n,t){var e=o.filter(n);return p_(e,t)},h=function(n){return o.getById(n).fold((function(){return O.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),O.value)},b=function(n){var t=Ou(n).getOr("not found");return h(t)};return c(n),{root:i(n),element:n.element,destroy:d,add:f,remove:l,getByUid:h,getByDom:b,addToWorld:c,removeFromWorld:s,broadcast:g,broadcastOn:p,broadcastEvent:v}},O_=bu("form-component-change"),__=bu("form-close"),T_=bu("form-cancel"),E_=bu("form-action"),B_=bu("form-submit"),D_=bu("form-block"),A_=bu("form-unblock"),M_=bu("form-tabchange"),F_=bu("form-resize"),I_=function(n,t){return k_.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Ex.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Ax(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(t){ui(t,E_,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]})},R_=function(n,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:Y(n.items,t.interpreter)}},V_=i([Ie("prefix","form-field"),Eg("fieldBehaviours",[Jp,Tg])]),H_=i([cp({schema:[pe("dom")],name:"label"}),cp({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[pe("text")],name:"aria-descriptor"}),up({factory:{sketch:function(n){var t=at(n,["factory"]);return n.factory.sketch(t)}},schema:[pe("factory")],name:"field"})]),P_=function(n,t,e,o){var r=Dg(n.fieldBehaviours,[Jp.config({find:function(t){return wp(t,n,"field")}}),Tg.config({store:{mode:"manual",getValue:function(n){return Jp.getCurrent(n).bind(Tg.getValue)},setValue:function(n,t){Jp.getCurrent(n).each((function(n){Tg.setValue(n,t)}))}}})]),i=li([Oi((function(t,e){var o=kp(t,n,["label","field","aria-descriptor"]);o.field().each((function(t){var e=bu(n.prefix);o.label().each((function(n){ru(n.element(),"for",e),ru(t.element(),"id",e)})),o["aria-descriptor"]().each((function(e){var o=bu(n.prefix);ru(e.element(),"id",o),ru(t.element(),"aria-describedby",o)}))}))}))]),u={getField:function(t){return wp(t,n,"field")},getLabel:function(t){return wp(t,n,"label")}};return{uid:n.uid,dom:n.dom,components:t,behaviours:r,events:i,apis:u}},z_=Lp({name:"FormField",configFields:V_(),partFields:H_(),factory:P_,apis:{getField:function(n,t){return n.getField(t)},getLabel:function(n,t){return n.getLabel(t)}}}),N_=i([_e("data"),Ie("inputAttributes",{}),Ie("inputStyles",{}),Ie("tag","input"),Ie("inputClasses",[]),bs("onSetValue"),Ie("styles",{}),Ie("eventOrder",{}),Eg("inputBehaviours",[Tg,sy]),Ie("selectOnFocus",!0)]),L_=function(n){return hf([sy.config({onFocus:n.selectOnFocus?function(n){var t=n.element(),e=za(t);t.dom().setSelectionRange(0,e.length)}:e})])},j_=function(n){return m(m({},L_(n)),Dg(n.inputBehaviours,[Tg.config({store:m(m({mode:"manual"},n.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return za(n.element())},setValue:function(n,t){var e=za(n.element());e!==t&&Na(n.element(),t)}}),onSetValue:n.onSetValue})]))},U_=function(n){return{tag:n.tag,attributes:m({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},W_=function(n,t){return{uid:n.uid,dom:U_(n),components:[],behaviours:j_(n),eventOrder:n.eventOrder}},G_=Np({name:"Input",configFields:N_(),factory:W_}),X_={},Y_={exports:X_};(function(t,e,o,r){(function(r){if("object"===typeof e&&"undefined"!==typeof o)o.exports=r();else if("function"===typeof t&&t.amd)t([],r);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof n?n:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=r()}})((function(){return function(){function n(t,e,o){function i(a,c){if(!e[a]){if(!t[a]){var s="function"==typeof r&&r;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};t[a][0].call(l.exports,(function(n){var e=t[a][1][n];return i(e||n)}),l,l.exports,n,t,e,o)}return e[a].exports}for(var u="function"==typeof r&&r,a=0;a<o.length;a++)i(o[a]);return i}return n}()({1:[function(n,t,e){var o,r,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(n){if(o===setTimeout)return setTimeout(n,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0);try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}function s(n){if(r===clearTimeout)return clearTimeout(n);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{return r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(function(){try{o="function"===typeof setTimeout?setTimeout:u}catch(n){o=u}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(n){r=a}})();var f,l=[],d=!1,m=-1;function g(){d&&f&&(d=!1,f.length?l=f.concat(l):m=-1,l.length&&p())}function p(){if(!d){var n=c(g);d=!0;var t=l.length;while(t){f=l,l=[];while(++m<t)f&&f[m].run();m=-1,t=l.length}f=null,d=!1,s(n)}}function v(n,t){this.fun=n,this.array=t}function h(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];l.push(new v(n,t)),1!==l.length||d||c(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){(function(e){var o=setTimeout;function r(){}function i(n,t){return function(){n.apply(t,arguments)}}function u(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(n,this)}function a(n,t){while(3===n._state)n=n._value;0!==n._state?(n._handled=!0,u._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(r){return void s(t.promise,r)}c(t.promise,o)}else(1===n._state?c:s)(t.promise,n._value)}))):n._deferreds.push(t)}function c(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var e=t.then;if(t instanceof u)return n._state=3,n._value=t,void f(n);if("function"===typeof e)return void d(i(e,t),n)}n._state=1,n._value=t,f(n)}catch(o){s(n,o)}}function s(n,t){n._state=2,n._value=t,f(n)}function f(n){2===n._state&&0===n._deferreds.length&&u._immediateFn((function(){n._handled||u._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)a(n,n._deferreds[t]);n._deferreds=null}function l(n,t,e){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.promise=e}function d(n,t){var e=!1;try{n((function(n){e||(e=!0,c(t,n))}),(function(n){e||(e=!0,s(t,n))}))}catch(o){if(e)return;e=!0,s(t,o)}}u.prototype["catch"]=function(n){return this.then(null,n)},u.prototype.then=function(n,t){var e=new this.constructor(r);return a(this,new l(n,t,e)),e},u.all=function(n){var t=Array.prototype.slice.call(n);return new u((function(n,e){if(0===t.length)return n([]);var o=t.length;function r(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){r(i,n)}),e)}t[i]=u,0===--o&&n(t)}catch(c){e(c)}}for(var i=0;i<t.length;i++)r(i,t[i])}))},u.resolve=function(n){return n&&"object"===typeof n&&n.constructor===u?n:new u((function(t){t(n)}))},u.reject=function(n){return new u((function(t,e){e(n)}))},u.race=function(n){return new u((function(t,e){for(var o=0,r=n.length;o<r;o++)n[o].then(t,e)}))},u._immediateFn="function"===typeof n?function(t){n(t)}:function(n){o(n,0)},u._unhandledRejectionFn=function(n){"undefined"!==typeof console&&console},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},"undefined"!==typeof t&&t.exports?t.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,o){var r=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"===typeof t?t:function(n){var t=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[t]=!0,r((function(){a[t]&&(o?n.apply(null,o):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"===typeof o?o:function(n){delete a[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var o=n("promise-polyfill"),r=function(){return"undefined"!==typeof window?window:Function("return this;")()}();t.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,X_,Y_,void 0);var q_,K_=Y_.exports.boltExport,J_=function(n){var e=w.none(),o=[],r=function(n){return J_((function(t){i((function(e){t(n(e))}))}))},i=function(n){a()?s(n):o.push(n)},u=function(n){e=w.some(n),c(o),o=[]},a=function(){return e.isSome()},c=function(n){q(n,s)},s=function(n){e.each((function(e){t.setTimeout((function(){n(e)}),0)}))};return n(u),{get:i,map:r,isReady:a}},$_=function(n){return J_((function(t){t(n)}))},Q_={nu:J_,pure:$_},Z_=function(n){t.setTimeout((function(){throw n}),0)},nT=function(n){var t=function(t){n().then(t,Z_)},e=function(t){return nT((function(){return n().then(t)}))},o=function(t){return nT((function(){return n().then((function(n){return t(n).toPromise()}))}))},r=function(t){return nT((function(){return n().then((function(){return t.toPromise()}))}))},i=function(){return Q_.nu(t)},u=function(){var t=null;return nT((function(){return null===t&&(t=n()),t}))},a=n;return{map:e,bind:o,anonBind:r,toLazy:i,toCached:u,toPromise:a,get:t}},tT=function(n){return nT((function(){return new K_(n)}))},eT=function(n){return nT((function(){return K_.resolve(n)}))},oT={nu:tT,pure:eT},rT=["input","textarea"],iT=function(n){var t=Qi(n);return U(rT,t)},uT=function(n,t){var e=t.getRoot(n).getOr(n.element());ya(e,t.invalidClass),t.notify.each((function(t){iT(n.element())&&ru(n.element(),"aria-invalid",!1),t.getContainer(n).each((function(n){Ji(n,t.validHtml)})),t.onValid(n)}))},aT=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element());ha(r,t.invalidClass),t.notify.each((function(t){iT(n.element())&&ru(n.element(),"aria-invalid",!0),t.getContainer(n).each((function(n){Ji(n,o)})),t.onInvalid(n,o)}))},cT=function(n,t,e){return t.validator.fold((function(){return oT.pure(O.value(!0))}),(function(t){return t.validate(n)}))},sT=function(n,t,e){return t.notify.each((function(t){t.onValidate(n)})),cT(n,t).map((function(o){return n.getSystem().isConnected()?o.fold((function(o){return aT(n,t,e,o),O.error(o)}),(function(e){return uT(n,t),O.value(e)})):O.error("No longer in system")}))},fT=function(n,t){var e=t.getRoot(n).getOr(n.element());return xa(e,t.invalidClass)},lT=Object.freeze({__proto__:null,markValid:uT,markInvalid:aT,query:cT,run:sT,isInvalid:fT}),dT=function(n,t){return n.validator.map((function(o){return li([pi(o.onEvent,(function(e){sT(e,n,t).get(u)}))].concat(o.validateOnLoad?[Oi((function(o){sT(o,n,t).get(e)}))]:[]))})).getOr({})},mT=Object.freeze({__proto__:null,events:dT}),gT=[pe("invalidClass"),Ie("getRoot",w.none),Me("notify",[Ie("aria","alert"),Ie("getContainer",w.none),Ie("validHtml",""),bs("onValid"),bs("onInvalid"),bs("onValidate")]),Me("validator",[pe("validate"),Ie("onEvent","input"),Ie("validateOnLoad",!0)])],pT=yf({fields:gT,name:"invalidating",active:mT,apis:lT,extra:{validation:function(n){return function(t){var e=Tg.getValue(t);return oT.pure(n(e))}}}}),vT=function(n,t){return Wu({attributes:st([{key:t.tabAttr,value:"true"}])})},hT=Object.freeze({__proto__:null,exhibit:vT}),bT=[Ie("tabAttr","data-alloy-tabstop")],yT=yf({fields:bT,name:"tabstopping",active:hT}),xT=function(n,t,e,o){var r=ST(n,t,e,o);return z_.sketch(r)},wT=function(n,t){return xT(n,t,[],[])},ST=function(n,t,e,o){return{dom:CT(e),components:n.toArray().concat([t]),fieldBehaviours:hf(o)}},kT=function(){return CT([])},CT=function(n){return{tag:"div",classes:["tox-form__group"].concat(n)}},OT=function(n,t){return z_.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}})},_T=function(n,t,e,o){return e.getOrCreate(n,t,o)},TT=Object.freeze({__proto__:null,getCoupled:_T}),ET=[ve("others",Qt(O.value,ue()))],BT=function(){var n={},t=function(t,e,o){var r=vn(e.others);if(r)return Tn(n,o).getOrThunk((function(){var r=Tn(e.others,o).getOrDie("No information found for coupled component: "+o),i=r(t),u=t.getSystem().build(i);return n[o]=u,u}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))},e=i({});return zu({readState:e,getOrCreate:t})},DT=Object.freeze({__proto__:null,init:BT}),AT=yf({fields:ET,name:"coupling",apis:TT,state:DT}),MT=i("sink"),FT=i(cp({name:MT(),overrides:i({dom:{tag:"div"},behaviours:hf([lm.config({useFixed:l})]),events:li([Si(_r()),Si(yr()),Si(Dr())])})}));(function(n){n[n["HighlightFirst"]=0]="HighlightFirst",n[n["HighlightNone"]=1]="HighlightNone"})(q_||(q_={}));var IT=function(n,t){var e=n.getHotspot(t).getOr(t),o="hotspot",r=n.getAnchorOverrides();return n.layouts.fold((function(){return{anchor:o,hotspot:e,overrides:r}}),(function(n){return{anchor:o,hotspot:e,overrides:r,layouts:n}}))},RT=function(n,t,e){var o=n.fetch;return o(e).map(t)},VT=function(n,t,e,o,r,i,u){var a=RT(n,t,o),c=LT(o,n);return a.map((function(n){return n.bind((function(n){return w.from(lx.sketch(m(m({},i.menu()),{uid:_u(""),data:n,highlightImmediately:u===q_.HighlightFirst,onOpenMenu:function(n,t){var o=c().getOrDie();lm.position(o,e,t),Gm.decloak(r)},onOpenSubmenu:function(n,t,e){var o=c().getOrDie();lm.position(o,{anchor:"submenu",item:t},e),Gm.decloak(r)},onRepositionMenu:function(n,t,o){var r=c().getOrDie();lm.position(r,e,t),q(o,(function(n){lm.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)}))},onEscape:function(){return sy.focus(o),Gm.close(r),w.some(!0)}})))}))}))},HT=function(n,t,e,o,r,i,u){var a=IT(n,e),c=VT(n,t,a,e,o,r,u);return c.map((function(n){return n.fold((function(){Gm.isOpen(o)&&Gm.close(o)}),(function(n){Gm.cloak(o),Gm.open(o,n),i(o)})),o}))},PT=function(n,t,e,o,r,i,u){return Gm.close(o),oT.pure(o)},zT=function(n,t,e,o,r,i){var u=AT.getCoupled(e,"sandbox"),a=Gm.isOpen(u),c=a?PT:HT;return c(n,t,e,u,o,r,i)},NT=function(n,t,e){var o=Jp.getCurrent(t).getOr(t),r=gc(n.element());e?Ba(o.element(),"min-width",r+"px"):mc(o.element(),r)},LT=function(n,t){return n.getSystem().getByUid(t.uid+"-"+MT()).map((function(n){return function(){return O.value(n)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return O.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(n)}}))}))},jT=function(n){Gm.getState(n).each((function(n){lx.repositionMenus(n)}))},UT=function(n,t,e){var o=$c(),r=function(r,i){var u=IT(n,t);o.link(t.element()),n.matchWidth&&NT(u.hotspot,i,n.useMinWidth),n.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},i=function(n,r){o.unlink(t.element()),void 0!==e&&void 0!==e.onClose&&e.onClose(n,r)},u=LT(t,n);return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Ag.augment(n.sandboxBehaviours,[Tg.config({store:{mode:"memory",initialValue:t}}),Gm.config({onOpen:r,onClose:i,isPartOf:function(n,e,o){return Zc(e,o)||Zc(t,o)},getAttachPoint:function(){return u().getOrDie()}}),Jp.config({find:function(n){return Gm.getState(n).bind((function(n){return Jp.getCurrent(n)}))}}),Tf.config({channels:m(m({},Jm({isExtraPart:f})),Qm({doReposition:jT}))})])}},WT=function(n){var t=AT.getCoupled(n,"sandbox");jT(t)},GT=function(){return[Ie("sandboxClasses",[]),Ag.field("sandboxBehaviours",[Jp,Tf,Gm,Tg])]},XT=i([pe("dom"),pe("fetch"),bs("onOpen"),ys("onExecute"),Ie("getHotspot",w.some),Ie("getAnchorOverrides",i({})),wl(),Eg("dropdownBehaviours",[Ey,AT,jb,sy]),pe("toggleClass"),Ie("eventOrder",{}),_e("lazySink"),Ie("matchWidth",!1),Ie("useMinWidth",!1),_e("role")].concat(GT())),YT=i([ap({schema:[ps()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),FT()]),qT=function(n,t,o,r){var i,u=function(t){return Tn(n.dom,"attributes").bind((function(n){return Tn(n,t)}))},a=function(n){Gm.getState(n).each((function(n){lx.highlightPrimary(n)}))},c=function(t){var o=a;zT(n,(function(n){return n}),t,r,o,q_.HighlightFirst).get(e)},s={expand:function(t){Ey.isOn(t)||zT(n,(function(n){return n}),t,r,e,q_.HighlightNone).get(e)},open:function(t){Ey.isOn(t)||zT(n,(function(n){return n}),t,r,e,q_.HighlightFirst).get(e)},isOpen:Ey.isOn,close:function(t){Ey.isOn(t)&&zT(n,(function(n){return n}),t,r,e,q_.HighlightFirst).get(e)},repositionMenus:function(n){Ey.isOn(n)&&WT(n)}},f=function(n,t){return ai(n),w.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Dg(n.dropdownBehaviours,[Ey.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),AT.config({others:{sandbox:function(t){return UT(n,t,{onOpen:function(){Ey.on(t)},onClose:function(){Ey.off(t)}})}}}),jb.config({mode:"special",onSpace:f,onEnter:f,onDown:function(n,t){if(KT.isOpen(n)){var e=AT.getCoupled(n,"sandbox");a(e)}else KT.open(n);return w.some(!0)},onEscape:function(n,t){return KT.isOpen(n)?(KT.close(n),w.some(!0)):w.none()}}),sy.config({})]),events:Dy(w.some(c)),eventOrder:m(m({},n.eventOrder),(i={},i[Pr()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:s,domModification:{attributes:m(m({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(n){return{role:n}}))),"button"===n.dom.tag?{type:u("type").getOr("button")}:{})}}},KT=Lp({name:"Dropdown",configFields:XT(),partFields:YT(),factory:qT,apis:{open:function(n,t){return n.open(t)},expand:function(n,t){return n.expand(t)},close:function(n,t){return n.close(t)},isOpen:function(n,t){return n.isOpen(t)},repositionMenus:function(n,t){return n.repositionMenus(t)}}}),JT=function(){return Wu({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},$T=function(){return li([di(Mr(),i(!0))])},QT=Object.freeze({__proto__:null,events:$T,exhibit:JT}),ZT=yf({fields:[],name:"unselecting",active:QT}),nE=function(n,t){return KT.sketch({dom:n.dom,components:n.components,toggleClass:"mce-active",dropdownBehaviours:hf([Ak.button(t.providers.isReadOnly),_k(),ZT.config({}),yT.config({})]),layouts:n.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(e){return oT.nu((function(t){return n.fetch(t)})).map((function(o){return w.from(LO(Vn(yO(bu("menu-value"),o,(function(t){n.onItemAction(e,t)}),n.columns,n.presets,Rk.CLOSE_ON_EXECUTE,(function(){return!1}),t.providers),{movement:wO(n.columns,n.presets)})))}))},parts:{menu:cO(!1,1,n.presets)}})},tE=bu("color-input-change"),eE=bu("color-swatch-change"),oE=bu("color-picker-cancel"),rE=function(n,t,e){var o=z_.parts().field({factory:G_,inputClasses:["tox-textfield"],onSetValue:function(n){return pT.run(n).get((function(){}))},inputBehaviours:hf([WS.config({disabled:t.providers.isReadOnly}),_k(),yT.config({}),pT.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(n){return Mi(n.element())},notify:{onValid:function(n){var t=Tg.getValue(n);ui(n,tE,{color:t})}},validator:{validateOnLoad:!1,validate:function(n){var t=Tg.getValue(n);if(0===t.length)return oT.pure(O.value(!0));var e=$e.fromTag("span");Ba(e,"background-color",t);var o=Ia(e,"background-color").fold((function(){return O.error("blah")}),(function(n){return O.value(t)}));return oT.pure(o)}}})]),selectOnFocus:!1}),r=n.label.map((function(n){return OT(n,t.providers)})),i=function(n,t){ui(n,eE,{value:t})},u=function(n,t){a.getOpt(n).each((function(n){"custom"===t?e.colorPicker((function(t){t.fold((function(){return ii(n,oE)}),(function(t){i(n,t),RC(t)}))}),"#ffffff"):i(n,"remove"===t?"":t)}))},a=Bx(nE({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Js,Ks,nf]},onLtr:function(){return[Ks,Js,nf]}},components:[],fetch:$C(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:u},t));return z_.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,a.asSpec()]}]),fieldBehaviours:hf([ny("form-field-events",[pi(tE,(function(t,e){a.getOpt(t).each((function(n){Ba(n.element(),"background-color",e.event().color())})),ui(t,O_,{name:n.name})})),pi(eE,(function(n,t){z_.getField(n).each((function(e){Tg.setValue(e,t.event().value()),Jp.getCurrent(n).each(sy.focus)}))})),pi(oE,(function(n,t){z_.getField(n).each((function(t){Jp.getCurrent(n).each(sy.focus)}))}))])])})},iE=function(n,t,e){return{hue:n,saturation:t,value:e}},uE=function(n){var t=0,e=0,o=0,r=n.red/255,i=n.green/255,u=n.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));if(a===c)return o=a,iE(0,0,100*o);var s=r===a?i-u:u===a?r-i:u-r;return t=r===a?3:u===a?1:5,t=60*(t-s/(c-a)),e=(c-a)/c,o=c,iE(Math.round(t),Math.round(100*e),Math.round(100*o))},aE=function(n){var t=(100-n)/100*360,e=iE(t,100,100),o=hC(e);return sC(o)},cE=bu("rgb-hex-update"),sE=bu("slider-update"),fE=bu("palette-update"),lE=cp({schema:[pe("dom")],name:"label"}),dE=function(n){return cp({name:n+"-edge",overrides:function(t){var e=t.model.manager.edgeActions[n];return e.fold((function(){return{}}),(function(n){return{events:li([vi(pr(),(function(t,e,o){return n(t,o)}),[t]),vi(yr(),(function(t,e,o){return n(t,o)}),[t]),vi(xr(),(function(t,e,o){o.mouseIsDown.get()&&n(t,o)}),[t])])}}))}})},mE=dE("top-left"),gE=dE("top"),pE=dE("top-right"),vE=dE("right"),hE=dE("bottom-right"),bE=dE("bottom"),yE=dE("bottom-left"),xE=dE("left"),wE=up({name:"thumb",defaults:i({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:li([xi(pr(),n,"spectrum"),xi(vr(),n,"spectrum"),xi(hr(),n,"spectrum"),xi(yr(),n,"spectrum"),xi(xr(),n,"spectrum"),xi(Sr(),n,"spectrum")])}}}),SE=up({schema:[We("mouseIsDown",(function(){return Ge(!1)}))],name:"spectrum",overrides:function(n){var t=n.model,e=t.manager,o=function(t,o){return e.getValueFromEvent(o).map((function(o){return e.setValueFrom(t,n,o)}))};return{behaviours:hf([jb.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),sy.config({})]),events:li([pi(pr(),o),pi(vr(),o),pi(yr(),o),pi(xr(),(function(t,e){n.mouseIsDown.get()&&o(t,e)}))])}}}),kE=[lE,xE,vE,gE,bE,mE,pE,yE,hE,wE,SE],CE="slider.change.value",OE=i(CE),_E=function(n){return-1!==n.type.indexOf("touch")},TE=function(n){var t=n.event().raw();if(_E(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?w.some(e.touches[0]).map((function(n){return ac(n.clientX,n.clientY)})):w.none()}var o=t;return void 0!==o.clientX?w.some(o).map((function(n){return ac(n.clientX,n.clientY)})):w.none()},EE="top",BE="right",DE="bottom",AE="left",ME=function(n){return n.model.minX},FE=function(n){return n.model.minY},IE=function(n){return n.model.minX-1},RE=function(n){return n.model.minY-1},VE=function(n){return n.model.maxX},HE=function(n){return n.model.maxY},PE=function(n){return n.model.maxX+1},zE=function(n){return n.model.maxY+1},NE=function(n,t,e){return t(n)-e(n)},LE=function(n){return NE(n,VE,ME)},jE=function(n){return NE(n,HE,FE)},UE=function(n){return LE(n)/2},WE=function(n){return jE(n)/2},GE=function(n){return n.stepSize},XE=function(n){return n.snapToGrid},YE=function(n){return n.snapStart},qE=function(n){return n.rounded},KE=function(n,t){return void 0!==n[t+"-edge"]},JE=function(n){return KE(n,AE)},$E=function(n){return KE(n,BE)},QE=function(n){return KE(n,EE)},ZE=function(n){return KE(n,DE)},nB=function(n){return n.model.value.get()},tB=function(n){return{x:i(n)}},eB=function(n){return{y:i(n)}},oB=function(n,t){return{x:i(n),y:i(t)}},rB=function(n,t){ui(n,OE(),{value:t})},iB=function(n,t){rB(n,oB(IE(t),RE(t)))},uB=function(n,t){rB(n,eB(RE(t)))},aB=function(n,t){rB(n,oB(UE(t),RE(t)))},cB=function(n,t){rB(n,oB(PE(t),RE(t)))},sB=function(n,t){rB(n,tB(PE(t)))},fB=function(n,t){rB(n,oB(PE(t),WE(t)))},lB=function(n,t){rB(n,oB(PE(t),zE(t)))},dB=function(n,t){rB(n,eB(zE(t)))},mB=function(n,t){rB(n,oB(UE(t),zE(t)))},gB=function(n,t){rB(n,oB(IE(t),zE(t)))},pB=function(n,t){rB(n,tB(IE(t)))},vB=function(n,t){rB(n,oB(IE(t),WE(t)))},hB=function(n,t,e,o){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-o)},bB=function(n,t,e,o){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+o)},yB=function(n,t,e){return Math.max(t,Math.min(e,n))},xB=function(n,t,e,o,r){return r.fold((function(){var r=n-t,i=Math.round(r/o)*o;return yB(t+i,t-1,e+1)}),(function(t){var r=(n-t)%o,i=Math.round(r/o),u=Math.floor((n-t)/o),a=Math.floor((e-t)/o),c=Math.min(a,u+i),s=t+c*o;return Math.max(t,s)}))},wB=function(n,t,e){return Math.min(e,Math.max(n,t))-t},SB=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.step,u=n.snap,a=n.snapStart,c=n.rounded,s=n.hasMinEdge,f=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=s?t-1:t,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var v=wB(r,l,d),h=yB(v/m*o+t,g,p);return u&&h>=t&&h<=e?xB(h,t,e,i,a):c?Math.round(h):h},kB=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,a=n.maxBound,c=n.maxOffset,s=n.centerMinEdge,f=n.centerMaxEdge;return r<t?i?0:s:r>e?u?a:f:(r-t)/o*c},CB="top",OB="right",_B="bottom",TB="left",EB="width",BB="height",DB=function(n){return n.element().dom().getBoundingClientRect()},AB=function(n,t){return n[t]},MB=function(n){var t=DB(n);return AB(t,TB)},FB=function(n){var t=DB(n);return AB(t,OB)},IB=function(n){var t=DB(n);return AB(t,CB)},RB=function(n){var t=DB(n);return AB(t,_B)},VB=function(n){var t=DB(n);return AB(t,EB)},HB=function(n){var t=DB(n);return AB(t,BB)},PB=function(n,t,e){return(n+t)/2-e},zB=function(n,t){var e=DB(n),o=DB(t),r=AB(e,TB),i=AB(e,OB),u=AB(o,TB);return PB(r,i,u)},NB=function(n,t){var e=DB(n),o=DB(t),r=AB(e,CB),i=AB(e,_B),u=AB(o,CB);return PB(r,i,u)},LB=function(n,t){ui(n,OE(),{value:t})},jB=function(n){return{x:i(n)}},UB=function(n,t,e){var o={min:ME(t),max:VE(t),range:LE(t),value:e,step:GE(t),snap:XE(t),snapStart:YE(t),rounded:qE(t),hasMinEdge:JE(t),hasMaxEdge:$E(t),minBound:MB(n),maxBound:FB(n),screenRange:VB(n)};return SB(o)},WB=function(n,t,e){var o=UB(n,t,e),r=jB(o);return LB(n,r),o},GB=function(n,t){var e=ME(t);LB(n,jB(e))},XB=function(n,t){var e=VE(t);LB(n,jB(e))},YB=function(n,t,e){var o=n>0?bB:hB,r=o(nB(e).x(),ME(e),VE(e),GE(e));return LB(t,jB(r)),w.some(r)},qB=function(n){return function(t,e){return YB(n,t,e).map((function(){return!0}))}},KB=function(n){var t=TE(n);return t.map((function(n){return n.left()}))},JB=function(n,t,e,o,r){var i=0,u=VB(n),a=o.bind((function(t){return w.some(zB(t,n))})).getOr(i),c=r.bind((function(t){return w.some(zB(t,n))})).getOr(u),s={min:ME(t),max:VE(t),range:LE(t),value:e,hasMinEdge:JE(t),hasMaxEdge:$E(t),minBound:MB(n),minOffset:i,maxBound:FB(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return kB(s)},$B=function(n,t,e,o,r,i){var u=JB(t,i,e,o,r);return MB(t)-MB(n)+u},QB=function(n,t,e,o){var r=nB(e),i=$B(n,o.getSpectrum(n),r.x(),o.getLeftEdge(n),o.getRightEdge(n),e),u=gc(t.element())/2;Ba(t.element(),"left",i-u+"px")},ZB=qB(-1),nD=qB(1),tD=w.none,eD=w.none,oD={"top-left":w.none(),top:w.none(),"top-right":w.none(),right:w.some(sB),"bottom-right":w.none(),bottom:w.none(),"bottom-left":w.none(),left:w.some(pB)},rD=Object.freeze({__proto__:null,setValueFrom:WB,setToMin:GB,setToMax:XB,findValueOfOffset:UB,getValueFromEvent:KB,findPositionOfValue:$B,setPositionFromValue:QB,onLeft:ZB,onRight:nD,onUp:tD,onDown:eD,edgeActions:oD}),iD=function(n,t){ui(n,OE(),{value:t})},uD=function(n){return{y:i(n)}},aD=function(n,t,e){var o={min:FE(t),max:HE(t),range:jE(t),value:e,step:GE(t),snap:XE(t),snapStart:YE(t),rounded:qE(t),hasMinEdge:QE(t),hasMaxEdge:ZE(t),minBound:IB(n),maxBound:RB(n),screenRange:HB(n)};return SB(o)},cD=function(n,t,e){var o=aD(n,t,e),r=uD(o);return iD(n,r),o},sD=function(n,t){var e=FE(t);iD(n,uD(e))},fD=function(n,t){var e=HE(t);iD(n,uD(e))},lD=function(n,t,e){var o=n>0?bB:hB,r=o(nB(e).y(),FE(e),HE(e),GE(e));return iD(t,uD(r)),w.some(r)},dD=function(n){return function(t,e){return lD(n,t,e).map((function(){return!0}))}},mD=function(n){var t=TE(n);return t.map((function(n){return n.top()}))},gD=function(n,t,e,o,r){var i=0,u=HB(n),a=o.bind((function(t){return w.some(NB(t,n))})).getOr(i),c=r.bind((function(t){return w.some(NB(t,n))})).getOr(u),s={min:FE(t),max:HE(t),range:jE(t),value:e,hasMinEdge:QE(t),hasMaxEdge:ZE(t),minBound:IB(n),minOffset:i,maxBound:RB(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return kB(s)},pD=function(n,t,e,o,r,i){var u=gD(t,i,e,o,r);return IB(t)-IB(n)+u},vD=function(n,t,e,o){var r=nB(e),i=pD(n,o.getSpectrum(n),r.y(),o.getTopEdge(n),o.getBottomEdge(n),e),u=oc(t.element())/2;Ba(t.element(),"top",i-u+"px")},hD=w.none,bD=w.none,yD=dD(-1),xD=dD(1),wD={"top-left":w.none(),top:w.some(uB),"top-right":w.none(),right:w.none(),"bottom-right":w.none(),bottom:w.some(dB),"bottom-left":w.none(),left:w.none()},SD=Object.freeze({__proto__:null,setValueFrom:cD,setToMin:sD,setToMax:fD,findValueOfOffset:aD,getValueFromEvent:mD,findPositionOfValue:pD,setPositionFromValue:vD,onLeft:hD,onRight:bD,onUp:yD,onDown:xD,edgeActions:wD}),kD=function(n,t){ui(n,OE(),{value:t})},CD=function(n,t){return{x:i(n),y:i(t)}},OD=function(n,t,e){var o=UB(n,t,e.left()),r=aD(n,t,e.top()),i=CD(o,r);return kD(n,i),i},_D=function(n,t,e,o){var r=n>0?bB:hB,i=t?nB(o).x():r(nB(o).x(),ME(o),VE(o),GE(o)),u=t?r(nB(o).y(),FE(o),HE(o),GE(o)):nB(o).y();return kD(e,CD(i,u)),w.some(i)},TD=function(n,t){return function(e,o){return _D(n,t,e,o).map((function(){return!0}))}},ED=function(n,t){var e=ME(t),o=FE(t);kD(n,CD(e,o))},BD=function(n,t){var e=VE(t),o=HE(t);kD(n,CD(e,o))},DD=function(n){return TE(n)},AD=function(n,t,e,o){var r=nB(e),i=$B(n,o.getSpectrum(n),r.x(),o.getLeftEdge(n),o.getRightEdge(n),e),u=pD(n,o.getSpectrum(n),r.y(),o.getTopEdge(n),o.getBottomEdge(n),e),a=gc(t.element())/2,c=oc(t.element())/2;Ba(t.element(),"left",i-a+"px"),Ba(t.element(),"top",u-c+"px")},MD=TD(-1,!1),FD=TD(1,!1),ID=TD(-1,!0),RD=TD(1,!0),VD={"top-left":w.some(iB),top:w.some(aB),"top-right":w.some(cB),right:w.some(fB),"bottom-right":w.some(lB),bottom:w.some(mB),"bottom-left":w.some(gB),left:w.some(vB)},HD=Object.freeze({__proto__:null,setValueFrom:OD,setToMin:ED,setToMax:BD,getValueFromEvent:DD,setPositionFromValue:AD,onLeft:MD,onRight:FD,onUp:ID,onDown:RD,edgeActions:VD}),PD=[Ie("stepSize",1),Ie("onChange",e),Ie("onChoose",e),Ie("onInit",e),Ie("onDragStart",e),Ie("onDragEnd",e),Ie("snapToGrid",!1),Ie("rounded",!0),_e("snapStart"),ve("model",ie("mode",{x:[Ie("minX",0),Ie("maxX",100),We("value",(function(n){return Ge(n.mode.minX)})),pe("getInitialValue"),Ss("manager",rD)],y:[Ie("minY",0),Ie("maxY",100),We("value",(function(n){return Ge(n.mode.minY)})),pe("getInitialValue"),Ss("manager",SD)],xy:[Ie("minX",0),Ie("maxX",100),Ie("minY",0),Ie("maxY",100),We("value",(function(n){return Ge({x:i(n.mode.minX),y:i(n.mode.minY)})})),pe("getInitialValue"),Ss("manager",HD)]})),Eg("sliderBehaviours",[jb,Tg]),We("mouseIsDown",(function(){return Ge(!1)}))],zD=function(n,t,e,o){var r,u=function(t){return Sp(t,n,"thumb")},a=function(t){return Sp(t,n,"spectrum")},c=function(t){return wp(t,n,"left-edge")},s=function(t){return wp(t,n,"right-edge")},f=function(t){return wp(t,n,"top-edge")},l=function(t){return wp(t,n,"bottom-edge")},d=n.model,m=d.manager,g=function(t,e){m.setPositionFromValue(t,e,n,{getLeftEdge:c,getRightEdge:s,getTopEdge:f,getBottomEdge:l,getSpectrum:a})},p=function(t,e){d.value.set(e);var o=u(t);return g(t,o),n.onChange(t,o,e),w.some(!0)},v=function(t){m.setToMin(t,n)},h=function(t){m.setToMax(t,n)},b=function(t){var e=function(){wp(t,n,"thumb").each((function(e){var o=d.value.get();n.onChoose(t,e,o)}))},o=n.mouseIsDown.get();n.mouseIsDown.set(!1),o&&e()},y=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,u(t))},x=function(t,e){e.stop(),n.onDragEnd(t,u(t)),b(t)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Dg(n.sliderBehaviours,[jb.config({mode:"special",focusIn:function(t){return wp(t,n,"spectrum").map(jb.focusIn).map(i(!0))}}),Tg.config({store:{mode:"manual",getValue:function(n){return d.value.get()}}}),Tf.config({channels:(r={},r[qm()]={onReceive:b},r)})]),events:li([pi(OE(),(function(n,t){p(n,t.event().value())})),Oi((function(t,e){var o=d.getInitialValue();d.value.set(o);var r=u(t);g(t,r);var i=a(t);n.onInit(t,r,i,d.value.get())})),pi(pr(),y),pi(hr(),x),pi(yr(),y),pi(Sr(),x)]),apis:{resetToMin:v,resetToMax:h,changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},ND=Lp({name:"Slider",configFields:PD,partFields:kE,factory:zD,apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),LD=function(n,t){var e=ND.parts().spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=ND.parts().thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return ND.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:i({y:i(0)})},components:[e,o],sliderBehaviours:hf([sy.config({})]),onChange:function(n,t,e){ui(n,sE,{value:e})}})},jD="form",UD=[Eg("formBehaviours",[Tg])],WD=function(n){return"<alloy.field."+n+">"},GD=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),vp(jD,WD(t),e)};return{field:t,record:function(){return n}}}(),e=n(t),o=t.record(),r=Y(o,(function(n){return up({name:n,pname:WD(n)})}));return Fp(jD,UD,r,YD,e)},XD=function(n,t){return n.fold((function(){return O.error(t)}),O.value)},YD=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Dg(n.formBehaviours,[Tg.config({store:{mode:"manual",getValue:function(t){var e=Cp(t,n);return yn(e,(function(n,t){return n().bind((function(n){var e=Jp.getCurrent(n);return XD(e,new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+mu(n.element())))})).map(Tg.getValue)}))},setValue:function(t,e){bn(e,(function(e,o){wp(t,n,o).each((function(n){Jp.getCurrent(n).each((function(n){Tg.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return wp(t,n,e).bind(Jp.getCurrent)}}}},qD={getField:Hu((function(n,t,e){return n.getField(t,e)})),sketch:GD},KD=bu("valid-input"),JD=bu("invalid-input"),$D=bu("validating-input"),QD="colorcustom.rgb.",ZD=function(n,t,o,r){var i=function(e,o){return pT.config({invalidClass:t("invalid"),notify:{onValidate:function(n){ui(n,$D,{type:e})},onValid:function(n){ui(n,KD,{type:e,value:Tg.getValue(n)})},onInvalid:function(n){ui(n,JD,{type:e,value:Tg.getValue(n)})}},validator:{validate:function(t){var e=Tg.getValue(t),r=o(e)?O.value(!0):O.error(n("aria.input.invalid"));return oT.pure(r)},validateOnLoad:!1}})},u=function(o,r,u,a,c){var s=n(QD+"range"),f=z_.parts().label({dom:{tag:"label",innerHtml:u,attributes:{"aria-label":a}}}),l=z_.parts().field({data:c,factory:G_,inputAttributes:m({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[t("textfield")],inputBehaviours:hf([i(r,o),yT.config({})]),onSetValue:function(n){if(pT.isInvalid(n)){var t=pT.run(n);t.get(e)}}}),d=[f,l],g="hex"!==r?[z_.parts()["aria-descriptor"]({text:s})]:[],p=d.concat(g);return{dom:{tag:"div",attributes:{role:"presentation"}},components:p}},a=function(n,t){var e=sC(t);return qD.getField(n,"hex").each((function(t){sy.isFocused(t)||Tg.setValue(n,{hex:e.value})})),e},c=function(n,t){var e=t.red,o=t.green,r=t.blue;Tg.setValue(n,{red:e,green:o,blue:r})},s=Bx({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),f=function(n,t){s.getOpt(n).each((function(n){Ba(n.element(),"background-color","#"+t.value)}))},l=function(){var e={red:Ge(w.some(255)),green:Ge(w.some(255)),blue:Ge(w.some(255)),hex:Ge(w.some("ffffff"))},i=function(n,t){var e=bC(t);c(n,e),g(e)},l=function(n){return e[n].get()},d=function(n,t){e[n].set(t)},m=function(){return l("red").bind((function(n){return l("green").bind((function(t){return l("blue").map((function(e){return pC(n,t,e,1)}))}))}))},g=function(n){var t=n.red,e=n.green,o=n.blue;d("red",w.some(t)),d("green",w.some(e)),d("blue",w.some(o))},p=function(n,t){var e=t.event();"hex"!==e.type()?d(e.type(),w.none()):r(n)},v=function(n,t){o(n);var e=eC(t);d("hex",w.some(t));var r=bC(e);c(n,r),g(r),ui(n,cE,{hex:e}),f(n,e)},h=function(n,t,e){var o=parseInt(e,10);d(t,w.some(o)),m().each((function(t){var e=a(n,t);f(n,e)}))},b=function(n){return"hex"===n.type()},y=function(n,t){var e=t.event();b(e)?v(n,e.value()):h(n,e.type(),e.value())},x=function(t){return{label:n(QD+t+".label"),description:n(QD+t+".description")}},S=x("red"),k=x("green"),C=x("blue"),O=x("hex");return Vn(qD.sketch((function(e){return{dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[e.field("red",z_.sketch(u(vC,"red",S.label,S.description,255))),e.field("green",z_.sketch(u(vC,"green",k.label,k.description,255))),e.field("blue",z_.sketch(u(vC,"blue",C.label,C.description,255))),e.field("hex",z_.sketch(u(iC,"hex",O.label,O.description,"ffffff"))),s.asSpec()],formBehaviours:hf([pT.config({invalidClass:t("form-invalid")}),ny("rgb-form-events",[pi(KD,y),pi(JD,p),pi($D,p)])])}})),{apis:{updateHex:function(n,t){Tg.setValue(n,{hex:t.value}),i(n,t),f(n,t)}}})},d=Np({factory:l,name:"RgbForm",configFields:[],apis:{updateHex:function(n,t,e){n.updateHex(t,e)}},extraApis:{}});return d},nA=function(n,t){var e=ND.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),o=ND.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(n,t){var e=n.width,o=n.height,r=n.getContext("2d");if(null!==r){r.fillStyle=t,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}},u=function(n,t){var e=n.components()[0].element().dom();r(e,wC(t))},a=function(n){var u=i({x:i(0),y:i(0)}),a=function(n,t,e){ui(n,fE,{value:e})},c=function(n,t,e,o){r(e.element().dom(),wC(SC))},s=hf([Jp.config({find:w.some}),sy.config({})]);return ND.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[e,o],onChange:a,onInit:c,sliderBehaviours:s})},c=Np({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(n,t,e){u(t,e)}},extraApis:{}});return c},tA=function(n,t){var o=function(e){var o=ZD(n,t,e.onValidHex,e.onInvalidHex),r=nA(n,t),i={paletteRgba:Ge(SC)},u=Bx(r.sketch({})),a=Bx(o.sketch({})),c=function(n,t){u.getOpt(n).each((function(n){var e=bC(t);i.paletteRgba.set(e),r.setRgba(n,e)}))},s=function(n,t){a.getOpt(n).each((function(n){o.updateHex(n,t)}))},f=function(n,t,e){q(e,(function(e){e(n,t)}))},l=function(){var n=[s];return function(t,e){var o=e.event().value(),r=i.paletteRgba.get(),u=uE(r),a=iE(u.hue,o.x(),100-o.y()),c=hC(a),s=sC(c);f(t,s,n)}},d=function(){var n=[c,s];return function(t,e){var o=e.event().value(),r=aE(o.y());f(t,r,n)}};return{uid:e.uid,dom:e.dom,components:[u.asSpec(),LD(n,t),a.asSpec()],behaviours:hf([ny("colour-picker-events",[pi(fE,l()),pi(sE,d())]),Jp.config({find:function(n){return a.getOpt(n)}}),jb.config({mode:"acyclic"})])}},r=Np({name:"ColourPicker",configFields:[pe("dom"),Ie("onValidHex",e),Ie("onInvalidHex",e)],factory:o});return r},eA=function(){return Jp.config({find:w.some})},oA=function(n){return Jp.config({find:n.getOpt})},rA=function(n){return Jp.config({find:function(t){return Vi(t.element(),n).bind((function(n){return t.getSystem().getByDom(n).toOption()}))}})},iA={self:eA,memento:oA,childAt:rA},uA={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},aA=function(n){return uA[n]},cA=function(n){return aA(n)},sA=function(n){var e=function(n){return"tox-"+n},o=tA(cA,e),r=function(n){ui(n,E_,{name:"hex-valid",value:!0})},i=function(n){ui(n,E_,{name:"hex-valid",value:!1})},u=Bx(o.sketch({dom:{tag:"div",classes:[e("color-picker-container")],attributes:{role:"presentation"}},onValidHex:r,onInvalidHex:i}));return{dom:{tag:"div"},components:[u.asSpec()],behaviours:hf([Tg.config({store:{mode:"manual",getValue:function(n){var t=u.get(n),e=Jp.getCurrent(t),o=e.bind((function(n){var t=Tg.getValue(n);return t.hex}));return o.map((function(n){return"#"+n})).getOr("")},setValue:function(n,e){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,r=o.exec(e),i=u.get(n),a=Jp.getCurrent(i);a.fold((function(){t.console.log("Can not find form")}),(function(n){Tg.setValue(n,{hex:w.from(r[1]).getOr("")}),qD.getField(n,"hex").each((function(n){ii(n,Er())}))}))}}}),iA.self()])}},fA=tinymce.util.Tools.resolve("tinymce.Resource"),lA=function(n){return Object.prototype.hasOwnProperty.call(n,"init")},dA=function(n){var t=Ge(w.none()),e=Bx({dom:{tag:n.tag}}),o=Ge(w.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:hf([ny("editor-foo-events",[Oi((function(r){e.getOpt(r).each((function(e){(lA(n)?n.init(e.element().dom()):fA.load(n.scriptId,n.scriptUrl).then((function(t){return t(e.element().dom(),n.settings)}))).then((function(n){o.get().each((function(t){n.setValue(t)})),o.set(w.none()),t.set(w.some(n))}))}))}))]),Tg.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return o.get().getOr("")}),(function(n){return n.getValue()}))},setValue:function(n,e){t.get().fold((function(){o.set(w.some(e))}),(function(n){return n.setValue(e)}))}}}),iA.self()]),components:[e.asSpec()]}},mA=Ht([Ie("preprocess",u),Ie("postprocess",u)]),gA=function(n,t){var e=ee("RepresentingConfigs.memento processors",mA,t);return Tg.config({store:{mode:"manual",getValue:function(t){var o=n.get(t),r=Tg.getValue(o);return e.postprocess(r)},setValue:function(t,o){var r=e.preprocess(o),i=n.get(t);Tg.setValue(i,r)}}})},pA=function(n,t,e){return Tg.config(Vn({store:{mode:"manual",getValue:t,setValue:e}},n.map((function(n){return{store:{initialValue:n}}})).getOr({})))},vA=function(n,t,e){return pA(n,(function(n){return t(n.element())}),(function(n,t){return e(n.element(),t)}))},hA=function(n){return vA(n,za,Na)},bA=function(n){return vA(n,Ki,Ji)},yA=function(n){return Tg.config({store:{mode:"memory",initialValue:n}})},xA={memento:gA,withElement:vA,withComp:pA,domValue:hA,domHtml:bA,memory:yA},wA=".jpg,.jpeg,.png,.gif",SA=function(n){var t=new RegExp("("+wA.split(/\s*,\s*/).join("|")+")$","i");return $(gn(n),(function(n){return t.test(n.name)}))},kA=function(n,t){var e=function(n,t){t.stop()},o=function(n){return function(t,e){q(n,(function(n){n(t,e)}))}},r=function(n,t){if(!WS.isDisabled(n)){var e=t.event().raw();u(n,e.dataTransfer.files)}},i=function(n,t){var e=t.event().raw().target.files;u(n,e)},u=function(t,e){Tg.setValue(t,SA(e)),ui(t,O_,{name:n.name})},a=Bx({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:hf([ny("input-file-events",[Si(Dr()),Si(Nr())])])}),c=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:hf([xA.memory([]),iA.self(),WS.config({}),Ey.config({toggleClass:"dragenter",toggleOnExecute:!1}),ny("dropzone-events",[pi("dragenter",o([e,Ey.toggle])),pi("dragleave",o([e,Ey.toggle])),pi("dragover",e),pi("drop",o([e,r])),pi(Br(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},Ex.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(n){var t=a.get(n);t.element().dom().click()},buttonBehaviours:hf([yT.config({}),Ak.button(t.isReadOnly),_k()])})]}]}},s=n.label.map((function(n){return OT(n,t)})),f=z_.parts().field({factory:{sketch:c}});return xT(s,f,["tox-form__group--stretched"],[])},CA=function(n,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:Y(n.items,t.interpreter)}},OA=bu("alloy-fake-before-tabstop"),_A=bu("alloy-fake-after-tabstop"),TA=function(n){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:n},behaviours:hf([sy.config({ignore:!0}),yT.config({})])}},EA=function(n){return{dom:{tag:"div",classes:["tox-navobj"]},components:[TA([OA]),n,TA([_A])],behaviours:hf([iA.childAt(1)])}},BA=function(n,t){ui(n,_r(),{raw:{which:9,shiftKey:t}})},DA=function(n,t){var e=t.element();xa(e,OA)?BA(n,!0):xa(e,_A)&&BA(n,!1)},AA=function(n){return KO(n,["."+OA,"."+_A].join(","),i(!1))},MA=!(Xo().browser.isIE()||Xo().browser.isEdge()),FA=function(n){var t=Ge("");return{getValue:function(n){return t.get()},setValue:function(e,o){if(n)ru(e.element(),"srcdoc",o);else{ru(e.element(),"src","javascript:''");var r=e.element().dom().contentWindow.document;r.open(),r.write(o),r.close()}t.set(o)}}},IA=function(n,t){var e=MA&&n.sandboxed,o=m(m({},n.label.map((function(n){return{title:n}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=FA(e),i=n.label.map((function(n){return OT(n,t)})),u=function(n){return EA({uid:n.uid,dom:{tag:"iframe",attributes:o},behaviours:hf([yT.config({}),sy.config({}),xA.withComp(w.none(),r.getValue,r.setValue)])})},a=z_.parts().field({factory:{sketch:u}});return xT(i,a,["tox-form__group--stretched"],[])};function RA(n,e){return PA(t.document.createElement("canvas"),n,e)}function VA(n){var t=RA(n.width,n.height),e=HA(t);return e.drawImage(n,0,0),t}function HA(n){return n.getContext("2d")}function PA(n,t,e){return n.width=t,n.height=e,n}function zA(n){return n.naturalWidth||n.width}function NA(n){return n.naturalHeight||n.height}var LA=function(){var n=function(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(n,o(u,this),o(a,this))},e=n.immediateFn||"function"===typeof window.setImmediate&&window.setImmediate||function(n){t.setTimeout(n,1)};function o(n,t){return function(){return n.apply(t,arguments)}}var r=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function i(n){var t=this;null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(r){return void n.reject(r)}n.resolve(o)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var t=n.then;if("function"===typeof t)return void f(o(t,n),o(u,this),o(a,this))}this._state=!0,this._value=n,c.call(this)}catch(e){a.call(this,e)}}function a(n){this._state=!1,this._value=n,c.call(this)}function c(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];i.call(this,e)}this._deferreds=[]}function s(n,t,e,o){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.resolve=e,this.reject=o}function f(n,t,e){var o=!1;try{n((function(n){o||(o=!0,t(n))}),(function(n){o||(o=!0,e(n))}))}catch(r){if(o)return;o=!0,e(r)}}return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var o=this;return new n((function(n,r){i.call(o,new s(t,e,n,r))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Array.prototype.slice.call(1===t.length&&r(t[0])?t[0]:t);return new n((function(n,t){if(0===o.length)return n([]);var e=o.length;function r(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){r(i,n)}),t)}o[i]=u,0===--e&&n(o)}catch(c){t(c)}}for(var i=0;i<o.length;i++)r(i,o[i])}))},n.resolve=function(t){return t&&"object"===typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t;o<r.length;o++){var i=r[o];i.then(n,e)}}))},n},jA=window.Promise?window.Promise:LA();function UA(n){return new jA((function(e,o){var r=t.URL.createObjectURL(n),i=new t.Image,u=function(){i.removeEventListener("load",a),i.removeEventListener("error",c)};function a(){u(),e(i)}function c(){u(),o("Unable to load data of type "+n.type+": "+r)}i.addEventListener("load",a),i.addEventListener("error",c),i.src=r,i.complete&&a()}))}function WA(n){var e=n.split(","),o=/data:([^;]+)/.exec(e[0]);if(!o)return w.none();for(var r=o[1],i=e[1],u=1024,a=t.atob(i),c=a.length,s=Math.ceil(c/u),f=new Array(s),l=0;l<s;++l){for(var d=l*u,m=Math.min(d+u,c),g=new Array(m-d),p=d,v=0;p<m;++v,++p)g[v]=a[p].charCodeAt(0);f[l]=new Uint8Array(g)}return w.some(new t.Blob(f,{type:r}))}function GA(n){return new jA((function(t,e){WA(n).fold((function(){e("uri is not base64: "+n)}),t)}))}function XA(n,e,o){return e=e||"image/png",t.HTMLCanvasElement.prototype.toBlob?new jA((function(t,r){n.toBlob((function(n){n?t(n):r()}),e,o)})):GA(n.toDataURL(e,o))}function YA(n,t,e){return t=t||"image/png",n.toDataURL(t,e)}function qA(n){return UA(n).then((function(n){JA(n);var t=RA(zA(n),NA(n)),e=HA(t);return e.drawImage(n,0,0),t}))}function KA(n){return new jA((function(e){var o=new t.FileReader;o.onloadend=function(){e(o.result)},o.readAsDataURL(n)}))}function JA(n){t.URL.revokeObjectURL(n.src)}function $A(n,t,e){var o=t.type,r=i(o);function u(){return jA.resolve(t)}var a=i(e);function c(){return e.split(",")[1]}function s(t,e){return n.then((function(n){return XA(n,t,e)}))}function f(t,e){return n.then((function(n){return YA(n,t,e)}))}function l(n,t){return f(n,t).then((function(n){return n.split(",")[1]}))}function d(){return n.then(VA)}return{getType:r,toBlob:u,toDataURL:a,toBase64:c,toAdjustedBlob:s,toAdjustedDataURL:f,toAdjustedBase64:l,toCanvas:d}}function QA(n){return KA(n).then((function(t){return $A(qA(n),n,t)}))}function ZA(n,t){return XA(n,t).then((function(t){return $A(jA.resolve(n),t,n.toDataURL())}))}var nM=function(n){return QA(n)};function tM(n,t,e){var o="string"===typeof n?parseFloat(n):n;return o>e?o=e:o<t&&(o=t),o}function eM(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var oM=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function rM(n,t){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=t[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=n[u+5*a]*o[a];r[u+5*i]=e}}return r}function iM(n,t){var e;return t=tM(t,-1,1),t*=100,t<0?e=127+t/100*127:(e=t%1,e=0===e?oM[t]:oM[Math.floor(t)]*(1-e)+oM[Math.floor(t)+1]*e,e=127*e+127),rM(n,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}function uM(n,t){return t=tM(255*t,-255,255),rM(n,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}function aM(n,t,e,o){return t=tM(t,0,2),e=tM(e,0,2),o=tM(o,0,2),rM(n,[t,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}function cM(n,t){return n.toCanvas().then((function(e){return sM(e,n.getType(),t)}))}function sM(n,t,e){var o=HA(n);function r(n,t){for(var e,o,r,i,u=n.data,a=t[0],c=t[1],s=t[2],f=t[3],l=t[4],d=t[5],m=t[6],g=t[7],p=t[8],v=t[9],h=t[10],b=t[11],y=t[12],x=t[13],w=t[14],S=t[15],k=t[16],C=t[17],O=t[18],_=t[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+v,u[T+2]=e*h+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return n}var i=r(o.getImageData(0,0,n.width,n.height),e);return o.putImageData(i,0,0),ZA(n,t)}function fM(n,t){return n.toCanvas().then((function(e){return lM(e,n.getType(),t)}))}function lM(n,t,e){var o=HA(n);function r(n,t,e){function o(n,t,e){return n>e?n=e:n<t&&(n=t),n}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=n.data,a=t.data,c=n.width,s=n.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var v=0;v<r;v++){var h=o(l+v-i,0,c-1),b=o(f+p-i,0,s-1),y=4*(b*c+h),x=e[p*r+v];d+=u[y]*x,m+=u[y+1]*x,g+=u[y+2]*x}var w=4*(f*c+l);a[w]=o(d,0,255),a[w+1]=o(m,0,255),a[w+2]=o(g,0,255)}return t}var i=o.getImageData(0,0,n.width,n.height),u=o.getImageData(0,0,n.width,n.height);return u=r(i,u,e),o.putImageData(u,0,0),ZA(n,t)}function dM(n){var t=function(t,e,o){var r=HA(t),i=new Array(256);function u(n,t){for(var e=n.data,o=0;o<e.length;o+=4)e[o]=t[e[o]],e[o+1]=t[e[o+1]],e[o+2]=t[e[o+2]];return n}for(var a=0;a<i.length;a++)i[a]=n(a,o);var c=u(r.getImageData(0,0,t.width,t.height),i);return r.putImageData(c,0,0),ZA(t,e)};return function(n,e){return n.toCanvas().then((function(o){return t(o,n.getType(),e)}))}}function mM(n){return function(t,e){return cM(t,n(eM(),e))}}function gM(n){return function(t){return cM(t,n)}}function pM(n){return function(t){return fM(t,n)}}var vM=gM([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),hM=mM(uM),bM=mM(iM),yM=function(n,t,e,o){return cM(n,aM(eM(),t,e,o))},xM=pM([0,-1,0,-1,5,-1,0,-1,0]),wM=dM((function(n,t){return 255*Math.pow(n/255,1-t)}));function SM(n,t,e){var o=zA(n),r=NA(n),i=t/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=kM(n,i,u);return a?c.then((function(n){return SM(n,t,e)})):c}function kM(n,t,e){return new jA((function(o){var r=zA(n),i=NA(n),u=Math.floor(r*t),a=Math.floor(i*e),c=RA(u,a),s=HA(c);s.drawImage(n,0,0,r,i,0,0,u,a),o(c)}))}function CM(n,t){return n.toCanvas().then((function(e){return OM(e,n.getType(),t)}))}function OM(n,t,e){var o=RA(n.width,n.height),r=HA(o),i=0,u=0;return e=e<0?360+e:e,90!==e&&270!==e||PA(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(n,0,0),ZA(o,t)}function _M(n,t){return n.toCanvas().then((function(e){return TM(e,n.getType(),t)}))}function TM(n,t,e){var o=RA(n.width,n.height),r=HA(o);return"v"===e?(r.scale(1,-1),r.drawImage(n,0,-o.height)):(r.scale(-1,1),r.drawImage(n,-o.width,0)),ZA(o,t)}function EM(n,t,e,o,r){return n.toCanvas().then((function(i){return BM(i,n.getType(),t,e,o,r)}))}function BM(n,t,e,o,r,i){var u=RA(r,i),a=HA(u);return a.drawImage(n,-e,-o),ZA(u,t)}function DM(n,t,e){return n.toCanvas().then((function(o){return SM(o,t,e).then((function(t){return ZA(t,n.getType())}))}))}var AM=function(n){return vM(n)},MM=function(n){return xM(n)},FM=function(n,t){return wM(n,t)},IM=function(n,t,e,o){return yM(n,t,e,o)},RM=function(n,t){return hM(n,t)},VM=function(n,t){return bM(n,t)},HM=function(n,t){return _M(n,t)},PM=function(n,t,e,o,r){return EM(n,t,e,o,r)},zM=function(n,t,e){return DM(n,t,e)},NM=function(n,t){return CM(n,t)},LM=function(n,t){return m({dom:{tag:"span",innerHtml:n,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},jM=function(n,t){return LM(Ax(n,t),{})},UM=function(n,t){return LM(Ax(n,t),{behaviours:hf([Qb.config({})])})},WM=function(n,t,e){return{dom:{tag:"span",innerHtml:e.translate(n),classes:[t+"__select-label"]},behaviours:hf([Qb.config({})])}},GM=bu("toolbar.button.execute"),XM=function(n){return Ei((function(t,e){Mk(n,t)((function(e){ui(t,GM,{buttonApi:e}),n.onAction(e)}))}))},YM={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},qM=bu("update-menu-text"),KM=bu("update-menu-icon"),JM=function(n,t,o){var r=Ge(e),i=n.text.map((function(n){return Bx(WM(n,t,o.providers))})),u=n.icon.map((function(n){return Bx(UM(n,o.providers.icons))})),a=function(n,t){var e=Tg.getValue(n);return sy.focus(e),ui(e,"keydown",{raw:t.event().raw()}),KT.close(e),w.some(!0)},c=n.role.fold((function(){return{}}),(function(n){return{role:n}})),s=n.tooltip.fold((function(){return{}}),(function(n){var t=o.providers.translate(n);return{title:t,"aria-label":t}})),f=Bx(KT.sketch(m(m({},c),{dom:{tag:"button",classes:[t,t+"--select"].concat(Y(n.classes,(function(n){return t+"--"+n}))),attributes:m({},s)},components:Pk([u.map((function(n){return n.asSpec()})),i.map((function(n){return n.asSpec()})),w.some({dom:{tag:"div",classes:[t+"__select-chevron"],innerHtml:Ax("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:hf(p(n.dropdownBehaviours,[Ak.button((function(){return n.disabled||o.providers.isReadOnly()})),_k(),ZT.config({}),Qb.config({}),ny("dropdown-events",[Fk(n,r),Ik(n,r)]),ny("menubutton-update-display-text",[pi(qM,(function(n,t){i.bind((function(t){return t.getOpt(n)})).each((function(n){Qb.set(n,[Ja(o.providers.translate(t.event().text()))])}))})),pi(KM,(function(n,t){u.bind((function(t){return t.getOpt(n)})).each((function(n){Qb.set(n,[UM(t.event().icon(),o.providers.icons)])}))}))])])),eventOrder:Vn(YM,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:hf([jb.config({mode:"special",onLeft:a,onRight:a})]),lazySink:o.getSink,toggleClass:t+"--active",parts:{menu:cO(!1,n.columns,n.presets)},fetch:function(){return oT.nu(n.fetch)}})));return f.asSpec()},$M=function(n){return D(n)},QM=function(n){return"separator"===n.type},ZM=function(n){return En(n,"getSubmenuItems")},nF={type:"separator"},tF=function(n,t){var e=Z(n,(function(n,e){return $M(e)?""===e?n:"|"===e?n.length>0&&!QM(n[n.length-1])?n.concat([nF]):n:En(t,e.toLowerCase())?n.concat([t[e.toLowerCase()]]):n:n.concat([e])}),[]);return e.length>0&&QM(e[e.length-1])&&e.pop(),e},eF=function(n,t){var e=n.getSubmenuItems(),o=iF(e,t),r=Vn(o.menus,ct(n.value,o.items)),i=Vn(o.expansions,ct(n.value,n.value));return{item:n,menus:r,expansions:i}},oF=function(n,t){return ZM(n)?eF(n,t):{item:n,menus:{},expansions:{}}},rF=function(n){if(QM(n))return n;var t=Tn(n,"value").getOrThunk((function(){return bu("generated-menu-item")}));return Vn({value:t},n)},iF=function(n,t){var e=tF(D(n)?n.split(" "):n,t);return Q(e,(function(n,e){var o=rF(e),r=oF(o,t);return{menus:Vn(n.menus,r.menus),items:[r.item].concat(n.items),expansions:Vn(n.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},uF=function(n,t,e,o){var r=bu("primary-menu"),i=iF(n,e.shared.providers.menuItems());if(0===i.items.length)return w.none();var u=NO(r,i.items,t,e,o),a=yn(i.menus,(function(n,o){return NO(o,n,t,e,!1)})),c=Vn(a,ct(r,u));return w.from(lx.tieredData(r,c,i.expansions))},aF=function(n){return{isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)},setActive:function(t){var e=n.element();t?(ha(e,"tox-tbtn--enabled"),ru(e,"aria-pressed",!0)):(ya(e,"tox-tbtn--enabled"),su(e,"aria-pressed"))},isActive:function(){return xa(n.element(),"tox-tbtn--enabled")}}},cF=function(n,t,e,o){return JM({text:n.text,icon:n.icon,tooltip:n.tooltip,role:o,fetch:function(t){n.fetch((function(n){t(uF(n,Rk.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:n.onSetup,getApi:aF,columns:1,presets:"normal",classes:[],dropdownBehaviours:[yT.config({})]},t,e.shared)},sF=function(n,t,e){var o=function(n){return function(o){var r=!o.isActive();o.setActive(r),n.storage.set(r),e.shared.getSink().each((function(e){t().getOpt(e).each((function(t){Df(t.element()),ui(t,E_,{name:n.name,value:n.storage.get()})}))}))}},r=function(n){return function(t){t.setActive(n.storage.get())}};return function(t){t(Y(n,(function(n){var t=n.text.fold((function(){return{}}),(function(n){return{text:n}}));return m(m({type:n.type,active:!1},t),{onAction:o(n),onSetup:r(n)})})))}},fF=function(n,t,e,o,r,i){void 0===e&&(e=[]);var u=t.fold((function(){return{}}),(function(n){return{action:n}})),a=m({buttonBehaviours:hf([Ak.button((function(){return n.disabled||i.isReadOnly()})),_k(),yT.config({}),ny("button press",[gi("click"),gi("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Vn(a,{dom:o});return Vn(c,{components:r})},lF=function(n,t,e,o){void 0===o&&(o=[]);var r=n.tooltip.map((function(n){return{"aria-label":e.translate(n),title:e.translate(n)}})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:r},u=n.icon.map((function(n){return jM(n,e.icons)})),a=Pk([u]);return fF(n,t,o,i,a,e)},dF=function(n,t,e,o){void 0===o&&(o=[]);var r=lF(n,w.some(t),e,o);return Ex.sketch(r)},mF=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(n.text),u=n.icon?n.icon.map((function(n){return jM(n,e.icons)})):w.none(),a=u.isSome()?Pk([u]):[],c=u.isSome()?{}:{innerHtml:i},s=p(n.primary||n.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],n.borderless?["tox-button--naked"]:[],r),f=m(m({tag:"button",classes:s},c),{attributes:{title:i}});return fF(n,t,o,f,a,e)},gF=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=mF(n,w.some(t),e,o,r);return Ex.sketch(i)},pF=function(n,e){return function(o){"custom"===e?ui(o,E_,{name:n,value:{}}):"submit"===e?ii(o,B_):"cancel"===e?ii(o,T_):t.console.error("Unknown button type: ",e)}},vF=function(n,t){return"menu"===t},hF=function(n,t){return"custom"===t||"cancel"===t||"submit"===t},bF=function(n,o,r){if(vF(n,o)){var i=function(){return c},u=n,a=m(m({},n),{onSetup:function(t){return t.setDisabled(n.disabled),e},fetch:sF(u.items,i,r)}),c=Bx(cF(a,"tox-tbtn",r,w.none()));return c.asSpec()}if(hF(n,o)){var s=pF(n.name,o),f=m(m({},n),{borderless:!1});return gF(f,s,r.shared.providers,[])}t.console.error("Unknown footer button type: ",o)},yF=function(n,t){var e=pF(n.name,"custom");return wT(w.none(),z_.parts().field(m({factory:Ex},mF(n,w.some(e),t,[xA.memory(""),iA.self()]))))},xF=i([Ie("field1Name","field1"),Ie("field2Name","field2"),xs("onLockedChange"),vs(["lockClass"]),Ie("locked",!1),Ag.field("coupledFieldBehaviours",[Jp,Tg])]),wF=function(n,t,e){return wp(n,t,e).bind(Jp.getCurrent)},SF=function(n,t){return up({factory:z_,name:n,overrides:function(n){return{fieldBehaviours:hf([ny("coupled-input-behaviour",[pi(Er(),(function(e){wF(e,n,t).each((function(t){wp(e,n,"lock").each((function(o){Ey.isOn(o)&&n.onLockedChange(e,t,o)}))}))}))])])}}})},kF=i([SF("field1","field2"),SF("field2","field1"),up({factory:Ex,schema:[pe("dom")],name:"lock",overrides:function(n){return{buttonBehaviours:hf([Ey.config({selected:n.locked,toggleClass:n.markers.lockClass,aria:{mode:"pressed"}})])}}})]),CF=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Ag.augment(n.coupledFieldBehaviours,[Jp.config({find:w.some}),Tg.config({store:{mode:"manual",getValue:function(t){var e,o=_p(t,n,["field1","field2"]);return e={},e[n.field1Name]=Tg.getValue(o.field1()),e[n.field2Name]=Tg.getValue(o.field2()),e},setValue:function(t,e){var o=_p(t,n,["field1","field2"]);Bn(e,n.field1Name)&&Tg.setValue(o.field1(),e[n.field1Name]),Bn(e,n.field2Name)&&Tg.setValue(o.field2(),e[n.field2Name])}}})]),apis:{getField1:function(t){return wp(t,n,"field1")},getField2:function(t){return wp(t,n,"field2")},getLock:function(t){return wp(t,n,"lock")}}}},OF=Lp({name:"FormCoupledInputs",configFields:xF(),partFields:kF(),factory:CF,apis:{getField1:function(n,t){return n.getField1(t)},getField2:function(n,t){return n.getField2(t)},getLock:function(n,t){return n.getLock(t)}}}),_F=function(n){var t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=function(n){return n in t?t[n]:1},o=n.value.toFixed(e(n.unit));return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+n.unit},TF=function(n){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,e=t.exec(n);if(null!==e){var o=parseFloat(e[1]),r=e[2];return O.value({value:o,unit:r})}return O.error(n)},EF=function(n,t){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(n){return Object.prototype.hasOwnProperty.call(e,n)};return n.unit===t?w.some(n.value):o(n.unit)&&o(t)?e[n.unit]===e[t]?w.some(n.value):w.some(n.value/e[n.unit]*e[t]):w.none()},BF=function(n){return w.none()},DF=function(n,t){return function(e){return EF(e,t).map((function(e){return{value:e*n,unit:t}}))}},AF=function(n,t){var e=TF(n).toOption(),o=TF(t).toOption();return Wp(e,o,(function(n,t){return EF(n,t.unit).map((function(n){return t.value/n})).map((function(n){return DF(n,t.unit)})).getOr(BF)})).getOr(BF)},MF=function(n,t){var e=BF,o=bu("ratio-event"),r=OF.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(n.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Ax("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Ax("unlock",t.icons)}}],buttonBehaviours:hf([WS.config({disabled:function(){return n.disabled||t.isReadOnly()}}),_k(),yT.config({})])}),i=function(n){return{dom:{tag:"div",classes:["tox-form__group"]},components:n}},u=function(e){return z_.parts().field({factory:G_,inputClasses:["tox-textfield"],inputBehaviours:hf([WS.config({disabled:function(){return n.disabled||t.isReadOnly()}}),_k(),yT.config({}),ny("size-input-events",[pi(Cr(),(function(n,t){ui(n,o,{isField1:e})})),pi(Br(),(function(t,e){ui(t,O_,{name:n.name})}))])]),selectOnFocus:!1})},a=function(n){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}},c=OF.parts().field1(i([z_.parts().label(a("Width")),u(!0)])),s=OF.parts().field2(i([z_.parts().label(a("Height")),u(!1)]));return OF.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(n,t,o){TF(Tg.getValue(n)).each((function(n){e(n).each((function(n){Tg.setValue(t,_F(n))}))}))},coupledFieldBehaviours:hf([WS.config({disabled:function(){return n.disabled||t.isReadOnly()},onDisabled:function(n){OF.getField1(n).bind(z_.getField).each(WS.disable),OF.getField2(n).bind(z_.getField).each(WS.disable),OF.getLock(n).each(WS.disable)},onEnabled:function(n){OF.getField1(n).bind(z_.getField).each(WS.enable),OF.getField2(n).bind(z_.getField).each(WS.enable),OF.getLock(n).each(WS.enable)}}),_k(),ny("size-input-events2",[pi(o,(function(n,t){var o=t.event().isField1(),r=o?OF.getField1(n):OF.getField2(n),i=o?OF.getField2(n):OF.getField1(n),u=r.map(Tg.getValue).getOr(""),a=i.map(Tg.getValue).getOr("");e=AF(u,a)}))])])})},FF=i(bu("undo")),IF=i(bu("redo")),RF=i(bu("zoom")),VF=i(bu("back")),HF=i(bu("apply")),PF=i(bu("swap")),zF=i(bu("transform")),NF=i(bu("temp-transform")),LF=i(bu("transform-apply")),jF={undo:FF,redo:IF,zoom:RF,back:VF,apply:HF,swap:PF,transform:zF,tempTransform:NF,transformApply:LF},UF=i("save-state"),WF=i("disable"),GF=i("enable"),XF={formActionEvent:E_,saveState:UF,disable:WF,enable:GF},YF=function(n,t){var o=function(n,e,o,r){return Bx(gF({name:n,text:n,disabled:o,primary:r,icon:w.none(),borderless:!1},e,t))},r=function(n,e,o,r){return Bx(dF({name:n,icon:w.some(n),tooltip:w.some(e),disabled:r,primary:!1,borderless:!1},o,t))},u=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(WS)&&WS.disable(e)}))},a=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(WS)&&WS.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=e,f=function(n,t,e){ui(n,t,e)},l=function(n){return ii(n,XF.disable())},d=function(n){return ii(n,XF.enable())},m=function(n,t){l(n),f(n,jF.transform(),{transform:t}),d(n)},g=function(n,t){l(n),f(n,jF.tempTransform(),{transform:t}),d(n)},p=function(n){return function(){an.getOpt(n).each((function(n){Qb.set(n,[rn])}))}},v=function(n,t){l(n),f(n,jF.transformApply(),{transform:t,swap:p(n)}),d(n)},h=function(){return o("Back",(function(n){return f(n,jF.back(),{swap:p(n)})}),!1,!1)},b=function(){return Bx({dom:{tag:"div",classes:["tox-spacer"]},behaviours:hf([WS.config({})])})},y=function(){return o("Apply",(function(n){return f(n,jF.apply(),{swap:p(n)})}),!0,!0)},x=function(){return function(t){var e=n.getRect();return PM(t,e.x,e.y,e.w,e.h)}},S=[h(),b(),o("Apply",(function(t){var e=x();v(t,e),n.hideCrop()}),!1,!0)],k=k_.sketch({dom:c,components:S.map((function(n){return n.asSpec()})),containerBehaviours:hf([ny("image-tools-crop-buttons-events",[pi(XF.disable(),(function(n,t){u(S,n)})),pi(XF.enable(),(function(n,t){a(S,n)}))])])}),C=Bx(MF({name:"size",label:w.none(),constrain:!0,disabled:!1},t)),O=function(n,t){return function(e){return zM(e,n,t)}},_=[h(),b(),C,b(),o("Apply",(function(n){C.getOpt(n).each((function(t){var e=Tg.getValue(t),o=parseInt(e.width,10),r=parseInt(e.height,10),i=O(o,r);v(n,i)}))}),!1,!0)],T=k_.sketch({dom:c,components:_.map((function(n){return n.asSpec()})),containerBehaviours:hf([ny("image-tools-resize-buttons-events",[pi(XF.disable(),(function(n,t){u(_,n)})),pi(XF.enable(),(function(n,t){a(_,n)}))])])}),E=function(n,t){return function(e){return n(e,t)}},B=E(HM,"h"),D=E(HM,"v"),A=E(NM,-90),M=E(NM,90),F=function(n,t){g(n,t)},I=[h(),b(),r("flip-horizontally","Flip horizontally",(function(n){F(n,B)}),!1),r("flip-vertically","Flip vertically",(function(n){F(n,D)}),!1),r("rotate-left","Rotate counterclockwise",(function(n){F(n,A)}),!1),r("rotate-right","Rotate clockwise",(function(n){F(n,M)}),!1),b(),y()],R=k_.sketch({dom:c,components:I.map((function(n){return n.asSpec()})),containerBehaviours:hf([ny("image-tools-fliprotate-buttons-events",[pi(XF.disable(),(function(n,t){u(I,n)})),pi(XF.enable(),(function(n,t){a(I,n)}))])])}),V=function(n,e,o,r,u){var a=ND.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}),c=ND.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=ND.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Bx(ND.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:u,getInitialValue:i({x:i(r)})},components:[a,c,s],sliderBehaviours:hf([sy.config({})]),onChoose:e}))},H=function(n,t,e,o,r){var i=function(n,e,o){var r=E(t,o.x()/100);m(n,r)};return V(n,i,e,o,r)},P=function(n,t,e,o,r){return[h(),H(n,t,e,o,r),y()]},z=function(n,t,e,o,r){var i=P(n,t,e,o,r);return k_.sketch({dom:c,components:i.map((function(n){return n.asSpec()})),containerBehaviours:hf([ny("image-tools-filter-panel-buttons-events",[pi(XF.disable(),(function(n,t){u(i,n)})),pi(XF.enable(),(function(n,t){a(i,n)}))])])})},N=[h(),b(),y()],L=k_.sketch({dom:c,components:N.map((function(n){return n.asSpec()}))}),j=z("Brightness",RM,-100,0,100),U=z("Contrast",VM,-100,0,100),W=z("Gamma",FM,-100,0,100),G=function(n,t,e){return function(o){return IM(o,n,t,e)}},X=function(n){var t=function(n,t,e){var o=Y.getOpt(n),r=K.getOpt(n),i=q.getOpt(n);o.each((function(t){r.each((function(e){i.each((function(o){var r=Tg.getValue(t).x()/100,i=Tg.getValue(o).x()/100,u=Tg.getValue(e).x()/100,a=G(r,i,u);m(n,a)}))}))}))};return V(n,t,0,100,200)},Y=X("R"),q=X("G"),K=X("B"),J=[h(),Y,q,K,y()],$=k_.sketch({dom:c,components:J.map((function(n){return n.asSpec()}))}),Q=function(n,t,e){return function(o){var r=function(){an.getOpt(o).each((function(t){Qb.set(t,[n]),e(t)}))};f(o,jF.swap(),{transform:t,swap:r})}},Z=function(t){n.showCrop()},nn=function(t){C.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height;Tg.setValue(t,{width:o,height:r})}))},tn=w.some(MM),en=w.some(AM),on=[r("crop","Crop",Q(k,w.none(),Z),!1),r("resize","Resize",Q(T,w.none(),nn),!1),r("orientation","Orientation",Q(R,w.none(),s),!1),r("brightness","Brightness",Q(j,w.none(),s),!1),r("sharpen","Sharpen",Q(L,tn,s),!1),r("contrast","Contrast",Q(U,w.none(),s),!1),r("color-levels","Color levels",Q($,w.none(),s),!1),r("gamma","Gamma",Q(W,w.none(),s),!1),r("invert","Invert",Q(L,en,s),!1)],rn=k_.sketch({dom:c,components:on.map((function(n){return n.asSpec()}))}),un=k_.sketch({dom:{tag:"div"},components:[rn],containerBehaviours:hf([Qb.config({})])}),an=Bx(un),cn=function(n){return an.getOpt(n).map((function(n){var t=n.components()[0];return t.components()[t.components().length-1]}))};return{memContainer:an,getApplyButton:cn}},qF=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),KF=tinymce.util.Tools.resolve("tinymce.geom.Rect"),JF=tinymce.util.Tools.resolve("tinymce.util.Observable"),$F=tinymce.util.Tools.resolve("tinymce.util.Tools"),QF=tinymce.util.Tools.resolve("tinymce.util.VK");function ZF(n){var t,e,o,r,i,u,a,c,s=Math.max;return t=n.documentElement,e=n.body,o=s(t.scrollWidth,e.scrollWidth),r=s(t.clientWidth,e.clientWidth),i=s(t.offsetWidth,e.offsetWidth),u=s(t.scrollHeight,e.scrollHeight),a=s(t.clientHeight,e.clientHeight),c=s(t.offsetHeight,e.offsetHeight),{width:o<i?r:o,height:u<c?a:u}}function nI(n){var t,e;if(n.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<t.length;e++)n[t[e]]=n.changedTouches[0][t[e]]}function tI(n,e){var o,r,i,u,a,c,s,f=e.document||t.document;e=e||{};var l=f.getElementById(e.handle||n);i=function(n){var i,d,m=ZF(f);nI(n),n.preventDefault(),r=n.button,i=l,c=n.screenX,s=n.screenY,d=t.window.getComputedStyle?t.window.getComputedStyle(i,null).getPropertyValue("cursor"):i.runtimeStyle.cursor,o=qF("<div></div>").css({position:"absolute",top:0,left:0,width:m.width,height:m.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(f.body),qF(f).on("mousemove touchmove",a).on("mouseup touchend",u),e.start(n)},a=function(n){if(nI(n),n.button!==r)return u(n);n.deltaX=n.screenX-c,n.deltaY=n.screenY-s,n.preventDefault(),e.drag(n)},u=function(n){nI(n),qF(f).off("mousemove touchmove",a).off("mouseup touchend",u),o.remove(),e.stop&&e.stop(n)},this.destroy=function(){qF(l).off()},qF(l).on("mousedown touchstart",i)}var eI=0,oI=function(n,t,e,o,r){var i,u,a,c="tox-",s=c+"crid-"+eI++,f=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}];a=["top","right","bottom","left"];var l=function(n,t){return{x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}},d=function(n,t){return{x:t.x-n.x,y:t.y-n.y,w:t.w,h:t.h}},m=function(){return d(e,n)};function g(t,o,r,u){var a,c,s,f,l;a=o.x,c=o.y,s=o.w,f=o.h,a+=r*t.deltaX,c+=u*t.deltaY,s+=r*t.deltaW,f+=u*t.deltaH,s<20&&(s=20),f<20&&(f=20),l=n=KF.clamp({x:a,y:c,w:s,h:f},e,"move"===t.name),l=d(e,l),i.fire("updateRect",{rect:l}),x(l)}function p(){function t(t){var e;return new tI(s,{document:o.ownerDocument,handle:s+"-"+t.name,start:function(){e=n},drag:function(n){g(t,e,n.deltaX,n.deltaY)}})}qF('<div id="'+s+'" class="'+c+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),$F.each(a,(function(n){qF("#"+s,o).append('<div id="'+s+"-"+n+'"class="'+c+'croprect-block" style="display: none" data-mce-bogus="all">')})),$F.each(f,(function(n){qF("#"+s,o).append('<div id="'+s+"-"+n.name+'" class="'+c+"croprect-handle "+c+"croprect-handle-"+n.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+n.label+'" aria-grabbed="false" title="'+n.label+'">')})),u=$F.map(f,t),h(n),qF(o).on("focusin focusout",(function(n){qF(n.target).attr("aria-grabbed","focus"===n.type?"true":"false")})),qF(o).on("keydown",(function(t){var e;function o(n,t,o,r,i){n.stopPropagation(),n.preventDefault(),g(e,o,r,i)}switch($F.each(f,(function(n){if(t.target.id===s+"-"+n.name)return e=n,!1})),t.keyCode){case QF.LEFT:o(t,e,n,-10,0);break;case QF.RIGHT:o(t,e,n,10,0);break;case QF.UP:o(t,e,n,0,-10);break;case QF.DOWN:o(t,e,n,0,10);break;case QF.ENTER:case QF.SPACEBAR:t.preventDefault(),r();break}}))}function v(n){var t;t=$F.map(f,(function(n){return"#"+s+"-"+n.name})).concat($F.map(a,(function(n){return"#"+s+"-"+n}))).join(","),n?qF(t,o).show():qF(t,o).hide()}function h(n){function e(n,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),qF("#"+s+"-"+n,o).css({left:t.x,top:t.y,width:t.w,height:t.h})}$F.each(f,(function(t){qF("#"+s+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})})),e("top",{x:t.x,y:t.y,w:t.w,h:n.y-t.y}),e("right",{x:n.x+n.w,y:n.y,w:t.w-n.x-n.w+t.x,h:n.h}),e("bottom",{x:t.x,y:n.y+n.h,w:t.w,h:t.h-n.y-n.h+t.y}),e("left",{x:t.x,y:n.y,w:n.x-t.x,h:n.h}),e("move",n)}function b(t){n=t,h(n)}function y(e){t=e,h(n)}function x(n){b(l(e,n))}function w(t){e=t,h(n)}function S(){$F.each(u,(function(n){n.destroy()})),u=[]}return p(),i=$F.extend({toggleVisibility:v,setClampRect:w,setRect:b,getInnerRect:m,setInnerRect:x,setViewPortRect:y,destroy:S},JF),i},rI={create:oI},iI=function(n){return new ew((function(t){var e=function(){n.removeEventListener("load",e),t(n)};n.complete?t(n):n.addEventListener("load",e)}))},uI=function(n){var t=Bx({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Ge(1),o=Ge(w.none()),r=Ge({x:0,y:0,w:1,h:1}),i=Ge({x:0,y:0,w:1,h:1}),u=function(n,i){g.getOpt(n).each((function(n){var u=e.get(),a=gc(n.element()),c=oc(n.element()),s=i.dom().naturalWidth*u,f=i.dom().naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};Da(i,m),t.getOpt(n).each((function(n){Da(n.element(),m)})),o.get().each((function(n){var t=r.get();n.setRect({x:t.x*u+l,y:t.y*u+d,w:t.w*u,h:t.h*u}),n.setClampRect({x:l,y:d,w:s,h:f}),n.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(n,t){g.getOpt(n).each((function(n){var o=gc(n.element()),r=oc(n.element()),i=t.dom().naturalWidth,u=t.dom().naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)}))},c=function(n,t){var e=$e.fromTag("img");return ru(e,"src",t),iI(e.dom()).then((function(){return g.getOpt(n).map((function(n){var t=$a({element:e});Qb.replaceAt(n,1,w.some(t));var o=i.get(),c={x:0,y:0,w:e.dom().naturalWidth,h:e.dom().naturalHeight};i.set(c);var s=KF.inflate(c,-20,-20);return r.set(s),o.w===c.w&&o.h===c.h||a(n,e),u(n,e),e}))}))},s=function(n,t){var o=e.get(),r=t>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),g.getOpt(n).each((function(n){var t=n.components()[1].element();u(n,t)}))},f=function(){o.get().each((function(n){n.toggleVisibility(!0)}))},l=function(){o.get().each((function(n){n.toggleVisibility(!1)}))},d=function(){return r.get()},m=k_.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:hf([ny("image-panel-crop-events",[Oi((function(n){g.getOpt(n).each((function(n){var t=n.element().dom(),i=rI.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,(function(){}));i.toggleVisibility(!1),i.on("updateRect",(function(n){var t=n.rect,o=e.get(),i={x:Math.round(t.x/o),y:Math.round(t.y/o),w:Math.round(t.w/o),h:Math.round(t.h/o)};r.set(i)})),o.set(w.some(i))}))}))])])}],containerBehaviours:hf([Qb.config({}),ny("image-panel-events",[Oi((function(t){c(t,n)}))])])}),g=Bx(m),p=function(){var n=i.get();return{width:n.w,height:n.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:f,hideCrop:l,getRect:d,getMeasurements:p}},aI=function(n,t,e,o,r){return dF({name:n,icon:w.some(t),disabled:e,tooltip:w.some(n),primary:!1,borderless:!1},o,r)},cI=function(n,t){t?WS.enable(n):WS.disable(n)},sI=function(n){var t=function(n,t,r){e.getOpt(n).each((function(n){cI(n,t)})),o.getOpt(n).each((function(n){cI(n,r)}))},e=Bx(aI("Undo","undo",!0,(function(n){ui(n,jF.undo(),{direction:1})}),n)),o=Bx(aI("Redo","redo",!0,(function(n){ui(n,jF.redo(),{direction:1})}),n)),r=k_.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[e.asSpec(),o.asSpec(),aI("Zoom in","zoom-in",!1,(function(n){ui(n,jF.zoom(),{direction:1})}),n),aI("Zoom out","zoom-out",!1,(function(n){ui(n,jF.zoom(),{direction:-1})}),n)]});return{container:r,updateButtonUndoStates:t}};function fI(){var n=[],t=-1;function e(e){var o;return o=n.splice(++t),n.push(e),{state:e,removed:o}}function o(){if(i())return n[--t]}function r(){if(u())return n[++t]}function i(){return t>0}function u(){return-1!==t&&t<n.length-1}return{data:n,add:e,undo:o,redo:r,canUndo:i,canRedo:u}}var lI,dI=function(n){var e=Ge(n),o=Ge(w.none()),r=fI();r.add(n);var i=function(){return e.get()},u=function(n){e.set(n)},a=function(){return o.get().fold((function(){return e.get()}),(function(n){return n}))},c=function(n){var t=s(n);return d(),o.set(w.some(t)),t.url},s=function(n){return{blob:n,url:t.URL.createObjectURL(n)}},f=function(n){t.URL.revokeObjectURL(n.url)},l=function(n){$F.each(n,f)},d=function(){o.get().each(f),o.set(w.none())},m=function(n){var t=s(n);u(t);var e=r.add(t).removed;return l(e),t.url},g=function(n){var t=s(n);return o.set(w.some(t)),t.url},p=function(n){return o.get().fold((function(){}),(function(t){m(t.blob),n()}))},v=function(){var n=r.undo();return u(n),n.url},h=function(){var n=r.redo();return u(n),n.url},b=function(){var n=r.canUndo(),t=r.canRedo();return{undoEnabled:n,redoEnabled:t}};return{getBlobState:i,setBlobState:u,addBlobState:m,getTempState:a,updateTempState:c,addTempState:g,applyTempState:p,destroyTempState:d,undo:v,redo:h,getHistoryStates:b}},mI=function(n,o){var r=dI(n.currentState),i=function(n,t){var e=t.event().direction();O.zoom(n,e)},u=function(n){var t=r.getHistoryStates();_.updateButtonUndoStates(n,t.undoEnabled,t.redoEnabled),ui(n,XF.formActionEvent,{name:XF.saveState(),value:t.undoEnabled})},a=function(n){_.updateButtonUndoStates(n,!1,!1)},c=function(n,t){var e=r.undo();m(n,e).then((function(t){d(n),u(n)}))},s=function(n,t){var e=r.redo();m(n,e).then((function(t){d(n),u(n)}))},f=function(n){return n.toBlob()},l=function(n){ui(n,XF.formActionEvent,{name:XF.disable(),value:{}})},d=function(n){T.getApplyButton(n).each((function(n){WS.enable(n)})),ui(n,XF.formActionEvent,{name:XF.enable(),value:{}})},m=function(n,t){return l(n),O.updateSrc(n,t)},g=function(n,e,o,r,i){return l(n),nM(e).then(o).then(f).then(r).then((function(t){return m(n,t).then((function(t){return u(n),i(),d(n),t}))})).catch((function(e){return t.console.log(e),d(n),e}))},p=function(n,t,e){var o=r.getBlobState().blob,i=function(n){return r.updateTempState(n)};g(n,o,t,i,e)},v=function(n,t){var o=r.getTempState().blob,i=function(n){return r.addTempState(n)};g(n,o,t,i,e)},h=function(n,t,e){var o=r.getBlobState().blob,i=function(t){var e=r.addBlobState(t);return y(n),e};g(n,o,t,i,e)},b=function(n,t){var e=function(){y(n);var e=t.event().swap();e()};r.applyTempState(e)},y=function(n){var t=r.getBlobState().url;return r.destroyTempState(),u(n),t},x=function(n){var t=y(n);m(n,t).then((function(t){d(n)}))},w=function(n,t){x(n);var e=t.event().swap();e(),O.hideCrop()},S=function(n,t){return p(n,t.event().transform(),e)},k=function(n,t){return v(n,t.event().transform())},C=function(n,t){return h(n,t.event().transform(),t.event().swap())},O=uI(n.currentState.url),_=sI(o),T=YF(O,o),E=function(n,t){a(n);var e=t.event().transform(),o=t.event().swap();e.fold((function(){o()}),(function(t){p(n,t,o)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[T.memContainer.asSpec(),O.memContainer.asSpec(),_.container],behaviours:hf([Tg.config({store:{mode:"manual",getValue:function(){return r.getBlobState()}}}),ny("image-tools-events",[pi(jF.undo(),c),pi(jF.redo(),s),pi(jF.zoom(),i),pi(jF.back(),w),pi(jF.apply(),b),pi(jF.transform(),S),pi(jF.tempTransform(),k),pi(jF.transformApply(),C),pi(jF.swap(),E)]),iA.self()])}},gI=function(n,t){var e=Y(n.options,(function(n){return{dom:{tag:"option",value:n.value,innerHtml:n.text}}})),o=n.data.map((function(n){return ct("initialValue",n)})).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Dg(n.selectBehaviours,[sy.config({}),Tg.config({store:m({mode:"manual",getValue:function(n){return za(n.element())},setValue:function(t,e){var o=tn(n.options,(function(n){return n.value===e}));o.isSome()&&Na(t.element(),e)}},o)})])}},pI=Np({name:"HtmlSelect",configFields:[pe("options"),Eg("selectBehaviours",[sy,Tg]),Ie("selectClasses",[]),Ie("selectAttributes",{}),_e("data")],factory:gI}),vI=function(n,t){var e=Y(n.items,(function(n){return{text:t.translate(n.text),value:n.value}})),o=n.label.map((function(n){return OT(n,t)})),r=z_.parts().field({dom:{},selectAttributes:{size:n.size},options:e,factory:pI,selectBehaviours:hf([WS.config({disabled:function(){return n.disabled||t.isReadOnly()}}),yT.config({}),ny("selectbox-change",[pi(Br(),(function(t,e){ui(t,O_,{name:n.name})}))])])}),i=n.size>1?w.none():w.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Ax("chevron-down",t.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:on([[r],i.toArray()])};return z_.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:on([o.toArray(),[u]]),fieldBehaviours:hf([WS.config({disabled:function(){return n.disabled||t.isReadOnly()},onDisabled:function(n){z_.getField(n).each(WS.disable)},onEnabled:function(n){z_.getField(n).each(WS.enable)}}),_k()])})},hI=function(n,t){var e=n.label.map((function(n){return OT(n,t)})),o=[WS.config({disabled:function(){return n.disabled||t.isReadOnly()}}),_k(),jb.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(n){return ii(n,B_),w.some(!0)}}),ny("textfield-change",[pi(Er(),(function(t,e){ui(t,O_,{name:n.name})})),pi(Vr(),(function(t,e){ui(t,O_,{name:n.name})}))]),yT.config({})],r=n.validation.map((function(n){return pT.config({getRoot:function(n){return Mi(n.element())},invalidClass:"tox-invalid",validator:{validate:function(t){var e=Tg.getValue(t),o=n.validator(e);return oT.pure(!0===o?O.value(e):O.error(o))},validateOnLoad:n.validateOnLoad}})})).toArray(),u=n.placeholder.fold(i({}),(function(n){return{placeholder:t.translate(n)}})),a=n.inputMode.fold(i({}),(function(n){return{inputmode:n}})),c=m(m({},u),a),s=z_.parts().field({tag:!0===n.multiline?"textarea":"input",inputAttributes:c,inputClasses:[n.classname],inputBehaviours:hf(on([o,r])),selectOnFocus:!1,factory:G_}),f=n.flex?["tox-form__group--stretched"]:[],l=f.concat(n.maximized?["tox-form-group--maximize"]:[]),d=[WS.config({disabled:function(){return n.disabled||t.isReadOnly()},onDisabled:function(n){z_.getField(n).each(WS.disable)},onEnabled:function(n){z_.getField(n).each(WS.enable)}}),_k()];return xT(e,s,l,d)},bI=function(n,t){return hI({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:w.none(),maximized:n.maximized},t)},yI=function(n,t){return hI({name:n.name,multiline:!0,label:n.label,inputMode:w.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:w.none(),maximized:n.maximized},t)},xI=function(n,t){var e=n.stream.streams,o=e.setup(n,t);return li([pi(n.event,o),_i((function(){return t.cancel()}))].concat(n.cancelEvent.map((function(n){return[pi(n,(function(){return t.cancel()}))]})).getOr([])))},wI=Object.freeze({__proto__:null,events:xI}),SI=function(n){var t=Ge(null),e=function(){return{timer:null!==t.get()?"set":"unset"}},o=function(n){t.set(n)},r=function(){var n=t.get();null!==n&&n.cancel()};return zu({readState:e,setTimer:o,cancel:r})},kI=function(n){return n.stream.streams.state(n)},CI=Object.freeze({__proto__:null,throttle:SI,init:kI}),OI=function(n,t){var e=n.stream,o=Nx(n.onStream,e.delay);return t.setTimer(o),function(n,t){o.throttle(n,t),e.stopEvent&&t.stop()}},_I=[ve("stream",ie("mode",{throttle:[pe("delay"),Ie("stopEvent",!0),Ss("streams",{setup:OI,state:SI})]})),Ie("event","input"),_e("cancelEvent"),xs("onStream")],TI=yf({fields:_I,name:"streaming",active:wI,state:CI}),EI=function(n,t,e){var o=Tg.getValue(e);Tg.setValue(t,o),DI(t)},BI=function(n,t){var e=n.element(),o=za(e),r=e.dom();"number"!==uu(e,"type")&&t(r,o)},DI=function(n){BI(n,(function(n,t){return n.setSelectionRange(t.length,t.length)}))},AI=function(n,t){BI(n,(function(n,e){return n.setSelectionRange(t,e.length)}))},MI=function(n,t,e){if(n.selectsOver){var o=Tg.getValue(t),r=n.getDisplayText(o),i=Tg.getValue(e),u=n.getDisplayText(i);return 0===u.indexOf(r)?w.some((function(){EI(n,t,e),AI(t,r.length)})):w.none()}return w.none()},FI=i("alloy.typeahead.itemexecute"),II=function(n,t,o,r){var i=function(t,o,i){n.previewing.set(!1);var u=AT.getCoupled(t,"sandbox");if(Gm.isOpen(u))Jp.getCurrent(u).each((function(n){vv.getHighlighted(n).fold((function(){i(n)}),(function(){fi(u,n.element(),"keydown",o)}))}));else{var c=function(n){Jp.getCurrent(n).each(i)};HT(n,a(t),t,u,r,c,q_.HighlightFirst).get(e)}},u=L_(n),a=function(n){return function(t){return t.map((function(t){var e=_n(t.menus),o=rn(e,(function(n){return $(n.items,(function(n){return"item"===n.type}))})),r=Tg.getState(n);return r.update(Y(o,(function(n){return n.data}))),t}))}},c=[sy.config({}),Tg.config({onSetValue:n.onSetValue,store:m({mode:"dataset",getDataKey:function(n){return za(n.element())},getFallbackEntry:function(n){return{value:n,meta:{}}},setValue:function(t,e){Na(t.element(),n.model.getDisplayText(e))}},n.initialData.map((function(n){return ct("initialValue",n)})).getOr({}))}),TI.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(t,o){var i=AT.getCoupled(t,"sandbox"),u=sy.isFocused(t);if(u&&za(t.element()).length>=n.minChars){var c=Jp.getCurrent(i).bind((function(n){return vv.getHighlighted(n).map(Tg.getValue)}));n.previewing.set(!0);var s=function(t){Jp.getCurrent(i).each((function(t){c.fold((function(){n.model.selectsOver&&vv.highlightFirst(t)}),(function(n){vv.highlightBy(t,(function(t){var e=Tg.getValue(t);return e.value===n.value})),vv.getHighlighted(t).orThunk((function(){return vv.highlightFirst(t),w.none()}))}))}))};HT(n,a(t),t,i,r,s,q_.HighlightFirst).get(e)}},cancelEvent:Ur()}),jb.config({mode:"special",onDown:function(n,t){return i(n,t,vv.highlightFirst),w.some(!0)},onEscape:function(n){var t=AT.getCoupled(n,"sandbox");return Gm.isOpen(t)?(Gm.close(t),w.some(!0)):w.none()},onUp:function(n,t){return i(n,t,vv.highlightLast),w.some(!0)},onEnter:function(t){var e=AT.getCoupled(t,"sandbox"),o=Gm.isOpen(e);if(o&&!n.previewing.get())return Jp.getCurrent(e).bind((function(n){return vv.getHighlighted(n)})).map((function(n){return ui(t,FI(),{item:n}),!0}));var r=Tg.getValue(t);return ii(t,Ur()),n.onExecute(e,t,r),o&&Gm.close(e),w.some(!0)}}),Ey.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),AT.config({others:{sandbox:function(t){return UT(n,t,{onOpen:function(){return Ey.on(t)},onClose:function(){return Ey.off(t)}})}}}),ny("typeaheadevents",[Ei((function(t){var o=e;zT(n,a(t),t,r,o,q_.HighlightFirst).get(e)})),pi(FI(),(function(t,e){var o=AT.getCoupled(t,"sandbox");EI(n.model,t,e.event().item()),ii(t,Ur()),n.onItemExecute(t,o,e.event().item(),Tg.getValue(t)),Gm.close(o),DI(t)}))].concat(n.dismissOnBlur?[pi(Rr(),(function(n){var t=AT.getCoupled(n,"sandbox");If(t.element()).isNone()&&Gm.close(t)}))]:[]))];return{uid:n.uid,dom:U_(Vn(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:m(m({},u),Dg(n.typeaheadBehaviours,c)),eventOrder:n.eventOrder}},RI=i([_e("lazySink"),pe("fetch"),Ie("minChars",5),Ie("responseTime",1e3),bs("onOpen"),Ie("getHotspot",w.some),Ie("getAnchorOverrides",i({})),Ie("layouts",w.none()),Ie("eventOrder",{}),Ue("model",{},[Ie("getDisplayText",(function(n){return void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.value})),Ie("selectsOver",!0),Ie("populateFromBrowse",!0)]),bs("onSetValue"),ys("onExecute"),bs("onItemExecute"),Ie("inputClasses",[]),Ie("inputAttributes",{}),Ie("inputStyles",{}),Ie("matchWidth",!0),Ie("useMinWidth",!1),Ie("dismissOnBlur",!0),vs(["openClass"]),_e("initialData"),Eg("typeaheadBehaviours",[sy,Tg,TI,jb,Ey,AT]),We("previewing",(function(){return Ge(!0)}))].concat(N_()).concat(GT())),VI=i([ap({schema:[ps()],name:"menu",overrides:function(n){return{fakeFocus:!0,onHighlight:function(t,e){n.previewing.get()?t.getSystem().getByUid(n.uid).each((function(o){MI(n.model,o,e).fold((function(){return vv.dehighlight(t,e)}),(function(n){return n()}))})):t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&EI(n.model,t,e)})),n.previewing.set(!1)},onExecute:function(t,e){return t.getSystem().getByUid(n.uid).toOption().map((function(n){return ui(n,FI(),{item:e}),!0}))},onHover:function(t,e){n.previewing.set(!1),t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&EI(n.model,t,e)}))}}}})]),HI=Lp({name:"Typeahead",configFields:RI(),partFields:VI(),factory:II}),PI=function(n){var e=function(){return PI(n.toCached())},o=function(t){return PI(n.bind((function(n){return n.fold((function(n){return oT.pure(O.error(n))}),(function(n){return t(n)}))})))},r=function(t){return PI(n.map((function(n){return n.bind(t)})))},i=function(t){return PI(n.map((function(n){return n.map(t)})))},u=function(t){return PI(n.map((function(n){return n.mapError(t)})))},a=function(t,e){return n.map((function(n){return n.fold(t,e)}))},c=function(e,o){return PI(oT.nu((function(r){var i=!1,u=t.setTimeout((function(){i=!0,r(O.error(o()))}),e);n.get((function(n){i||(t.clearTimeout(u),r(n))}))})))};return m(m({},n),{toCached:e,bindFuture:o,bindResult:r,mapResult:i,mapError:u,foldResult:a,withTimeout:c})},zI=function(n){return PI(oT.nu(n))},NI=function(n){return PI(oT.pure(O.value(n)))},LI=function(n){return PI(oT.pure(O.error(n)))},jI=function(n){return PI(oT.pure(n))},UI=function(n){return PI(n.map(O.value))},WI=function(n){return zI((function(t){n.then((function(n){t(O.value(n))}),(function(n){t(O.error(n))}))}))},GI={nu:zI,wrap:PI,pure:NI,value:NI,error:LI,fromResult:jI,fromFuture:UI,fromPromise:WI},XI={type:"separator"},YI=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:function(){}}},qI=function(n,t){return{type:"menuitem",value:t,text:n,meta:{attach:void 0},onAction:function(){}}},KI=function(n){return Y(n,YI)},JI=function(n,t){return $(t,(function(t){return t.type===n}))},$I=function(n,t){return KI(JI(n,t))},QI=function(n){return $I("header",n.targets)},ZI=function(n){return $I("anchor",n.targets)},nR=function(n){return w.from(n.anchorTop).map((function(n){return qI("<top>",n)})).toArray()},tR=function(n){return w.from(n.anchorBottom).map((function(n){return qI("<bottom>",n)})).toArray()},eR=function(n){return Y(n,(function(n){return qI(n,n)}))},oR=function(n){return Z(n,(function(n,t){var e=0===n.length||0===t.length;return e?n.concat(t):n.concat(XI,t)}),[])},rR=function(n,t){var e=n.toLowerCase();return $(t,(function(n){var t=void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.text;return Fo(t.toLowerCase(),e)||Fo(n.value.toLowerCase(),e)}))},iR=function(n,t,e){var o=Tg.getValue(t),r=void 0!==o.meta.text?o.meta.text:o.value,i=e.getLinkInformation();return i.fold((function(){return[]}),(function(t){var o=rR(r,eR(e.getHistory(n)));return"file"===n?oR([o,rR(r,QI(t)),rR(r,on([nR(t),ZI(t),tR(t)]))]):o}))},uR=bu("aria-invalid"),aR=function(n,t,o){var r,i=t.shared.providers,u=function(t){var e=Tg.getValue(t);o.addToHistory(e.value,n.filetype)},a=z_.parts().field({factory:HI,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":uR,type:"url"},minChars:0,responseTime:0,fetch:function(e){var r=iR(n.filetype,e,o),i=uF(r,Rk.BUBBLE_TO_SANDBOX,t,!1);return oT.pure(i)},getHotspot:function(n){return p.getOpt(n)},onSetValue:function(n,t){n.hasConfigured(pT)&&pT.run(n).get(e)},typeaheadBehaviours:hf(on([o.getValidationHandler().map((function(t){return pT.config({getRoot:function(n){return Mi(n.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(n,t){f.getOpt(n).each((function(n){ru(n.element(),"title",i.translate(t))}))}},validator:{validate:function(e){var o=Tg.getValue(e);return GI.nu((function(e){t({type:n.filetype,url:o.value},(function(n){if("invalid"===n.status){var t=O.error(n.message);e(t)}else{var o=O.value(n.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[WS.config({disabled:function(){return n.disabled||i.isReadOnly()}}),yT.config({}),ny("urlinput-events",on(["file"===n.filetype?[pi(Er(),(function(t){ui(t,O_,{name:n.name})}))]:[],[pi(Br(),(function(t){ui(t,O_,{name:n.name}),u(t)})),pi(Vr(),(function(t){ui(t,O_,{name:n.name}),u(t)}))]]))]])),eventOrder:(r={},r[Er()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(n){return n.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:cO(!1,1,"normal")},onExecute:function(n,t,e){ui(t,B_,{})},onItemExecute:function(t,e,o,r){u(t),ui(t,O_,{name:n.name})}}),c=n.label.map((function(n){return OT(n,i)})),s=function(n,t,e,o){return void 0===e&&(e=n),void 0===o&&(o=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:Ax(e,i.icons),attributes:m({title:i.translate(o),"aria-live":"polite"},t.fold((function(){return{}}),(function(n){return{id:n}})))}}},f=Bx(s("invalid",w.some(uR),"warning")),l=Bx({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),d=o.getUrlPicker(n.filetype),g=bu("browser.url.event"),p=Bx({dom:{tag:"div",classes:["tox-control-wrap"]},components:[a,l.asSpec()],behaviours:hf([WS.config({disabled:function(){return n.disabled||i.isReadOnly()}})])}),v=Bx(gF({name:n.name,icon:w.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(n){return ii(n,g)}),i,[],["tox-browse-url"])),h=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:on([[p.asSpec()],d.map((function(){return v.asSpec()})).toArray()])}},b=function(t){Jp.getCurrent(t).each((function(e){var o=Tg.getValue(e),r=m({fieldname:n.name},o);d.each((function(o){o(r).get((function(o){Tg.setValue(e,o),ui(t,O_,{name:n.name})}))}))}))};return z_.sketch({dom:kT(),components:c.toArray().concat([h()]),fieldBehaviours:hf([WS.config({disabled:function(){return n.disabled||i.isReadOnly()},onDisabled:function(n){z_.getField(n).each(WS.disable),v.getOpt(n).each(WS.disable)},onEnabled:function(n){z_.getField(n).each(WS.enable),v.getOpt(n).each(WS.enable)}}),_k(),ny("url-input-events",[pi(g,b)])])})},cR=function(n,t){var e=Tg.config({store:{mode:"manual",getValue:function(n){var t=n.element().dom();return t.checked},setValue:function(n,t){var e=n.element().dom();e.checked=t}}}),o=function(n){return n.element().dom().click(),w.some(!0)},r=z_.parts().field({factory:{sketch:u},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:hf([iA.self(),WS.config({disabled:function(){return n.disabled||t.isReadOnly()}}),yT.config({}),sy.config({}),e,jb.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),ny("checkbox-events",[pi(Br(),(function(t,e){ui(t,O_,{name:n.name})}))])])}),i=z_.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(n.label)},behaviours:hf([ZT.config({})])}),a=function(n){var e="checked"===n?"selected":"unselected";return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+n],innerHtml:Ax(e,t.icons)}}},c=Bx({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return z_.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,c.asSpec(),i],fieldBehaviours:hf([WS.config({disabled:function(){return n.disabled||t.isReadOnly()},disableClass:"tox-checkbox--disabled",onDisabled:function(n){z_.getField(n).each(WS.disable)},onEnabled:function(n){z_.getField(n).each(WS.enable)}}),_k()])})},sR=function(n){return"presentation"===n.presets?k_.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html}}):k_.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html,attributes:{role:"document"}},containerBehaviours:hf([yT.config({}),sy.config({})])})},fR=function(n,t){var e={dom:{tag:"label",innerHtml:t.providers.translate(n.label),classes:["tox-label"]}},o=Y(n.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:hf([iA.self(),Qb.config({}),xA.domHtml(w.none()),jb.config({mode:"acyclic"})])}},lR=function(n,t){var e=n.label.map((function(n){return OT(n,t)})),o=function(n){return function(t,e){Kc(e.event().target(),"[data-collection-item-value]").each((function(o){n(t,e,o,uu(o,"data-collection-item-value"))}))}},r=function(n){return'"'===n?"&quot;":n},i=function(e,o){var i=Y(o,(function(e){var o=Jw.translate(e.text),i=1===n.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",u='<div class="tox-collection__item-icon">'+e.icon+"</div>",a={_:" "," - ":" ","-":" "},c=o.replace(/\_| \- |\-/g,(function(n){return a[n]})),s=t.isReadOnly()?" tox-collection__item--state-disabled":"";return'<div class="tox-collection__item'+s+'" tabindex="-1" data-collection-item-value="'+r(e.value)+'" title="'+c+'" aria-label="'+c+'">'+u+i+"</div>"})),u=n.columns>1&&"auto"!==n.columns?X(i,n.columns):[i],a=Y(u,(function(n){return'<div class="tox-collection__group">'+n.join("")+"</div>"}));Ji(e.element(),a.join(""))},a=o((function(e,o,r,i){o.stop(),t.isReadOnly()||ui(e,E_,{name:n.name,value:i})})),c=[pi(kr(),o((function(n,t,e){Df(e)}))),pi(Dr(),a),pi(Nr(),a),pi(Cr(),o((function(n,t,e){qc(n.element(),"."+cS).each((function(n){ya(n,cS)})),ha(e,cS)}))),pi(Or(),o((function(n){qc(n.element(),"."+cS).each((function(n){ya(n,cS)}))}))),Ei(o((function(t,e,o,r){ui(t,E_,{name:n.name,value:r})})))],s=function(n,t){return Y(pd(n.element(),".tox-collection__item"),t)},f=z_.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==n.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:u},behaviours:hf([WS.config({disabled:t.isReadOnly,onDisabled:function(n){s(n,(function(n){ha(n,"tox-collection__item--state-disabled"),ru(n,"aria-disabled",!0)}))},onEnabled:function(n){s(n,(function(n){ya(n,"tox-collection__item--state-disabled"),su(n,"aria-disabled")}))}}),_k(),Qb.config({}),Tg.config({store:{mode:"memory",initialValue:[]},onSetValue:function(t,e){i(t,e),"auto"===n.columns&&Iw(t,5,"tox-collection__item").each((function(n){var e=n.numRows,o=n.numColumns;jb.setGridSize(t,e,o)})),ii(t,F_)}}),yT.config({}),jb.config(SO(n.columns,"normal")),ny("collection-events",c)]),eventOrder:{"alloy.execute":["disabling","alloy.base.behaviour","collection-events"]}}),l=["tox-form__group--collection"];return xT(e,f,l,[])},dR=function(n,t){var e=function(n){return{dom:{tag:"th",innerHtml:t.translate(n)}}},o=function(n){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:Y(n,e)}]}},r=function(n){return{dom:{tag:"td",innerHtml:t.translate(n)}}},i=function(n){return{dom:{tag:"tr"},components:Y(n,r)}},u=function(n){return{dom:{tag:"tbody"},components:Y(n,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[o(n.header),u(n.cells)],behaviours:hf([yT.config({}),sy.config({})])}},mR=function(n,t){return{dom:{tag:"div",classes:n.classes},components:Y(n.items,t.shared.interpreter)}},gR=function(n){return function(t,e,o){return Tn(e,"name").fold((function(){return n(e,o)}),(function(r){return t.field(r,n(e,o))}))}},pR=function(n){return function(t,e,o){var r=Vn(e,{source:"dynamic"});return gR(n)(t,r,o)}},vR={bar:gR((function(n,t){return R_(n,t.shared)})),collection:gR((function(n,t){return lR(n,t.shared.providers)})),alertbanner:gR((function(n,t){return I_(n,t.shared.providers)})),input:gR((function(n,t){return bI(n,t.shared.providers)})),textarea:gR((function(n,t){return yI(n,t.shared.providers)})),label:gR((function(n,t){return fR(n,t.shared)})),iframe:pR((function(n,t){return IA(n,t.shared.providers)})),button:gR((function(n,t){return yF(n,t.shared.providers)})),checkbox:gR((function(n,t){return cR(n,t.shared.providers)})),colorinput:gR((function(n,t){return rE(n,t.shared,t.colorinput)})),colorpicker:gR(sA),dropzone:gR((function(n,t){return kA(n,t.shared.providers)})),grid:gR((function(n,t){return CA(n,t.shared)})),selectbox:gR((function(n,t){return vI(n,t.shared.providers)})),sizeinput:gR((function(n,t){return MF(n,t.shared.providers)})),urlinput:gR((function(n,t){return aR(n,t,t.urlinput)})),customeditor:gR(dA),htmlpanel:gR(sR),imagetools:gR((function(n,t){return mI(n,t.shared.providers)})),table:gR((function(n,t){return dR(n,t.shared.providers)})),panel:gR((function(n,t){return mR(n,t)}))},hR={field:function(n,t){return t}},bR=function(n,t,e){var o=Vn(e,{shared:{interpreter:function(t){return yR(n,t,o)}}});return yR(n,t,o)},yR=function(n,e,o){return Tn(vR,e.type).fold((function(){return t.console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e}),(function(t){return t(n,e,o)}))},xR=function(n,t){var e=hR;return yR(e,n,t)},wR={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},SR=function(n,t,e){var o=gl(-12,12,wR),r={maxHeightFunction:sl()},i=function(){return{anchor:"node",root:_a(Bi(n())),node:w.from(n()),bubble:o,layouts:{onRtl:function(){return[kx]},onLtr:function(){return[Sx]}},overrides:r}},u=function(){return{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[Ks]},onLtr:function(){return[Js]}},overrides:r}};return function(){return e()?i():u()}},kR=function(n,t,e){var o=function(){return{anchor:"node",root:_a(Bi(n())),node:w.from(n()),layouts:{onRtl:function(){return[Cx]},onLtr:function(){return[Cx]}}}},r=function(){return{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[nf]},onLtr:function(){return[nf]}}}};return function(){return e()?o():r()}},CR=function(n,t){return function(){return{anchor:"selection",root:t(),getSelection:function(){var t=n.selection.getRng();return w.some(Xl.range($e.fromDom(t.startContainer),t.startOffset,$e.fromDom(t.endContainer),t.endOffset))}}}},OR=function(n){return function(t){return{anchor:"node",root:n(),node:t}}},_R=function(n,t,e){var o=hk(n),r=function(){return $e.fromDom(n.getBody())},i=function(){return $e.fromDom(n.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:SR(i,t,u),banner:kR(i,t,u),cursor:CR(n,r),node:OR(r)}},TR=function(n){return function(t,e){var o=tO(n);o(t,e)}},ER=function(n){return function(){return AC(n)}},BR=function(n){return function(){return FC(n)}},DR=function(n){return function(){return YC(n)}},AR=function(n){return{colorPicker:TR(n),hasCustomColors:ER(n),getColors:BR(n),getColorCols:DR(n)}},MR=function(n){return function(){return wk(n)}},FR=function(n){return{isDraggableModal:MR(n)}},IR=function(n){var t=Ge(gk(n)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===t.get()},getDockingMode:t.get,setDockingMode:t.set}},RR=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],VR=function(n){return En(n,"items")},HR=function(n){return En(n,"block")},PR=function(n){return En(n,"inline")},zR=function(n){return En(n,"selector")},NR=function(n){return Z(n,(function(n,t){if(VR(t)){var e=NR(t.items);return{customFormats:n.customFormats.concat(e.customFormats),formats:n.formats.concat([{title:t.title,items:e.formats}])}}if(PR(t)||HR(t)||zR(t)){var o="custom-"+t.title.toLowerCase();return{customFormats:n.customFormats.concat([{name:o,format:t}]),formats:n.formats.concat([{title:t.title,format:o,icon:t.icon}])}}return m(m({},n),{formats:n.formats.concat(t)})}),{customFormats:[],formats:[]})},LR=function(n,t){var e=NR(t),o=function(t){q(t,(function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)}))};return n.formatter?o(e.customFormats):n.on("init",(function(){o(e.customFormats)})),e.formats},jR=function(n){return ek(n).map((function(t){var e=LR(n,t);return ok(n)?RR.concat(e):e})).getOr(RR)},UR=function(n,t,e){var o={type:"formatter",isSelected:t(n.format),getStylePreview:e(n.format)};return Vn(n,o)},WR=function(n,t,e,o){var r=function(n){return UR(n,e,o)},i=function(n){var t={type:"submenu"};return Vn(n,t)},u=function(t){var r=bu(t.title),i={type:"formatter",format:r,isSelected:e(r),getStylePreview:o(r)},u=Vn(t,i);return n.formatter.register(r,u),u},a=function(n){return Y(n,(function(n){var t=vn(n);if(Bn(n,"items")){var e=a(n.items);return Vn(i(n),{getStyleItems:function(){return e}})}return Bn(n,"format")?r(n):1===t.length&&U(t,"title")?Vn(n,{type:"separator"}):u(n)}))};return a(t)},GR=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?w.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):w.none()}},o=function(n){var t=n.items;return void 0!==t&&t.length>0?rn(t,o):[n.format]},r=Ge([]),i=Ge([]),u=Ge([]),a=Ge([]),c=Ge(!1);n.on("PreInit",(function(u){var a=jR(n),c=WR(n,a,t,e);r.set(c),i.set(rn(c,o))})),n.on("addStyleModifications",(function(r){var i=WR(n,r.items,t,e);u.set(i),c.set(r.replace),a.set(rn(i,o))}));var s=function(){var n=c.get()?[]:r.get(),t=u.get();return n.concat(t)},f=function(){var n=c.get()?[]:i.get(),t=a.get();return n.concat(t)};return{getData:s,getFlattenedKeys:f}},XR=$F.trim,YR=function(n){return function(t){if(t&&1===t.nodeType){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},qR=YR("true"),KR=YR("false"),JR=function(n,t,e,o,r){return{type:n,title:t,url:e,level:o,attach:r}},$R=function(n){while(n=n.parentNode){var t=n.contentEditable;if(t&&"inherit"!==t)return qR(n)}return!1},QR=function(n,t){return Y(pd($e.fromDom(t),n),(function(n){return n.dom()}))},ZR=function(n){return n.innerText||n.textContent},nV=function(n){return n.id?n.id:bu("h")},tV=function(n){return n&&"A"===n.nodeName&&void 0!==(n.id||n.name)},eV=function(n){return tV(n)&&rV(n)},oV=function(n){return n&&/^(H[1-6])$/.test(n.nodeName)},rV=function(n){return $R(n)&&!KR(n)},iV=function(n){return oV(n)&&rV(n)},uV=function(n){return oV(n)?parseInt(n.nodeName.substr(1),10):0},aV=function(n){var t=nV(n),e=function(){n.id=t};return JR("header",ZR(n),"#"+t,uV(n),e)},cV=function(n){var t=n.id||n.name,o=ZR(n);return JR("anchor",o||"#"+t,"#"+t,0,e)},sV=function(n){return Y($(n,iV),aV)},fV=function(n){return Y($(n,eV),cV)},lV=function(n){var t=QR("h1,h2,h3,h4,h5,h6,a:not([href])",n);return t},dV=function(n){return XR(n.title).length>0},mV=function(n){var t=lV(n);return $(sV(t).concat(fV(t)),dV)},gV={find:mV},pV="tinymce-url-history",vV=5,hV=function(n){return D(n)&&/^https?/.test(n)},bV=function(n){return M(n)&&n.length<=vV&&un(n,hV)},yV=function(n){return A(n)&&On(n,(function(n){return!bV(n)})).isNone()},xV=function(){var n,e=kC.getItem(pV);if(null===e)return{};try{n=JSON.parse(e)}catch(o){if(o instanceof SyntaxError)return t.console.log("Local storage "+pV+" was not valid JSON",o),{};throw o}return yV(n)?n:(t.console.log("Local storage "+pV+" was not valid format",n),{})},wV=function(n){if(!yV(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));kC.setItem(pV,JSON.stringify(n))},SV=function(n){var t=xV();return Object.prototype.hasOwnProperty.call(t,n)?t[n]:[]},kV=function(n,t){if(hV(n)){var e=xV(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=$(o,(function(t){return t!==n}));e[t]=[n].concat(r).slice(0,vV),wV(e)}},CV=Object.prototype.hasOwnProperty,OV=function(n){return!!n},_V=function(n){return yn($F.makeMap(n,/[, ]/),OV)},TV=function(n,t){return CV.call(n,t)?w.some(n[t]):w.none()},EV=function(n,t,e){var o=TV(n,t).getOr(e);return D(o)?w.some(o):w.none()},BV=function(n){return w.some(n.file_picker_callback).filter(R)},DV=function(n){var t=w.some(n.file_picker_types).filter(OV),e=w.some(n.file_browser_callback_types).filter(OV),o=t.or(e).map(_V);return BV(n).fold((function(){return!1}),(function(n){return o.fold((function(){return!0}),(function(n){return vn(n).length>0&&n}))}))},AV=function(n,t){var e=DV(n);return F(e)?e?BV(n):w.none():e[t]?BV(n):w.none()},MV=function(n,t){return AV(n.settings,t).map((function(e){return function(o){return oT.nu((function(r){var i=function(n,t){if(!D(n))throw new Error("Expected value to be string");if(void 0!==t&&!A(t))throw new Error("Expected meta to be a object");var e={value:n,meta:t};r(e)},u=m({filetype:t,fieldname:o.fieldname},w.from(o.meta).getOr({}));e.call(n,i,o.value,u)}))}}))},FV=function(n){return!1===n.settings.typeahead_urls?w.none():w.some({targets:gV.find(n.getBody()),anchorTop:EV(n.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:EV(n.settings,"anchor_bottom","#bottom").getOrUndefined()})},IV=function(n){var t=w.from(n.settings.file_picker_validator_handler).filter(R);return t.orThunk((function(){return w.from(n.settings.filepicker_validator_handler).filter(R)}))},RV=function(n){return{getHistory:SV,addToHistory:kV,getLinkInformation:function(){return FV(n)},getValidationHandler:function(){return IV(n)},getUrlPicker:function(t){return MV(n,t)}}},VV=function(n,t,e){var o=Ge(!1),r=IR(t),i={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:Jw.translate,isReadOnly:function(){return t.mode.isReadOnly()}},interpreter:function(n){return xR(n,i)},anchors:_R(t,e,r.isPositionedAtTop),header:r,getSink:function(){return O.value(n)}},urlinput:RV(t),styleselect:GR(t),colorinput:AR(t),dialog:FR(t),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(n){return o.set(n)}};return i},HV=i((function(n,t){vc(n,Math.floor(t))})),PV="contexttoolbar-show",zV="contexttoolbar-hide",NV=i([pe("items"),vs(["itemSelector"]),Eg("tgroupBehaviours",[jb])]),LV=i([sp({name:"items",unit:"item"})]),jV=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Dg(n.tgroupBehaviours,[jb.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},UV=Lp({name:"ToolbarGroup",configFields:NV(),partFields:LV(),factory:jV}),WV=i([pe("dom"),Ie("shell",!0),Eg("toolbarBehaviours",[Qb])]),GV=function(){return{behaviours:hf([Qb.config({})])}},XV=i([cp({name:"groups",overrides:GV})]),YV=function(n,e,o,r){var i=function(n,e){u(n).fold((function(){throw t.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){Qb.set(n,e)}))},u=function(t){return n.shell?w.some(t):wp(t,n,"groups")},a=n.shell?{behaviours:[Qb.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:a.components,behaviours:Dg(n.toolbarBehaviours,a.behaviours),apis:{setGroups:i},domModification:{attributes:{role:"group"}}}},qV=Lp({name:"Toolbar",configFields:WV(),partFields:XV(),factory:YV,apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),KV=function(n,t){var e={len:0,list:[]},o=Z(n,(function(n,e){var o=t(e,n.len);return o.fold(i(n),(function(t){return{len:t.finish(),list:n.list.concat([t])}}))}),e);return o.list},JV=function(n,t,e){return{within:i(n),extra:i(t),withinWidth:i(e)}},$V=function(n,t,e){var o=KV(n,(function(n,t){var o=e(n);return w.some({element:i(n),start:i(t),finish:i(t+o),width:i(o)})})),r=$(o,(function(n){return n.finish()<=t})),u=Q(r,(function(n,t){return n+t.width()}),0),a=o.slice(r.length);return{within:i(r),extra:i(a),withinWidth:i(u)}},QV=function(n){return Y(n,(function(n){return n.element()}))},ZV=function(n,t,e){var o=QV(n.concat(t));return JV(o,[],e)},nH=function(n,t,e,o){var r=QV(n).concat([e]);return JV(r,QV(t),o)},tH=function(n,t,e){return JV(QV(n),[],e)},eH=function(n,t,e){var o=$V(t,n,e);return 0===o.extra().length?w.some(o):w.none()},oH=function(n,t,e,o){var r=eH(n,t,e).getOrThunk((function(){return $V(t,n-e(o),e)})),i=r.within(),u=r.extra(),a=r.withinWidth();return 1===u.length&&u[0].width()<=e(o)?ZV(i,u,a):u.length>=1?nH(i,u,o,a):tH(i,u,a)},rH=function(n,t){var e=Y(t,(function(n){return nc(n)}));qV.setGroups(n,e)},iH=function(n){return pn(n,(function(n){return If(n.element()).bind((function(t){return n.getSystem().getByDom(t).toOption()}))}))},uH=function(n,t,e){var o=Sp(n,t,"primary"),r=AT.getCoupled(n,"overflowGroup");Ba(o.element(),"visibility","hidden");var i=t.builtGroups.get().concat([r]),u=iH(i);e([]),rH(o,i);var a=gc(o.element()),c=oH(a,t.builtGroups.get(),(function(n){return gc(n.element())}),r);0===c.extra().length?(Qb.remove(o,r),e([])):(rH(o,c.within()),e(c.extra())),Ha(o.element(),"visibility"),Pa(o.element()),u.each(sy.focus)},aH=i([Eg("splitToolbarBehaviours",[AT]),We("builtGroups",(function(){return Ge([])}))]),cH=i([vs(["overflowToggledClass"]),De("getOverflowBounds"),pe("lazySink"),We("overflowGroups",(function(){return Ge([])}))].concat(aH())),sH=i([up({factory:qV,schema:WV(),name:"primary"}),ap({schema:WV(),name:"overflow"}),ap({name:"overflow-button"}),ap({name:"overflow-group"})]),fH=i([vs(["toggledClass"]),pe("lazySink"),we("fetch"),De("getBounds"),Me("fireDismissalEventInstead",[Ie("event",$r())]),wl()]),lH=i([ap({name:"button",overrides:function(n){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:hf([Ey.config({toggleClass:n.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),ap({factory:qV,schema:WV(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:hf([jb.config({mode:"cyclic",onEscape:function(t){return wp(t,n,"button").each(sy.focus),w.none()}})])}}})]),dH=function(n,t){var e=AT.getCoupled(n,"toolbarSandbox");Gm.isOpen(e)?Gm.close(e):Gm.open(e,t.toolbar())},mH=function(n,t,e,o){var r=e.getBounds.map((function(n){return n()})),i=e.lazySink(n).getOrDie();lm.positionWithinBounds(i,{anchor:"hotspot",hotspot:n,layouts:o,overrides:{maxWidthFunction:HV()}},t,r)},gH=function(n,t,e,o,r){qV.setGroups(t,r),mH(n,t,e,o),Ey.on(n)},pH=function(n,t,e){var o=$c(),r=function(r,i){e.fetch().get((function(r){gH(n,i,e,t.layouts,r),o.link(n.element()),jb.focusIn(i)}))},i=function(){Ey.off(n),sy.focus(n),o.unlink(n.element())};return{dom:{tag:"div",attributes:{id:o.id}},behaviours:hf([jb.config({mode:"special",onEscape:function(n){return Gm.close(n),w.some(!0)}}),Gm.config({onOpen:r,onClose:i,isPartOf:function(t,e,o){return Zc(e,o)||Zc(n,o)},getAttachPoint:function(){return e.lazySink(n).getOrDie()}}),Tf.config({channels:m(m({},Jm(m({isExtraPart:f},e.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),Qm({doReposition:function(){Gm.getState(AT.getCoupled(n,"toolbarSandbox")).each((function(o){mH(n,o,e,t.layouts)}))}}))})])}},vH=function(n,t,e,o){return m(m({},Ex.sketch(m(m({},o.button()),{action:function(n){dH(n,o)},buttonBehaviours:Ag.augment({dump:o.button().buttonBehaviours},[AT.config({others:{toolbarSandbox:function(t){return pH(t,e,n)}}})])}))),{apis:{setGroups:function(t,o){Gm.getState(AT.getCoupled(t,"toolbarSandbox")).each((function(r){gH(t,r,n,e.layouts,o)}))},reposition:function(t){Gm.getState(AT.getCoupled(t,"toolbarSandbox")).each((function(o){mH(t,o,n,e.layouts)}))},toggle:function(n){dH(n,o)},getToolbar:function(n){return Gm.getState(AT.getCoupled(n,"toolbarSandbox"))}}})},hH=Lp({name:"FloatingToolbarButton",factory:vH,configFields:fH(),partFields:lH(),apis:{setGroups:function(n,t,e){n.setGroups(t,e)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getToolbar:function(n,t){return n.getToolbar(t)}}}),bH=function(n){return Y(n,(function(n){return nc(n)}))},yH=function(n,t,e){uH(n,e,(function(o){e.overflowGroups.set(o),t.getOpt(n).each((function(n){hH.setGroups(n,bH(o))}))}))},xH=function(n,t,e,o){var r=Bx(hH.sketch({fetch:function(){return oT.nu((function(t){t(bH(n.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Js,Ks]},onRtl:function(){return[Ks,Js]},onBottomLtr:function(){return[Qs,$s]},onBottomRtl:function(){return[$s,Qs]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:n.uid,dom:n.dom,components:t,behaviours:Dg(n.splitToolbarBehaviours,[AT.config({others:{overflowGroup:function(){return UV.sketch(m(m({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(Y(e,t.getSystem().build)),yH(t,r,n)},refresh:function(t){return yH(t,r,n)},toggle:function(n){r.getOpt(n).each((function(n){hH.toggle(n)}))},reposition:function(n){r.getOpt(n).each((function(n){hH.reposition(n)}))},getOverflow:function(n){return r.getOpt(n).bind((function(n){return hH.getToolbar(n)}))}},domModification:{attributes:{role:"group"}}}},wH=Lp({name:"SplitFloatingToolbar",configFields:cH(),partFields:sH(),factory:xH,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getOverflow:function(n,t){return n.getOverflow(t)}}}),SH=function(n,t){return t.getAnimationRoot.fold((function(){return n.element()}),(function(t){return t(n)}))},kH=function(n){return n.dimension.property},CH=function(n,t){return n.dimension.getDimension(t)},OH=function(n,t){var e=SH(n,t);Sa(e,[t.shrinkingClass,t.growingClass])},_H=function(n,t){ya(n.element(),t.openClass),ha(n.element(),t.closedClass),Ba(n.element(),kH(t),"0px"),Pa(n.element())},TH=function(n,t){ya(n.element(),t.closedClass),ha(n.element(),t.openClass),Ha(n.element(),kH(t))},EH=function(n,t,e,o){e.setCollapsed(),Ba(n.element(),kH(t),CH(t,n.element())),Pa(n.element()),OH(n,t),_H(n,t),t.onStartShrink(n),t.onShrunk(n)},BH=function(n,t,e,o){var r=o.getOrThunk((function(){return CH(t,n.element())}));e.setCollapsed(),Ba(n.element(),kH(t),r),Pa(n.element());var i=SH(n,t);ya(i,t.growingClass),ha(i,t.shrinkingClass),_H(n,t),t.onStartShrink(n)},DH=function(n,t,e){var o=CH(t,n.element()),r="0px"===o?EH:BH;r(n,t,e,w.some(o))},AH=function(n,t,e){var o=SH(n,t),r=xa(o,t.shrinkingClass),i=CH(t,n.element());TH(n,t);var u=CH(t,n.element()),a=function(){Ba(n.element(),kH(t),i),Pa(n.element())},c=function(){_H(n,t)},s=r?a:c;s(),ya(o,t.shrinkingClass),ha(o,t.growingClass),TH(n,t),Ba(n.element(),kH(t),u),e.setExpanded(),t.onStartGrow(n)},MH=function(n,t,e){if(e.isExpanded()){Ha(n.element(),kH(t));var o=CH(t,n.element());Ba(n.element(),kH(t),o)}},FH=function(n,t,e){e.isExpanded()||AH(n,t,e)},IH=function(n,t,e){e.isExpanded()&&DH(n,t,e)},RH=function(n,t,e){e.isExpanded()&&EH(n,t,e,w.none())},VH=function(n,t,e){return e.isExpanded()},HH=function(n,t,e){return e.isCollapsed()},PH=function(n,t,e){var o=SH(n,t);return!0===xa(o,t.growingClass)},zH=function(n,t,e){var o=SH(n,t);return!0===xa(o,t.shrinkingClass)},NH=function(n,t,e){return!0===PH(n,t)||!0===zH(n,t)},LH=function(n,t,e){var o=e.isExpanded()?DH:AH;o(n,t,e)},jH=Object.freeze({__proto__:null,refresh:MH,grow:FH,shrink:IH,immediateShrink:RH,hasGrown:VH,hasShrunk:HH,isGrowing:PH,isShrinking:zH,isTransitioning:NH,toggleGrow:LH,disableTransitions:OH}),UH=function(n,t,e){var o=t.expanded;return Wu(o?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:ct(t.dimension.property,"0px")})},WH=function(n,t){return li([Ci(Ar(),(function(e,o){var r=o.event().raw();if(r.propertyName===n.dimension.property){OH(e,n),t.isExpanded()&&Ha(e.element(),n.dimension.property);var i=t.isExpanded()?n.onGrown:n.onShrunk;i(e)}}))])},GH=Object.freeze({__proto__:null,exhibit:UH,events:WH}),XH=[pe("closedClass"),pe("openClass"),pe("shrinkingClass"),pe("growingClass"),_e("getAnimationRoot"),bs("onShrunk"),bs("onStartShrink"),bs("onGrown"),bs("onStartGrow"),Ie("expanded",!1),ve("dimension",ie("property",{width:[Ss("property","width"),Ss("getDimension",(function(n){return gc(n)+"px"}))],height:[Ss("property","height"),Ss("getDimension",(function(n){return oc(n)+"px"}))]}))],YH=function(n){var t=Ge(n.expanded),e=function(){return"expanded: "+t.get()};return zu({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:a(t.set,!1),setExpanded:a(t.set,!0),readState:e})},qH=Object.freeze({__proto__:null,init:YH}),KH=yf({fields:XH,name:"sliding",active:GH,apis:jH,state:qH}),JH=i([vs(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),bs("onOpened"),bs("onClosed")].concat(aH())),$H=i([up({factory:qV,schema:WV(),name:"primary"}),up({factory:qV,schema:WV(),name:"overflow",overrides:function(n){return{toolbarBehaviours:hf([KH.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){wp(t,n,"overflow-button").each((function(n){Ey.off(n),sy.focus(n)})),n.onClosed(t)},onGrown:function(t){jb.focusIn(t),n.onOpened(t)},onStartGrow:function(t){wp(t,n,"overflow-button").each(Ey.on)}}),jb.config({mode:"acyclic",onEscape:function(t){return wp(t,n,"overflow-button").each(sy.focus),w.some(!0)}})])}}}),ap({name:"overflow-button",overrides:function(n){return{buttonBehaviours:hf([Ey.config({toggleClass:n.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),ap({name:"overflow-group"})]),QH=function(n,t){wp(n,t,"overflow").each((function(e){ZH(n,t),KH.toggleGrow(e)}))},ZH=function(n,t){wp(n,t,"overflow").each((function(e){uH(n,t,(function(n){var t=Y(n,(function(n){return nc(n)}));qV.setGroups(e,t)})),wp(n,t,"overflow-button").each((function(n){KH.hasGrown(e)&&Ey.on(n)})),KH.refresh(e)}))},nP=function(n,t,e,o){var r="alloy.toolbar.toggle",i=function(t,e){var o=Y(e,t.getSystem().build);n.builtGroups.set(o)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Dg(n.splitToolbarBehaviours,[AT.config({others:{overflowGroup:function(n){return UV.sketch(m(m({},o["overflow-group"]()),{items:[Ex.sketch(m(m({},o["overflow-button"]()),{action:function(t){ii(n,r)}}))]}))}}}),ny("toolbar-toggle-events",[pi(r,(function(t){wp(t,n,"overflow").each((function(e){ZH(t,n),KH.toggleGrow(e)}))}))])]),apis:{setGroups:function(t,e){i(t,e),ZH(t,n)},refresh:function(t){return ZH(t,n)},toggle:function(t){return QH(t,n)}},domModification:{attributes:{role:"group"}}}},tP=Lp({name:"SplitSlidingToolbar",configFields:JH(),partFields:$H(),factory:nP,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},toggle:function(n,t){n.toggle(t)}}}),eP=i(bu("toolbar-height-change")),oP=function(n){var t=n.title.fold((function(){return{}}),(function(n){return{attributes:{title:n}}}));return{dom:m({tag:"div",classes:["tox-toolbar__group"]},t),components:[UV.parts().items({})],items:n.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:hf([yT.config({}),sy.config({})])}},rP=function(n){return UV.sketch(oP(n))},iP=function(n,t){var e=Oi((function(t){var e=Y(n.initGroups,rP);qV.setGroups(t,e)}));return hf([Ak.toolbarButton(n.providers.isReadOnly),_k(),jb.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),ny("toolbar-events",[e])])},uP=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return{uid:n.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":oP({title:w.none(),items:[]}),"overflow-button":lF({name:"more",icon:w.some("more-drawer"),disabled:!1,tooltip:w.some("More..."),primary:!1,borderless:!1},w.none(),n.providers)},splitToolbarBehaviours:iP(n,t)}},aP=function(n){var t=uP(n),e=4,o=wH.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return wH.sketch(m(m({},t),{lazySink:n.getSink,getOverflowBounds:function(){var t=n.moreDrawerData.lazyHeader().element(),o=zc(t),r=Di(t),i=zc(r),u=Math.max(r.dom().scrollHeight,i.height);return Hc(o.x+e,i.y,o.width-2*e,u)},parts:m(m({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}}),components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},cP=function(n){var t=tP.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=tP.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=uP(n);return tP.sketch(m(m({},o),{components:[t,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(n){n.getSystem().broadcastOn([eP()],{type:"opened"})},onClosed:function(n){n.getSystem().broadcastOn([eP()],{type:"closed"})}}))},sP=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return qV.sketch({uid:n.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(n.type===Px.scrolling?["tox-toolbar--scrolling"]:[])},components:[qV.parts().groups({})],toolbarBehaviours:iP(n,t)})},fP=[ze("disabled",!1),Be("tooltip"),Be("icon"),Be("text"),Ne("onSetup",(function(){return e}))],lP=Ht([be("type"),we("onAction")].concat(fP)),dP=function(n){return ne("toolbarbutton",lP,n)},mP=[Be("text"),Be("tooltip"),Be("icon"),we("fetch"),Ne("onSetup",(function(){return e}))],gP=Ht(p([be("type")],mP)),pP=function(n){return ne("menubutton",gP,n)},vP=Ht([be("type"),Be("tooltip"),Be("icon"),Be("text"),De("select"),we("fetch"),Ne("onSetup",(function(){return e})),Pe("presets","normal",["normal","color","listpreview"]),Ie("columns",1),we("onAction"),we("onItemAction")]),hP=function(n){return ne("SplitButton",vP,n)},bP=[ze("active",!1)].concat(fP),yP=Ht(bP.concat([be("type"),we("onAction")])),xP=function(n){return ne("ToggleButton",yP,n)},wP=Ht([be("type"),ve("items",zt([qt([be("name"),Oe("items",se)]),se]))].concat(fP)),SP=function(n){return ne("GroupToolbarButton",wP,n)},kP=[Ne("predicate",(function(){return!1})),Pe("scope","node",["node","editor"]),Pe("position","selection",["node","selection","line"])],CP=fP.concat([Ie("type","contextformbutton"),Ie("primary",!1),we("onAction"),We("original",u)]),OP=bP.concat([Ie("type","contextformbutton"),Ie("primary",!1),we("onAction"),We("original",u)]),_P=fP.concat([Ie("type","contextformbutton")]),TP=bP.concat([Ie("type","contextformtogglebutton")]),EP=ie("type",{contextformbutton:CP,contextformtogglebutton:OP}),BP=Ht([Ie("type","contextform"),Ne("initValue",(function(){return""})),Be("label"),Oe("commands",EP),Te("launch",ie("type",{contextformbutton:_P,contextformtogglebutton:TP}))].concat(kP)),DP=Ht([Ie("type","contexttoolbar"),be("items")].concat(kP)),AP=function(n){return ne("ContextToolbar",DP,n)},MP=function(n){return ne("ContextForm",BP,n)},FP=function(n,t,e){return e},IP=Object.freeze({__proto__:null,getState:FP}),RP=function(n,t){var e=function(e,o){n.updateState.each((function(n){var r=n(e,o);t.set(r)})),n.renderComponents.each((function(n){var r=n(o,t.get()),i=Y(r,e.getSystem().build);vm(e,i)}))};return li([pi(Hr(),(function(t,o){var r=o,i=n.channel;U(r.channels(),i)&&e(t,r.data())})),Oi((function(t,o){n.initialData.each((function(n){e(t,n)}))}))])},VP=Object.freeze({__proto__:null,events:RP}),HP=function(){var n=Ge(w.none()),t=function(t){return n.set(t)},e=function(){return n.set(w.none())},o=function(){return n.get()},r=function(){return n.get().fold((function(){return"none"}),(function(n){return n}))};return{readState:r,get:o,set:t,clear:e}},PP=Object.freeze({__proto__:null,init:HP}),zP=[pe("channel"),_e("renderComponents"),_e("updateState"),_e("initialData")],NP=yf({fields:zP,name:"reflecting",active:VP,apis:IP,state:PP}),LP=i([pe("toggleClass"),pe("fetch"),xs("onExecute"),Ie("getHotspot",w.some),Ie("getAnchorOverrides",i({})),wl(),xs("onItemExecute"),_e("lazySink"),pe("dom"),bs("onOpen"),Eg("splitDropdownBehaviours",[AT,jb,sy]),Ie("matchWidth",!1),Ie("useMinWidth",!1),Ie("eventOrder",{}),_e("role")].concat(GT())),jP=up({factory:Ex,schema:[pe("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:hf([sy.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(ai)},buttonBehaviours:hf([Ey.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),UP=up({factory:Ex,schema:[pe("dom")],name:"button",defaults:function(){return{buttonBehaviours:hf([sy.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each((function(e){n.onExecute(e,t)}))}}}}),WP=i([jP,UP,cp({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[pe("text")],name:"aria-descriptor"}),ap({schema:[ps()],name:"menu",defaults:function(n){return{onExecute:function(t,e){t.getSystem().getByUid(n.uid).each((function(o){n.onItemExecute(o,t,e)}))}}}}),FT()]),GP=function(n,t,o,r){var i=function(n){Jp.getCurrent(n).each((function(n){vv.highlightFirst(n),jb.focusIn(n)}))},u=function(t){var o=i;zT(n,(function(n){return n}),t,r,o,q_.HighlightFirst).get(e)},a=function(n){return u(n),w.some(!0)},c=function(t){var e=Sp(t,n,"button");return ai(e),w.some(!0)},s=m(m({},li([Oi((function(t,e){var o=wp(t,n,"aria-descriptor");o.each((function(n){var e=bu("aria");ru(n.element(),"id",e),ru(t.element(),"aria-describedby",e)}))}))])),Dy(w.some(u))),f={repositionMenus:function(n){Ey.isOn(n)&&WT(n)}};return{uid:n.uid,dom:n.dom,components:t,apis:f,eventOrder:m(m({},n.eventOrder),{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:s,behaviours:Dg(n.splitDropdownBehaviours,[AT.config({others:{sandbox:function(t){var e=Sp(t,n,"arrow"),o={onOpen:function(){Ey.on(e),Ey.on(t)},onClose:function(){Ey.off(e),Ey.off(t)}};return UT(n,t,o)}}}),jb.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),sy.config({}),Ey.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},XP=Lp({name:"SplitDropdown",configFields:LP(),partFields:WP(),factory:GP,apis:{repositionMenus:function(n,t){return n.repositionMenus(t)}}}),YP=function(n){return{isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)}}},qP=function(n){return{setActive:function(t){Ey.set(n,t)},isActive:function(){return Ey.isOn(n)},isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)}}},KP=function(n,t){return n.map((function(n){return{"aria-label":t.translate(n),title:t.translate(n)}})).getOr({})},JP=bu("focus-button"),$P=["checklist","ordered-list"],QP=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],ZP=function(n,t,e,o,r,i){var u,a=function(n){return Jw.isRtl()&&U($P,n)?n+"-rtl":n},c=Jw.isRtl()&&n.exists((function(n){return U(QP,n)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:KP(e,i)},components:Pk([n.map((function(n){return jM(a(n),i.icons)})),t.map((function(n){return WM(n,"tox-tbtn",i)}))]),eventOrder:(u={},u[yr()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:hf([Ak.toolbarButton(i.isReadOnly),_k(),ny("common-button-display-events",[pi(yr(),(function(n,t){t.event().prevent(),ii(n,JP)}))])].concat(o.map((function(e){return NP.config({channel:e,initialData:{icon:n,text:t},renderComponents:function(n,t){return Pk([n.icon.map((function(n){return jM(a(n),i.icons)})),n.text.map((function(n){return WM(n,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},nz=function(n,t,e,o){var r=t.shared;return hH.sketch({lazySink:r.getSink,fetch:function(){return oT.nu((function(t){t(Y(e(n.items),rP))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:ZP(n.icon,n.text,n.tooltip,w.none(),w.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},tz=function(n,t,o){var r=Ge(e),i=ZP(n.icon,n.text,n.tooltip,w.none(),w.none(),o);return Ex.sketch({dom:i.dom,components:i.components,eventOrder:YM,buttonBehaviours:hf([ny("toolbar-button-events",[XM({onAction:n.onAction,getApi:t.getApi}),Fk(t,r),Ik(t,r)]),Ak.toolbarButton((function(){return n.disabled||o.isReadOnly()})),_k()].concat(t.toolbarButtonBehaviours))})},ez=function(n,t){return oz(n,t,[])},oz=function(n,t,e){return tz(n,{toolbarButtonBehaviours:[].concat(e.length>0?[ny("toolbarButtonWith",e)]:[]),getApi:YP,onSetup:n.onSetup},t)},rz=function(n,t){return iz(n,t,[])},iz=function(n,t,e){return Vn(tz(n,{toolbarButtonBehaviours:[Qb.config({}),Ey.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[ny("toolbarToggleButtonWith",e)]:[]),getApi:qP,onSetup:n.onSetup},t))},uz=function(n,t,e){return function(o){return oT.nu((function(n){return t.fetch(n)})).map((function(r){return w.from(LO(Vn(yO(bu("menu-value"),r,(function(e){t.onItemAction(n(o),e)}),t.columns,t.presets,Rk.CLOSE_ON_EXECUTE,t.select.getOr((function(){return!1})),e),{movement:wO(t.columns,t.presets),menuBehaviours:Hw.unnamedEvents("auto"!==t.columns?[]:[Oi((function(n,e){Iw(n,4,fS(t.presets)).each((function(t){var e=t.numRows,o=t.numColumns;jb.setGridSize(n,e,o)}))}))])})))}))}},az=function(n,t){var o,r=bu("channel-update-split-dropdown-display"),i=function(n){return{isDisabled:function(){return WS.isDisabled(n)},setDisabled:function(t){return WS.set(n,t)},setIconFill:function(t,e){qc(n.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){ru(n,"fill",e)}))},setIconStroke:function(t,e){qc(n.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){ru(n,"stroke",e)}))},setActive:function(t){ru(n.element(),"aria-pressed",t),qc(n.element(),"span").each((function(e){n.getSystem().getByDom(e).each((function(n){return Ey.set(n,t)}))}))},isActive:function(){return qc(n.element(),"span").exists((function(t){return n.getSystem().getByDom(t).exists(Ey.isOn)}))}}},u=Ge(e),a={getApi:i,onSetup:n.onSetup};return XP.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:m({"aria-pressed":!1},KP(n.tooltip,t.providers))},onExecute:function(t){n.onAction(i(t))},onItemExecute:function(n,t,e){},splitDropdownBehaviours:hf([Ak.splitButton(t.providers.isReadOnly),_k(),ny("split-dropdown-events",[pi(JP,sy.focus),Fk(a,u),Ik(a,u)]),ZT.config({})]),eventOrder:(o={},o[Kr()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:uz(i,n,t.providers),parts:{menu:cO(!1,n.columns,n.presets)},components:[XP.parts().button(ZP(n.icon,n.text,w.none(),w.some(r),w.some([Ey.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),XP.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Ax("chevron-down",t.providers.icons)},buttonBehaviours:hf([Ak.splitButton(t.providers.isReadOnly),_k()])}),XP.parts()["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},cz=function(n){return{hide:function(){return ii(n,jr())},getValue:function(){return Tg.getValue(n)}}},sz=function(n,t){return pi(GM,(function(e,o){var r=n.get(e),i=cz(r);t.onAction(i,o.event().buttonApi())}))},fz=function(n,t,e){var o=t.original,r=(o.primary,g(o,["primary"])),i=te(dP(m(m({},r),{type:"button",onAction:function(){}})));return oz(i,e.backstage.shared.providers,[sz(n,t)])},lz=function(n,t,e){var o=t.original,r=(o.primary,g(o,["primary"])),i=te(xP(m(m({},r),{type:"togglebutton",onAction:function(){}})));return iz(i,e.backstage.shared.providers,[sz(n,t)])},dz=function(n,t,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===t.type?lz(n,t,o):fz(n,t,o)},mz=function(n,t,e){var o=Y(t,(function(t){return Bx(dz(n,t,e))})),r=function(){return Y(o,(function(n){return n.asSpec()}))},i=function(n){return pn(t,(function(t,e){return t.primary?w.from(o[e]).bind((function(t){return t.getOpt(n)})).filter(c(WS.isDisabled)):w.none()}))};return{asSpecs:r,findPrimary:i}},gz=function(n,t){var e=n.label.fold((function(){return{}}),(function(n){return{"aria-label":n}})),o=Bx(G_.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:hf([jb.config({mode:"special",onEnter:function(n){return r.findPrimary(n).map((function(n){return ai(n),!0}))},onLeft:function(n,t){return t.cut(),w.none()},onRight:function(n,t){return t.cut(),w.none()}})])})),r=mz(o,n.commands,t);return[{title:w.none(),items:[o.asSpec()]},{title:w.none(),items:r.asSpecs()}]},pz=function(n,t,e){return sP({type:n,uid:bu("context-toolbar"),initGroups:gz(t,e),onEscape:w.none,cyclicKeying:!0,providers:e})},vz={renderContextForm:pz,buildInitGroups:gz},hz=function(n,t){var e=Math.max(t.x,n.x),o=n.right-e,r=t.width-(e-t.x),i=Math.min(o,r);return{x:e,width:i}},bz=function(n,t,e,o){var r=$e.fromDom(n.getContainer()),i=qc(r,".tox-editor-header").getOr(r),u=Pc(i),a=u.y>=t.bottom,c=o&&!a;if(n.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(n.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=Pc(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}},yz=function(n,e){var o=Ec(t.window),r=Pc($e.fromDom(n.getContentAreaContainer())),i=ik(n)||uk(n)||ck(n),u=hz(r,o),a=u.x,c=u.width;if(n.inline&&!i)return Hc(a,o.y,c,o.height);var s=e.header.isPositionedAtTop(),f=bz(n,r,o,s),l=f.y,d=f.bottom;return Hc(a,l,c,d-l)},xz=function(n,t){var e=$(t,(function(t){return t.predicate(n.dom())})),o=J(e,(function(n){return"contexttoolbar"===n.type})),r=o.pass,i=o.fail;return{contextToolbars:r,contextForms:i}},wz=function(n){if(n.length<=1)return n;var t=function(t){return W(n,(function(n){return n.position===t}))},e=function(t){return $(n,(function(n){return n.position===t}))},o=t("selection"),r=t("node");if(o||r){if(r&&o){var i=e("node"),u=Y(e("selection"),(function(n){return m(m({},n),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")},Sz=function(n){if(n.length<=1)return n;var t=function(t){return tn(n,(function(n){return n.position===t}))},e=t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(n){return n.position}));return e.fold((function(){return[]}),(function(t){return $(n,(function(n){return n.position===t}))}))},kz=function(n,t,e){var o=xz(n,t);if(o.contextForms.length>0)return w.some({elem:n,toolbars:[o.contextForms[0]]});var r=xz(n,e);if(r.contextForms.length>0)return w.some({elem:n,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=wz(o.contextToolbars.concat(r.contextToolbars));return w.some({elem:n,toolbars:i})}return w.none()},Cz=function(n,t,e){return n(t)?w.none():ar(t,(function(n){var t=xz(n,e.inNodeScope),o=t.contextToolbars,r=t.contextForms,i=r.length>0?r:Sz(o);return i.length>0?w.some({elem:n,toolbars:i}):w.none()}),n)},Oz=function(n,t){var e=$e.fromDom(t.getBody()),o=function(n){return er(n,e)},r=function(n){return!o(n)&&!ir(e,n)},i=$e.fromDom(t.selection.getNode());return r(i)?w.none():kz(i,n.inNodeScope,n.inEditorScope).orThunk((function(){return Cz(o,i,n)}))},_z=function(n,t){var e={},o=[],r=[],i={},u={},a=function(n,a){var c=te(MP(a));e[n]=c,c.launch.map((function(e){i["form:"+n]=m(m({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){t(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[n]=c},c=function(n,t){AP(t).each((function(e){"editor"===t.scope?r.push(e):o.push(e),u[n]=e}))},s=vn(n);return q(s,(function(t){var e=n[t];"contextform"===e.type?a(t,e):"contexttoolbar"===e.type&&c(t,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},Tz=bu("forward-slide"),Ez=bu("backward-slide"),Bz=bu("change-slide-event"),Dz="tox-pop--resizing",Az=function(n){var t=Ge([]);return gx.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(n){t.set([]),gx.getContent(n).each((function(n){Ha(n.element(),"visibility")})),ya(n.element(),Dz),Ha(n.element(),"width")},inlineBehaviours:hf([ny("context-toolbar-events",[Ci(Ar(),(function(n,t){ya(n.element(),Dz),Ha(n.element(),"width")})),pi(Bz,(function(n,t){Ha(n.element(),"width");var e=gc(n.element());gx.setContent(n,t.event().contents()),ha(n.element(),Dz);var o=gc(n.element());Ba(n.element(),"width",e+"px"),gx.getContent(n).each((function(e){t.event().focus().bind((function(t){return Df(t),If(n.element())})).orThunk((function(){return jb.focusIn(e),Ff()}))})),_x.setTimeout((function(){Ba(n.element(),"width",o+"px")}),0)})),pi(Tz,(function(n,e){gx.getContent(n).each((function(n){t.set(t.get().concat([{bar:n,focus:Ff()}]))})),ui(n,Bz,{contents:e.event().forwardContents(),focus:w.none()})})),pi(Ez,(function(n,e){mn(t.get()).each((function(e){t.set(t.get().slice(0,t.get().length-1)),ui(n,Bz,{contents:nc(e.bar),focus:e.focus})}))}))]),jb.config({mode:"special",onEscape:function(e){return mn(t.get()).fold((function(){return n.onEscape()}),(function(n){return ii(e,Ez),w.some(!0)}))}})]),lazySink:function(){return O.value(n.sink)}})},Mz=function(n,t,e){var o=function(n,o,i,u){var a=t.shared.providers.translate(n.title);if("separator"===n.type)return w.some({type:"separator",text:a});if("submenu"===n.type){var c=rn(n.getStyleItems(),(function(n){return r(n,o,u)}));return 0===o&&c.length<=0?w.none():w.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return rn(n.getStyleItems(),(function(n){return r(n,o,u)}))}})}return w.some(m({type:"togglemenuitem",text:a,icon:n.icon,active:n.isSelected(u),disabled:i,onAction:e.onAction(n)},n.getStylePreview().fold((function(){return{}}),(function(n){return{meta:{style:n}}}))))},r=function(n,t,r){var i="formatter"===n.type&&e.isInvalid(n);return 0===t?i?[]:o(n,t,!1,r).toArray():o(n,t,i,r).toArray()},i=function(n){var t=e.getCurrentValue(),o=e.shouldHide?0:1;return rn(n,(function(n){return r(n,o,t)}))},u=function(n,t){return function(e){var o=t(),r=i(o),u=uF(r,Rk.CLOSE_ON_EXECUTE,n,!1);e(u)}};return{validateItems:i,getFetch:u}},Fz=function(n,t,e){var o=e.dataset,r="basic"===o.type?function(){return Y(o.data,(function(n){return UR(n,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:Mz(n,t,e),getStyleItems:r}},Iz=function(n,t,o){var r=Fz(n,t,o),i=r.items,u=r.getStyleItems,a=function(n){return{getComponent:function(){return n}}},c=function(t){return o.setInitialValue.each((function(n){return n(t.getComponent())})),o.nodeChangeHandler.map((function(e){var o=e(t.getComponent());return n.on("NodeChange",o),function(){n.off("NodeChange",o)}})).getOr(e)};return JM({text:o.icon.isSome()?w.none():w.some(""),icon:o.icon,tooltip:w.from(o.tooltip),role:w.none(),fetch:i.getFetch(t,u),onSetup:c,getApi:a,columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},Rz=function(n){return Y(n,(function(n){var t=n,e=n,o=n.split("=");return o.length>1&&(t=o[0],e=o[1]),{title:t,format:e}}))},Vz=function(n){return{type:"basic",data:n}};(function(n){n[n["SemiColon"]=0]="SemiColon",n[n["Space"]=1]="Space"})(lI||(lI={}));var Hz,Pz=function(n,t){return t===lI.SemiColon?n.replace(/;$/,"").split(";"):n.split(" ")},zz=function(n,t,e,o){var r=Tn(n.settings,t).getOr(e),i=Rz(Pz(r,o));return{type:"basic",data:i}},Nz=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],Lz=function(n){var t=function(){return tn(Nz,(function(t){return n.formatter.match(t.format)}))},e=function(t){return function(){return n.formatter.match(t)}},o=function(n){return function(){return w.none()}},r=function(n){var e=t(),o=e.fold((function(){return"left"}),(function(n){return n.title.toLowerCase()}));ui(n,KM,{icon:"align-"+o})},u=w.some((function(n){return function(){return r(n)}})),a=w.some((function(n){return r(n)})),c=Vz(Nz),s=function(t){return function(){return tn(Nz,(function(n){return n.format===t.format})).each((function(t){return n.execCommand(t.command)}))}};return{tooltip:"Align",icon:w.some("align-left"),isSelectedFor:e,getCurrentValue:i(w.none()),getPreviewFor:o,onAction:s,setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},jz=function(n,t){return Iz(n,t,Lz(n))},Uz=function(n,t){var e=Fz(n,t,Lz(n));n.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},Wz="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Gz=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],Xz=function(n){var t=n.split(/\s*,\s*/);return Y(t,(function(n){return n.replace(/^['"]+|['"]+$/g,"")}))},Yz=function(n){var t=function(){var t=Xz(n.toLowerCase());return un(Gz,(function(n){return t.indexOf(n.toLowerCase())>-1}))};return 0===n.indexOf("-apple-system")&&t()},qz=function(n){var t=function(){var t=function(n){return n?Xz(n)[0]:""},e=n.queryCommandValue("FontName"),o=s.data,r=e?e.toLowerCase():"",i=tn(o,(function(n){var e=n.format;return e.toLowerCase()===r||t(e).toLowerCase()===t(r).toLowerCase()})).orThunk((function(){return Yz(r)?w.from({title:"System Font",format:r}):w.none()}));return{matchOpt:i,font:e}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},o=function(){var n=t().matchOpt;return n},r=function(n){return function(){return w.some({tag:"div",styles:-1===n.indexOf("dings")?{"font-family":n}:{}})}},i=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontName",!1,t.format)}))}},u=function(n){var e=t(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(n){return n.title}));ui(n,qM,{text:i})},a=w.some((function(n){return function(){return u(n)}})),c=w.some((function(n){return u(n)})),s=zz(n,"font_formats",Wz,lI.SemiColon);return{tooltip:"Fonts",icon:w.none(),isSelectedFor:e,getCurrentValue:o,getPreviewFor:r,onAction:i,setInitialValue:c,nodeChangeHandler:a,dataset:s,shouldHide:!1,isInvalid:function(){return!1}}},Kz=function(n,t){return Iz(n,t,qz(n))},Jz=function(n,t){var e=Fz(n,t,qz(n));n.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},$z="8pt 10pt 12pt 14pt 18pt 24pt 36pt",Qz={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Zz=function(n,t){var e=Math.pow(10,t);return Math.round(n*e)/e},nN=function(n,t){return/[0-9.]+px$/.test(n)?Zz(72*parseInt(n,10)/96,t||0)+"pt":n},tN=function(n){return Tn(Qz,n).getOr("")},eN=function(n){var t=function(){var t=w.none(),e=f.data,o=n.queryCommandValue("FontSize");if(o)for(var r=function(n){var r=nN(o,n),i=tN(r);t=tn(e,(function(n){return n.format===o||n.format===r||n.format===i}))},i=3;t.isNone()&&i>=0;i--)r(i);return{matchOpt:t,size:o}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},o=function(){var n=t().matchOpt;return n},r=i(i(w.none())),u=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontSize",!1,t.format)}))}},a=function(n){var e=t(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(n){return n.title}));ui(n,qM,{text:i})},c=w.some((function(n){return function(){return a(n)}})),s=w.some((function(n){return a(n)})),f=zz(n,"fontsize_formats",$z,lI.Space);return{tooltip:"Font sizes",icon:w.none(),isSelectedFor:e,getPreviewFor:r,getCurrentValue:o,onAction:u,setInitialValue:s,nodeChangeHandler:c,dataset:f,shouldHide:!1,isInvalid:function(){return!1}}},oN=function(n,t){return Iz(n,t,eN(n))},rN=function(n,t){var e=Fz(n,t,eN(n));n.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},iN=function(n,t,e){var o=t();return pn(e,(function(t){return tn(o,(function(e){return n.formatter.matchNode(t,e.format)}))})).orThunk((function(){return n.formatter.match("p")?w.some({title:"Paragraph",format:"p"}):w.none()}))},uN=function(n){var t=n.selection.getStart(!0)||n.getBody();return n.dom.getParents(t,(function(){return!0}),n.getBody())},aN=function(n,t){return function(e){var o=Ge(w.none()),r=function(){e.setActive(n.formatter.match(t));var r=n.formatter.formatChanged(t,e.setActive).unbind;o.set(w.some(r))};return n.initialized?r():n.on("init",r),function(){return o.get().each((function(n){return n()}))}}},cN=function(n){return function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)}))}}},sN="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",fN=function(n){var t=function(t){return iN(n,(function(){return c.data}),t)},e=function(t){return function(){return n.formatter.match(t)}},o=function(t){return function(){var e=n.formatter.get(t);return w.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},r=function(n,e){var o=t(n),r=o.fold((function(){return"Paragraph"}),(function(n){return n.title}));ui(e,qM,{text:r})},u=w.some((function(n){return function(t){return r(t.parents,n)}})),a=w.some((function(t){var e=uN(n);r(e,t)})),c=zz(n,"block_formats",sN,lI.SemiColon);return{tooltip:"Blocks",icon:w.none(),isSelectedFor:e,getCurrentValue:i(w.none()),getPreviewFor:o,onAction:cN(n),setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},lN=function(n,t){return Iz(n,t,fN(n))},dN=function(n,t){var e=Fz(n,t,fN(n));n.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},mN=function(n,t){var e=function(t){return function(){return n.formatter.match(t)}},o=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?w.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):w.none()}},r=function(t,e){var o=function(n){var t=n.items;return void 0!==t&&t.length>0?rn(t,o):[{title:n.title,format:n.format}]},r=rn(jR(n),o),i=iN(n,(function(){return r}),t),u=i.fold((function(){return"Paragraph"}),(function(n){return n.title}));ui(e,qM,{text:u})},u=w.some((function(n){return function(t){return r(t.parents,n)}})),a=w.some((function(t){var e=uN(n);r(e,t)}));return{tooltip:"Formats",icon:w.none(),isSelectedFor:e,getCurrentValue:i(w.none()),getPreviewFor:o,onAction:cN(n),setInitialValue:a,nodeChangeHandler:u,shouldHide:n.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!n.formatter.canApply(t.format)},dataset:t}},gN=function(n,t){var e=m({type:"advanced"},t.styleselect);return Iz(n,t,mN(n,e))},pN=function(n,t){var e=m({type:"advanced"},t.styleselect),o=Fz(n,t,mN(n,e));n.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})},vN=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],hN=function(n,t){return function(e,o,r){var i=n(e).mapError((function(n){return oe(n)})).getOrDie();return t(i,o,r)}},bN={button:hN(dP,(function(n,t){return ez(n,t.backstage.shared.providers)})),togglebutton:hN(xP,(function(n,t){return rz(n,t.backstage.shared.providers)})),menubutton:hN(pP,(function(n,t){return cF(n,"tox-tbtn",t.backstage,w.none())})),splitbutton:hN(hP,(function(n,t){return az(n,t.backstage.shared)})),grouptoolbarbutton:hN(SP,(function(n,t,e){var o,r=e.ui.registry.getAll().buttons,i=function(n){return _N(e,{buttons:r,toolbar:n,allowToolbarGroups:!1},t,w.none())},u=(o={},o[yl]=t.backstage.shared.header.isPositionedAtTop()?ts.TopToBottom:ts.BottomToTop,o);switch(fk(e)){case Px.floating:return nz(n,t.backstage,i,u);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(n,t){return gN(n,t.backstage)},fontsizeSelectButton:function(n,t){return oN(n,t.backstage)},fontSelectButton:function(n,t){return Kz(n,t.backstage)},formatButton:function(n,t){return lN(n,t.backstage)},alignMenuButton:function(n,t){return jz(n,t.backstage)}},yN=function(n,e,o){return Tn(bN,n.type).fold((function(){return t.console.error("skipping button defined by",n),w.none()}),(function(t){return w.some(t(n,e,o))}))},xN={styleselect:bN.styleSelectButton,fontsizeselect:bN.fontsizeSelectButton,fontselect:bN.fontSelectButton,formatselect:bN.formatButton,align:bN.alignMenuButton},wN=function(n){var t=Y(vN,(function(t){var e=$(t.items,(function(t){return En(n,t)||En(xN,t)}));return{name:t.name,items:e}}));return $(t,(function(n){return n.items.length>0}))},SN=function(n){var t=n.split("|");return Y(t,(function(n){return{items:n.trim().split(" ")}}))},kN=function(n){return H(n,(function(n){return En(n,"name")&&En(n,"items")}))},CN=function(n){var e=n.toolbar,o=n.buttons;return!1===e?[]:void 0===e||!0===e?wN(o):D(e)?SN(e):kN(e)?e:(t.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},ON=function(n,e,o,r,i,u){return Tn(e,o.toLowerCase()).orThunk((function(){return u.bind((function(n){return pn(n,(function(n){return Tn(e,n+o.toLowerCase())}))}))})).fold((function(){return Tn(xN,o.toLowerCase()).map((function(t){return t(n,i)})).orThunk((function(){return w.none()}))}),(function(e){return"grouptoolbarbutton"!==e.type||r?yN(e,i,n):(t.console.warn("Ignoring the '"+o+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),w.none())}))},_N=function(n,t,e,o){var r=CN(t),i=Y(r,(function(r){var i=rn(r.items,(function(r){return 0===r.trim().length?[]:ON(n,t.buttons,r,t.allowToolbarGroups,e,o).toArray()}));return{title:w.from(n.translate(r.name)),items:i}}));return $(i,(function(n){return n.items.length>0}))},TN=12,EN={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},BN={maxHeightFunction:sl(),maxWidthFunction:HV()},DN={onLtr:function(){return[Zs,nf,$s,Ks,Qs,Js,Cx,Ox,Sx,xx,kx,wx]},onRtl:function(){return[Zs,nf,Qs,Js,$s,Ks,Cx,Ox,kx,wx,Sx,xx]}},AN={onLtr:function(){return[nf,Ks,Js,$s,Qs,Zs,Cx,Ox,Sx,xx,kx,wx]},onRtl:function(){return[nf,Js,Ks,Qs,$s,Zs,Cx,Ox,kx,wx,Sx,xx]}},MN=function(n,t){return"line"===n?{bubble:gl(TN,0,EN),layouts:{onLtr:function(){return[tf]},onRtl:function(){return[ef]}},overrides:BN}:{bubble:gl(0,TN,EN),layouts:t?AN:DN,overrides:BN}},FN=function(n,t,e,o){var r=Xo().deviceType.isTouch,i=Za(Az({sink:e,onEscape:function(){return n.focus(),w.some(!0)}})),u=function(){return yz(n,o.backstage.shared)},a=function(n,t,e,o){return Math.max(n,e)<=Math.min(t,o)},c=function(){var t=g.get().map((function(n){return n.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?Cc().top():zc($e.fromDom(n.getBody())).y;return{y:t.top+e,bottom:t.bottom+e}},s=function(){if(r()&&o.backstage.isContextMenuOpen())return!0;var n=c(),t=u();return!a(n.y,n.bottom,t.y,t.bottom)},f=function(){gx.hide(i)},l=function(){d.get().each((function(n){var t=i.element();Ha(t,"display"),s()?Ba(t,"display","none"):lm.positionWithinBounds(e,n,i,w.some(u()))}))},d=Ge(w.none()),g=Ge(w.none()),p=Ge(null),v=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:hf([jb.config({mode:"acyclic"}),ny("pop-dialog-wrap-events",[Oi((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return jb.focusIn(t)}))})),_i((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},h=Pn((function(){return _z(t,(function(n){var t=x([n]);ui(i,Tz,{forwardContents:v(t)})}))})),b=function(t,e){return _N(n,{buttons:t,toolbar:e.items,allowToolbarGroups:!1},o,w.some(["form:"]))},y=function(n,t){return vz.buildInitGroups(n,t)},x=function(t){var e=n.ui.registry.getAll().buttons,r=h(),i=m(m({},e),r.formNavigators),u=fk(n)===Px.scrolling?Px.scrolling:Px.default,a=on(Y(t,(function(n){return"contexttoolbar"===n.type?b(i,n):y(n,o.backstage.shared.providers)})));return sP({type:u,uid:bu("context-toolbar"),initGroups:a,onEscape:w.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};n.on(PV,(function(t){var e=h();Tn(e.lookupTable,t.toolbarKey).each((function(e){k([e],t.target===n?w.none():w.some(t)),gx.getContent(i).each(jb.focusIn)}))}));var S=function(n,t){var e="node"===n?o.backstage.shared.anchors.node(t):o.backstage.shared.anchors.cursor();return Vn(e,MN(n,r()))},k=function(n,t){if(O(),!r()||!o.backstage.isContextMenuOpen()){var e=x(n),a=t.map($e.fromDom),c=S(n[0].position,a);d.set(w.some(c)),g.set(t);var f=i.element();Ha(f,"display"),gx.showWithinBounds(i,c,v(e),(function(){return w.some(u())})),s()&&Ba(f,"display","none")}},C=function(){if(n.hasFocus()){var t=h();Oz(t,n).fold((function(){d.set(w.none()),gx.hide(i)}),(function(n){k(n.toolbars,w.some(n.elem.dom()))}))}},O=function(){var n=p.get();null!==n&&(_x.clearTimeout(n),p.set(null))},_=function(n){O(),p.set(n)};n.on("init",(function(){n.on(zV,f),n.on("ScrollContent ScrollWindow longpress",l),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){_(_x.setEditorTimeout(n,C,0))})),n.on("focusout",(function(t){_x.setEditorTimeout(n,(function(){If(e.element()).isNone()&&If(i.element()).isNone()&&(d.set(w.none()),gx.hide(i))}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&(d.set(w.none()),gx.hide(i))})),n.on("NodeChange",(function(t){If(i.element()).fold((function(){_(_x.setEditorTimeout(n,C,0))}),(function(n){}))}))}))},IN=function(n,e,o){var r=function(n,t){q([e,o],(function(e){e.broadcastEvent(n,t)}))},i=function(n,t){q([e,o],(function(e){e.broadcastOn([n],t)}))},u=function(n){return i(Xm(),{target:n.target()})},a=XO($e.fromDom(t.document),"touchstart",u),c=XO($e.fromDom(t.document),"touchmove",(function(n){return r(Gr(),n)})),s=XO($e.fromDom(t.document),"touchend",(function(n){return r(Xr(),n)})),f=XO($e.fromDom(t.document),"mousedown",u),l=XO($e.fromDom(t.document),"mouseup",(function(n){0===n.raw().button&&i(qm(),{target:n.target()})})),d=function(n){return i(Xm(),{target:$e.fromDom(n.target)})},m=function(n){0===n.button&&i(qm(),{target:$e.fromDom(n.target)})},g=function(n){return r(Yr(),qO(n))},p=function(n){i(Ym(),{}),r(qr(),qO(n))},v=function(){return i(Ym(),{})};n.on("PostRender",(function(){n.on("click",d),n.on("tap",d),n.on("mouseup",m),n.on("ScrollWindow",g),n.on("ResizeWindow",p),n.on("ResizeEditor",v)})),n.on("remove",(function(){n.off("click",d),n.off("tap",d),n.off("mouseup",m),n.off("ScrollWindow",g),n.off("ResizeWindow",p),n.off("ResizeEditor",v),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()})),n.on("detach",(function(){Om(e),Om(o),e.destroy(),o.destroy()}))},RN=Bp,VN=lp,HN=i([Ie("shell",!1),pe("makeItem"),Ie("setupItem",e),Ag.field("listBehaviours",[Qb])]),PN=function(){return{behaviours:hf([Qb.config({})])}},zN=cp({name:"items",overrides:PN}),NN=i([zN]),LN=i("CustomList"),jN=function(n,e,o,r){var i=function(e,o){a(e).fold((function(){throw t.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(t){var r=Qb.contents(t),i=o.length,u=i-r.length,a=u>0?G(u,(function(){return n.makeItem()})):[],c=r.slice(i);q(c,(function(n){return Qb.remove(t,n)})),q(a,(function(n){return Qb.append(t,n)}));var s=Qb.contents(t);q(s,(function(t,r){n.setupItem(e,t,o[r],r)}))}))},u=n.shell?{behaviours:[Qb.config({})],components:[]}:{behaviours:[],components:e},a=function(t){return n.shell?w.some(t):wp(t,n,"items")};return{uid:n.uid,dom:n.dom,components:u.components,behaviours:Dg(n.listBehaviours,u.behaviours),apis:{setItems:i}}},UN=Lp({name:LN(),configFields:HN(),partFields:NN(),factory:jN,apis:{setItems:function(n,t,e){n.setItems(t,e)}}}),WN=function(n){var t=Ia(n,"position").is("fixed"),e=t?w.none():Fi(n);return e.orThunk((function(){var t=$e.fromTag("span");return Mi(n).bind((function(n){Li(n,t);var e=Fi(t);return Xi(t),e}))}))},GN=function(n){return WN(n).map(fc).getOrThunk((function(){return ac(0,0)}))},XN=An.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),YN=function(n,t){var e=n.element();ha(e,t.transitionClass),ya(e,t.fadeOutClass),ha(e,t.fadeInClass),t.onShow(n)},qN=function(n,t){var e=n.element();ha(e,t.transitionClass),ya(e,t.fadeInClass),ha(e,t.fadeOutClass),t.onHide(n)},KN=function(n,t){return n.y<t.bottom&&n.bottom>t.y},JN=function(n,t){return n.y>=t.y},$N=function(n,t){return n.bottom<=t.bottom},QN=function(n,t,e){return un(n,(function(n){switch(n){case"bottom":return $N(t,e);case"top":return JN(t,e)}}))},ZN=function(n,t){return t.getInitialPosition().map((function(t){return Hc(t.bounds.x,t.bounds.y,gc(n),oc(n))}))},nL=function(n,t,e){e.setInitialPosition(w.some({style:Ra(n),position:Ma(n,"position")||"static",bounds:t}))},tL=function(n,t,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(w.none()),o.position){case"static":return w.some(XN.static());case"absolute":var r=WN(n).map(Pc).getOrThunk((function(){return Pc(Oa())}));return w.some(XN.absolute(Vf("absolute",Tn(o.style,"left").map((function(n){return t.x-r.x})),Tn(o.style,"top").map((function(n){return t.y-r.y})),Tn(o.style,"right").map((function(n){return r.right-t.right})),Tn(o.style,"bottom").map((function(n){return r.bottom-t.bottom})))));default:return w.none()}}))},eL=function(n,t,e){return ZN(n,e).filter((function(n){return QN(e.getModes(),n,t)})).bind((function(t){return tL(n,t,e)}))},oL=function(n,t,e){var o=Pc(n);if(QN(e.getModes(),o,t))return w.none();nL(n,o,e);var r=Nc(),i=o.x-r.x,u=t.y-r.y,a=r.bottom-t.bottom,c=o.y<=t.y;return w.some(XN.fixed(Vf("fixed",w.some(i),c?w.some(u):w.none(),w.none(),c?w.none():w.some(a))))},rL=function(n,t,e){var o=n.element(),r=Ia(o,"position").is("fixed");return r?eL(o,t,e):oL(o,t,e)},iL=function(n,t){var e=n.element();return ZN(e,t).bind((function(n){return tL(e,n,t)}))},uL=function(n,t){q(["left","right","top","bottom","position"],(function(t){return Ha(n.element(),t)})),t.onUndocked(n)},aL=function(n,t,e){Hf(n.element(),e);var o="fixed"===e.position()?t.onDocked:t.onUndocked;o(n)},cL=function(n,t,e,o,r){void 0===r&&(r=!1),t.contextual.each((function(t){t.lazyContext(n).each((function(i){var u=KN(i,o);if(u!==e.isVisible())if(e.setVisible(u),r&&!u)wa(n.element(),[t.fadeOutClass]),t.onHide(n);else{var a=u?YN:qN;a(n,t)}}))}))},sL=function(n,t,e){var o=t.lazyViewport(n),r=e.isDocked();r&&cL(n,t,e,o),rL(n,o,e).each((function(i){e.setDocked(!r),i.fold((function(){return uL(n,t)}),(function(e){return aL(n,t,e)}),(function(r){cL(n,t,e,o,!0),aL(n,t,r)}))}))},fL=function(n,t,o){var r=n.element();o.setDocked(!1),iL(n,o).each((function(o){o.fold((function(){return uL(n,t)}),(function(e){return aL(n,t,e)}),e)})),o.setVisible(!0),t.contextual.each((function(t){Sa(r,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),lL(n,t,o)},lL=function(n,t,e){n.getSystem().isConnected()&&sL(n,t,e)},dL=function(n,t,e){e.isDocked()&&fL(n,t,e)},mL=function(n,t,e){return e.isDocked()},gL=function(n,t,e,o){return e.setModes(o)},pL=function(n,t,e){return e.getModes()},vL=Object.freeze({__proto__:null,refresh:lL,reset:dL,isDocked:mL,getModes:pL,setModes:gL}),hL=function(n,t){return li([Ci(Ar(),(function(e,o){n.contextual.each((function(n){if(xa(e.element(),n.transitionClass)){Sa(e.element(),[n.transitionClass,n.fadeInClass]);var r=t.isVisible()?n.onShown:n.onHidden;r(e)}o.stop()}))})),pi(Yr(),(function(e,o){lL(e,n,t)})),pi(qr(),(function(e,o){dL(e,n,t)}))])},bL=Object.freeze({__proto__:null,events:hL}),yL=[Me("contextual",[be("fadeInClass"),be("fadeOutClass"),be("transitionClass"),we("lazyContext"),bs("onShow"),bs("onShown"),bs("onHide"),bs("onHidden")]),Ne("lazyViewport",Nc),je("modes",["top","bottom"],se),bs("onDocked"),bs("onUndocked")],xL=function(n){var t=Ge(!1),e=Ge(!0),o=Ge(w.none()),r=Ge(n.modes),i=function(){return"docked:  "+t.get()+", visible: "+e.get()+", modes: "+r.get().join(",")};return zu({isDocked:t.get,setDocked:t.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:i})},wL=Object.freeze({__proto__:null,init:xL}),SL=yf({fields:yL,name:"docking",active:bL,apis:vL,state:wL}),kL={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},CL="tox-tinymce--toolbar-sticky-on",OL="tox-tinymce--toolbar-sticky-off",_L=function(n,t){var e=Bi(t),o=e.dom().defaultView.innerHeight,r=Cc(e),i=$e.fromDom(n.elm),u=zc(i),a=oc(i),c=u.y,s=c+a,f=fc(t),l=oc(t),d=f.top(),m=d+l,g=Math.abs(d-r.top())<2,p=Math.abs(m-(r.top()+o))<2;if(g&&c<m)Oc(r.left(),c-l,e);else if(p&&s>d){var v=c-o+a+l;Oc(r.left(),v,e)}},TL=function(n,t){return U(SL.getModes(n),t)},EL=function(n){var t=function(n){return rc(n)+(parseInt(Ma(n,"margin-top"),10)||0)+(parseInt(Ma(n,"margin-bottom"),10)||0)},e=n.element();Mi(e).each((function(o){var r="padding-"+SL.getModes(n)[0];if(SL.isDocked(n)){var i=gc(o);Ba(e,"width",i+"px"),Ba(o,r,t(e)+"px")}else Ha(e,"width"),Ha(o,r)}))},BL=function(n,t){t?(ya(n,kL.fadeOutClass),wa(n,[kL.transitionClass,kL.fadeInClass])):(ya(n,kL.fadeInClass),wa(n,[kL.fadeOutClass,kL.transitionClass]))},DL=function(n,t){var e=$e.fromDom(n.getContainer());t?(ha(e,CL),ya(e,OL)):(ha(e,OL),ya(e,CL))},AL=function(n,t){var e=Bi(t);Ff(e).filter((function(n){return!er(t,n)})).filter((function(t){return er(t,$e.fromDom(e.dom().body))||ir(n,t)})).each((function(){return Df(t)}))},ML=function(n,t){return If(n).orThunk((function(){return t().toOption().bind((function(n){return If(n.element())}))}))},FL=function(n,t,e){n.inline||(t.header.isPositionedAtTop()||n.on("ResizeEditor",(function(){e().each(SL.reset)})),n.on("ResizeWindow ResizeEditor",(function(){e().each(EL)})),n.on("SkinLoaded",(function(){e().each((function(n){SL.isDocked(n)?SL.reset(n):SL.refresh(n)}))})),n.on("FullscreenStateChanged",(function(){e().each(SL.reset)}))),n.on("AfterScrollIntoView",(function(n){e().each((function(t){SL.refresh(t);var e=t.element();fh(e)&&_L(n,e)}))})),n.on("PostRender",(function(){DL(n,!1)}))},IL=function(n){return n().map(SL.isDocked).getOr(!1)},RL=function(){var n;return[Tf.config({channels:(n={},n[eP()]={onReceive:EL},n)})]},VL=function(n,t){var e=Ge(w.none()),o=t.getSink,r=function(n){o().each((function(t){return n(t.element())}))},i=function(t){n.inline||EL(t),DL(n,SL.isDocked(t)),t.getSystem().broadcastOn([Ym()],{}),o().each((function(n){return n.getSystem().broadcastOn([Ym()],{})}))},u=n.inline?[]:RL();return p([sy.config({}),SL.config({contextual:m({lazyContext:function(t){var e=rc(t.element()),o=n.inline?n.getContentAreaContainer():n.getContainer(),r=Pc($e.fromDom(o)),i=r.height-e,u=r.y+(TL(t,"top")?0:e);return w.some(Hc(r.x,u,r.width,i))},onShow:function(){r((function(n){return BL(n,!0)}))},onShown:function(n){r((function(n){return Sa(n,[kL.transitionClass,kL.fadeInClass])})),e.get().each((function(t){AL(n.element(),t),e.set(w.none())}))},onHide:function(n){e.set(ML(n.element(),o)),r((function(n){return BL(n,!1)}))},onHidden:function(){r((function(n){return Sa(n,[kL.transitionClass])}))}},kL),modes:[t.header.getDockingMode()],onDocked:i,onUndocked:i})],u)},HL=Object.freeze({__proto__:null,setup:FL,isDocked:IL,getBehaviours:VL}),PL=e,zL=f,NL=i([]),LL=Object.freeze({__proto__:null,setup:PL,isDocked:zL,getBehaviours:NL}),jL=function(n){var t=n.editor,e=n.sticky?VL:NL;return{uid:n.uid,dom:n.dom,components:n.components,behaviours:hf(e(t,n.sharedBackstage))}},UL=function(n,t){var e=function(n,e){var o=Y(e,(function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},o=pP(e).mapError((function(n){return oe(n)})).getOrDie();return cF(o,"tox-mbtn",t.backstage,w.some("menuitem"))}));Qb.set(n,o)},o={focus:jb.focusIn,setMenus:e};return{uid:n.uid,dom:n.dom,components:[],behaviours:hf([Qb.config({}),ny("menubar-events",[Oi((function(t){n.onSetup(t)})),pi(kr(),(function(n,t){qc(n.element(),".tox-mbtn--active").each((function(e){Kc(t.event().target(),".tox-mbtn").each((function(t){er(e,t)||n.getSystem().getByDom(e).each((function(e){n.getSystem().getByDom(t).each((function(n){KT.expand(n),KT.close(e),sy.focus(n)}))}))}))}))})),pi(Zr(),(function(n,t){t.event().prevFocus().bind((function(t){return n.getSystem().getByDom(t).toOption()})).each((function(e){t.event().newFocus().bind((function(t){return n.getSystem().getByDom(t).toOption()})).each((function(n){KT.isOpen(e)&&(KT.expand(n),KT.close(e))}))}))}))]),jb.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),w.some(!0)}}),yT.config({})]),apis:o,domModification:{attributes:{role:"menubar"}}}},WL=Np({factory:UL,name:"silver.Menubar",configFields:[pe("dom"),pe("uid"),pe("onEscape"),pe("backstage"),Ie("onSetup",e)],apis:{focus:function(n,t){n.focus(t)},setMenus:function(n,t,e){n.setMenus(t,e)}}}),GL="container",XL=[Eg("slotBehaviours",[])],YL=function(n){return"<alloy.field."+n+">"},qL=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),vp(GL,YL(t),e)};return{slot:t,record:function(){return n}}}(),e=n(t),o=t.record(),r=Y(o,(function(n){return up({name:n,pname:YL(n)})}));return Fp(GL,XL,r,KL,e)},KL=function(n,t){var e=function(t){return Op(n)},o=function(t,e){return wp(t,n,e)},r=function(t,e){return function(o,r){return wp(o,n,r).map((function(n){return t(n,r)})).getOr(e)}},i=function(n){return function(t,e){q(e,(function(e){return n(t,e)}))}},u=function(n,t){return"true"!==uu(n.element(),"aria-hidden")},a=function(n,t){if(!u(n)){var e=n.element();Ha(e,"display"),su(e,"aria-hidden"),ui(n,ni(),{name:t,visible:!0})}},c=function(n,t){if(u(n)){var e=n.element();Ba(e,"display","none"),ru(e,"aria-hidden","true"),ui(n,ni(),{name:t,visible:!1})}},s=r(u,!1),f=r(c),l=i(f),d=function(n){return l(n,e())},m=r(a),g={getSlotNames:e,getSlot:o,isShowing:s,hideSlot:f,hideAllSlots:d,showSlot:m};return{uid:n.uid,dom:n.dom,components:t,behaviours:Bg(n.slotBehaviours),apis:g}},JL=yn({getSlotNames:function(n,t){return n.getSlotNames(t)},getSlot:function(n,t,e){return n.getSlot(t,e)},isShowing:function(n,t,e){return n.isShowing(t,e)},hideSlot:function(n,t,e){return n.hideSlot(t,e)},hideAllSlots:function(n,t){return n.hideAllSlots(t)},showSlot:function(n,t,e){return n.showSlot(t,e)}},(function(n){return Hu(n)})),$L=m(m({},JL),{sketch:qL}),QL=Ht([Be("icon"),Be("tooltip"),Ne("onShow",e),Ne("onHide",e),Ne("onSetup",(function(){return e}))]),ZL=function(n){return ne("sidebar",QL,n)},nj=function(n){var t=n.ui.registry.getAll().sidebars;q(vn(t),(function(e){var o=t[e],r=function(){return w.from(n.queryCommandValue("ToggleSidebar")).is(e)};n.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(t){n.execCommand("ToggleSidebar",!1,e),t.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}))},tj=function(n){return{element:function(){return n.element().dom()}}},ej=function(n,t){var o=Y(vn(t),(function(n){var e=t[n],o=te(ZL(e));return{name:n,getApi:tj,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return Y(o,(function(t){var r=Ge(e);return n.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Hw.unnamedEvents([Fk(t,r),Ik(t,r),pi(ni(),(function(n,t){var e=t.event(),r=tn(o,(function(n){return n.name===e.name()}));r.each((function(t){var o=e.visible()?t.onShow:t.onHide;o(t.getApi(n))}))}))])})}))},oj=function(n){return $L.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:ej(t,n),slotBehaviours:Hw.unnamedEvents([Oi((function(n){return $L.hideAllSlots(n)}))])}}))},rj=function(n,t){var e=Jp.getCurrent(n);e.each((function(n){return Qb.set(n,[oj(t)])}))},ij=function(n,t){var e=Jp.getCurrent(n);e.each((function(n){var e=Jp.getCurrent(n);e.each((function(e){KH.hasGrown(n)?$L.isShowing(e,t)?KH.shrink(n):($L.hideAllSlots(e),$L.showSlot(e,t)):($L.hideAllSlots(e),$L.showSlot(e,t),KH.grow(n))}))}))},uj=function(n){var t=Jp.getCurrent(n);return t.bind((function(n){var t=KH.isGrowing(n)||KH.hasGrown(n);if(t){var e=Jp.getCurrent(n);return e.bind((function(n){return tn($L.getSlotNames(n),(function(t){return $L.isShowing(n,t)}))}))}return w.none()}))},aj=bu("FixSizeEvent"),cj=bu("AutoSizeEvent"),sj=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:hf([yT.config({}),sy.config({}),KH.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(n){var t=Jp.getCurrent(n);t.each($L.hideAllSlots),ii(n,cj)},onGrown:function(n){ii(n,cj)},onStartGrow:function(n){ui(n,aj,{width:Ia(n.element(),"width").getOr("")})},onStartShrink:function(n){ui(n,aj,{width:gc(n.element())+"px"})}}),Qb.config({}),Jp.config({find:function(n){var t=Qb.contents(n);return dn(t)}})])}],behaviours:hf([iA.childAt(0),ny("sidebar-sliding-events",[pi(aj,(function(n,t){Ba(n.element(),"width",t.event().width())})),pi(cj,(function(n,t){Ha(n.element(),"width")}))])])}},fj=function(n){var t=void 0!==n.dom().attributes?n.dom().attributes:[];return Z(t,(function(n,t){var e;return"class"===t.name?n:m(m({},n),(e={},e[t.name]=t.value,e))}),{})},lj=function(n){return Array.prototype.slice.call(n.dom().classList,0)},dj=function(n){var t=$e.fromHtml(n),e=Ri(t),o=fj(t),r=lj(t),i=0===e.length?{}:{innerHtml:Ki(t)};return m({tag:Qi(t),classes:r,attributes:o},i)},mj=function(n){return{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:dj('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:hf([jb.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),sy.config({})])}},gj=function(n,t,e){var o=n.element();!0===t?(Qb.set(n,[mj(e)]),Ha(o,"display"),su(o,"aria-hidden")):(Qb.set(n,[]),Ba(o,"display","none"),ru(o,"aria-hidden","true"))},pj=function(n){return{uid:n.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:hf([Qb.config({})]),components:[]}},vj=function(n,t,e){var o=Ge(!1),r=Ge(w.none()),i=function(n){n!==o.get()&&(gj(t(),n,e.providers),o.set(n))};n.on("ProgressState",(function(t){if(r.get().each(_x.clearTimeout),V(t.time)){var e=_x.setEditorTimeout(n,(function(){return i(t.state)}),t.time);r.set(w.some(e))}else i(t.state),r.set(w.none())}))},hj=function(n,t,e){var o={getSocket:function(t){return RN.getPart(t,n,"socket")},setSidebar:function(t,e){RN.getPart(t,n,"sidebar").each((function(n){return rj(n,e)}))},toggleSidebar:function(t,e){RN.getPart(t,n,"sidebar").each((function(n){return ij(n,e)}))},whichSidebar:function(t){return RN.getPart(t,n,"sidebar").bind(uj).getOrNull()},getHeader:function(t){return RN.getPart(t,n,"header")},getToolbar:function(t){return RN.getPart(t,n,"toolbar")},setToolbar:function(t,e){RN.getPart(t,n,"toolbar").each((function(n){n.getApis().setGroups(n,e)}))},setToolbars:function(t,e){RN.getPart(t,n,"multiple-toolbar").each((function(n){UN.setItems(n,e)}))},refreshToolbar:function(t){var e=RN.getPart(t,n,"toolbar");e.each((function(n){return n.getApis().refresh(n)}))},getThrobber:function(t){return RN.getPart(t,n,"throbber")},focusToolbar:function(t){var e=RN.getPart(t,n,"toolbar").orThunk((function(){return RN.getPart(t,n,"multiple-toolbar")}));e.each((function(n){jb.focusIn(n)}))},setMenubar:function(t,e){RN.getPart(t,n,"menubar").each((function(n){WL.setMenus(n,e)}))},focusMenubar:function(t){RN.getPart(t,n,"menubar").each((function(n){WL.focus(n)}))}};return{uid:n.uid,dom:n.dom,components:t,apis:o,behaviours:n.behaviours}},bj=VN.optional({factory:WL,name:"menubar",schema:[pe("backstage")]}),yj=function(n){return n.type===Px.sliding?cP:n.type===Px.floating?aP:sP},xj=VN.optional({factory:{sketch:function(n){return UN.sketch({uid:n.uid,dom:n.dom,listBehaviours:hf([jb.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return sP({type:n.type,uid:bu("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:n.providers,onEscape:function(){return w.none()}})},setupItem:function(n,t,e,o){qV.setGroups(t,e)},shell:!0})}},name:"multiple-toolbar",schema:[pe("dom"),pe("onEscape")]}),wj=VN.optional({factory:{sketch:function(n){var t=yj(n),e={type:n.type,uid:n.uid,onEscape:function(){return n.onEscape(),w.some(!0)},cyclicKeying:!1,initGroups:[],getSink:n.getSink,providers:n.providers,moreDrawerData:{lazyToolbar:n.lazyToolbar,lazyMoreButton:n.lazyMoreButton,lazyHeader:n.lazyHeader},attributes:n.attributes};return t(e)}},name:"toolbar",schema:[pe("dom"),pe("onEscape"),pe("getSink")]}),Sj=VN.optional({factory:{sketch:jL},name:"header",schema:[pe("dom")]}),kj=VN.optional({name:"socket",schema:[pe("dom")]}),Cj=VN.optional({factory:{sketch:sj},name:"sidebar",schema:[pe("dom")]}),Oj=VN.optional({factory:{sketch:pj},name:"throbber",schema:[pe("dom")]}),_j=Lp({name:"OuterContainer",factory:hj,configFields:[pe("dom"),pe("behaviours")],partFields:[Sj,bj,wj,xj,kj,Cj,Oj],apis:{getSocket:function(n,t){return n.getSocket(t)},setSidebar:function(n,t,e){n.setSidebar(t,e)},toggleSidebar:function(n,t,e){n.toggleSidebar(t,e)},whichSidebar:function(n,t){return n.whichSidebar(t)},getHeader:function(n,t){return n.getHeader(t)},getToolbar:function(n,t){return n.getToolbar(t)},setToolbar:function(n,t,e){var o=Y(e,(function(n){return rP(n)}));n.setToolbar(t,o)},setToolbars:function(n,t,e){var o=Y(e,(function(n){return Y(n,rP)}));n.setToolbars(t,o)},refreshToolbar:function(n,t){return n.refreshToolbar(t)},getThrobber:function(n,t){return n.getThrobber(t)},setMenubar:function(n,t,e){n.setMenubar(t,e)},focusMenubar:function(n,t){n.focusMenubar(t)},focusToolbar:function(n,t){n.focusToolbar(t)}}}),Tj="file edit view insert format tools table help",Ej={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},Bj=function(n,t,e){var o=rk(e).split(/[ ,]/);return{text:n.title,getItems:function(){return rn(n.items,(function(n){var e=n.toLowerCase();return 0===e.trim().length||W(o,(function(n){return n===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:t.menuItems[e]?[t.menuItems[e]]:[]}))}}},Dj=function(n){return"string"===typeof n?n.split(" "):n},Aj=function(n,t){var e=m(m({},Ej),t.menus),o=vn(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?Dj(Tj):Dj(!1===t.menubar?"":t.menubar),i=$(r,(function(n){return o&&t.menus.hasOwnProperty(n)&&t.menus[n].hasOwnProperty("items")||Ej.hasOwnProperty(n)})),u=Y(i,(function(o){var r=e[o];return Bj({title:r.title,items:Dj(r.items)},t,n)}));return $(u,(function(n){var t=function(n){return"separator"!==n.type};return n.getItems().length>0&&W(n.getItems(),t)}))},Mj=function(n){var t=function(){n._skinLoaded=!0,VC(n)};return function(){n.initialized?t():n.on("init",t)}},Fj=function(n,t){return function(){return HC(n,{message:t})}},Ij=function(n,t){var e,o=YS(t);o&&(e=o+"/skin.min.css",t.contentCSS.push(o+(n?"/content.inline":"/content")+".min.css")),!1===KS(t)&&e?GS.DOM.styleSheetLoader.load(e,Mj(t),Fj(t,"Skin could not be loaded")):Mj(t)()},Rj=a(Ij,!1),Vj=a(Ij,!0),Hj=function(n,t,e,o){var r=t.outerContainer,i=e.toolbar,u=e.buttons;if(H(i,D)){var a=i.map((function(t){var r={toolbar:t,buttons:u,allowToolbarGroups:e.allowToolbarGroups};return _N(n,r,{backstage:o},w.none())}));_j.setToolbars(r,a)}else _j.setToolbar(r,_N(n,e,{backstage:o},w.none()))},Pj=GS.DOM,zj=Xo(),Nj=zj.os.isiOS()&&zj.os.version.major<=12,Lj=function(n){var t=n.getWin(),e=n.getDoc().documentElement,o=Ge(ac(t.innerWidth,t.innerHeight)),r=Ge(ac(e.offsetWidth,e.offsetHeight)),i=function(e){var r=o.get();r.left()===t.innerWidth&&r.top()===t.innerHeight||(o.set(ac(t.innerWidth,t.innerHeight)),zC(n,e))},u=function(t){var e=n.getDoc().documentElement,o=r.get();o.left()===e.offsetWidth&&o.top()===e.offsetHeight||(r.set(ac(e.offsetWidth,e.offsetHeight)),zC(n,t))},a=function(t){return NC(n,t)};Pj.bind(t,"resize",i),Pj.bind(t,"scroll",a);var c=YO($e.fromDom(n.getBody()),"load",u);n.on("NodeChange",u),n.on("remove",(function(){c.unbind(),Pj.unbind(t,"resize",i),Pj.unbind(t,"scroll",a)}))},jj=function(n,t,e,o,r){var i=Ge(0);Rj(n),km($e.fromDom(r.targetNode),t.mothership),Sm(Oa(),t.uiMothership),n.on("PostRender",(function(){Hj(n,t,e,o),i.set(n.getWin().innerWidth),_j.setMenubar(t.outerContainer,Aj(n,e)),_j.setSidebar(t.outerContainer,e.sidebar),Lj(n)}));var u=_j.getSocket(t.outerContainer).getOrDie("Could not find expected socket element");if(!0===Nj){Da(u.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var a=zx((function(){n.fire("ScrollContent")}),20);XO(u.element(),"scroll",a.throttle)}Ok(n,t),n.addCommand("ToggleSidebar",(function(e,o){_j.toggleSidebar(t.outerContainer,o),n.fire("ToggleSidebar")})),n.addQueryValueHandler("ToggleSidebar",(function(){return _j.whichSidebar(t.outerContainer)}));var c=fk(n),s=function(){_j.refreshToolbar(t.outerContainer)};return c!==Px.sliding&&c!==Px.floating||n.on("ResizeWindow ResizeEditor ResizeContent",(function(){var t=n.getWin().innerWidth;t!==i.get()&&(s(),i.set(t))})),{iframeContainer:u.element().dom(),editorContainer:t.outerContainer.element().dom()}},Uj=Object.freeze({__proto__:null,render:jj}),Wj=function(n){var t=Ge(w.none()),e=function(){t.get().each(n)},o=function(){e(),t.set(w.none())},r=function(n){e(),t.set(w.some(n))},i=function(){return t.get().isSome()};return{clear:o,isSet:i,set:r}},Gj=function(){return Wj((function(n){n.unbind()}))},Xj=function(){var n=Ge(w.none()),t=function(){n.set(w.none())},e=function(t){n.set(w.some(t))},o=function(t){n.get().each(t)},r=function(){return n.get().isSome()};return{clear:t,set:e,isSet:r,on:o}},Yj=function(n){var t=/^[0-9\.]+(|px)$/i;return t.test(""+n)?w.some(parseInt(""+n,10)):w.none()},qj=function(n){return V(n)?n+"px":n},Kj=function(n,t,e){var o=t.filter((function(t){return n<t})),r=e.filter((function(t){return n>t}));return o.or(r).getOr(n)},Jj=function(n){var t=JS(n),e=ZS(n),o=tk(n);return Yj(t).map((function(n){return Kj(n,e,o)}))},$j=function(n){var t=Jj(n);return t.getOr(JS(n))},Qj=function(n){var t=$S(n),e=QS(n),o=nk(n);return Yj(t).map((function(n){return Kj(n,e,o)}))},Zj=function(n){var t=Qj(n);return t.getOr($S(n))},nU=function(n,t,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=GS.DOM,c=hk(n),s=xk(n),f=nk(n).or(Qj(n)),l=o.shared.header,d=l.isPositionedAtTop,m=fk(n),g=m===Px.sliding||m===Px.floating,p=Ge(!1),v=function(){return p.get()&&!n.removed},h=function(n){return g?n.fold((function(){return 0}),(function(n){return n.components().length>1?oc(n.components()[1].element()):0})):0},b=function(e){switch(mk(n)){case sk.auto:var o=_j.getToolbar(u),r=h(o),i=oc(e.element())-r,a=Pc(t),c=a.y>i;if(c)return"top";var s=Di(t),f=Math.max(s.dom().scrollHeight,oc(s)),l=a.bottom<f-i;if(l)return"bottom";var d=Nc(),m=d.bottom<a.bottom-i;return m?"bottom":"top";case sk.bottom:return"bottom";case sk.top:default:return"top"}},y=function(n){var t=r.get();SL.setModes(t,[n]),l.setDockingMode(n);var e=d()?ts.TopToBottom:ts.BottomToTop;ru(t.element(),yl,e)},x=function(){var n=f.getOrThunk((function(){var n=Yj(Ma(Oa(),"margin-left")).getOr(0);return gc(Oa())-fc(t).left()+n}));Ba(r.get().element(),"max-width",n+"px")},w=function(){var n=_j.getToolbar(u),e=h(n),o=Pc(t),i=d()?Math.max(o.y-oc(r.get().element())+e,0):o.bottom;Da(u.element(),{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})},S=function(){i.broadcastOn([Ym()],{})},k=function(n){if(void 0===n&&(n=!1),v()){if(c||x(),g&&_j.refreshToolbar(u),c||w(),s){var t=r.get();n?SL.reset(t):SL.refresh(t)}S()}},C=function(n){if(void 0===n&&(n=!0),!c&&s&&v()){var t=l.getDockingMode(),e=b(r.get());e!==t&&(y(e),n&&k(!0))}},O=function(){p.set(!0),Ba(u.element(),"display","flex"),a.addClass(n.getBody(),"mce-edit-focus"),Ha(i.element(),"display"),C(!1),k()},_=function(){p.set(!1),e.outerContainer&&(Ba(u.element(),"display","none"),a.removeClass(n.getBody(),"mce-edit-focus")),Ba(i.element(),"display","none")};return{isVisible:v,isPositionedAtTop:d,show:O,hide:_,update:k,updateMode:C,repositionPopups:S}},tU=function(n,t){var e=Pc(n);return{pos:t?e.y:e.bottom,bounds:e}},eU=function(n,t,e){var o=Ge(tU(t,e.isPositionedAtTop())),r=function(r){var i=tU(t,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=o.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;o.set({pos:u,bounds:a}),l&&zC(n,r),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};n.on("activate",e.show),n.on("deactivate",e.hide),n.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),n.on("NodeChange keydown",(function(n){_x.requestAnimationFrame((function(){return r(n)}))})),n.on("ScrollWindow",(function(){return e.updateMode()}));var i=Gj();i.set(YO($e.fromDom(n.getBody()),"load",r)),n.on("remove",(function(){i.clear()}))},oU=function(n,t,e,o,r){var i=t.mothership,u=t.uiMothership,a=t.outerContainer,c=Ge(null),s=$e.fromDom(r.targetNode),f=nU(n,s,t,o,c);Vj(n);var l=function(){if(c.get())f.show();else{c.set(_j.getHeader(a).getOrDie());var r=bk(n);Sm(r,i),Sm(r,u),Hj(n,t,e,o),_j.setMenubar(a,Aj(n,e)),f.show(),eU(n,s,f),n.nodeChanged()}};return n.on("focus",l),n.on("blur hide",f.hide),n.on("init",(function(){n.hasFocus()&&l()})),Ok(n,t),{editorContainer:a.element().dom()}},rU=Object.freeze({__proto__:null,render:oU}),iU=function(n){var t=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];$F.each(t,(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:aN(n,t.name)})}));var e={name:"alignnone",text:"No alignment",cmd:"JustifyNone",icon:"align-none"};n.ui.registry.addButton(e.name,{tooltip:e.text,onAction:function(){return n.execCommand(e.cmd)},icon:e.icon})},uU=function(n,t){return function(){n.execCommand("mceToggleFormat",!1,t)}},aU=function(n){$F.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,e){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:aN(n,t.name),onAction:uU(n,t.name)})}));for(var t=1;t<=6;t++){var e="h"+t;n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:aN(n,e),onAction:uU(n,e)})}},cU=function(n){$F.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}))},sU=function(n){$F.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)},onSetup:aN(n,t.name)})}))},fU=function(n){aU(n),cU(n),sU(n)},lU=function(n){$F.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:uU(n,"code")})},dU=function(n){fU(n),lU(n)},mU=function(n,t,e){var o=function(){return!!t.undoManager&&t.undoManager[e]()},r=function(){n.setDisabled(t.mode.isReadOnly()||!o())};return n.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},gU=function(n){n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return mU(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return mU(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},pU=function(n){n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return mU(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return mU(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},vU=function(n){gU(n),pU(n)},hU=function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}},bU=function(n){n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return hU(t,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})},yU=function(n){n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}})},xU=function(n){yU(n),bU(n)},wU=function(n,t){n.setDisabled(!t.queryCommandState("outdent"));var e=function(){n.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}},SU=function(n){n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return wU(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})},kU=function(n){SU(n)},CU=function(n,t){Uz(n,t),Jz(n,t),pN(n,t),dN(n,t),rN(n,t)},OU=function(n,t){iU(n),dU(n),CU(n,t),vU(n),eO(n),xU(n),kU(n)},_U=function(n,t){return{anchor:"makeshift",x:n,y:t}},TU=function(n,t,e){return _U(n.x+t,n.y+e)},EU=function(n){return"longpress"===n.type||0===n.type.indexOf("touch")},BU=function(n){if(EU(n)){var t=n.touches[0];return _U(t.pageX,t.pageY)}return _U(n.pageX,n.pageY)},DU=function(n){if(EU(n)){var t=n.touches[0];return _U(t.clientX,t.clientY)}return _U(n.clientX,n.clientY)},AU=function(n,t){var e=GS.DOM.getPos(n);return TU(t,e.x,e.y)},MU=function(n,t){return"contextmenu"===t.type||"longpress"===t.type?n.inline?BU(t):AU(n.getContentAreaContainer(),DU(t)):FU(n)},FU=function(n){return{anchor:"selection",root:$e.fromDom(n.selection.getNode())}},IU=function(n){return{anchor:"node",node:w.some($e.fromDom(n.selection.getNode())),root:$e.fromDom(n.getBody())}},RU=function(n,t,e){return e?IU(n):MU(n,t)},VU=function(n,t,e,o,r,i){var u=e(),a=RU(n,t,i);uF(u,Rk.CLOSE_ON_EXECUTE,o,!1).map((function(n){t.preventDefault(),gx.showMenuAt(r,a,{menu:{markers:iO("normal")},data:n})}))},HU={onLtr:function(){return[nf,Ks,Js,$s,Qs,Zs,Cx,Ox,Sx,xx,kx,wx]},onRtl:function(){return[nf,Js,Ks,Qs,$s,Zs,Cx,Ox,kx,wx,Sx,xx]}},PU=12,zU={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},NU=function(n,t){var e=n.selection;if(e.isCollapsed()||t.touches.length<1)return!1;var o=t.touches[0],r=e.getRng(),i=wd(n.getWin(),Xl.domRange(r));return i.exists((function(n){return n.left()<=o.clientX&&n.right()>=o.clientX&&n.top()<=o.clientY&&n.bottom()>=o.clientY}))},LU=function(n,t,e){var o=t?IU(n):MU(n,e);return m({bubble:gl(0,PU,zU),layouts:HU,overrides:{maxWidthFunction:HV(),maxHeightFunction:sl()}},o)},jU=function(n){var t=n.selection.getRng(),e=function(){_x.setEditorTimeout(n,(function(){n.selection.setRng(t)}),10),i()};n.once("touchend",e);var o=function(n){n.preventDefault(),n.stopImmediatePropagation()};n.on("mousedown",o,!0);var r=function(){return i()};n.once("longpresscancel",r);var i=function(){n.off("touchend",e),n.off("longpresscancel",r),n.off("mousedown",o)}},UU=function(n,t,e,o,r,i,u){var a=LU(n,i,t);uF(e,Rk.CLOSE_ON_EXECUTE,o,!0).map((function(e){t.preventDefault(),gx.showMenuWithinBounds(r,a,{menu:{markers:iO("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return w.some(yz(n,o.shared))})),n.fire(zV)}))},WU=function(n,t,e,o,r,i){var u=Xo(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){return!(s||a||c&&f)},d=function(){var u=e();UU(n,t,u,o,r,i,l())};if(!c&&!a||i)s&&!i&&n.selection.setCursorLocation(t.target,0),d();else{var m=function(){jU(n),d()};NU(n,t)?m():(n.once("selectionchange",m),n.once("touchend",(function(){return n.off("selectionchange",m)})))}},GU=function(n){return"string"===typeof n?n.split(/[ ,]/):n},XU=function(n){return n.settings.contextmenu_never_use_native||!1},YU=function(n,t,e){var o=n.ui.registry.getAll().contextMenus;return Tn(n.settings,t).map(GU).getOrThunk((function(){return $(GU(e),(function(n){return En(o,n)}))}))},qU=function(n){return!1===n.getParam("contextmenu")},KU=function(n){return YU(n,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},JU=function(n){return D(n)?"|"===n:"separator"===n.type},$U={type:"separator"},QU=function(n){if(D(n))return n;switch(n.type){case"separator":return $U;case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var t=n.getSubmenuItems();return D(t)?t:Y(t,QU)}};default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:o(n.onAction)}}},ZU=function(n,t){if(0===t.length)return n;var e=mn(n).filter((function(n){return!JU(n)})),o=e.fold((function(){return[]}),(function(n){return[$U]}));return n.concat(o).concat(t).concat([$U])},nW=function(n,t,e){var o=Z(t,(function(t,o){if(En(n,o)){var r=n[o].update(e);if(D(r))return ZU(t,r.split(" "));if(r.length>0){var i=Y(r,QU);return ZU(t,i)}return t}return t.concat([o])}),[]);return o.length>0&&JU(o[o.length-1])&&o.pop(),o},tW=function(n,t){return t.ctrlKey&&!XU(n)},eW=function(n,t){return"longpress"!==t.type&&(2!==t.button||t.target===n.getBody()&&""===t.pointerType)},oW=function(n,t,e){var o=Xo(),r=o.deviceType.isTouch,i=Za(gx.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return n.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:hf([ny("dismissContextMenu",[pi($r(),(function(t,e){Gm.close(t),n.focus()}))])])})),u=function(n){return gx.hide(i)},a=function(t){if(XU(n)&&t.preventDefault(),!tW(n,t)&&!qU(n)){var o=eW(n,t),u=function(){var e=o?n.selection.getStart(!0):t.target,r=n.ui.registry.getAll(),i=KU(n);return nW(r.contextMenus,i,e)},a=r()?WU:VU;a(n,t,u,e,i,o)}};n.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");n.on(t,u),n.on("longpress contextmenu",a)}))},rW=An.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),iW=function(n){return function(t){return t.translate(-n.left(),-n.top())}},uW=function(n){return function(t){return t.translate(n.left(),n.top())}},aW=function(n){return function(t,e){return Z(n,(function(n,t){return t(n)}),ac(t,e))}},cW=function(n,t,e){return n.fold(aW([uW(e),iW(t)]),aW([iW(t)]),aW([]))},sW=function(n,t,e){return n.fold(aW([uW(e)]),aW([]),aW([uW(t)]))},fW=function(n,t,e){return n.fold(aW([]),aW([iW(e)]),aW([uW(t),iW(e)]))},lW=function(n,t,e,o,r,i){var u=sW(n,r,i),a=sW(t,r,i);return Math.abs(u.left()-a.left())<=e&&Math.abs(u.top()-a.top())<=o},dW=function(n,t,e,o,r,i){var u=sW(n,r,i),a=sW(t,r,i),c=Math.abs(u.left()-a.left()),s=Math.abs(u.top()-a.top());return ac(c,s)},mW=function(n,t,e){var o=n.fold((function(n,t){return{position:w.some("absolute"),left:w.some(n+"px"),top:w.some(t+"px")}}),(function(n,t){return{position:w.some("absolute"),left:w.some(n-e.left()+"px"),top:w.some(t-e.top()+"px")}}),(function(n,t){return{position:w.some("fixed"),left:w.some(n+"px"),top:w.some(t+"px")}}));return m({right:w.none(),bottom:w.none()},o)},gW=function(n,t,e){return n.fold((function(n,o){return vW(n+t,o+e)}),(function(n,o){return hW(n+t,o+e)}),(function(n,o){return bW(n+t,o+e)}))},pW=function(n,t,e,o){var r=function(n,r){return function(i,u){var a=n(t,e,o);return r(i.getOr(a.left()),u.getOr(a.top()))}};return n.fold(r(fW,vW),r(sW,hW),r(cW,bW))},vW=rW.offset,hW=rW.absolute,bW=rW.fixed,yW=function(n,t){var e=uu(n,t);return I(e)?NaN:parseInt(e,10)},xW=function(n,t){var e=n.element(),o=yW(e,t.leftAttr),r=yW(e,t.topAttr);return isNaN(o)||isNaN(r)?w.none():w.some(ac(o,r))},wW=function(n,t,e){var o=n.element();ru(o,t.leftAttr,e.left()+"px"),ru(o,t.topAttr,e.top()+"px")},SW=function(n,t){var e=n.element();su(e,t.leftAttr),su(e,t.topAttr)},kW=function(n,t,e,o){return xW(n,t).fold((function(){return e}),(function(n){return bW(n.left()+o.left(),n.top()+o.top())}))},CW=function(n,t,e,o,r,i){var u=kW(n,t,e,o),a=t.mustSnap?TW(n,t,u,r,i):EW(n,t,u,r,i),c=cW(u,r,i);return wW(n,t,c),a.fold((function(){return{coord:bW(c.left(),c.top()),extra:w.none()}}),(function(n){return{coord:n.output,extra:n.extra}}))},OW=function(n,t){SW(n,t)},_W=function(n,t,e,o){return pn(n,(function(n){var r=n.sensor,i=lW(t,r,n.range.left(),n.range.top(),e,o);return i?w.some({output:pW(n.output,t,e,o),extra:n.extra}):w.none()}))},TW=function(n,t,e,o,r){var i=t.getSnapPoints(n),u=_W(i,e,o,r);return u.orThunk((function(){var n=Z(i,(function(n,t){var i=t.sensor,u=dW(e,i,t.range.left(),t.range.top(),o,r);return n.deltas.fold((function(){return{deltas:w.some(u),snap:w.some(t)}}),(function(e){var o=(u.left()+u.top())/2,r=(e.left()+e.top())/2;return o<=r?{deltas:w.some(u),snap:w.some(t)}:n}))}),{deltas:w.none(),snap:w.none()});return n.snap.map((function(n){return{output:pW(n.output,e,o,r),extra:n.extra}}))}))},EW=function(n,t,e,o,r){var i=t.getSnapPoints(n);return _W(i,e,o,r)},BW=function(n,t,e){return{coord:pW(n.output,n.output,t,e),extra:n.extra}},DW=function(n,t,e,o){var r=t.getTarget(n.element());if(t.repositionTarget){var i=Bi(n.element()),u=Cc(i),a=GN(r),c=BW(o,u,a),s=mW(c.coord,u,a);Aa(r,s)}},AW=Object.freeze({__proto__:null,snapTo:DW}),MW="data-initial-z-index",FW=function(n){Mi(n.element()).filter(tu).each((function(n){au(n,MW).fold((function(){return Ha(n,"z-index")}),(function(t){return Ba(n,"z-index",t)})),su(n,MW)}))},IW=function(n){Mi(n.element()).filter(tu).each((function(t){Ia(t,"z-index").each((function(n){ru(t,MW,n)})),Ba(t,"z-index",Ma(n.element(),"z-index"))}))},RW=function(n,t){n.getSystem().addToGui(t),IW(t)},VW=function(n){FW(n),n.getSystem().removeFromGui(n)},HW=function(n,t,e){return n.getSystem().build(k_.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:e}))},PW=Me("snaps",[pe("getSnapPoints"),bs("onSensor"),pe("leftAttr"),pe("topAttr"),Ie("lazyViewport",Nc),Ie("mustSnap",!1)]),zW=[Ie("useFixed",f),pe("blockerClass"),Ie("getTarget",u),Ie("onDrag",e),Ie("repositionTarget",!0),Ie("onDrop",e),Ne("getBounds",Nc),PW],NW=function(n){return Gp(Ia(n,"left"),Ia(n,"top"),Ia(n,"position"),(function(n,t,e){var o="fixed"===e?bW:vW;return o(parseInt(n,10),parseInt(t,10))})).getOrThunk((function(){var t=fc(n);return hW(t.left(),t.top())}))},LW=function(n,t,e,o,r){var i=r.bounds,u=sW(t,e,o),a=Jf(u.left(),i.x,i.x+i.width-r.width),c=Jf(u.top(),i.y,i.y+i.height-r.height),s=hW(a,c);return t.fold((function(){var n=fW(s,e,o);return vW(n.left(),n.top())}),(function(){return s}),(function(){var n=cW(s,e,o);return bW(n.left(),n.top())}))},jW=function(n,t,e,o,r,i,u){var a=t.fold((function(){var n=gW(e,i.left(),i.top()),t=cW(n,o,r);return bW(t.left(),t.top())}),(function(t){var u=CW(n,t,e,i,o,r);return u.extra.each((function(e){t.onSensor(n,e)})),u.coord}));return LW(n,a,o,r,u)},UW=function(n,t,e,o){var r=t.getTarget(n.element());if(t.repositionTarget){var i=Bi(n.element()),u=Cc(i),a=GN(r),c=NW(r),s=jW(n,t.snaps,c,u,a,o,e),f=mW(s,u,a);Aa(r,f)}t.onDrag(n,r,o)},WW=function(n,t){return{bounds:n.getBounds(),height:rc(t.element()),width:pc(t.element())}},GW=function(n,t,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return WW(t,n)}));i.each((function(e){UW(n,t,u,e)}))},XW=function(n,t,e,o){t.each(VW),e.snaps.each((function(t){OW(n,t)}));var r=e.getTarget(n.element());o.reset(),e.onDrop(n,r)},YW=function(n){return function(t,e){var o=function(n){e.setStartData(WW(t,n))};return li(p([pi(Yr(),(function(n){e.getStartData().each((function(){return o(n)}))}))],n(t,e,o)))}},qW=function(n){return li([pi(yr(),n.forceDrop),pi(Sr(),n.drop),pi(xr(),(function(t,e){n.move(e.event())})),pi(wr(),n.delayDrop)])},KW=function(n){return w.from(ac(n.x(),n.y()))},JW=function(n,t){return ac(t.left()-n.left(),t.top()-n.top())},$W=Object.freeze({__proto__:null,getData:KW,getDelta:JW}),QW=function(n,t,e){return[pi(yr(),(function(o,r){var i=r.event().raw();if(0===i.button){r.stop();var u=function(){return XW(o,w.some(s),n,t)},a=JO(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(e){a.cancel(),GW(o,n,t,$W,e)}},s=HW(o,n.blockerClass,qW(c)),f=function(){e(o),RW(o,s)};f()}}))]},ZW=p(zW,[Ss("dragger",{handlers:YW(QW)})]),nG=function(n){return li([pi(pr(),n.forceDrop),pi(hr(),n.drop),pi(br(),n.drop),pi(vr(),(function(t,e){n.move(e.event())}))])},tG=function(n){var t=n[0];return w.some(ac(t.clientX,t.clientY))},eG=function(n){var t=n.raw(),e=t.touches;return 1===e.length?tG(e):w.none()},oG=function(n,t){return ac(t.left()-n.left(),t.top()-n.top())},rG=Object.freeze({__proto__:null,getData:eG,getDelta:oG}),iG=function(n,t,e){var o=Ge(w.none());return[pi(pr(),(function(r,i){i.stop();var u=function(){XW(r,o.get(),n,t),o.set(w.none())},a={drop:u,delayDrop:function(){},forceDrop:u,move:function(e){GW(r,n,t,rG,e)}},c=HW(r,n.blockerClass,nG(a));o.set(w.some(c));var s=function(){e(r),RW(r,c)};s()})),pi(vr(),(function(e,o){o.stop(),GW(e,n,t,rG,o.event())})),pi(hr(),(function(e,r){r.stop(),XW(e,o.get(),n,t),o.set(w.none())})),pi(br(),(function(e){XW(e,o.get(),n,t),o.set(w.none())}))]},uG=p(zW,[Ss("dragger",{handlers:YW(iG)})]),aG=function(n,t,e){return p(QW(n,t,e),iG(n,t,e))},cG=p(zW,[Ss("dragger",{handlers:YW(aG)})]),sG=ZW,fG=uG,lG=cG,dG=Object.freeze({__proto__:null,mouse:sG,touch:fG,mouseOrTouch:lG}),mG=function(){var n=w.none(),t=w.none(),e=function(){n=w.none(),t=w.none()},o=function(t,e){var o=n.map((function(n){return t.getDelta(n,e)}));return n=w.some(e),o},r=function(n,t){return n.getData(t).bind((function(t){return o(n,t)}))},u=function(n){t=w.some(n)},a=function(){return t},c=i({});return zu({readState:c,reset:e,update:r,getStartData:a,setStartData:u})},gG=Object.freeze({__proto__:null,init:mG}),pG=wf({branchKey:"mode",branches:dG,name:"dragging",active:{events:function(n,t){var e=n.dragger;return e.handlers(n,t)}},extra:{snap:function(n){return{sensor:n.sensor,range:n.range,output:n.output,extra:w.from(n.extra)}}},state:gG,apis:AW}),vG=40,hG=vG/2,bG=function(n,t,e,o,r,i){return n.fold((function(){return pG.snap({sensor:hW(e-hG,o-hG),range:ac(r,i),output:hW(w.some(e),w.some(o)),extra:{td:t}})}),(function(n){var r=e-hG,i=o-hG,u=vG,a=vG,c=n.element().dom().getBoundingClientRect();return pG.snap({sensor:hW(r,i),range:ac(u,a),output:hW(w.some(e-c.width/2),w.some(o-c.height/2)),extra:{td:t}})}))},yG=function(n,t,e){var o=function(n,t){return n.exists((function(n){return er(n,t)}))};return{getSnapPoints:n,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(n,r){var i=r.td;o(t.get(),i)||(t.set(w.some(i)),e(i))},mustSnap:!0}},xG=function(n){return Bx(Ex.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:hf([pG.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:n}),ZT.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},wG=function(n,t){var e=Ge([]),o=Ge([]),r=Ge(!1),i=Ge(w.none()),u=Ge(w.none()),a=function(n){var e=zc(n);return bG(m.getOpt(t),n,e.x,e.y,e.width,e.height)},c=function(){return Y(e.get(),(function(n){return a(n)}))},s=function(n){var e=zc(n);return bG(g.getOpt(t),n,e.right,e.bottom,e.width,e.height)},f=function(){return Y(o.get(),(function(n){return s(n)}))},l=yG(c,i,(function(t){u.get().each((function(e){n.fire("TableSelectorChange",{start:t,finish:e})}))})),d=yG(f,u,(function(t){i.get().each((function(e){n.fire("TableSelectorChange",{start:e,finish:t})}))})),m=xG(l),g=xG(d),p=Za(m.asSpec()),v=Za(g.asSpec()),h=function(t,e,o,r){var i=e.dom().getBoundingClientRect();Ha(t.element(),"display");var u=Ai($e.fromDom(n.getBody())).dom().innerHeight,a=o(i),c=r(i,u);(a||c)&&Ba(t.element(),"display","none")},b=function(n,t,e,o){var r=e(t);pG.snapTo(n,r);var i=function(n){return n[o]<0},u=function(n,t){return n[o]>t};h(n,t,i,u)},y=function(n){return b(p,n,a,"top")},x=function(){return i.get().each(y)},S=function(n){return b(v,n,s,"bottom")},k=function(){return u.get().each(S)};Xo().deviceType.isTouch()&&(n.on("TableSelectionChange",(function(n){r.get()||(hm(t,p),hm(t,v),r.set(!0)),i.set(w.some(n.start)),u.set(w.some(n.finish)),n.otherCells.each((function(t){e.set(t.upOrLeftCells),o.set(t.downOrRightCells),y(n.start),S(n.finish)}))})),n.on("ResizeEditor ResizeWindow ScrollContent",(function(){x(),k()})),n.on("TableSelectionClear",(function(){r.get()&&(xm(p),xm(v),r.set(!1)),i.set(w.none()),u.set(w.none())})))};(function(n){n[n["None"]=0]="None",n[n["Both"]=1]="Both",n[n["Vertical"]=2]="Vertical"})(Hz||(Hz={}));var SG=function(n,t,e,o,r){var i={};return i.height=Kj(o+t.top(),ZS(n),tk(n)),e===Hz.Both&&(i.width=Kj(r+t.left(),QS(n),nk(n))),i},kG=function(n,t,e){var o=$e.fromDom(n.getContainer()),r=SG(n,t,e,oc(o),gc(o));bn(r,(function(n,t){return Ba(o,t,qj(n))})),PC(n)},CG=function(n){if(1===n.nodeType){if("BR"===n.nodeName||n.getAttribute("data-mce-bogus"))return!0;if("bookmark"===n.getAttribute("data-mce-type"))return!0}return!1},OG=function(n,t,e){t.delimiter||(t.delimiter="");var o=function(o){var r=o||[],i=Y(r,(function(t,o){return Ex.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:t.name},action:function(e){n.focus(),n.selection.select(t.element),n.nodeChanged()},buttonBehaviours:hf([Ak.button(e.isReadOnly),_k()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}};return Z(i.slice(1),(function(n,t){var e=n;return e.push(u),e.push(t),e}),[i[0]])},r=function(t){var e=[],o=t.length;while(o-- >0){var r=t[o];if(1===r.nodeType&&!CG(r)){var i=n.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:hf([jb.config({mode:"flow",selector:"div[role=button]"}),WS.config({disabled:e.isReadOnly}),_k(),yT.config({}),Qb.config({}),ny("elementPathEvents",[Oi((function(t,e){n.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return jb.focusIn(t)})),n.on("NodeChange",(function(n){var e=r(n.parents);e.length>0?Qb.set(t,o(e)):Qb.set(t,[])}))}))])]),components:[]}},_G=function(n,t){var e=function(n,e,o){return Qb.set(n,[Ja(t.translate(["{0} "+o,e[o]]))])};return Ex.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:hf([Ak.button(t.isReadOnly),_k(),yT.config({}),Qb.config({}),Tg.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),ny("wordcount-events",[Ei((function(n){var t=Tg.getValue(n),o="words"===t.mode?"characters":"words";Tg.setValue(n,{mode:o,count:t.count}),e(n,t.count,o)})),Oi((function(t){n.on("wordCountUpdate",(function(n){var o=Tg.getValue(t).mode;Tg.setValue(t,{mode:o,count:n.wordCount}),e(t,n.wordCount,o)}))}))])]),eventOrder:{"alloy.execute":["disabling","alloy.base.behaviour","wordcount-events"]}})},TG=function(n,t){var e=function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:Ax("resize-handle",t.icons)},behaviours:hf([pG.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,o,r){kG(n,r,e)},blockerClass:"tox-blocker"})])}},o=function(){var n=Jw.translate(["Powered by {0}","Tiny"]),t='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+n+'">'+n+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:t}}},r=function(n){var t=!Fo(n.settings.plugins,"autoresize"),e=n.getParam("resize",t);return!1===e?Hz.None:"both"===e?Hz.Both:Hz.Vertical},i=function(){var e=[];return n.getParam("elementpath",!0,"boolean")&&e.push(OG(n,{},t)),Fo(n.settings.plugins,"wordcount")&&e.push(_G(n,t)),n.getParam("branding",!0,"boolean")&&e.push(o()),e.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]},u=function(){var t=i(),o=r(n);return o!==Hz.None&&t.push(e(o)),t};return{dom:{tag:"div",classes:["tox-statusbar"]},components:u()}},EG=function(n){var t,e=n.inline,o=e?rU:Uj,r=xk(n)?HL:LL,i=w.none(),u=Xo(),a=u.browser.isIE(),c=a?["tox-platform-ie"]:[],s=u.deviceType.isTouch(),f="tox-platform-touch",l=s?[f]:[],d=gk(n),g=Jw.isRtl()?{attributes:{dir:"rtl"}}:{},p={attributes:(t={},t[yl]=d?ts.BottomToTop:ts.TopToBottom,t)},v=function(){return i.bind(_j.getHeader)},h=function(){return r.isDocked(v)},b=Za({dom:m({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(c).concat(l)},g),behaviours:hf([lm.config({useFixed:function(){return h()}})])}),y=function(){return O.value(b)},x=Bx({dom:{tag:"div",classes:["tox-anchorbar"]}}),S=function(){return i.bind((function(n){return x.getOpt(n)})).getOrDie("Could not find a anchor bar element")},k=function(){return i.bind((function(n){return _j.getToolbar(n)})).getOrDie("Could not find more toolbar element")},C=function(){return i.bind((function(n){return _j.getThrobber(n)})).getOrDie("Could not find throbber element")},_=VV(b,n,S),T=_j.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:_,onEscape:function(){n.focus()}}),E=fk(n),B=_j.parts().toolbar(m({dom:{tag:"div",classes:["tox-toolbar"]},getSink:y,providers:_.shared.providers,onEscape:function(){n.focus()},type:E,lazyToolbar:k,lazyHeader:function(){return v().getOrDie("Could not find header element")}},p)),D=_j.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:_.shared.providers,onEscape:function(){},type:E}),A=_j.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),M=_j.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),F=_j.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:_}),I=n.getParam("statusbar",!0,"boolean"),R=I&&!e?w.some(TG(n,_.shared.providers)):w.none(),V={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[A,M]},H=ck(n),P=uk(n),z=ik(n),N=function(){return H?[D]:P?[B]:[]},L=_j.parts().header({dom:m({tag:"div",classes:["tox-editor-header"]},p),components:on([z?[T]:[],N(),hk(n)?[]:[x.asSpec()]]),sticky:xk(n),editor:n,sharedBackstage:_.shared}),j=on([d?[]:[L],e?[]:[V],d?[L]:[]]),U={dom:{tag:"div",classes:["tox-editor-container"]},components:j},W=on([[U],e?[]:R.toArray(),[F]]),G=yk(n),X=m(m({role:"application"},Jw.isRtl()?{dir:"rtl"}:{}),G?{"aria-hidden":"true"}:{}),Y=Za(_j.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(c),styles:m({visibility:"hidden"},G?{opacity:"0",border:"0"}:{}),attributes:X},components:W,behaviours:hf([jb.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));i=w.some(Y),n.shortcuts.add("alt+F9","focus menubar",(function(){_j.focusMenubar(Y)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){_j.focusToolbar(Y)}));var q=C_(Y),K=C_(b);IN(n,q,K);var J=function(){var n={broadcastAll:K.broadcast,broadcastOn:K.broadcastOn,register:function(){}};return{channels:n}},$=function(){var t=qj($j(n)),e=qj(Zj(n));return n.inline||(Va("div","width",e)&&Ba(Y.element(),"width",e),Va("div","height",t)?Ba(Y.element(),"height",t):Ba(Y.element(),"height","200px")),t},Q=function(){r.setup(n,_.shared,v),OU(n,_),oW(n,y,_),nj(n),vj(n,C,_.shared),yn(dk(n),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}));var t=n.ui.registry.getAll(),e=t.buttons,i=t.menuItems,u=t.contextToolbars,a=t.sidebars,c=ak(n),s={menuItems:i,menus:n.settings.menu?yn(n.settings.menu,(function(n){return m(m({},n),{items:n.items})})):{},menubar:n.settings.menubar,toolbar:c.getOrThunk((function(){return n.getParam("toolbar",!0)})),allowToolbarGroups:E===Px.floating,buttons:e,sidebar:a};FN(n,u,b,{backstage:_}),wG(n,b);var f=n.getElement(),l=$(),d={mothership:q,uiMothership:K,outerContainer:Y},g={targetNode:f,height:l};return o.render(n,d,s,_,g)};return{mothership:q,uiMothership:K,backstage:_,renderUI:Q,getUi:J}},BG=function(n,t){var e=w.from(uu(n,"id")).fold((function(){var n=bu("dialog-describe");return ru(t,"id",n),n}),u);ru(n,"aria-describedby",e)},DG=function(n,t){var e=w.from(uu(n,"id")).fold((function(){var n=bu("dialog-label");return ru(t,"id",n),n}),u);ru(n,"aria-labelledby",e)},AG=i([pe("lazySink"),_e("dragBlockClass"),Ne("getBounds",Nc),Ie("useTabstopAt",i(!0)),Ie("eventOrder",{}),Eg("modalBehaviours",[jb]),ys("onExecute"),ws("onEscape")]),MG={sketch:u},FG=i([cp({name:"draghandle",overrides:function(n,t){return{behaviours:hf([pG.config({mode:"mouse",getTarget:function(n){return Yc(n,'[role="dialog"]').getOr(n)},blockerClass:n.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:n.getDragBounds})])}}}),up({schema:[pe("dom")],name:"title"}),up({factory:MG,schema:[pe("dom")],name:"close"}),up({factory:MG,schema:[pe("dom")],name:"body"}),cp({factory:MG,schema:[pe("dom")],name:"footer"}),ap({factory:{sketch:function(n,t){return m(m({},n),{dom:t.dom,components:t.components})}},schema:[Ie("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Ie("components",[])],name:"blocker"})]),IG=function(n,t,e,o){var r=bu("alloy.dialog.busy"),i=bu("alloy.dialog.idle"),u=hf([jb.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),sy.config({})]),a=function(t){var e=n.lazySink(t).getOrDie(),a=Ge(w.none()),c=o.blocker(),s=e.getSystem().build(m(m({},c),{components:c.components.concat([nc(t)]),behaviours:hf([sy.config({}),ny("dialog-blocker-events",[Ci(Cr(),(function(){jb.focusIn(t)})),pi(i,(function(n,e){cu(t.element(),"aria-busy")&&(su(t.element(),"aria-busy"),a.get().each((function(n){return Qb.remove(t,n)})))})),pi(r,(function(n,e){ru(t.element(),"aria-busy","true");var o=e.event().getBusySpec();a.get().each((function(n){Qb.remove(t,n)}));var r=o(t,u),i=n.getSystem().build(r);a.set(w.some(i)),Qb.append(t,nc(i)),i.hasConfigured(jb)&&jb.focusIn(i)}))])])}));hm(e,s),jb.focusIn(t)},c=function(n){Mi(n.element()).each((function(t){n.getSystem().getByDom(t).each((function(n){xm(n)}))}))},s=function(t){return Sp(t,n,"body")},f=function(t){return Sp(t,n,"footer")},l=function(n,t){ui(n,r,{getBusySpec:t})},d=function(n){ii(n,i)},g=bu("modal-events"),p=m(m({},n.eventOrder),{"alloy.system.attached":[g].concat(n.eventOrder["alloy.system.attached"]||[])});return{uid:n.uid,dom:n.dom,components:t,apis:{show:a,hide:c,getBody:s,getFooter:f,setIdle:d,setBusy:l},eventOrder:p,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Dg(n.modalBehaviours,[Qb.config({}),jb.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt}),ny(g,[Oi((function(t){DG(t.element(),Sp(t,n,"title").element()),BG(t.element(),Sp(t,n,"body").element())}))])])}},RG=Lp({name:"ModalDialog",configFields:AG(),partFields:FG(),factory:IG,apis:{show:function(n,t){n.show(t)},hide:function(n,t){n.hide(t)},getBody:function(n,t){return n.getBody(t)},getFooter:function(n,t){return n.getFooter(t)},setBusy:function(n,t,e){n.setBusy(t,e)},setIdle:function(n,t){n.setIdle(t)}}}),VG=[be("type"),be("text"),ye("level",["info","warn","error","success"]),be("icon"),Ie("url","")],HG=Ht(VG),PG=function(n){return[be("type"),n]},zG=[be("type"),be("text"),ze("disabled",!1),ze("primary",!1),Wt("name","name",tt((function(){return bu("button-name")})),se),Be("icon"),ze("borderless",!1)],NG=Ht(zG),LG=[be("type"),be("name"),be("label"),ze("disabled",!1)],jG=Ht(LG),UG=fe,WG=[be("type"),be("name")],GG=WG.concat([Be("label")]),XG=GG,YG=Ht(XG),qG=se,KG=GG,JG=Ht(KG),$G=se,QG=GG,ZG=Ht(QG),nX=Kt(),tX=function(n){return[be("type"),he("columns"),n]},eX=GG.concat([ze("sandboxed",!0)]),oX=Ht(eX),rX=se,iX=GG.concat([Be("inputMode"),Be("placeholder"),ze("maximized",!1),ze("disabled",!1)]),uX=Ht(iX),aX=se,cX=GG.concat([Ce("items",[be("text"),be("value")]),Ve("size",1),ze("disabled",!1)]),sX=Ht(cX),fX=se,lX=GG.concat([ze("constrain",!0),ze("disabled",!1)]),dX=Ht(lX),mX=Ht([be("width"),be("height")]),gX=GG.concat([Be("placeholder"),ze("maximized",!1),ze("disabled",!1)]),pX=Ht(gX),vX=se,hX=GG.concat([Pe("filetype","file",["image","media","file"]),Ie("disabled",!1)]),bX=Ht(hX),yX=Ht([be("value"),Ie("meta",{})]),xX=WG.concat([He("tag","textarea"),be("scriptId"),be("scriptUrl"),Le("settings",void 0)]),wX=WG.concat([He("tag","textarea"),we("init")]),SX=$t((function(n){return ne("customeditor.old",Vt(wX),n).orThunk((function(){return ne("customeditor.new",Vt(xX),n)}))})),kX=se,CX=[be("type"),be("html"),Pe("presets","presentation",["presentation","document"])],OX=Ht(CX),_X=GG.concat([ve("currentState",Ht([pe("blob"),be("url")]))]),TX=Ht(_X),EX=GG.concat([Ie("columns","auto")]),BX=Ht(EX),DX=qt([be("value"),be("text"),be("icon")]),AX=function(n){return[be("type"),be("label"),n]},MX=[be("type"),Oe("header",se),Oe("cells",Pt(se))],FX=Ht(MX),IX=function(n){return Wt("items","items",Zn(),Pt($t((function(t){return ne("Checking item of "+n,RX,t).fold((function(n){return O.error(oe(n))}),(function(n){return O.value(n)}))}))))},RX=Jt((function(){return re("type",{alertbanner:HG,bar:Ht(PG(IX("bar"))),button:NG,checkbox:jG,colorinput:YG,colorpicker:JG,dropzone:ZG,grid:Ht(tX(IX("grid"))),iframe:oX,input:uX,selectbox:sX,sizeinput:dX,textarea:pX,urlinput:bX,customeditor:SX,htmlpanel:OX,imagetools:TX,collection:BX,label:Ht(AX(IX("label"))),table:FX,panel:HX})})),VX=[be("type"),Ie("classes",[]),Oe("items",RX)],HX=Ht(VX),PX=[Wt("name","name",tt((function(){return bu("tab-name")})),se),be("title"),Oe("items",RX)],zX=[be("type"),Ce("tabs",PX)],NX=Ht(zX),LX=Ht([be("type"),be("name")].concat(Sw)),jX=fe,UX=[Wt("name","name",tt((function(){return bu("button-name")})),se),Be("icon"),Pe("align","end",["start","end"]),ze("primary",!1),ze("disabled",!1)],WX=p(UX,[be("text")]),GX=p([ye("type",["submit","cancel","custom"])],WX),XX=p([ye("type",["menu"]),Be("text"),Be("tooltip"),Be("icon"),Oe("items",LX)],UX),YX=ie("type",{submit:GX,cancel:GX,custom:GX,menu:XX}),qX=WX,KX=YX,JX=Ht([be("title"),ve("body",re("type",{panel:HX,tabpanel:NX})),He("size","normal"),Oe("buttons",KX),Ie("initialData",{}),Ne("onAction",e),Ne("onChange",e),Ne("onSubmit",e),Ne("onClose",e),Ne("onCancel",e),Ie("onTabChange",e)]),$X=function(n){return ne("dialog",JX,n)},QX=function(n){return A(n)?[n].concat(rn(_n(n),QX)):M(n)?rn(n,QX):[]},ZX=function(n){return D(n.type)&&D(n.name)},nY={checkbox:UG,colorinput:qG,colorpicker:$G,dropzone:nX,input:aX,iframe:rX,sizeinput:mX,selectbox:fX,size:mX,textarea:vX,urlinput:yX,customeditor:kX,collection:DX,togglemenuitem:jX},tY=function(n){return w.from(nY[n.type])},eY=function(n){return $(QX(n),ZX)},oY=function(n){var t=eY(n),e=rn(t,(function(n){return tY(n).fold((function(){return[]}),(function(t){return[ve(n.name,t)]}))}));return Ht(e)},rY=Ht(p([ye("type",["cancel","custom"])],qX)),iY=Ht([be("title"),be("url"),Ee("height"),Ee("width"),Ae("buttons",rY),Ne("onAction",e),Ne("onCancel",e),Ne("onClose",e),Ne("onMessage",e)]),uY=function(n){return ne("dialog",iY,n)},aY=function(n){var t=te($X(n)),e=oY(n),o=n.initialData;return{internalDialog:t,dataValidator:e,initialData:o}},cY={open:function(n,t){var e=aY(t);return n(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(n,t){var e=te(uY(t));return n(e)},redial:function(n){return aY(n)}},sY=function(n){var t=[],e={};return bn(n,(function(n,o){n.fold((function(){t.push(o)}),(function(n){e[o]=n}))})),t.length>0?O.error(t):O.value(e)},fY=function(n,e){var o=Bx(qD.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:Y(n.items,(function(n){return bR(t,n,e)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[o.asSpec()]}],behaviours:hf([jb.config({mode:"acyclic",useTabstopAt:c(AA)}),iA.memento(o),xA.memento(o,{postprocess:function(n){return sY(n).fold((function(n){return t.console.error(n),{}}),(function(n){return n}))}})])}},lY=function(n,t){return{uid:n.uid,dom:n.dom,components:n.components,events:Dy(n.action),behaviours:Dg(n.tabButtonBehaviours,[sy.config({}),jb.config({mode:"execution",useSpace:!0,useEnter:!0}),Tg.config({store:{mode:"memory",initialValue:n.value}})]),domModification:n.domModification}},dY=Np({name:"TabButton",configFields:[Ie("uid",void 0),pe("value"),Wt("dom","dom",et((function(){return{attributes:{role:"tab",id:bu("aria"),"aria-selected":"false"}}})),ue()),_e("action"),Ie("domModification",{}),Eg("tabButtonBehaviours",[sy,jb,Tg]),pe("view")],factory:lY}),mY=i([pe("tabs"),pe("dom"),Ie("clickToDismiss",!1),Eg("tabbarBehaviours",[vv,jb]),vs(["tabClass","selectedClass"])]),gY=sp({factory:dY,name:"tabs",unit:"tab",overrides:function(n){var t=function(n,t){vv.dehighlight(n,t),ui(n,ei(),{tabbar:n,button:t})},o=function(n,t){vv.highlight(n,t),ui(n,ti(),{tabbar:n,button:t})};return{action:function(r){var i=r.getSystem().getByUid(n.uid).getOrDie(),u=vv.isHighlighted(i,r),a=function(){return u&&n.clickToDismiss?t:u?e:o}();a(i,r)},domModification:{classes:[n.markers.tabClass]}}}}),pY=i([gY]),vY=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Dg(n.tabbarBehaviours,[vv.config({highlightClass:n.markers.selectedClass,itemClass:n.markers.tabClass,onHighlight:function(n,t){ru(t.element(),"aria-selected","true")},onDehighlight:function(n,t){ru(t.element(),"aria-selected","false")}}),jb.config({mode:"flow",getInitial:function(n){return vv.getHighlighted(n).map((function(n){return n.element()}))},selector:"."+n.markers.tabClass,executeOnMove:!0})])}},hY=Lp({name:"Tabbar",configFields:mY(),partFields:pY(),factory:vY}),bY=function(n,t){return{uid:n.uid,dom:n.dom,behaviours:Dg(n.tabviewBehaviours,[Qb.config({})]),domModification:{attributes:{role:"tabpanel"}}}},yY=Np({name:"Tabview",configFields:[Eg("tabviewBehaviours",[Qb])],factory:bY}),xY=i([Ie("selectFirst",!0),bs("onChangeTab"),bs("onDismissTab"),Ie("tabs",[]),Eg("tabSectionBehaviours",[])]),wY=up({factory:hY,schema:[pe("dom"),ke("markers",[pe("tabClass"),pe("selectedClass")])],name:"tabbar",defaults:function(n){return{tabs:n.tabs}}}),SY=up({factory:yY,name:"tabview"}),kY=i([wY,SY]),CY=function(n,t,e,o){var r=function(t){var e=Tg.getValue(t);wp(t,n,"tabview").each((function(o){var r=tn(n.tabs,(function(n){return n.value===e}));r.each((function(e){var r=e.view();au(t.element(),"id").each((function(n){ru(o.element(),"aria-labelledby",n)})),Qb.set(o,r),n.onChangeTab(o,t,r)}))}))},i=function(t,e){wp(t,n,"tabbar").each((function(n){e(n).each(ai)}))};return{uid:n.uid,dom:n.dom,components:t,behaviours:Bg(n.tabSectionBehaviours),events:li(on([n.selectFirst?[Oi((function(n,t){i(n,vv.getFirst)}))]:[],[pi(ti(),(function(n,t){var e=t.event().button();r(e)})),pi(ei(),(function(t,e){var o=e.event().button();n.onDismissTab(t,o)}))]])),apis:{getViewItems:function(t){return wp(t,n,"tabview").map((function(n){return Qb.contents(n)})).getOr([])},showTab:function(n,t){var e=function(n){var e=vv.getCandidates(n),o=tn(e,(function(n){return Tg.getValue(n)===t}));return o.filter((function(t){return!vv.isHighlighted(n,t)}))};i(n,e)}}}},OY=Lp({name:"TabSection",configFields:xY(),partFields:kY(),factory:CY,apis:{getViewItems:function(n,t){return n.getViewItems(t)},showTab:function(n,t,e){n.showTab(t,e)}}}),_Y=function(n,t,e){return Y(n,(function(o,r){Qb.set(e,n[r].view());var i=t.dom().getBoundingClientRect();return Qb.set(e,[]),i.height}))},TY=function(n){return dn(ln(n,(function(n,t){return n>t?-1:n<t?1:0})))},EY=function(n,e,o){var r,i=Di(n).dom(),u=Yc(n,".tox-dialog-wrap").getOr(n),a="fixed"===Ma(u,"position");r=a?Math.max(i.clientHeight,t.window.innerHeight):Math.max(i.offsetHeight,i.scrollHeight);var c=oc(e),s=e.dom().offsetLeft>=o.dom().offsetLeft+gc(o),f=s?Math.max(oc(o),c):c,l=parseInt(Ma(n,"margin-top"),10)||0,d=parseInt(Ma(n,"margin-bottom"),10)||0,m=oc(n)+l+d,g=m-f;return r-g},BY=function(n,t){dn(n).each((function(n){return OY.showTab(t,n.value)}))},DY=function(n,t){Ba(n,"height",t+"px"),Xo().browser.isIE()?Ha(n,"flex-basis"):Ba(n,"flex-basis",t+"px")},AY=function(n,t,e){Yc(n,'[role="dialog"]').each((function(n){qc(n,'[role="tablist"]').each((function(o){e.get().map((function(e){return Ba(t,"height","0"),Ba(t,"flex-basis","0"),Math.min(e,EY(n,t,o))})).each((function(n){DY(t,n)}))}))}))},MY=function(n){return qc(n,'[role="tabpanel"]')},FY=function(n){var t=function(){var t=Ge(w.none()),e=[Oi((function(e){var o=e.element();MY(o).each((function(r){Ba(r,"visibility","hidden"),e.getSystem().getByDom(r).toOption().each((function(e){var o=_Y(n,r,e),i=TY(o);t.set(i)})),AY(o,r,t),Ha(r,"visibility"),BY(n,e),_x.requestAnimationFrame((function(){AY(o,r,t)}))}))})),pi(qr(),(function(n){var e=n.element();MY(e).each((function(n){AY(e,n,t)}))})),pi(F_,(function(n,e){var o=n.element();MY(o).each((function(n){var e=Ff();Ba(n,"visibility","hidden");var r=Ia(n,"height").map((function(n){return parseInt(n,10)}));Ha(n,"height"),Ha(n,"flex-basis");var i=n.dom().getBoundingClientRect().height,u=r.forall((function(n){return i>n}));u?(t.set(w.from(i)),AY(o,n,t)):r.each((function(t){DY(n,t)})),Ha(n,"visibility"),e.each(Df)}))}))],o=!1;return{extraEvents:e,selectFirst:o}}(),e=function(){var n=[],t=!0;return{extraEvents:n,selectFirst:t}}();return{smartTabHeight:t,naiveTabHeight:e}},IY="send-data-to-section",RY="send-data-to-view",VY=function(n,t){var e=Ge({}),o=function(n){var t=Tg.getValue(n),o=sY(t).getOr({}),r=e.get(),i=Vn(r,o);e.set(i)},r=function(n){var t=e.get();Tg.setValue(n,t)},i=Ge(null),u=Y(n.tabs,(function(n){return{value:n.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(n.title)},view:function(){return[qD.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:Y(n.items,(function(n){return bR(e,n,t)})),formBehaviours:hf([jb.config({mode:"acyclic",useTabstopAt:c(AA)}),ny("TabView.form.events",[Oi(r),_i(o)]),Tf.config({channels:st([{key:IY,value:{onReceive:o}},{key:RY,value:{onReceive:r}}])})])}}))]}}})),a=FY(u).smartTabHeight;return OY.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(n,t,e){var o=Tg.getValue(t);ui(n,M_,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[OY.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[hY.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:hf([yT.config({})])}),OY.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:hf([ny("tabpanel",a.extraEvents),jb.config({mode:"acyclic"}),Jp.config({find:function(n){return dn(OY.getViewItems(n))}}),Tg.config({store:{mode:"manual",getValue:function(n){return n.getSystem().broadcastOn([IY],{}),e.get()},setValue:function(n,t){e.set(t),n.getSystem().broadcastOn([RY],{})}}})])})},HY=bu("update-dialog"),PY=bu("update-title"),zY=bu("update-body"),NY=bu("update-footer"),LY=bu("body-send-message"),jY=function(n,t,e,o){var r=function(n){switch(n.body.type){case"tabpanel":return[VY(n.body,e)];default:return[fY(n.body,e)]}},i=function(n,t){return w.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:m(m({},t.map((function(n){return{id:n}})).getOr({})),o?u:{})},components:[],behaviours:hf([iA.childAt(0),NP.config({channel:zY,updateState:i,renderComponents:r,initialData:n})])}},UY=function(n,t,e,o){return jY(n,w.some(t),e,o)},WY=function(n,t){var e=jY(n,w.none(),t,!1);return RG.parts().body(e)},GY=function(n){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[EA({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:hf([yT.config({}),sy.config({})])})]}],behaviours:hf([jb.config({mode:"acyclic",useTabstopAt:c(AA)})])};return RG.parts().body(t)},XY=lS.deviceType.isTouch(),YY=function(n,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[n,t]}},qY=function(n,t){return RG.parts().close(Ex.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:n,buttonBehaviours:hf([yT.config({})])}))},KY=function(){return RG.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},JY=function(n,t){return RG.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:dj("<p>"+t.translate(n)+"</p>")}]}]})},$Y=function(n){return RG.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:n})},QY=function(n,t){return[k_.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:n}),k_.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},ZY=function(n){var t,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return RG.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),w.some(!0)},useTabstopAt:function(n){return!AA(n)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:m({position:"relative"},n.extraStyles)},components:p([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:dj('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:XY?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:hf(p([sy.config({}),ny("dialog-events",n.dialogEvents.concat([Ci(Cr(),(function(n,t){jb.focusIn(n)}))])),ny("scroll-lock",[Oi((function(){ha(Oa(),i)})),_i((function(){ya(Oa(),i)}))])],n.extraBehaviours)),eventOrder:m((t={},t[Pr()]=["dialog-events"],t[Kr()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Jr()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},nq=function(n){return Ex.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close"),title:n.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(n){ii(n,T_)}})},tq=function(n,t,e){var o=function(n){return[Ja(e.translate(n.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:m({},t.map((function(n){return{id:n}})).getOr({}))},components:o(n),behaviours:hf([NP.config({channel:PY,renderComponents:o})])}},eq=function(){return{dom:dj('<div class="tox-dialog__draghandle"></div>')}},oq=function(n,t,e){return k_.sketch({dom:dj('<div class="tox-dialog__header"></div>'),components:[tq(n,w.some(t),e),eq(),nq(e)],containerBehaviours:hf([pG.config({mode:"mouse",blockerClass:"blocker",getTarget:function(n){return Kc(n,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},rq=function(n,t){var e=RG.parts().title(tq(n,w.none(),t)),o=RG.parts().draghandle(eq()),r=RG.parts().close(nq(t)),i=[e].concat(n.draggable?[o]:[]).concat([r]);return k_.sketch({dom:dj('<div class="tox-dialog__header"></div>'),components:i})},iq=function(n,t){return rq({title:t.shared.providers.translate(n),draggable:t.dialog.isDraggableModal()},t.shared.providers)},uq=function(n,t){return{onClose:function(){return t.closeWindow()},onBlock:function(t){RG.setBusy(n(),(function(n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":t.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:dj('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){RG.setIdle(n())}}},aq=function(n,t,e,o){var r,i=function(n,t){return w.some(t)};return Za(ZY(m(m({},n),{lazySink:o.shared.getSink,extraBehaviours:p([NP.config({channel:HY,updateState:i,initialData:t}),xA.memory({})],n.extraBehaviours),onEscape:function(n){ii(n,T_)},dialogEvents:e,eventOrder:(r={},r[Hr()]=["reflecting","receiving"],r[Kr()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],r[Jr()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],r)})))},cq=function(n){var t=function(n){var t=Y(n.items,(function(n){var t=Ge(!1);return m(m({},n),{storage:t})}));return m(m({},n),{items:t})};return Y(n,(function(n){return"menu"===n.type?t(n):n}))},sq=function(n){return Z(n,(function(n,t){if("menu"===t.type){var e=t;return Z(e.items,(function(n,t){return n[t.name]=t.storage,n}),n)}return n}),{})},fq=function(n,t){return[wi(Cr(),DA),n(__,(function(n,e){t.onClose(),e.onClose()})),n(T_,(function(n,t,e,o){t.onCancel(n),ii(o,__)})),pi(A_,(function(n,e){return t.onUnblock()})),pi(D_,(function(n,e){return t.onBlock(e.event())}))]},lq=function(n,t){var e=function(t,e){return pi(t,(function(t,r){o(t,(function(o,i){e(n(),o,r.event(),t)}))}))},o=function(n,t){NP.getState(n).get().each((function(e){t(e,n)}))};return p(fq(e,t),[e(E_,(function(n,t,e){t.onAction(n,{name:e.name()})}))])},dq=function(n,t,e){var o=function(t,e){return pi(t,(function(t,o){r(t,(function(r,i){e(n(),r,o.event(),t)}))}))},r=function(n,t){NP.getState(n).get().each((function(e){t(e.internalDialog,n)}))};return p(fq(o,t),[o(B_,(function(n,t){return t.onSubmit(n)})),o(O_,(function(n,t,e){t.onChange(n,{name:e.name()})})),o(E_,(function(n,t,o,r){var i=function(){return jb.focusIn(r)},u=function(n){return cu(n,"disabled")||au(n,"aria-disabled").exists((function(n){return"true"===n}))},a=Ff();t.onAction(n,{name:o.name(),value:o.value()}),Ff().fold(i,(function(n){u(n)||a.exists((function(t){return ir(n,t)&&u(t)}))?i():e().toOption().filter((function(t){return!ir(t.element(),n)})).each(i)}))})),o(M_,(function(n,t,e){t.onTabChange(n,{newTabName:e.name(),oldTabName:e.oldName()})})),_i((function(t){var e=n();Tg.setValue(t,e.getData())}))])},mq={initUrlDialog:lq,initDialog:dq},gq=function(n,t){return bF(n,n.type,t)},pq=function(n,t,e){return tn(t,(function(n){return n.name===e})).bind((function(t){return t.memento.getOpt(n)}))},vq=function(n,t){var e=t.map((function(n){return n.footerButtons})).getOr([]),o=J(e,(function(n){return"start"===n.align})),r=function(n,t){return k_.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+n]},components:Y(t,(function(n){return n.memento.asSpec()}))})},i=r("start",o.pass),u=r("end",o.fail);return[i,u]},hq=function(n,t){var e=function(n,e){var o=Y(e.buttons,(function(n){var e=Bx(gq(n,t));return{name:n.name,align:n.align,memento:e}})),r=function(n,t){return pq(n,o,t)};return w.some({lookupByName:r,footerButtons:o})};return{dom:dj('<div class="tox-dialog__footer"></div>'),components:[],behaviours:hf([NP.config({channel:NY,initialData:n,updateState:e,renderComponents:vq})])}},bq=function(n,t){return hq(n,t)},yq=function(n,t){return RG.parts().footer(hq(n,t))},xq=function(n,t){var e=n.getRoot();if(e.getSystem().isConnected()){var o=Jp.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return qD.getField(o,t).fold((function(){var e=n.getFooter(),r=NP.getState(e);return r.get().bind((function(n){return n.lookupByName(o,t)}))}),(function(n){return w.some(n)}))}return w.none()},wq=function(n,t){var e=n.getRoot();return NP.getState(e).get().map((function(n){return te(ne("data",n.dataValidator,t))})).getOr(t)},Sq=function(n,t,e){var o=function(t){var e=n.getRoot();e.getSystem().isConnected()&&t(e)},r=function(){var t=n.getRoot(),o=t.getSystem().isConnected()?n.getFormWrapper():t,r=Tg.getValue(o),i=yn(e,(function(n){return n.get()}));return m(m({},r),i)},i=function(t){o((function(o){var r=p.getData(),i=m(m({},r),t),u=wq(n,i),a=n.getFormWrapper();Tg.setValue(a,u),bn(e,(function(n,t){En(i,t)&&n.set(i[t])}))}))},u=function(t){xq(n,t).each(WS.disable)},a=function(t){xq(n,t).each(WS.enable)},c=function(t){xq(n,t).each(sy.focus)},s=function(n){if(!D(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(t){ui(t,D_,{message:n})}))},f=function(){o((function(n){ii(n,A_)}))},l=function(t){o((function(e){var o=n.getBody(),r=NP.getState(o);r.get().exists((function(n){return n.isTabPanel()}))&&Jp.getCurrent(o).each((function(n){OY.showTab(n,t)}))}))},d=function(n){o((function(e){var o=t(n);e.getSystem().broadcastOn([HY],o),e.getSystem().broadcastOn([PY],o.internalDialog),e.getSystem().broadcastOn([zY],o.internalDialog),e.getSystem().broadcastOn([NY],o.internalDialog),p.setData(o.initialData)}))},g=function(){o((function(n){ii(n,__)}))},p={getData:r,setData:i,disable:u,enable:a,focus:c,block:s,unblock:f,showTab:l,redial:d,close:g};return p},kq=function(n,t,e){var o=iq(n.internalDialog.title,e),r=WY({body:n.internalDialog.body},e),i=cq(n.internalDialog.buttons),u=sq(i),a=yq({buttons:i},e),c=mq.initDialog((function(){return m}),uq((function(){return l}),t),e.shared.getSink),s="normal"!==n.internalDialog.size?"large"===n.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],f={header:o,body:r,footer:w.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=aq(f,n,c,e),d=function(){var n=function(){var n=RG.getBody(l);return Jp.getCurrent(n).getOr(n)};return{getRoot:function(){return l},getBody:function(){return RG.getBody(l)},getFooter:function(){return RG.getFooter(l)},getFormWrapper:n}}(),m=Sq(d,t.redial,u);return{dialog:l,instanceApi:m}},Cq=function(n,t,e,o){var r,i,u=bu("dialog-label"),a=bu("dialog-content"),c=function(n,t){return w.some(t)},s=Bx(oq({title:n.internalDialog.title,draggable:!0},u,e.shared.providers)),f=Bx(UY({body:n.internalDialog.body},a,e,o)),l=cq(n.internalDialog.buttons),d=sq(l),m=Bx(bq({buttons:l},e)),g=mq.initDialog((function(){return v}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return t.closeWindow()}},e.shared.getSink),p=Za({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=u,r["aria-describedby"]=""+a,r)},eventOrder:(i={},i[Hr()]=[NP.name(),Tf.name()],i[Pr()]=["execute-on-form"],i[Kr()]=["reflecting","execute-on-form"],i),behaviours:hf([jb.config({mode:"cyclic",onEscape:function(n){return ii(n,__),w.some(!0)},useTabstopAt:function(n){return!AA(n)&&("button"!==Qi(n)||"disabled"!==uu(n,"disabled"))}}),NP.config({channel:HY,updateState:c,initialData:n}),sy.config({}),ny("execute-on-form",g.concat([Ci(Cr(),(function(n,t){jb.focusIn(n)}))])),xA.memory({})]),components:[s.asSpec(),f.asSpec(),m.asSpec()]}),v=Sq({getRoot:function(){return p},getFooter:function(){return m.get(p)},getBody:function(){return f.get(p)},getFormWrapper:function(){var n=f.get(p);return Jp.getCurrent(n).getOr(n)}},t.redial,d);return{dialog:p,instanceApi:v}},Oq=tinymce.util.Tools.resolve("tinymce.util.URI"),_q=function(n){var t=function(t){n.getSystem().isConnected()&&t(n)},e=function(n){if(!D(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t((function(t){ui(t,D_,{message:n})}))},o=function(){t((function(n){ii(n,A_)}))},r=function(){t((function(n){ii(n,__)}))},i=function(n){t((function(t){t.getSystem().broadcastOn([LY],n)}))};return{block:e,unblock:o,close:r,sendMessage:i}},Tq=["insertContent","setContent","execCommand","close","block","unblock"],Eq=function(n){return A(n)&&-1!==Tq.indexOf(n.mceAction)},Bq=function(n){return!Eq(n)&&A(n)&&En(n,"mceAction")},Dq=function(n,t,e){switch(e.mceAction){case"insertContent":n.insertContent(e.content);break;case"setContent":n.setContent(e.content);break;case"execCommand":var o=!!F(e.ui)&&e.ui;n.execCommand(e.cmd,o,e.value);break;case"close":t.close();break;case"block":t.block(e.message);break;case"unblock":t.unblock();break}},Aq=function(n,e,o,r){var i,u=iq(n.title,r),a=GY(n),c=n.buttons.bind((function(n){return 0===n.length?w.none():w.some(yq({buttons:n},r))})),s=mq.initUrlDialog((function(){return y}),uq((function(){return b}),e)),f=m(m({},n.height.fold((function(){return{}}),(function(n){return{height:n+"px","max-height":n+"px"}}))),n.width.fold((function(){return{}}),(function(n){return{width:n+"px","max-width":n+"px"}}))),l=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],d=new Oq(n.url,{base_uri:new Oq(t.window.location.href)}),g=d.protocol+"://"+d.host+(d.port?":"+d.port:""),p=Ge(w.none()),v=[ny("messages",[Oi((function(){var e=XO($e.fromDom(t.window),"message",(function(t){if(d.isSameOrigin(new Oq(t.raw().origin))){var e=t.raw().data;Eq(e)?Dq(o,y,e):Bq(e)&&n.onMessage(y,e)}}));p.set(w.some(e))})),_i((function(){p.get().each((function(n){return n.unbind()}))}))]),Tf.config({channels:(i={},i[LY]={onReceive:function(n,t){qc(n.element(),"iframe").each((function(n){var e=n.dom().contentWindow;e.postMessage(t,g)}))}},i)})],h={header:u,body:a,footer:c,extraClasses:l,extraBehaviours:v,extraStyles:f},b=aq(h,n,s,r),y=_q(b);return{dialog:b,instanceApi:y}},Mq=function(n){var t=n.backstage.shared,e=function(e,o){var r=function(){RG.hide(c),o()},i=Bx(bF({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:w.none()},"cancel",n.backstage)),u=KY(),a=qY(r,t.providers),c=Za(ZY({lazySink:function(){return t.getSink()},header:YY(u,a),body:JY(e,t.providers),footer:w.some($Y(QY([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[pi(T_,r)],eventOrder:{}}));RG.show(c);var s=i.get(c);sy.focus(s)};return{open:e}},Fq=function(n){var t=n.backstage.shared,e=function(e,o){var r=function(n){RG.hide(s),o(n)},i=Bx(bF({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:w.none()},"submit",n.backstage)),u=bF({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:w.none()},"cancel",n.backstage),a=KY(),c=qY((function(){return r(!1)}),t.providers),s=Za(ZY({lazySink:function(){return t.getSink()},header:YY(a,c),body:JY(e,t.providers),footer:w.some($Y(QY([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[pi(T_,(function(){return r(!1)})),pi(B_,(function(){return r(!0)}))],eventOrder:{}}));RG.show(s);var f=i.get(s);sy.focus(f)};return{open:e}},Iq=function(n,t){return te(ne("data",t,n))},Rq=function(n){return KO(n,".tox-alert-dialog")||KO(n,".tox-confirm-dialog")},Vq=function(n,t,e){return t&&e?[]:[SL.config({contextual:{lazyContext:function(){return w.some(Pc($e.fromDom(n.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},Hq=function(n){var t=n.backstage,e=n.editor,o=xk(e),r=Mq(n),i=Fq(n),u=function(n,e,o){return void 0!==e&&"toolbar"===e.inline?f(n,t.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?f(n,t.shared.anchors.cursor(),o,e.ariaAttrs):s(n,o)},a=function(n,t){return c(n,t)},c=function(n,o){var r=function(n){var r=Aq(n,{closeWindow:function(){RG.hide(r.dialog),o(r.instanceApi)}},e,t);return RG.show(r.dialog),r.instanceApi};return cY.openUrl(r,n)},s=function(n,e){var o=function(n,o,r){var i=o,u={dataValidator:r,initialData:i,internalDialog:n},a=kq(u,{redial:cY.redial,closeWindow:function(){RG.hide(a.dialog),e(a.instanceApi)}},t);return RG.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return cY.open(o,n)},f=function(n,r,i,u){var a=function(n,a,c){var s=Iq(a,c),f=Xj(),l=t.shared.header.isPositionedAtTop(),d={dataValidator:c,initialData:s,internalDialog:n},g=function(){return f.on((function(n){gx.reposition(n),SL.refresh(n)}))},v=Cq(d,{redial:cY.redial,closeWindow:function(){f.on(gx.hide),e.off("ResizeEditor",g),f.clear(),i(v.instanceApi)}},t,u),h=Za(gx.sketch(m(m({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},l?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:hf(p([ny("window-manager-inline-events",[pi($r(),(function(n,t){ii(v.dialog,T_)}))])],Vq(e,o,l))),isExtraPart:function(n,t){return Rq(t)}})));return f.set(h),gx.showWithin(h,r,nc(v.dialog),w.some(Oa())),o&&l||(SL.refresh(h),e.on("ResizeEditor",g)),v.instanceApi.setData(s),jb.focusIn(v.dialog),v.instanceApi};return cY.open(a,n)},l=function(n,t){i.open(n,(function(n){t(n)}))},d=function(n,t){r.open(n,(function(){t()}))},g=function(n){n.close()};return{open:u,openUrl:a,alert:d,close:g,confirm:l}};function Pq(){d.add("silver",(function(n){var t=EG(n),e=t.uiMothership,o=t.backstage,r=t.renderUI,u=t.getUi;WO.register(n,o.shared);var a=Hq({editor:n,backstage:o});return{renderUI:r,getWindowManagerImpl:i(a),getNotificationManagerImpl:function(){return Hx(n,{backstage:o},e)},ui:u()}}))}Pq()})(window)}).call(this,e("24aa"))}}]);